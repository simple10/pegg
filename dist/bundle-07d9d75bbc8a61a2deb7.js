!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define(e);else{var n=e();for(var i in n)("object"==typeof exports?exports:t)[i]=n[i]}}(this,function(){return function(t){function e(i){if(n[i])return n[i].exports;var r=n[i]={exports:{},id:i,loaded:!1};return t[i].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var n={};return e.m=t,e.c=n,e.p="dist/",e(0)}([function(t,e,n){var i,r,o,s,a,c,u,l,h,p,d,f,g,m,_,y,v,b,w,P,x,k,O,j,C,S,A,T,E,I,N;n(203),j=n(182),j(document.body),n(81),n(80),n(82),u=n(35),d=n(37),v=n(13),b=n(1),c=n(8),l=n(179),o=n(135),h=n(142),f=n(68),_=n(162),x=n(11),r=n(38),g=n(27),i=n(62),P=n(28),s=n(63),a=n(7),m=n(130),p=n(176).scripts.cosmic_unicorn,k=n(2),w=n(21),y=n(92),w.registerMethod("spring",y),u.setFPSCap(60),k.getViewportWidth()>400?(C=document.createElement("div"),C.className="device",S=document.createElement("iframe"),S.src="/index.html",S.className="iframe",C.appendChild(S),document.body.appendChild(C)):(E=u.createContext(),E.setPerspective(2e3),O=new o,T=new f,N=new _,A=new d({inOrigin:[1,-1],outOrigin:[0,-1],showOrigin:[.5,.5],inTransform:b.thenMove(b.rotateX(0),[0,-window.innerHeight,0]),outTransform:b.thenMove(b.rotateZ(0),[0,window.innerHeight,0]),inTransition:{duration:500,curve:c.outCubic},outTransition:{duration:350,curve:c.outCubic}}),E.add(A),v.after(function(){return I()},20),I=function(){x.getLoggedIn()?(A.show(O),g.load(),i.load(1),s.loadCategories()):A.show("card"===r.getCurrentPageID()?O:"login"===r.getCurrentPageID()?T:N)},r.on(a.stores.LOGIN_CHANGE,I),x.on(a.stores.LOGIN_CHANGE,I))},function(t,e,n){var i;i=function(t,e,n){function i(t){return 2===t.length?t[0]*t[0]+t[1]*t[1]:t[0]*t[0]+t[1]*t[1]+t[2]*t[2]}function r(t){return Math.sqrt(i(t))}function o(t){return 0>t?-1:1}var s={};s.precision=1e-6,s.identity=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],s.multiply4x4=function(t,e){return[t[0]*e[0]+t[4]*e[1]+t[8]*e[2]+t[12]*e[3],t[1]*e[0]+t[5]*e[1]+t[9]*e[2]+t[13]*e[3],t[2]*e[0]+t[6]*e[1]+t[10]*e[2]+t[14]*e[3],t[3]*e[0]+t[7]*e[1]+t[11]*e[2]+t[15]*e[3],t[0]*e[4]+t[4]*e[5]+t[8]*e[6]+t[12]*e[7],t[1]*e[4]+t[5]*e[5]+t[9]*e[6]+t[13]*e[7],t[2]*e[4]+t[6]*e[5]+t[10]*e[6]+t[14]*e[7],t[3]*e[4]+t[7]*e[5]+t[11]*e[6]+t[15]*e[7],t[0]*e[8]+t[4]*e[9]+t[8]*e[10]+t[12]*e[11],t[1]*e[8]+t[5]*e[9]+t[9]*e[10]+t[13]*e[11],t[2]*e[8]+t[6]*e[9]+t[10]*e[10]+t[14]*e[11],t[3]*e[8]+t[7]*e[9]+t[11]*e[10]+t[15]*e[11],t[0]*e[12]+t[4]*e[13]+t[8]*e[14]+t[12]*e[15],t[1]*e[12]+t[5]*e[13]+t[9]*e[14]+t[13]*e[15],t[2]*e[12]+t[6]*e[13]+t[10]*e[14]+t[14]*e[15],t[3]*e[12]+t[7]*e[13]+t[11]*e[14]+t[15]*e[15]]},s.multiply=function(t,e){return[t[0]*e[0]+t[4]*e[1]+t[8]*e[2],t[1]*e[0]+t[5]*e[1]+t[9]*e[2],t[2]*e[0]+t[6]*e[1]+t[10]*e[2],0,t[0]*e[4]+t[4]*e[5]+t[8]*e[6],t[1]*e[4]+t[5]*e[5]+t[9]*e[6],t[2]*e[4]+t[6]*e[5]+t[10]*e[6],0,t[0]*e[8]+t[4]*e[9]+t[8]*e[10],t[1]*e[8]+t[5]*e[9]+t[9]*e[10],t[2]*e[8]+t[6]*e[9]+t[10]*e[10],0,t[0]*e[12]+t[4]*e[13]+t[8]*e[14]+t[12],t[1]*e[12]+t[5]*e[13]+t[9]*e[14]+t[13],t[2]*e[12]+t[6]*e[13]+t[10]*e[14]+t[14],1]},s.thenMove=function(t,e){return e[2]||(e[2]=0),[t[0],t[1],t[2],0,t[4],t[5],t[6],0,t[8],t[9],t[10],0,t[12]+e[0],t[13]+e[1],t[14]+e[2],1]},s.moveThen=function(t,e){t[2]||(t[2]=0);var n=t[0]*e[0]+t[1]*e[4]+t[2]*e[8],i=t[0]*e[1]+t[1]*e[5]+t[2]*e[9],r=t[0]*e[2]+t[1]*e[6]+t[2]*e[10];return s.thenMove(e,[n,i,r])},s.translate=function(t,e,n){return void 0===n&&(n=0),[1,0,0,0,0,1,0,0,0,0,1,0,t,e,n,1]},s.thenScale=function(t,e){return[e[0]*t[0],e[1]*t[1],e[2]*t[2],0,e[0]*t[4],e[1]*t[5],e[2]*t[6],0,e[0]*t[8],e[1]*t[9],e[2]*t[10],0,e[0]*t[12],e[1]*t[13],e[2]*t[14],1]},s.scale=function(t,e,n){return void 0===n&&(n=1),void 0===e&&(e=t),[t,0,0,0,0,e,0,0,0,0,n,0,0,0,0,1]},s.rotateX=function(t){var e=Math.cos(t),n=Math.sin(t);return[1,0,0,0,0,e,n,0,0,-n,e,0,0,0,0,1]},s.rotateY=function(t){var e=Math.cos(t),n=Math.sin(t);return[e,0,-n,0,0,1,0,0,n,0,e,0,0,0,0,1]},s.rotateZ=function(t){var e=Math.cos(t),n=Math.sin(t);return[e,n,0,0,-n,e,0,0,0,0,1,0,0,0,0,1]},s.rotate=function(t,e,n){var i=Math.cos(t),r=Math.sin(t),o=Math.cos(e),s=Math.sin(e),a=Math.cos(n),c=Math.sin(n),u=[o*a,i*c+r*s*a,r*c-i*s*a,0,-o*c,i*a-r*s*c,r*a+i*s*c,0,s,-r*o,i*o,0,0,0,0,1];return u},s.rotateAxis=function(t,e){var n=Math.sin(e),i=Math.cos(e),r=1-i,o=t[0]*t[0]*r,s=t[0]*t[1]*r,a=t[0]*t[2]*r,c=t[1]*t[1]*r,u=t[1]*t[2]*r,l=t[2]*t[2]*r,h=t[0]*n,p=t[1]*n,d=t[2]*n,f=[o+i,s+d,a-p,0,s-d,c+i,u+h,0,a+p,u-h,l+i,0,0,0,0,1];return f},s.aboutOrigin=function(t,e){var n=t[0]-(t[0]*e[0]+t[1]*e[4]+t[2]*e[8]),i=t[1]-(t[0]*e[1]+t[1]*e[5]+t[2]*e[9]),r=t[2]-(t[0]*e[2]+t[1]*e[6]+t[2]*e[10]);return s.thenMove(e,[n,i,r])},s.skew=function(t,e,n){return[1,Math.tan(e),0,0,Math.tan(n),1,0,0,0,Math.tan(t),1,0,0,0,0,1]},s.skewX=function(t){return[1,0,0,0,Math.tan(t),1,0,0,0,0,1,0,0,0,0,1]},s.skewY=function(t){return[1,Math.tan(t),0,0,0,1,0,0,0,0,1,0,0,0,0,1]},s.perspective=function(t){return[1,0,0,0,0,1,0,0,0,0,1,-1/t,0,0,0,1]},s.getTranslate=function(t){return[t[12],t[13],t[14]]},s.inverse=function(t){var e=t[5]*t[10]-t[6]*t[9],n=t[4]*t[10]-t[6]*t[8],i=t[4]*t[9]-t[5]*t[8],r=t[1]*t[10]-t[2]*t[9],o=t[0]*t[10]-t[2]*t[8],s=t[0]*t[9]-t[1]*t[8],a=t[1]*t[6]-t[2]*t[5],c=t[0]*t[6]-t[2]*t[4],u=t[0]*t[5]-t[1]*t[4],l=t[0]*e-t[1]*n+t[2]*i,h=1/l,p=[h*e,-h*r,h*a,0,-h*n,h*o,-h*c,0,h*i,-h*s,h*u,0,0,0,0,1];return p[12]=-t[12]*p[0]-t[13]*p[4]-t[14]*p[8],p[13]=-t[12]*p[1]-t[13]*p[5]-t[14]*p[9],p[14]=-t[12]*p[2]-t[13]*p[6]-t[14]*p[10],p},s.transpose=function(t){return[t[0],t[4],t[8],t[12],t[1],t[5],t[9],t[13],t[2],t[6],t[10],t[14],t[3],t[7],t[11],t[15]]},s.interpret=function(t){var e=[t[0],t[1],t[2]],n=o(e[0]),a=r(e),c=[e[0]+n*a,e[1],e[2]],u=2/i(c);if(u>=1/0)return{translate:s.getTranslate(t),rotate:[0,0,0],scale:[0,0,0],skew:[0,0,0]};var l=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1];l[0]=1-u*c[0]*c[0],l[5]=1-u*c[1]*c[1],l[10]=1-u*c[2]*c[2],l[1]=-u*c[0]*c[1],l[2]=-u*c[0]*c[2],l[6]=-u*c[1]*c[2],l[4]=l[1],l[8]=l[2],l[9]=l[6];var h=s.multiply(l,t),p=[h[5],h[6]],d=o(p[0]),f=r(p),g=[p[0]+d*f,p[1]],m=2/i(g),_=[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1];_[5]=1-m*g[0]*g[0],_[10]=1-m*g[1]*g[1],_[6]=-m*g[0]*g[1],_[9]=_[6];var y=s.multiply(_,l),v=s.multiply(y,t),b=s.scale(v[0]<0?-1:1,v[5]<0?-1:1,v[10]<0?-1:1);v=s.multiply(v,b),y=s.multiply(b,y);var w={};return w.translate=s.getTranslate(t),w.rotate=[Math.atan2(-y[6],y[10]),Math.asin(y[2]),Math.atan2(-y[1],y[0])],w.rotate[0]||(w.rotate[0]=0,w.rotate[2]=Math.atan2(y[4],y[5])),w.scale=[v[0],v[5],v[10]],w.skew=[Math.atan2(v[9],w.scale[2]),Math.atan2(v[8],w.scale[2]),Math.atan2(v[4],w.scale[0])],Math.abs(w.rotate[0])+Math.abs(w.rotate[2])>1.5*Math.PI&&(w.rotate[1]=Math.PI-w.rotate[1],w.rotate[1]>Math.PI&&(w.rotate[1]-=2*Math.PI),w.rotate[1]<-Math.PI&&(w.rotate[1]+=2*Math.PI),w.rotate[0]<0?w.rotate[0]+=Math.PI:w.rotate[0]-=Math.PI,w.rotate[2]<0?w.rotate[2]+=Math.PI:w.rotate[2]-=Math.PI),w},s.average=function(t,e,n){n=void 0===n?.5:n;for(var i=s.interpret(t),r=s.interpret(e),o={translate:[0,0,0],rotate:[0,0,0],scale:[0,0,0],skew:[0,0,0]},a=0;3>a;a++)o.translate[a]=(1-n)*i.translate[a]+n*r.translate[a],o.rotate[a]=(1-n)*i.rotate[a]+n*r.rotate[a],o.scale[a]=(1-n)*i.scale[a]+n*r.scale[a],o.skew[a]=(1-n)*i.skew[a]+n*r.skew[a];return s.build(o)},s.build=function(t){var e=s.scale(t.scale[0],t.scale[1],t.scale[2]),n=s.skew(t.skew[0],t.skew[1],t.skew[2]),i=s.rotate(t.rotate[0],t.rotate[1],t.rotate[2]);return s.thenMove(s.multiply(s.multiply(i,n),e),t.translate)},s.equals=function(t,e){return!s.notEquals(t,e)},s.notEquals=function(t,e){return t===e?!1:!(t&&e)||t[12]!==e[12]||t[13]!==e[13]||t[14]!==e[14]||t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||t[4]!==e[4]||t[5]!==e[5]||t[6]!==e[6]||t[8]!==e[8]||t[9]!==e[9]||t[10]!==e[10]},s.normalizeRotation=function(t){var e=t.slice(0);for((e[0]===.5*Math.PI||e[0]===.5*-Math.PI)&&(e[0]=-e[0],e[1]=Math.PI-e[1],e[2]-=Math.PI),e[0]>.5*Math.PI&&(e[0]=e[0]-Math.PI,e[1]=Math.PI-e[1],e[2]-=Math.PI),e[0]<.5*-Math.PI&&(e[0]=e[0]+Math.PI,e[1]=-Math.PI-e[1],e[2]-=Math.PI);e[1]<-Math.PI;)e[1]+=2*Math.PI;for(;e[1]>=Math.PI;)e[1]-=2*Math.PI;for(;e[2]<-Math.PI;)e[2]+=2*Math.PI;for(;e[2]>=Math.PI;)e[2]-=2*Math.PI;return e},s.inFront=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,.001,1],s.behind=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,-.001,1],n.exports=s}.call(e,n,e,t),/* This Source Code Form is subject to the terms of the Mozilla Public
	 * License, v. 2.0. If a copy of the MPL was not distributed with this
	 * file, You can obtain one at http://mozilla.org/MPL/2.0/.
	 *
	 * Owner: mark@famo.us
	 * @license MPL 2.0
	 * @copyright Famous Industries, Inc. 2014
	 */
!(void 0!==i&&(t.exports=i))},function(t,e,n){var i,r,o,s=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1};i=n(13),r=n(1),o={keyMirror:function(t){var e,n;n={};for(e in t)t.hasOwnProperty(e)&&(n[e]=e);return n},animateAll:function(t,e){var n,o,s,a;for(a=[],o=0,s=e.length;s>o;o++)n=e[o],a.push(i.after(function(t,e){return null!=e.origin&&t.setOrigin(e.origin,e.transition),null!=e.align&&t.setAlign(e.align,e.transition),null!=e.scale&&t.setTransform(r.scale.apply(r,e.scale),e.transition),null!=e.transform?t.setTransform(e.transform,e.transition):void 0}.bind(this,t,n),n.delay));return a},animate:function(t,e,n){return n||(n=function(){}),i.after(function(){return null!=e.origin&&t.setOrigin(e.origin,e.transition,n),null!=e.align&&t.setAlign(e.align,e.transition,n),null!=e.scale&&t.setTransform(r.scale.apply(r,e.scale),e.transition,n),null!=e.transform&&t.setTransform(e.transform,e.transition,n),null!=e.opacity?t.setOpacity(e.opacity,e.transition,n):void 0},e.delay)},getViewportWidth:function(){return Math.max(document.documentElement.clientWidth,window.innerWidth||0)},getViewportHeight:function(){return Math.max(document.documentElement.clientHeight,window.innerHeight||0)},getContentWidth:function(){return this.getViewportWidth()-20},getAjax:function(t,e,n){var i,r;return r=""+t+"?"+e,i=new XMLHttpRequest,i.addEventListener("readystatechange",function(){var t,e;return 4===i.readyState?(t=[200,304],e=i.status,n(s.call(t,e)>=0?i.responseText:"Error loading data...")):void 0}),i.open("GET",r,!1),i.send()},parseQueryString:function(t,e){var n,i,r,o,s,a,c,u;if(s=t.split("&"),r=function(){var t,e,r,a;for(a=[],t=0,e=s.length;e>t;t++)i=s[t],a.push((r=i.split("="),n=r[0],o=r[1],r));return a}(),null==e)return r;for(a=0,c=r.length;c>a;a++)if(u=r[a],n=u[0],o=u[1],n===e)return o}},t.exports=o,Date.prototype.addDays=function(t){var e;return e=new Date(this.valueOf()),e.setDate(e.getDate()+t),e}},function(t,e,n){var i;i=function(t,e,i){function r(t){h.call(this),this.options={},this.properties={},this.attributes={},this.content="",this.classList=[],this.size=null,this._classesDirty=!0,this._stylesDirty=!0,this._attributesDirty=!0,this._sizeDirty=!0,this._contentDirty=!0,this._trueSizeCheck=!0,this._dirtyClasses=[],t&&this.setOptions(t),this._currentTarget=null}function o(t){for(var e=0;e<this._dirtyClasses.length;e++)t.classList.remove(this._dirtyClasses[e]);this._dirtyClasses=[]}function s(t){for(var e in this.properties)t.style[e]=this.properties[e]}function a(t){for(var e in this.properties)t.style[e]=""}function c(t){for(var e in this.attributes)t.setAttribute(e,this.attributes[e])}function u(t){for(var e in this.attributes)t.removeAttribute(e)}function l(t,e){return t&&e?t[0]!==e[0]||t[1]!==e[1]:t!==e}var h=n(84);r.prototype=Object.create(h.prototype),r.prototype.constructor=r,r.prototype.elementType="div",r.prototype.elementClass="famous-surface",r.prototype.setAttributes=function(t){for(var e in t){if("style"===e)throw new Error('Cannot set styles via "setAttributes" as it will break Famo.us.  Use "setProperties" instead.');this.attributes[e]=t[e]}this._attributesDirty=!0},r.prototype.getAttributes=function(){return this.attributes},r.prototype.setProperties=function(t){for(var e in t)this.properties[e]=t[e];return this._stylesDirty=!0,this},r.prototype.getProperties=function(){return this.properties},r.prototype.addClass=function(t){return this.classList.indexOf(t)<0&&(this.classList.push(t),this._classesDirty=!0),this},r.prototype.removeClass=function(t){var e=this.classList.indexOf(t);return e>=0&&(this._dirtyClasses.push(this.classList.splice(e,1)[0]),this._classesDirty=!0),this},r.prototype.toggleClass=function(t){var e=this.classList.indexOf(t);return e>=0?this.removeClass(t):this.addClass(t),this},r.prototype.setClasses=function(t){var e=0,n=[];for(e=0;e<this.classList.length;e++)t.indexOf(this.classList[e])<0&&n.push(this.classList[e]);for(e=0;e<n.length;e++)this.removeClass(n[e]);for(e=0;e<t.length;e++)this.addClass(t[e]);return this},r.prototype.getClassList=function(){return this.classList},r.prototype.setContent=function(t){return this.content!==t&&(this.content=t,this._contentDirty=!0),this},r.prototype.getContent=function(){return this.content},r.prototype.setOptions=function(t){return t.size&&this.setSize(t.size),t.classes&&this.setClasses(t.classes),t.properties&&this.setProperties(t.properties),t.attributes&&this.setAttributes(t.attributes),t.content&&this.setContent(t.content),this},r.prototype.setup=function(t){var e=t.allocate(this.elementType);if(this.elementClass)if(this.elementClass instanceof Array)for(var n=0;n<this.elementClass.length;n++)e.classList.add(this.elementClass[n]);else e.classList.add(this.elementClass);e.style.display="",this.attach(e),this._opacity=null,this._currentTarget=e,this._stylesDirty=!0,this._classesDirty=!0,this._attributesDirty=!0,this._sizeDirty=!0,this._contentDirty=!0,this._originDirty=!0,this._transformDirty=!0},r.prototype.commit=function(t){this._currentTarget||this.setup(t.allocator);var e=this._currentTarget,n=t.size;if(this._classesDirty){o.call(this,e);for(var i=this.getClassList(),r=0;r<i.length;r++)e.classList.add(i[r]);this._classesDirty=!1,this._trueSizeCheck=!0}if(this._stylesDirty&&(s.call(this,e),this._stylesDirty=!1,this._trueSizeCheck=!0),this._attributesDirty&&(c.call(this,e),this._attributesDirty=!1,this._trueSizeCheck=!0),this.size){var a=t.size;if(n=[this.size[0],this.size[1]],void 0===n[0]&&(n[0]=a[0]),void 0===n[1]&&(n[1]=a[1]),n[0]===!0||n[1]===!0){if(n[0]!==!0||!this._trueSizeCheck&&0!==this._size[0])this._size&&(n[0]=this._size[0]);else{var u=e.offsetWidth;this._size&&this._size[0]!==u&&(this._size[0]=u,this._sizeDirty=!0),n[0]=u}if(n[1]!==!0||!this._trueSizeCheck&&0!==this._size[1])this._size&&(n[1]=this._size[1]);else{var p=e.offsetHeight;this._size&&this._size[1]!==p&&(this._size[1]=p,this._sizeDirty=!0),n[1]=p}this._trueSizeCheck=!1}}l(this._size,n)&&(this._size||(this._size=[0,0]),this._size[0]=n[0],this._size[1]=n[1],this._sizeDirty=!0),this._sizeDirty&&(this._size&&(e.style.width=this.size&&this.size[0]===!0?"":this._size[0]+"px",e.style.height=this.size&&this.size[1]===!0?"":this._size[1]+"px"),this._eventOutput.emit("resize")),this._contentDirty&&(this.deploy(e),this._eventOutput.emit("deploy"),this._contentDirty=!1,this._trueSizeCheck=!0),h.prototype.commit.call(this,t)},r.prototype.cleanup=function(t){var e=0,n=this._currentTarget;this._eventOutput.emit("recall"),this.recall(n),n.style.display="none",n.style.opacity="",n.style.width="",n.style.height="",a.call(this,n),u.call(this,n);var i=this.getClassList();for(o.call(this,n),e=0;e<i.length;e++)n.classList.remove(i[e]);if(this.elementClass)if(this.elementClass instanceof Array)for(e=0;e<this.elementClass.length;e++)n.classList.remove(this.elementClass[e]);else n.classList.remove(this.elementClass);this.detach(n),this._currentTarget=null,t.deallocate(n)},r.prototype.deploy=function(t){var e=this.getContent();if(e instanceof Node){for(;t.hasChildNodes();)t.removeChild(t.firstChild);t.appendChild(e)}else t.innerHTML=e},r.prototype.recall=function(t){for(var e=document.createDocumentFragment();t.hasChildNodes();)e.appendChild(t.firstChild);this.setContent(e)},r.prototype.getSize=function(){return this._size?this._size:this.size},r.prototype.setSize=function(t){return this.size=t?[t[0],t[1]]:null,this._sizeDirty=!0,this},i.exports=r}.call(e,n,e,t),/* This Source Code Form is subject to the terms of the Mozilla Public
	 * License, v. 2.0. If a copy of the MPL was not distributed with this
	 * file, You can obtain one at http://mozilla.org/MPL/2.0/.
	 *
	 * Owner: mark@famo.us
	 * @license MPL 2.0
	 * @copyright Famous Industries, Inc. 2014
	 */
!(void 0!==i&&(t.exports=i))},function(t,e,n){var i;i=function(t,e,i){function r(t){this._node=new a,this._eventInput=new o,this._eventOutput=new o,o.setInputHandler(this,this._eventInput),o.setOutputHandler(this,this._eventOutput),this.options=c.clone(this.constructor.DEFAULT_OPTIONS||r.DEFAULT_OPTIONS),this._optionsManager=new s(this.options),t&&this.setOptions(t)}var o=n(12),s=n(19),a=n(20),c=n(15);r.DEFAULT_OPTIONS={},r.prototype.getOptions=function(t){return this._optionsManager.getOptions(t)},r.prototype.setOptions=function(t){this._optionsManager.patch(t)},r.prototype.add=function(){return this._node.add.apply(this._node,arguments)},r.prototype._add=r.prototype.add,r.prototype.render=function(){return this._node.render()},r.prototype.getSize=function(){return this._node&&this._node.getSize?this._node.getSize.apply(this._node,arguments)||this.options.size:this.options.size},i.exports=r}.call(e,n,e,t),/* This Source Code Form is subject to the terms of the Mozilla Public
	 * License, v. 2.0. If a copy of the MPL was not distributed with this
	 * file, You can obtain one at http://mozilla.org/MPL/2.0/.
	 *
	 * Owner: mark@famo.us
	 * @license MPL 2.0
	 * @copyright Famous Industries, Inc. 2014
	 */
!(void 0!==i&&(t.exports=i))},function(t,e,n){var i;i=function(t,e,i){function r(t){this._transformState=new c(s.identity),this._opacityState=new a(1),this._originState=new a([0,0]),this._alignState=new a([0,0]),this._sizeState=new a([0,0]),this._proportionsState=new a([0,0]),this._modifier=new o({transform:this._transformState,opacity:this._opacityState,origin:null,align:null,size:null,proportions:null}),this._hasOrigin=!1,this._hasAlign=!1,this._hasSize=!1,this._hasProportions=!1,t&&(t.transform&&this.setTransform(t.transform),void 0!==t.opacity&&this.setOpacity(t.opacity),t.origin&&this.setOrigin(t.origin),t.align&&this.setAlign(t.align),t.size&&this.setSize(t.size),t.proportions&&this.setProportions(t.proportions))}var o=n(16),s=n(1),a=n(21),c=n(43);r.prototype.setTransform=function(t,e,n){return this._transformState.set(t,e,n),this},r.prototype.setOpacity=function(t,e,n){return this._opacityState.set(t,e,n),this},r.prototype.setOrigin=function(t,e,n){return null===t?(this._hasOrigin&&(this._modifier.originFrom(null),this._hasOrigin=!1),this):(this._hasOrigin||(this._hasOrigin=!0,this._modifier.originFrom(this._originState)),this._originState.set(t,e,n),this)},r.prototype.setAlign=function(t,e,n){return null===t?(this._hasAlign&&(this._modifier.alignFrom(null),this._hasAlign=!1),this):(this._hasAlign||(this._hasAlign=!0,this._modifier.alignFrom(this._alignState)),this._alignState.set(t,e,n),this)},r.prototype.setSize=function(t,e,n){return null===t?(this._hasSize&&(this._modifier.sizeFrom(null),this._hasSize=!1),this):(this._hasSize||(this._hasSize=!0,this._modifier.sizeFrom(this._sizeState)),this._sizeState.set(t,e,n),this)},r.prototype.setProportions=function(t,e,n){return null===t?(this._hasProportions&&(this._modifier.proportionsFrom(null),this._hasProportions=!1),this):(this._hasProportions||(this._hasProportions=!0,this._modifier.proportionsFrom(this._proportionsState)),this._proportionsState.set(t,e,n),this)},r.prototype.halt=function(){this._transformState.halt(),this._opacityState.halt(),this._originState.halt(),this._alignState.halt(),this._sizeState.halt(),this._proportionsState.halt()},r.prototype.getTransform=function(){return this._transformState.get()},r.prototype.getFinalTransform=function(){return this._transformState.getFinal()},r.prototype.getOpacity=function(){return this._opacityState.get()},r.prototype.getOrigin=function(){return this._hasOrigin?this._originState.get():null},r.prototype.getAlign=function(){return this._hasAlign?this._alignState.get():null},r.prototype.getSize=function(){return this._hasSize?this._sizeState.get():null},r.prototype.getProportions=function(){return this._hasProportions?this._proportionsState.get():null},r.prototype.modify=function(t){return this._modifier.modify(t)},i.exports=r}.call(e,n,e,t),/* This Source Code Form is subject to the terms of the Mozilla Public
	 * License, v. 2.0. If a copy of the MPL was not distributed with this
	 * file, You can obtain one at http://mozilla.org/MPL/2.0/.
	 *
	 * Owner: mark@famo.us
	 * @license MPL 2.0
	 * @copyright Famous Industries, Inc. 2014
	 */
!(void 0!==i&&(t.exports=i))},function(t,e,n){var i;i=function(t,e,i){function r(){this._imageUrl=void 0,o.apply(this,arguments)}var o=n(3),s=[],a=[],c=[],u=!0;r.enableCache=function(){u=!0},r.disableCache=function(){u=!1},r.clearCache=function(){s=[],a=[],c=[]},r.getCache=function(){return{urlCache:s,countCache:a,nodeCache:a}},r.prototype=Object.create(o.prototype),r.prototype.constructor=r,r.prototype.elementType="img",r.prototype.elementClass="famous-surface",r.prototype.setContent=function(t){var e=s.indexOf(this._imageUrl);-1!==e&&(1===a[e]?(s.splice(e,1),a.splice(e,1),c.splice(e,1)):a[e]--),e=s.indexOf(t),-1===e?(s.push(t),a.push(1)):a[e]++,this._imageUrl=t,this._contentDirty=!0},r.prototype.deploy=function(t){var e=s.indexOf(this._imageUrl);if(void 0===c[e]&&u){var n=new Image;n.src=this._imageUrl||"",c[e]=n}t.src=this._imageUrl||""},r.prototype.recall=function(t){t.src=""},i.exports=r}.call(e,n,e,t),/* This Source Code Form is subject to the terms of the Mozilla Public
	 * License, v. 2.0. If a copy of the MPL was not distributed with this
	 * file, You can obtain one at http://mozilla.org/MPL/2.0/.
	 *
	 * Owner: mark@famo.us
	 * @license MPL 2.0
	 * @copyright Famous Industries, Inc. 2014
	 */
!(void 0!==i&&(t.exports=i))},function(t,e,n){var i;i=n(2),t.exports={actions:i.keyMirror({ADD_ANSWERS:null,ADD_CATEGORIES:null,ADD_QUESTION:null,AUTH:null,BADGES_VIEWED:null,CARD_COMMENT:null,CARD_SELECT:null,FILTER_PREFS:null,LOAD_ACTIVITY:null,LOAD_CARD:null,LOAD_CATEGORIES:null,LOAD_APP:null,LOAD_LINK:null,LOADING_START:null,LOADING_DONE:null,LOGIN:null,LOGOUT:null,MENU_SELECT:null,NEXT_PAGE:null,PEGG_SUBMIT:null,PICK_MOOD:null,PLAY_CONTINUE:null,PLUG_IMAGE:null,PREF_SUBMIT:null,PREV_PAGE:null,SHOW_MESSAGE:null,SUBSCRIBER_SUBMIT:null,USER_LOAD:null,USER_LOGIN:null,USER_LOGOUT:null,SINGLE_CARD_COMMENT:null,SINGLE_CARD_LOAD:null,SINGLE_CARD_PEGG:null,SINGLE_CARD_PREF:null,SINGLE_CARD_PLUG:null}),stores:i.keyMirror({CHANGE:null,ACTIVITY_CHANGE:null,CARDS_CHANGE:null,CARD_CHANGE:null,CARD_FAIL:null,CARD_WIN:null,CATEGORIES_CHANGE:null,CHOICES_CHANGE:null,COMMENTS_CHANGE:null,HIDE_MESSAGE:null,LOAD_ERROR:null,LOGIN_CHANGE:null,MENU_CHANGE:null,MOOD_CHANGE:null,MOODS_LOADED:null,NO_PEGGS_REMAINING:null,NO_PREFS_REMAINING:null,PAGE_CHANGE:null,PLAY_CHANGE:null,PLAY_PEGGS:null,PLAY_PREFS:null,PLUG_SAVED:null,PREF_IMAGES_CHANGE:null,PREF_SAVED:null,PROFILE_ACTIVITY_CHANGE:null,PROFILE_LOAD:null,REQUIRE_LOGIN:null,SHOW_MESSAGE:null,STATUS_CHANGE:null,SUBSCRIBE_FAIL:null,SUBSCRIBE_PASS:null,UNLOCK_ACHIEVED:null,BADGE_CHANGE:null,GAME_LOADED:null})}},function(t,e,n){var i;i=function(t,e,n){var i={inQuad:function(t){return t*t},outQuad:function(t){return-(t-=1)*t+1},inOutQuad:function(t){return(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1)},inCubic:function(t){return t*t*t},outCubic:function(t){return--t*t*t+1},inOutCubic:function(t){return(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2)},inQuart:function(t){return t*t*t*t},outQuart:function(t){return-(--t*t*t*t-1)},inOutQuart:function(t){return(t/=.5)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)},inQuint:function(t){return t*t*t*t*t},outQuint:function(t){return--t*t*t*t*t+1},inOutQuint:function(t){return(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)},inSine:function(t){return-1*Math.cos(t*(Math.PI/2))+1},outSine:function(t){return Math.sin(t*(Math.PI/2))},inOutSine:function(t){return-.5*(Math.cos(Math.PI*t)-1)},inExpo:function(t){return 0===t?0:Math.pow(2,10*(t-1))},outExpo:function(t){return 1===t?1:-Math.pow(2,-10*t)+1},inOutExpo:function(t){return 0===t?0:1===t?1:(t/=.5)<1?.5*Math.pow(2,10*(t-1)):.5*(-Math.pow(2,-10*--t)+2)},inCirc:function(t){return-(Math.sqrt(1-t*t)-1)},outCirc:function(t){return Math.sqrt(1- --t*t)},inOutCirc:function(t){return(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},inElastic:function(t){var e=1.70158,n=0,i=1;return 0===t?0:1===t?1:(n||(n=.3),e=n/(2*Math.PI)*Math.asin(1/i),-(i*Math.pow(2,10*(t-=1))*Math.sin(2*(t-e)*Math.PI/n)))},outElastic:function(t){var e=1.70158,n=0,i=1;return 0===t?0:1===t?1:(n||(n=.3),e=n/(2*Math.PI)*Math.asin(1/i),i*Math.pow(2,-10*t)*Math.sin(2*(t-e)*Math.PI/n)+1)},inOutElastic:function(t){var e=1.70158,n=0,i=1;return 0===t?0:2===(t/=.5)?1:(n||(n=.3*1.5),e=n/(2*Math.PI)*Math.asin(1/i),1>t?-.5*i*Math.pow(2,10*(t-=1))*Math.sin(2*(t-e)*Math.PI/n):i*Math.pow(2,-10*(t-=1))*Math.sin(2*(t-e)*Math.PI/n)*.5+1)},inBack:function(t,e){return void 0===e&&(e=1.70158),t*t*((e+1)*t-e)},outBack:function(t,e){return void 0===e&&(e=1.70158),--t*t*((e+1)*t+e)+1},inOutBack:function(t,e){return void 0===e&&(e=1.70158),(t/=.5)<1?.5*t*t*(((e*=1.525)+1)*t-e):.5*((t-=2)*t*(((e*=1.525)+1)*t+e)+2)},inBounce:function(t){return 1-i.outBounce(1-t)},outBounce:function(t){return 1/2.75>t?7.5625*t*t:2/2.75>t?7.5625*(t-=1.5/2.75)*t+.75:2.5/2.75>t?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},inOutBounce:function(t){return.5>t?.5*i.inBounce(2*t):.5*i.outBounce(2*t-1)+.5}};n.exports=i}.call(e,n,e,t),/* This Source Code Form is subject to the terms of the Mozilla Public
	 * License, v. 2.0. If a copy of the MPL was not distributed with this
	 * file, You can obtain one at http://mozilla.org/MPL/2.0/.
	 *
	 * Owner: david@famo.us
	 * @license MPL 2.0
	 * @copyright Famous Industries, Inc. 2014
	 */
!(void 0!==i&&(t.exports=i))},function(t,e,n){"use strict";function i(t){"undefined"!=typeof console&&null!==console&&"function"==typeof console.warn&&console.warn("Bluebird: "+t)}function r(t,e,n){try{return t.call(e,n)}catch(i){return v.e=i,v}}function o(t,e,n,i){try{return t.call(e,n,i)}catch(r){return v.e=r,v}}function s(t,e,n){try{return t.apply(n,e)}catch(i){return v.e=i,v}}function a(t){return"string"==typeof t?t:""+t}function c(t){return null==t||t===!0||t===!1||"string"==typeof t||"number"==typeof t}function u(t){return!c(t)}function l(t){return c(t)?new Error(a(t)):t}function h(t,e){var n,i=t.length,r=new Array(i+1);for(n=0;i>n;++n)r[n]=t[n];return r[n]=e,r}function p(t,e,n){if(c(t))return t;var i={value:n,configurable:!0,enumerable:!1,writable:!0};return m.defineProperty(t,e,i),t}function d(t){throw t}function f(t){function e(){}return e.prototype=t,e}var g=n(32),m=n(30),_=function(){try{var t={};return m.defineProperty(t,"f",{get:function(){return 3}}),3===t.f}catch(e){return!1}}(),y=function(){return"undefined"!=typeof window&&null!==window&&"undefined"!=typeof window.document&&"undefined"!=typeof navigator&&null!==navigator&&"string"==typeof navigator.appName&&window===g?!1:!0}(),v={e:{}},b=function(t,e){function n(){this.constructor=t,this.constructor$=e;for(var n in e.prototype)i.call(e.prototype,n)&&"$"!==n.charAt(n.length-1)&&(this[n+"$"]=e.prototype[n])}var i={}.hasOwnProperty;return n.prototype=e.prototype,t.prototype=new n,t.prototype},w=function(){return"string"!==this}.call("string"),P={thrower:d,isArray:m.isArray,haveGetters:_,notEnumerableProp:p,isPrimitive:c,isObject:u,canEvaluate:y,deprecated:i,errorObj:v,tryCatch1:r,tryCatch2:o,tryCatchApply:s,inherits:b,withAppended:h,asString:a,maybeWrapAsError:l,wrapsPrimitiveReceiver:w,toFastProperties:f};t.exports=P},function(t,e,n){var i;i=function(t,e,i){function r(t){o.call(this,t),this._container=document.createElement("div"),this._container.classList.add("famous-group"),this._container.classList.add("famous-container-group"),this._shouldRecalculateSize=!1,this.context=new s(this._container),this.setContent(this._container)}var o=n(3),s=n(48);r.prototype=Object.create(o.prototype),r.prototype.constructor=r,r.prototype.elementType="div",r.prototype.elementClass="famous-surface",r.prototype.add=function(){return this.context.add.apply(this.context,arguments)},r.prototype.render=function(){return this._sizeDirty&&(this._shouldRecalculateSize=!0),o.prototype.render.apply(this,arguments)},r.prototype.deploy=function(){return this._shouldRecalculateSize=!0,o.prototype.deploy.apply(this,arguments)},r.prototype.commit=function(){var t=this._size?[this._size[0],this._size[1]]:null,e=o.prototype.commit.apply(this,arguments);return(this._shouldRecalculateSize||t&&(this._size[0]!==t[0]||this._size[1]!==t[1]))&&(this.context.setSize(),this._shouldRecalculateSize=!1),this.context.update(),e},i.exports=r}.call(e,n,e,t),/* This Source Code Form is subject to the terms of the Mozilla Public
	 * License, v. 2.0. If a copy of the MPL was not distributed with this
	 * file, You can obtain one at http://mozilla.org/MPL/2.0/.
	 *
	 * Owner: mark@famo.us
	 * @license MPL 2.0
	 * @copyright Famous Industries, Inc. 2014
	 */
!(void 0!==i&&(t.exports=i))},function(t,e,n){var i,r,o,s,a,c,u,l,h,p,d,f={}.hasOwnProperty,g=function(t,e){function n(){this.constructor=t}for(var i in e)f.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};c=n(29),o=n(7),i=n(18),l=n(24),p=n(2),s=n(178),r=n(47)["public"],a=n(33),u=n(22),h=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return g(e,t),e.prototype._subscribed=!1,e.prototype._images=[],e.prototype.login=function(){var t,e,n;return s.setItem("pegg_auth_lastpage",window.location.hash,3600,"/"),t=r.facebook.appId,n=r.facebook.redirectUrl,e="https://m.facebook.com/dialog/oauth?client_id="+t+"&redirect_uri="+n+"&scope=email,public_profile&response_type=token",window.location=e},e.prototype.auth=function(t){var e,n,i,o;return e=p.parseQueryString(t,"access_token"),null!=e?(o="access_token="+e,i=(new Date).addDays(r.facebook.expirationDays),n=i.toISOString(),p.getAjax("https://graph.facebook.com/me",o,function(t){return function(i){var r,o;return o=JSON.parse(i),r={expiration_date:n,id:o.id,access_token:e},t._loginParse(r)}}(this))):void 0},e.prototype._loginParse=function(t){return l.FacebookUtils.logIn(t,{success:function(t){return function(e){return FB.api("/me","get",function(n){return e.save({avatar_url:"https://graph.facebook.com/"+e.get("authData").facebook.id+"/picture",first_name:n.first_name,last_name:n.last_name,gender:n.gender,facebook_id:n.id},{wait:!1,error:function(){},success:function(){var e;return e=s.getItem("pegg_auth_lastpage"),t.emit(o.stores.CHANGE),u.login(e),t.importFriends()}})}),console.log(e.existed()?"User logged in through Facebook!":"User signed up and logged in through Facebook!")}}(this),error:function(t){return function(e,n){return console.log("UserStore.login Error: "+e+" - "+n+" "),t.emit(o.stores.CHANGE),l.User.logOut(),FB.logout()}}(this)})},e.prototype.subscribe=function(t){var e,n;return e=l.Object.extend("Subscriber"),n=new e,n.set("email",t),n.save(null,{success:function(t){return function(e){t._subscribed=!0,t.emit(o.stores.SUBSCRIBE_PASS),console.log("Subscriber created with objectId: "+e.id)}}(this),error:function(t,e){this._subscribed=!1,this.emit(o.stores.SUBSCRIBE_FAIL),console.log("Failed to create subscriber, with error code: "+e.description)}})},e.prototype.load=function(t){return t=t||null,a.getProfileActivity(this.getUser().id,t,function(t){return function(e){return t._activity=e,t.emit(o.stores.PROFILE_ACTIVITY_CHANGE),t.emit(o.stores.CHANGE)}}(this))},e.prototype.logout=function(){return FB.logout(),l.User.logOut(),this.emit(o.stores.LOGIN_CHANGE)},e.prototype.getUser=function(){return l.User.current()},e.prototype.getName=function(t){var e;return e=this.getUser(),null!=e?e.get(""+t+"_name"):"not logged in"},e.prototype.getAvatar=function(t){var e;return e=this.getUser(),null!=e&&null!=t?e.get("avatar_url")+("?"+t):null!=e?e.get("avatar_url"):"images/Unicorn_Cosmic1@2x.png"},e.prototype.getLoggedIn=function(){return this.getUser()?!0:!1},e.prototype.getPrefImages=function(){return this._images},e.prototype.getProfileActivity=function(){return this._activity},e.prototype.getSubscriptionStatus=function(){return this._subscribed},e.prototype.importFriends=function(){return l.Cloud.run("importFriends",null,{success:function(t){return console.log(t)},error:function(t){return console.error(t.message)}})},e}(c),d=new h,i.register(function(t){var e;switch(e=t.action,e.actionType){case o.actions.USER_LOGIN:return d.login();case o.actions.USER_LOGOUT:return d.logout();case o.actions.USER_LOAD:return d.load();case o.actions.FILTER_PREFS:return d.load(e.filter);case o.actions.SUBSCRIBER_SUBMIT:return d.subscribe(e.email);case o.actions.USER_AUTH:return d.auth(e.code)}}),t.exports=d},function(t,e,n){var i;i=function(t,e,i){function r(){o.apply(this,arguments),this.downstream=[],this.downstreamFn=[],this.upstream=[],this.upstreamListeners={}}var o=n(29);r.prototype=Object.create(o.prototype),r.prototype.constructor=r,r.setInputHandler=function(t,e){t.trigger=e.trigger.bind(e),e.subscribe&&e.unsubscribe&&(t.subscribe=e.subscribe.bind(e),t.unsubscribe=e.unsubscribe.bind(e))},r.setOutputHandler=function(t,e){e instanceof r&&e.bindThis(t),t.pipe=e.pipe.bind(e),t.unpipe=e.unpipe.bind(e),t.on=e.on.bind(e),t.addListener=t.on,t.removeListener=e.removeListener.bind(e)},r.prototype.emit=function(t,e){o.prototype.emit.apply(this,arguments);var n=0;for(n=0;n<this.downstream.length;n++)this.downstream[n].trigger&&this.downstream[n].trigger(t,e);for(n=0;n<this.downstreamFn.length;n++)this.downstreamFn[n](t,e);return this},r.prototype.trigger=r.prototype.emit,r.prototype.pipe=function(t){if(t.subscribe instanceof Function)return t.subscribe(this);var e=t instanceof Function?this.downstreamFn:this.downstream,n=e.indexOf(t);return 0>n&&e.push(t),t instanceof Function?t("pipe",null):t.trigger&&t.trigger("pipe",null),t},r.prototype.unpipe=function(t){if(t.unsubscribe instanceof Function)return t.unsubscribe(this);var e=t instanceof Function?this.downstreamFn:this.downstream,n=e.indexOf(t);return n>=0?(e.splice(n,1),t instanceof Function?t("unpipe",null):t.trigger&&t.trigger("unpipe",null),t):!1},r.prototype.on=function(t){if(o.prototype.on.apply(this,arguments),!(t in this.upstreamListeners)){var e=this.trigger.bind(this,t);this.upstreamListeners[t]=e;for(var n=0;n<this.upstream.length;n++)this.upstream[n].on(t,e)}return this},r.prototype.addListener=r.prototype.on,r.prototype.subscribe=function(t){var e=this.upstream.indexOf(t);if(0>e){this.upstream.push(t);for(var n in this.upstreamListeners)t.on(n,this.upstreamListeners[n])}return this},r.prototype.unsubscribe=function(t){var e=this.upstream.indexOf(t);if(e>=0){this.upstream.splice(e,1);for(var n in this.upstreamListeners)t.removeListener(n,this.upstreamListeners[n])}return this},i.exports=r}.call(e,n,e,t),/* This Source Code Form is subject to the terms of the Mozilla Public
	 * License, v. 2.0. If a copy of the MPL was not distributed with this
	 * file, You can obtain one at http://mozilla.org/MPL/2.0/.
	 *
	 * Owner: mark@famo.us
	 * @license MPL 2.0
	 * @copyright Famous Industries, Inc. 2014
	 */
!(void 0!==i&&(t.exports=i))},function(t,e,n){var i;i=function(t,e,i){function r(t){return h.on(p,t),t}function o(t,e){var n=d(),i=function(){var r=d();r-n>=e&&(t.apply(this,arguments),h.removeListener(p,i))};return r(i)}function s(t,e){var n=d(),i=function(){var i=d();i-n>=e&&(t.apply(this,arguments),n=d())};return r(i)}function a(t,e){if(void 0===e)return void 0;var n=function(){e--,0>=e&&(t.apply(this,arguments),u(n))};return r(n)}function c(t,e){e=e||1;var n=e,i=function(){e--,0>=e&&(t.apply(this,arguments),e=n)};return r(i)}function u(t){h.removeListener(p,t)}function l(t,e){var n,i,r,s,a;return function(){i=this,a=arguments,r=d();var c=function(){var u=d-r;e>u?n=o(c,e-u):(n=null,s=t.apply(i,a))};return u(n),n=o(c,e),s}}var h=n(35),p="prerender",d=window.performance&&window.performance.now?function(){return window.performance.now()}:function(){return Date.now()};i.exports={setTimeout:o,setInterval:s,debounce:l,after:a,every:c,clear:u}}.call(e,n,e,t),/* This Source Code Form is subject to the terms of the Mozilla Public
	 * License, v. 2.0. If a copy of the MPL was not distributed with this
	 * file, You can obtain one at http://mozilla.org/MPL/2.0/.
	 *
	 * Owner: mark@famo.us
	 * @license MPL 2.0
	 * @copyright Famous Industries, Inc. 2014
	 */
!(void 0!==i&&(t.exports=i))},function(t){t.exports=function(t){var e=document.createElement("style");e.type="text/css";var n=document.getElementsByTagName("head")[0];return n.appendChild(e),e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t)),function(){n.removeChild(e)}}},function(t,e,n){var i;i=function(t,e,n){var i={};i.Direction={X:0,Y:1,Z:2},i.after=function(t,e){var n=t;return function(){n--,0===n&&e.apply(this,arguments)}},i.loadURL=function(t,e){var n=new XMLHttpRequest;n.onreadystatechange=function(){4===this.readyState&&e&&e(this.responseText)},n.open("GET",t),n.send()},i.createDocumentFragmentFromHTML=function(t){var e=document.createElement("div");e.innerHTML=t;for(var n=document.createDocumentFragment();e.hasChildNodes();)n.appendChild(e.firstChild);return n},i.clone=function(t){var e;if("object"==typeof t){e=t instanceof Array?[]:{};for(var n in t)if("object"==typeof t[n]&&null!==t[n])if(t[n]instanceof Array){e[n]=new Array(t[n].length);for(var r=0;r<t[n].length;r++)e[n][r]=i.clone(t[n][r])}else e[n]=i.clone(t[n]);else e[n]=t[n]}else e=t;return e},n.exports=i}.call(e,n,e,t),/* This Source Code Form is subject to the terms of the Mozilla Public
	 * License, v. 2.0. If a copy of the MPL was not distributed with this
	 * file, You can obtain one at http://mozilla.org/MPL/2.0/.
	 *
	 * Owner: mark@famo.us
	 * @license MPL 2.0
	 * @copyright Famous Industries, Inc. 2014
	 */
!(void 0!==i&&(t.exports=i))},function(t,e,n){var i;i=function(t,e,i){function r(t){this._transformGetter=null,this._opacityGetter=null,this._originGetter=null,this._alignGetter=null,this._sizeGetter=null,this._proportionGetter=null,this._legacyStates={},this._output={transform:s.identity,opacity:1,origin:null,align:null,size:null,proportions:null,target:null},t&&(t.transform&&this.transformFrom(t.transform),void 0!==t.opacity&&this.opacityFrom(t.opacity),t.origin&&this.originFrom(t.origin),t.align&&this.alignFrom(t.align),t.size&&this.sizeFrom(t.size),t.proportions&&this.proportionsFrom(t.proportions))}function o(){this._transformGetter&&(this._output.transform=this._transformGetter()),this._opacityGetter&&(this._output.opacity=this._opacityGetter()),this._originGetter&&(this._output.origin=this._originGetter()),this._alignGetter&&(this._output.align=this._alignGetter()),this._sizeGetter&&(this._output.size=this._sizeGetter()),this._proportionGetter&&(this._output.proportions=this._proportionGetter())}var s=n(1),a=n(21),c=n(43);r.prototype.transformFrom=function(t){return t instanceof Function?this._transformGetter=t:t instanceof Object&&t.get?this._transformGetter=t.get.bind(t):(this._transformGetter=null,this._output.transform=t),this},r.prototype.opacityFrom=function(t){return t instanceof Function?this._opacityGetter=t:t instanceof Object&&t.get?this._opacityGetter=t.get.bind(t):(this._opacityGetter=null,this._output.opacity=t),this},r.prototype.originFrom=function(t){return t instanceof Function?this._originGetter=t:t instanceof Object&&t.get?this._originGetter=t.get.bind(t):(this._originGetter=null,this._output.origin=t),this},r.prototype.alignFrom=function(t){return t instanceof Function?this._alignGetter=t:t instanceof Object&&t.get?this._alignGetter=t.get.bind(t):(this._alignGetter=null,this._output.align=t),this},r.prototype.sizeFrom=function(t){return t instanceof Function?this._sizeGetter=t:t instanceof Object&&t.get?this._sizeGetter=t.get.bind(t):(this._sizeGetter=null,this._output.size=t),this},r.prototype.proportionsFrom=function(t){return t instanceof Function?this._proportionGetter=t:t instanceof Object&&t.get?this._proportionGetter=t.get.bind(t):(this._proportionGetter=null,this._output.proportions=t),this},r.prototype.setTransform=function(t,e,n){return e||this._legacyStates.transform?(this._legacyStates.transform||(this._legacyStates.transform=new c(this._output.transform)),this._transformGetter||this.transformFrom(this._legacyStates.transform),this._legacyStates.transform.set(t,e,n),this):this.transformFrom(t)},r.prototype.setOpacity=function(t,e,n){return e||this._legacyStates.opacity?(this._legacyStates.opacity||(this._legacyStates.opacity=new a(this._output.opacity)),this._opacityGetter||this.opacityFrom(this._legacyStates.opacity),this._legacyStates.opacity.set(t,e,n)):this.opacityFrom(t)},r.prototype.setOrigin=function(t,e,n){return e||this._legacyStates.origin?(this._legacyStates.origin||(this._legacyStates.origin=new a(this._output.origin||[0,0])),this._originGetter||this.originFrom(this._legacyStates.origin),this._legacyStates.origin.set(t,e,n),this):this.originFrom(t)},r.prototype.setAlign=function(t,e,n){return e||this._legacyStates.align?(this._legacyStates.align||(this._legacyStates.align=new a(this._output.align||[0,0])),this._alignGetter||this.alignFrom(this._legacyStates.align),this._legacyStates.align.set(t,e,n),this):this.alignFrom(t)},r.prototype.setSize=function(t,e,n){return t&&(e||this._legacyStates.size)?(this._legacyStates.size||(this._legacyStates.size=new a(this._output.size||[0,0])),this._sizeGetter||this.sizeFrom(this._legacyStates.size),this._legacyStates.size.set(t,e,n),this):this.sizeFrom(t)},r.prototype.setProportions=function(t,e,n){return t&&(e||this._legacyStates.proportions)?(this._legacyStates.proportions||(this._legacyStates.proportions=new a(this._output.proportions||[0,0])),this._proportionGetter||this.proportionsFrom(this._legacyStates.proportions),this._legacyStates.proportions.set(t,e,n),this):this.proportionsFrom(t)},r.prototype.halt=function(){this._legacyStates.transform&&this._legacyStates.transform.halt(),this._legacyStates.opacity&&this._legacyStates.opacity.halt(),this._legacyStates.origin&&this._legacyStates.origin.halt(),this._legacyStates.align&&this._legacyStates.align.halt(),this._legacyStates.size&&this._legacyStates.size.halt(),this._legacyStates.proportions&&this._legacyStates.proportions.halt(),this._transformGetter=null,this._opacityGetter=null,this._originGetter=null,this._alignGetter=null,this._sizeGetter=null,this._proportionGetter=null},r.prototype.getTransform=function(){return this._transformGetter()},r.prototype.getFinalTransform=function(){return this._legacyStates.transform?this._legacyStates.transform.getFinal():this._output.transform},r.prototype.getOpacity=function(){return this._opacityGetter()},r.prototype.getOrigin=function(){return this._originGetter()},r.prototype.getAlign=function(){return this._alignGetter()},r.prototype.getSize=function(){return this._sizeGetter?this._sizeGetter():this._output.size},r.prototype.getProportions=function(){return this._proportionGetter?this._proportionGetter():this._output.proportions},r.prototype.modify=function(t){return o.call(this),this._output.target=t,this._output},i.exports=r}.call(e,n,e,t),/* This Source Code Form is subject to the terms of the Mozilla Public
	 * License, v. 2.0. If a copy of the MPL was not distributed with this
	 * file, You can obtain one at http://mozilla.org/MPL/2.0/.
	 *
	 * Owner: mark@famo.us
	 * @license MPL 2.0
	 * @copyright Famous Industries, Inc. 2014
	 */
!(void 0!==i&&(t.exports=i))},function(t,e,n){"use strict";function i(t){try{d(t,"isAsync",!0)}catch(e){}}function r(t){return null==t?!1:t instanceof c||t.isAsync===!0}function o(t){return t instanceof f}function s(t){return o(t)}function a(t,e){function n(i){return this instanceof n?(this.message="string"==typeof i?i:e,this.name=t,void(f.captureStackTrace&&f.captureStackTrace(this,this.constructor))):new n(i)}return p(n,f),n}function c(t){this.name="RejectionError",this.message=t,this.cause=t,this.isAsync=!0,t instanceof f?(this.message=t.message,this.stack=t.stack):f.captureStackTrace&&f.captureStackTrace(this,this.constructor)}var u=n(32),l=n(30).freeze,h=n(9),p=h.inherits,d=h.notEnumerableProp,f=u.Error,g=u.TypeError;"function"!=typeof g&&(g=a("TypeError","type error"));var m=u.RangeError;"function"!=typeof m&&(m=a("RangeError","range error"));var _=a("CancellationError","cancellation error"),y=a("TimeoutError","timeout error");p(c,f);var v="__BluebirdErrorTypes__",b=u[v];b||(b=l({CancellationError:_,TimeoutError:y,RejectionError:c}),d(u,v,b)),t.exports={Error:f,TypeError:g,RangeError:m,CancellationError:b.CancellationError,RejectionError:b.RejectionError,TimeoutError:b.TimeoutError,originatesFromRejection:r,markAsOriginatingFromRejection:i,canAttach:s}},function(t,e,n){var i,r,o,s={}.hasOwnProperty,a=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};r=n(129),i=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.handleViewAction=function(t){return this.dispatch({source:"VIEW_ACTION",action:t})},e}(r),o=new i,t.exports=o},function(t,e,n){var i;i=function(t,e,i){function r(t){this._value=t,this.eventOutput=null}function o(){this.eventOutput=new s,this.eventOutput.bindThis(this),s.setOutputHandler(this,this.eventOutput)}var s=n(12);r.patch=function(t){for(var e=new r(t),n=1;n<arguments.length;n++)e.patch(arguments[n]);return t},r.prototype.patch=function(){for(var t=this._value,e=0;e<arguments.length;e++){var n=arguments[e];for(var i in n)i in t&&n[i]&&n[i].constructor===Object&&t[i]&&t[i].constructor===Object?(t.hasOwnProperty(i)||(t[i]=Object.create(t[i])),this.key(i).patch(n[i]),this.eventOutput&&this.eventOutput.emit("change",{id:i,value:this.key(i).value()})):this.set(i,n[i])}return this},r.prototype.setOptions=r.prototype.patch,r.prototype.key=function(t){var e=new r(this._value[t]);return(!(e._value instanceof Object)||e._value instanceof Array)&&(e._value={}),e},r.prototype.get=function(t){return t?this._value[t]:this._value},r.prototype.getOptions=r.prototype.get,r.prototype.set=function(t,e){var n=this.get(t);return this._value[t]=e,this.eventOutput&&e!==n&&this.eventOutput.emit("change",{id:t,value:e}),this},r.prototype.on=function(){return o.call(this),this.on.apply(this,arguments)},r.prototype.removeListener=function(){return o.call(this),this.removeListener.apply(this,arguments)},r.prototype.pipe=function(){return o.call(this),this.pipe.apply(this,arguments)},r.prototype.unpipe=function(){return o.call(this),this.unpipe.apply(this,arguments)},i.exports=r}.call(e,n,e,t),/* This Source Code Form is subject to the terms of the Mozilla Public
	 * License, v. 2.0. If a copy of the MPL was not distributed with this
	 * file, You can obtain one at http://mozilla.org/MPL/2.0/.
	 *
	 * Owner: mark@famo.us
	 * @license MPL 2.0
	 * @copyright Famous Industries, Inc. 2014
	 */
!(void 0!==i&&(t.exports=i))},function(t,e,n){var i;i=function(t,e,i){function r(t){this._object=null,this._child=null,this._hasMultipleChildren=!1,this._isRenderable=!1,this._isModifier=!1,this._resultCache={},this._prevResults={},this._childResult=null,t&&this.set(t)}function o(t,e,n){for(var i=a.parse(t,e),r=Object.keys(i),c=0;c<r.length;c++){var u=r[c],l=s.get(u),h=i[u];h.allocator=e.allocator;var p=l.commit(h);p?o(p,e,n):n[u]=h}}var s=n(36),a=n(86);r.prototype.add=function(t){var e=t instanceof r?t:new r(t);return this._child instanceof Array?this._child.push(e):this._child?(this._child=[this._child,e],this._hasMultipleChildren=!0,this._childResult=[]):this._child=e,e},r.prototype.get=function(){return this._object||(this._hasMultipleChildren?null:this._child?this._child.get():null)},r.prototype.set=function(t){return this._childResult=null,this._hasMultipleChildren=!1,this._isRenderable=t.render?!0:!1,this._isModifier=t.modify?!0:!1,this._object=t,this._child=null,t instanceof r?t:this},r.prototype.getSize=function(){var t=null,e=this.get();return e&&e.getSize&&(t=e.getSize()),!t&&this._child&&this._child.getSize&&(t=this._child.getSize()),t},r.prototype.commit=function(t){for(var e=Object.keys(this._prevResults),n=0;n<e.length;n++){var i=e[n];if(void 0===this._resultCache[i]){var r=s.get(i);r.cleanup&&r.cleanup(t.allocator)}}this._prevResults=this._resultCache,this._resultCache={},o(this.render(),t,this._resultCache)},r.prototype.render=function(){if(this._isRenderable)return this._object.render();var t=null;if(this._hasMultipleChildren){t=this._childResult;for(var e=this._child,n=0;n<e.length;n++)t[n]=e[n].render()}else this._child&&(t=this._child.render());return this._isModifier?this._object.modify(t):t},i.exports=r}.call(e,n,e,t),/* This Source Code Form is subject to the terms of the Mozilla Public
	 * License, v. 2.0. If a copy of the MPL was not distributed with this
	 * file, You can obtain one at http://mozilla.org/MPL/2.0/.
	 *
	 * Owner: mark@famo.us
	 * @license MPL 2.0
	 * @copyright Famous Industries, Inc. 2014
	 */
!(void 0!==i&&(t.exports=i))},function(t,e,n){var i;i=function(t,e,i){function r(t){this.currentAction=null,this.actionQueue=[],this.callbackQueue=[],this.state=0,this.velocity=void 0,this._callback=void 0,this._engineInstance=null,this._currentMethod=null,this.set(t)}function o(){if(this._callback){var t=this._callback;this._callback=void 0,t()}if(this.actionQueue.length<=0)return void this.set(this.get());this.currentAction=this.actionQueue.shift(),this._callback=this.callbackQueue.shift();var e=null,n=this.currentAction[0],i=this.currentAction[1];i instanceof Object&&i.method?(e=i.method,"string"==typeof e&&(e=c[e])):e=a,this._currentMethod!==e&&(this._engineInstance=!(n instanceof Object)||e.SUPPORTS_MULTIPLE===!0||n.length<=e.SUPPORTS_MULTIPLE?new e:new s(e),this._currentMethod=e),this._engineInstance.reset(this.state,this.velocity),void 0!==this.velocity&&(i.velocity=this.velocity),this._engineInstance.set(n,i,o.bind(this))}var s=n(91),a=n(93),c={};r.register=function(t){var e=!0;for(var n in t)r.registerMethod(n,t[n])||(e=!1);return e},r.registerMethod=function(t,e){return t in c?!1:(c[t]=e,!0)},r.unregisterMethod=function(t){return t in c?(delete c[t],!0):!1},r.prototype.set=function(t,e,n){if(!e)return this.reset(t),n&&n(),this;var i=[t,e];return this.actionQueue.push(i),this.callbackQueue.push(n),this.currentAction||o.call(this),this},r.prototype.reset=function(t,e){this._currentMethod=null,this._engineInstance=null,this._callback=void 0,this.state=t,this.velocity=e,this.currentAction=null,this.actionQueue=[],this.callbackQueue=[]},r.prototype.delay=function(t,e){this.set(this.get(),{duration:t,curve:function(){return 0}},e)},r.prototype.get=function(t){return this._engineInstance&&(this._engineInstance.getVelocity&&(this.velocity=this._engineInstance.getVelocity()),this.state=this._engineInstance.get(t)),this.state},r.prototype.isActive=function(){return!!this.currentAction},r.prototype.halt=function(){return this.set(this.get())},i.exports=r}.call(e,n,e,t),/* This Source Code Form is subject to the terms of the Mozilla Public
	 * License, v. 2.0. If a copy of the MPL was not distributed with this
	 * file, You can obtain one at http://mozilla.org/MPL/2.0/.
	 *
	 * Owner: david@famo.us
	 * @license MPL 2.0
	 * @copyright Famous Industries, Inc. 2014
	 */
!(void 0!==i&&(t.exports=i))},function(t,e,n){var i,r,o;i=n(18),r=n(7).actions,o={login:function(t){return i.handleViewAction({actionType:r.LOGIN,referrer:t})},selectMenuItem:function(t){return i.handleViewAction({actionType:r.MENU_SELECT,pageId:t})},selectSingleCardItem:function(t,e,n){return i.handleViewAction({actionType:r.CARD_SELECT,cardId:t,peggeeId:e,referrer:n})},logout:function(){return i.handleViewAction({actionType:r.LOGOUT})}},t.exports=o},function(t,e,n){var i,r,o,s,a;r=n(2),s={LoginViewLayout:n(168),NewCardViewLayout:n(170),PlayViewLayout:n(172),PlayNavViewLayout:n(171),SignupViewLayout:n(173),StatusViewLayout:n(175),SingleCardViewLayout:n(174),CardViewLayout:n(166),FooterViewLayout:n(167),MessageViewLayout:n(169)},o={},a={},i=function(){function t(){this.device=this._getDevice()}return t.prototype._getDevice=function(){var t;return t=r.getViewportWidth(),"mobile"},t.prototype.getViewLayout=function(t){var e;return e=null,"mobile"===this.device?e=s[t+"Layout"]:"desktop"===this.device?e=o[t+"Layout"]:"tablet"===this.device&&(e=a[t+"Layout"]),e||{}},t}(),t.exports=i},function(t,e,n){var i,r,o;i=n(181),n(201),r=n(47)["public"].parse,o=window.Parse,o.initialize(r.appId,r.jsKey),t.exports=o,String.prototype.truncate=function(t){return this.substr(0,t-1)+(this.length>t?"&hellip;":"")}},function(t,e,n){var i;i=function(t,e,i){function r(t){this.options=Object.create(r.DEFAULT_OPTIONS),this._optionsManager=new P(this.options),this._scroller=new k(this.options),this.sync=new j(["scroll","touch"],{direction:this.options.direction,scale:this.options.syncScale,rails:this.options.rails,preventDefault:void 0!==this.options.preventDefault?this.options.preventDefault:this.options.direction!==O.Direction.Y}),this._physicsEngine=new _,this._particle=new y,this._physicsEngine.addBody(this._particle),this.spring=new b({anchor:[0,0,0],period:this.options.edgePeriod,dampingRatio:this.options.edgeDamp}),this.drag=new v({forceFunction:v.FORCE_FUNCTIONS.QUADRATIC,strength:this.options.drag}),this.friction=new v({forceFunction:v.FORCE_FUNCTIONS.LINEAR,strength:this.options.friction}),this._node=null,this._touchCount=0,this._springState=A.NONE,this._onEdge=T.NONE,this._pageSpringPosition=0,this._edgeSpringPosition=0,this._touchVelocity=0,this._earlyEnd=!1,this._needsPaginationCheck=!1,this._displacement=0,this._totalShift=0,this._cachedIndex=0,this._scroller.positionFrom(this.getPosition.bind(this)),this._eventInput=new w,this._eventOutput=new w,this._eventInput.pipe(this.sync),this.sync.pipe(this._eventInput),w.setInputHandler(this,this._eventInput),w.setOutputHandler(this,this._eventOutput),c.call(this),t&&this.setOptions(t)}function o(t){this._touchCount=t.count,void 0===t.count&&(this._touchCount=1),l.call(this),this.setVelocity(0),this._touchVelocity=0,this._earlyEnd=!1}function s(t){var e=-t.velocity,n=-t.delta;if(this._onEdge!==T.NONE&&t.slip&&(0>e&&this._onEdge===T.TOP||e>0&&this._onEdge===T.BOTTOM?this._earlyEnd||(a.call(this,t),this._earlyEnd=!0):this._earlyEnd&&Math.abs(e)>Math.abs(this.getVelocity())&&o.call(this,t)),!this._earlyEnd){if(this._touchVelocity=e,t.slip){var i=this.options.speedLimit;-i>e?e=-i:e>i&&(e=i),this.setVelocity(e);var r=16*i;n>r?n=r:-r>n&&(n=-r)}this.setPosition(this.getPosition()+n),this._displacement+=n,this._springState===A.NONE&&g.call(this)}}function a(t){if(this._touchCount=t.count||0,!this._touchCount){l.call(this),this._onEdge!==T.NONE&&f.call(this,this._edgeSpringPosition,A.EDGE),u.call(this);var e=-t.velocity,n=this.options.speedLimit;t.slip&&(n*=this.options.edgeGrip),-n>e?e=-n:e>n&&(e=n),this.setVelocity(e),this._touchVelocity=0,this._needsPaginationCheck=!0}}function c(){this._eventInput.bindThis(this),this._eventInput.on("start",o),this._eventInput.on("update",s),this._eventInput.on("end",a),this._eventInput.on("resize",function(){this._node._.calculateSize()}.bind(this)),this._scroller.on("onEdge",function(t){this._edgeSpringPosition=t.position,p.call(this,this._scroller.onEdge()),this._eventOutput.emit("onEdge")}.bind(this)),this._scroller.on("offEdge",function(){this.sync.setOptions({scale:this.options.syncScale}),this._onEdge=this._scroller.onEdge(),this._eventOutput.emit("offEdge")}.bind(this)),this._particle.on("update",function(t){this._springState===A.NONE&&g.call(this),this._displacement=t.position.x-this._totalShift}.bind(this)),this._particle.on("end",function(){(!this.options.paginated||this.options.paginated&&this._springState!==A.NONE)&&this._eventOutput.emit("settle")}.bind(this))}function u(){this._springState?this._physicsEngine.attach([this.spring],this._particle):this._physicsEngine.attach([this.drag,this.friction],this._particle)}function l(){this._springState=A.NONE,this._physicsEngine.detachAll()}function h(t){var e=this.options.direction,n=t.getSize();return n?n[e]:this._scroller.getSize()[e]}function p(t){this.sync.setOptions({scale:this.options.edgeGrip}),this._onEdge=t,this._touchCount||this._springState===A.EDGE||f.call(this,this._edgeSpringPosition,A.EDGE),this._springState&&Math.abs(this.getVelocity())<.001&&(l.call(this),u.call(this))}function d(){if(!this._touchCount&&this._springState!==A.EDGE){var t=this.getVelocity();if(!(Math.abs(t)>=this.options.pageStopSpeed)){var e=this.getPosition(),n=Math.abs(t)>this.options.pageSwitchSpeed,i=h.call(this,this._node),r=e>.5*i,o=t>0,s=0>t;this._needsPaginationCheck=!1,r&&!n||n&&o?this.goToNextPage():n&&s?this.goToPreviousPage():f.call(this,0,A.PAGE)}}}function f(t,e){var n;e===A.EDGE?(this._edgeSpringPosition=t,n={anchor:[this._edgeSpringPosition,0,0],period:this.options.edgePeriod,dampingRatio:this.options.edgeDamp}):e===A.PAGE&&(this._pageSpringPosition=t,n={anchor:[this._pageSpringPosition,0,0],period:this.options.pagePeriod,dampingRatio:this.options.pageDamp}),this.spring.setOptions(n),e&&!this._springState&&(l.call(this),this._springState=e,u.call(this)),this._springState=e}function g(){var t=0,e=this.getPosition();e+=(0>e?-.5:.5)>>0;for(var n=h.call(this,this._node),i=this._node.getNext();t+e>=n&&i;)t-=n,this._scroller.sequenceFrom(i),this._node=i,i=this._node.getNext(),n=h.call(this,this._node);for(var r,o=this._node.getPrevious();0>=t+e&&o;)r=h.call(this,o),this._scroller.sequenceFrom(o),this._node=o,t+=r,o=this._node.getPrevious();t&&m.call(this,t),this._node&&(this._node.index!==this._cachedIndex?this.getPosition()<.5*n&&(this._cachedIndex=this._node.index,this._eventOutput.emit("pageChange",{direction:-1,index:this._cachedIndex})):this.getPosition()>.5*n&&(this._cachedIndex=this._node.index+1,this._eventOutput.emit("pageChange",{direction:1,index:this._cachedIndex})))}function m(t){this._edgeSpringPosition+=t,this._pageSpringPosition+=t,this.setPosition(this.getPosition()+t),this._totalShift+=t,this._springState===A.EDGE?this.spring.setOptions({anchor:[this._edgeSpringPosition,0,0]}):this._springState===A.PAGE&&this.spring.setOptions({anchor:[this._pageSpringPosition,0,0]})}var _=n(54),y=n(55),v=n(89),b=n(57),w=n(12),P=n(19),x=n(39),k=n(97),O=n(15),j=n(40),C=n(87),S=n(41);j.register({scroll:C,touch:S});var A={NONE:0,EDGE:1,PAGE:2},T={TOP:-1,NONE:0,BOTTOM:1};r.DEFAULT_OPTIONS={direction:O.Direction.Y,rails:!0,friction:.005,drag:1e-4,edgeGrip:.2,edgePeriod:300,edgeDamp:1,margin:1e3,paginated:!1,pagePeriod:500,pageDamp:.8,pageStopSpeed:10,pageSwitchSpeed:.5,speedLimit:5,groupScroll:!1,syncScale:1},r.prototype.getCurrentIndex=function(){return this._node.index},r.prototype.goToPreviousPage=function(){if(!this._node||this._onEdge===T.TOP)return null;if(this.getPosition()>1&&this._springState===A.NONE)return f.call(this,0,A.PAGE),this._node;var t=this._node.getPrevious();if(t){var e=h.call(this,t);this._scroller.sequenceFrom(t),this._node=t,m.call(this,e),f.call(this,0,A.PAGE)}return t},r.prototype.goToNextPage=function(){if(!this._node||this._onEdge===T.BOTTOM)return null;var t=this._node.getNext();if(t){var e=h.call(this,this._node);this._scroller.sequenceFrom(t),this._node=t,m.call(this,-e),f.call(this,0,A.PAGE)}return t},r.prototype.goToPage=function(t){var e,n=this.getCurrentIndex();if(n>t)for(e=0;n-t>e;e++)this.goToPreviousPage();if(t>n)for(e=0;t-n>e;e++)this.goToNextPage()},r.prototype.outputFrom=function(){return this._scroller.outputFrom.apply(this._scroller,arguments)},r.prototype.getPosition=function(){return this._particle.getPosition1D()},r.prototype.getAbsolutePosition=function(){return this._scroller.getCumulativeSize(this.getCurrentIndex())[this.options.direction]+this.getPosition()},r.prototype.getOffset=r.prototype.getPosition,r.prototype.setPosition=function(t){this._particle.setPosition1D(t)},r.prototype.setOffset=r.prototype.setPosition,r.prototype.getVelocity=function(){return this._touchCount?this._touchVelocity:this._particle.getVelocity1D()},r.prototype.setVelocity=function(t){this._particle.setVelocity1D(t)},r.prototype.setOptions=function(t){void 0!==t.direction&&("x"===t.direction?t.direction=O.Direction.X:"y"===t.direction&&(t.direction=O.Direction.Y)),t.groupScroll!==this.options.groupScroll&&(t.groupScroll?this.subscribe(this._scroller):this.unsubscribe(this._scroller)),this._optionsManager.setOptions(t),this._scroller.setOptions(t),void 0!==t.drag&&this.drag.setOptions({strength:this.options.drag}),void 0!==t.friction&&this.friction.setOptions({strength:this.options.friction}),(void 0!==t.edgePeriod||void 0!==t.edgeDamp)&&this.spring.setOptions({period:this.options.edgePeriod,dampingRatio:this.options.edgeDamp}),(t.rails||void 0!==t.direction||void 0!==t.syncScale||t.preventDefault)&&this.sync.setOptions({rails:this.options.rails,direction:this.options.direction===O.Direction.X?j.DIRECTION_X:j.DIRECTION_Y,scale:this.options.syncScale,preventDefault:this.options.preventDefault})},r.prototype.sequenceFrom=function(t){return t instanceof Array&&(t=new x({array:t,trackSize:!0})),this._node=t,this._scroller.sequenceFrom(t)},r.prototype.getSize=function(){return this._scroller.getSize.apply(this._scroller,arguments)},r.prototype.render=function(){return this.options.paginated&&this._needsPaginationCheck&&d.call(this),this._scroller.render()},i.exports=r}.call(e,n,e,t),/* This Source Code Form is subject to the terms of the Mozilla Public
	 * License, v. 2.0. If a copy of the MPL was not distributed with this
	 * file, You can obtain one at http://mozilla.org/MPL/2.0/.
	 *
	 * Owner: felix@famo.us
	 * @license MPL 2.0
	 * @copyright Famous Industries, Inc. 2014
	 */
!(void 0!==i&&(t.exports=i))},function(t,e,n){var i,r,o,s,a,c,u,l,h,p,d=function(t,e){return function(){return t.apply(e,arguments)}},f={}.hasOwnProperty,g=function(t,e){function n(){this.constructor=t}for(var i in e)f.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},m=[].slice;o=n(33),c=n(24),p=c._,s=n(12),i=n(18),r=n(7),l=n(11),a=n(127),u=function(t){function e(){return this._fetchMoods=d(this._fetchMoods,this),this._loadAncillaryDatums=d(this._loadAncillaryDatums,this),this._fetchPeggs=d(this._fetchPeggs,this),this._fetchPrefs=d(this._fetchPrefs,this),this._sortGame=d(this._sortGame,this),e.__super__.constructor.apply(this,arguments)}var n;return g(e,t),e.prototype._currentPage=-1,e.prototype._fails=0,e.prototype._game=null,e.prototype._size=4,e.prototype._mood={},e.prototype._peggee={},n={},e.prototype._loadMoodGame=function(){return a.loading("game"),this._fetchPeggs().fail(this._failHandler).done(function(t){return function(){var e;return e=1<=arguments.length?m.call(arguments,0):[],t._loadGame(e)}}(this))},e.prototype._loadPeggeeGame=function(){return a.loading("game"),this._fetchPeggs().fail(this._failHandler).done(function(t){return function(){var e;return e=1<=arguments.length?m.call(arguments,0):[],t._loadGame(e)}}(this))},e.prototype._loadGame=function(t){var e,n,i,s,u,h,p,d,g;if(this._game=[],this._currentPage=-1,i=[],console.log("peggCards: ",t),null!=t&&t.length>0){for(u={},d=0,g=t.length;g>d;d++)e=t[d],u[e.id]=e;p={},h=[];for(n in u)f.call(u,n)&&(s=u[n],h.push(s.peggeeId),-1===s.hasPreffed.indexOf(l.getUser().id)&&(p[n]=this._peggToPref(s)));return i.push(c.Promise.as(p)),i.push(o.getPrefPopularities(p)),i.push(c.Promise.as(u)),i.push(o.getTopPeggers(h)),c.Promise.when(i).then(this._sortGame).done(function(t){return function(){return a.doneLoading("game"),t.emit(r.stores.GAME_LOADED),t._next()}}(this))}return this._fetchPrefs().then(function(t){return function(){var n,i,s;for(n=1<=arguments.length?m.call(arguments,0):[],p={},i=0,s=n.length;s>i;i++)e=n[i],p[e.id]=e;return o.getPrefPopularities(p).then(function(e){return t._sortGame(p,e)}).done(function(){return a.doneLoading("game"),t.emit(r.stores.GAME_LOADED),t._next()})}}(this))},e.prototype._sortGame=function(t,e,n,i){var r,o,s,a;if(2===arguments.length)for(r in t)f.call(t,r)&&(a=t[r],this._game.push({type:"card",card:a}),this._game.push({type:"prefPopularities",stats:e[r]}));else for(r in n)f.call(n,r)&&(o=n[r],s=o.peggeeId,this._game.push({type:"card",card:o}),this._game.push({type:"topPeggers",stats:i[s]}),null!=t[r]&&(this._game.push({type:"card",card:t[r]}),this._game.push({type:"prefPopularities",stats:e[r]})));return this._game.push({type:"done"})},e.prototype._peggToPref=function(t){return t=p.clone(t),delete t.answer,t.peggeeId=l.getUser().id,t.firstName=l.getUser().get("first_name"),t.pic=l.getAvatar(),t},e.prototype._fetchPrefs=function(){return o.getUnpreffedCards(this._size,this._mood,l.getUser()).then(this._loadAncillaryDatums)},e.prototype._fetchPeggs=function(){return o.getPeggCards(this._size,l.getUser(),this._mood.id,this._peggee.id).then(this._loadAncillaryDatums)},e.prototype._loadAncillaryDatums=function(t){var e,n,i;i=[];for(n in t)f.call(t,n)&&(e=t[n],i.push(this._fetchChoices(e).then(this._fetchComments)));return c.Promise.when(i)},e.prototype._fetchComments=function(t){return null!=t.peggeeId?o.getComments(t.id,t.peggeeId).then(function(){return function(e){return t.comments=e,t}}(this)):c.Promise.as(t)},e.prototype._fetchChoices=function(t){return o.getChoices(t.id).then(function(){return function(e){return t.choices=e,t}}(this))},e.prototype._fetchNewBadge=function(t){return o.getNewBadge(t).then(function(t){return function(e){return null!=e?(t._badge=e,t.emit(r.stores.BADGE_CHANGE),!0):!1}}(this))},e.prototype._next=function(){return this._fetchNewBadge(l.getUser().id).then(function(t){return function(e){var n;return e?void 0:(t._currentPage++,t._fails=0,n=t.getCurrentPage(),"card"===n.type&&(null!=n.card.peggeeId&&n.card.peggeeId!==l.getUser().id?(t._title="Pegg "+n.card.firstName+"!",a.show("tutorial__first_pegg_card")):(t._title="Pegg yourself!",a.show("tutorial__first_unpreffed_card"))),t.emit(r.stores.PAGE_CHANGE))}}(this))},e.prototype._prev=function(){return this._currentPage--},e.prototype._pegg=function(t,e,n,i){return console.log("save Pegg: card: "+e+" choice: "+n),o.savePegg(t,e,n,i,l.getUser().id).fail(this._failHandler).done(function(s){return function(){var a;return n===i?(a=10-3*s._fails,s.emit(r.stores.CARD_WIN,a),o.savePoints(l.getUser().id,t,a).fail(s._failHandler),s._savePeggActivity(e,t,s._fails+1)):(s._fails++,s.emit(r.stores.CARD_FAIL))}}(this))},e.prototype._pref=function(t,e,n,i){return console.log("save Pref: card: "+t+" choice: "+e),this.getCurrentPage().answered=!0,o.savePref(t,e,n,i,l.getUser().id,this._mood.id).fail(this._failHandler).done(function(n){return function(){return o.savePrefCount(t,e).fail(n._failHandler),n._savePrefActivity(t),n.emit(r.stores.PREF_SAVED)}}(this))},e.prototype._saveMoodActivity=function(t,e,n){var i;return i=""+l.getUser().get("first_name")+" is feeling "+e,o.saveActivity(i,n,l.getUser().id).fail(this._failHandler)},e.prototype._saveNewCardActivity=function(t,e,n){var i;return i=""+l.getUser().get("first_name")+" created card: "+e,o.saveActivity(i,n,l.getUser().id,t).fail(this._failHandler)},e.prototype._savePrefActivity=function(t){return o.getPrefCard(t,l.getUser().id).fail(this._failHandler).done(function(e){return function(n){var i,r;return i="male"===n.gender?"himself":"herself",r=""+n.firstName+" pegged "+i+": "+n.question,o.saveActivity(r,n.pic,l.getUser().id,t,l.getUser().id).fail(e._failHandler)}}(this))},e.prototype._savePeggActivity=function(t,e,n){return o.getPrefCard(t,e).fail(this._failHandler).done(function(i){return function(r){var s,a;return a=1===n?"try":"tries",s=""+l.getUser().get("first_name")+" pegged "+r.firstName+" in "+n+" "+a+": "+r.question,o.saveActivity(s,l.getAvatar(),l.getUser().id,t,e).fail(i._failHandler)}}(this))},e.prototype._saveCommentActivity=function(t,e,n){var i;return i=""+l.getUser().get("first_name")+" commented: "+t,o.saveActivity(i,l.getAvatar(),l.getUser().id,n,e).fail(this._failHandler)},e.prototype._plug=function(t,e,n){return console.log("save Plug: card: "+t+" image: "+e),l.getUser().id=l.getUser().id,o.savePlug(t,e,n,l.getUser().id).fail(this._failHandler).done(function(t){return function(){return t.emit(r.stores.PLUG_SAVED)}}(this))},e.prototype._failHandler=function(t){return console.log("ERROR:",t)},e.prototype._comment=function(t,e,n){return console.log("comment: "+t+"  peggee: "+n+"  card: "+e),o.saveComment(t,e,n,l.getUser().id,l.getAvatar()).fail(this._failHandler).done(function(i){return function(r){return i.getCurrentPage().card.comments.unshift(r),i._saveCommentActivity(t,n,e)}}(this))},e.prototype._setMood=function(t,e,n){return console.log("moodId: "+e),this._mood={text:t,id:e,url:n},this._loadMoodGame(e),o.saveMood(e,l.getUser().id).fail(this._failHandler).done(function(i){return function(){return i._saveMoodActivity(e,t,n)}}(this))},e.prototype._badgesViewed=function(t){return o.saveBadgeView(t.userBadgeId).fail(this._failHandler).done(function(t){return function(){return t._next()}}(this))},e.prototype._fetchMoods=function(){return o.getTodaysMoods().then(function(t){return function(e){return t._moods=e,t.emit(r.stores.MOODS_LOADED)}}(this))},e.prototype.getCurrentPage=function(){return this._game[this._currentPage]},e.prototype.getComments=function(){var t;return t=this.getCurrentPage(),"card"===t.type?t.card.comments:null},e.prototype.getMoods=function(){return this._moods},e.prototype.getBadge=function(){return this._badge},e.prototype.getGameState=function(){return{mood:this._mood,title:this._title,position:this._currentPage,size:this._game.length}},e.prototype.getMessage=function(t){switch(t){case"win":return"Good job!";case"fail":return"Boo."}},e}(s),h=new u,i.register(function(t){var e;switch(e=t.action,e.actionType){case r.actions.LOAD_APP:return h._fetchMoods();case r.actions.PEGG_SUBMIT:return h._pegg(e.peggeeId,e.card,e.choice,e.answer);case r.actions.PREF_SUBMIT:return h._pref(e.card,e.choice,e.plug,e.thumb);case r.actions.PLUG_IMAGE:return h._plug(e.card,e.full,e.thumb);case r.actions.NEXT_PAGE:return h._next();case r.actions.PREV_PAGE:return h._prev();case r.actions.CARD_COMMENT:return h._comment(e.comment,e.cardId,e.peggeeId);case r.actions.PICK_MOOD:return h._setMood(e.moodText,e.moodId,e.moodUrl);case r.actions.BADGES_VIEWED:return h._badgesViewed(e.badges)}}),t.exports=h},function(t,e,n){var i,r,o;i=n(18),r=n(7).actions,o={load:function(t,e){return i.handleViewAction({actionType:r.LOAD_APP,flow:t,script:e})},pref:function(t,e,n,o){return i.handleViewAction({actionType:r.PREF_SUBMIT,card:t,choice:e,plug:n,thumb:o})},pegg:function(t,e,n,o){return i.handleViewAction({actionType:r.PEGG_SUBMIT,peggeeId:t,card:e,choice:n,answer:o})},plug:function(t,e,n){return i.handleViewAction({actionType:r.PLUG_IMAGE,card:t,full:e,thumb:n})},rate:function(t){return i.handleViewAction({actionType:r.CARD_RATE,rating:t})},pass:function(t){return i.handleViewAction({actionType:r.CARD_PASS,card:t})},mood:function(t,e,n){return i.handleViewAction({actionType:r.PICK_MOOD,moodText:t,moodId:e,moodUrl:n})},nextPage:function(){return i.handleViewAction({actionType:r.NEXT_PAGE})},prevPage:function(){return i.handleViewAction({actionType:r.PREV_PAGE})},comment:function(t,e,n){return i.handleViewAction({actionType:r.CARD_COMMENT,comment:t,cardId:e,peggeeId:n})},badgesViewed:function(t){return i.handleViewAction({actionType:r.BADGES_VIEWED,badges:t})}},t.exports=o},function(t,e,n){var i,r,o;i=n(18),r=n(7),o={login:function(){return i.handleViewAction({actionType:r.actions.USER_LOGIN})},logout:function(){return i.handleViewAction({actionType:r.actions.USER_LOGOUT})},subscribe:function(t){return i.handleViewAction({actionType:r.actions.SUBSCRIBER_SUBMIT,email:t})},load:function(){return i.handleViewAction({actionType:r.actions.USER_LOAD})},filterPrefs:function(t){return i.handleViewAction({actionType:r.actions.FILTER_PREFS,filter:t})},auth:function(t){return i.handleViewAction({actionType:r.actions.USER_AUTH,code:t})}},t.exports=o},function(t,e,n){var i;i=function(t,e,n){function i(){this.listeners={},this._owner=this}i.prototype.emit=function(t,e){var n=this.listeners[t];if(n)for(var i=0;i<n.length;i++)n[i].call(this._owner,e);return this},i.prototype.on=function(t,e){t in this.listeners||(this.listeners[t]=[]);var n=this.listeners[t].indexOf(e);return 0>n&&this.listeners[t].push(e),this},i.prototype.addListener=i.prototype.on,i.prototype.removeListener=function(t,e){var n=this.listeners[t];if(void 0!==n){var i=n.indexOf(e);i>=0&&n.splice(i,1)}return this},i.prototype.bindThis=function(t){this._owner=t},n.exports=i}.call(e,n,e,t),/* This Source Code Form is subject to the terms of the Mozilla Public
	 * License, v. 2.0. If a copy of the MPL was not distributed with this
	 * file, You can obtain one at http://mozilla.org/MPL/2.0/.
	 *
	 * Owner: mark@famo.us
	 * @license MPL 2.0
	 * @copyright Famous Industries, Inc. 2014
	 */
!(void 0!==i&&(t.exports=i))},function(t){var e=function(){"use strict";return void 0===this}();if(e)t.exports={freeze:Object.freeze,defineProperty:Object.defineProperty,keys:Object.keys,getPrototypeOf:Object.getPrototypeOf,isArray:Array.isArray,isES5:e};else{var n={}.hasOwnProperty,i={}.toString,r={}.constructor.prototype,o=function(t){var e=[];for(var i in t)n.call(t,i)&&e.push(i);return e},s=function(t,e,n){return t[e]=n.value,t},a=function(t){return t},c=function(t){try{return Object(t).constructor.prototype}catch(e){return r}},u=function(t){try{return"[object Array]"===i.call(t)}catch(e){return!1}};t.exports={isArray:u,keys:o,defineProperty:s,freeze:a,getPrototypeOf:c,isES5:e}}},function(t,e,n){"use strict";function i(){this._isTickUsed=!1,this._length=0,this._lateBuffer=new o,this._functionBuffer=new o(75e3);var t=this;this.consumeFunctionBuffer=function(){t._consumeFunctionBuffer()}}var r=n(120),o=n(117),s=n(9).errorObj,a=n(9).tryCatch1,c=n(32).process;i.prototype.haveItemsQueued=function(){return this._length>0},i.prototype.invokeLater=function(t,e,n){void 0===c||null==c.domain||t.domain||(t=c.domain.bind(t)),this._lateBuffer.push(t,e,n),this._queueTick()},i.prototype.invoke=function(t,e,n){void 0===c||null==c.domain||t.domain||(t=c.domain.bind(t));var i=this._functionBuffer;i.push(t,e,n),this._length=i.length(),this._queueTick()},i.prototype._consumeFunctionBuffer=function(){for(var t=this._functionBuffer;t.length()>0;){var e=t.shift(),n=t.shift(),i=t.shift();e.call(n,i)}this._reset(),this._consumeLateBuffer()},i.prototype._consumeLateBuffer=function(){for(var t=this._lateBuffer;t.length()>0;){var e=t.shift(),n=t.shift(),i=t.shift(),r=a(e,n,i);if(r===s){if(this._queueTick(),null==e.domain)throw r.e;e.domain.emit("error",r.e)}}},i.prototype._queueTick=function(){this._isTickUsed||(r(this.consumeFunctionBuffer),this._isTickUsed=!0)},i.prototype._reset=function(){this._isTickUsed=!1,this._length=0},t.exports=new i},function(t,e){(function(e){t.exports=function(){if(void 0!==this)return this;try{return e}catch(t){}try{return window}catch(t){}try{return self}catch(t){}}()}).call(e,function(){return this}())},function(t,e,n){var i,r,o,s,a,c,u,l,h,p,d,f,g,m,_,y={}.hasOwnProperty;c=n(24),a=c.Object.extend("Comment"),r=c.Object.extend("Card"),s=c.Object.extend("Choice"),o=c.Object.extend("Category"),p=c.Object.extend("Pref"),l=c.Object.extend("Pegg"),h=c.Object.extend("Points"),d=c.Object.extend("PrefCounts"),i=c.Object.extend("Activity"),f=c.Object.extend("User"),g=c.Object.extend("UserMood"),m=c.Object.extend("UserSetting"),u=function(){function t(){}return t.prototype.getUserSetting=function(t,e,n){return this._getUserSetting.apply(this,arguments).then(function(){return function(t){return console.log("getUserSetting: result:",t),null!=t?t.get("value"):n}}(this))},t.prototype._getUserSetting=function(t,e,n){var i,r;return console.log("getUserSetting: ("+t+", "+e+", "+n+")"),r=new c.Object("User"),r.set("id",e),i=new c.Query(m),i.equalTo("key",t),i.equalTo("user",r),i.first()},t.prototype.saveUserSetting=function(t,e,n){var i;return console.log("saveUserSetting: ("+t+", "+e+", "+n+")"),i=new c.Object("User"),i.set("id",n),this._getUserSetting(t,n).then(function(){return function(n){var r,o;return r=n,null==r&&(r=new c.Object("UserSetting"),o=new c.ACL(i),o.setPublicReadAccess(!1),r.set("ACL",o),r.set("key",t),r.set("user",i)),r.set("value",e),r.save()}}(this))},t.prototype.saveActivity=function(t,e,n,i,r){var o,s,a;return console.log("saveActivity: ",t,e,n,i,r),a=new c.Object("User"),a.set("id",n),s=new c.ACL(a),s.setRoleReadAccess(""+n+"_Friends",!0),o=new c.Object("Activity"),o.set("message",t),o.set("pic",e),o.set("user",new c.Object("User").set("id",n)),null!=r&&o.set("peggee",new c.Object("User").set("id",r)),null!=i&&o.set("card",new c.Object("Card").set("id",i)),o.set("ACL",s),o.save()},t.prototype.saveComment=function(t,e,n,i,r){var o,s,a,u,l;return s=new c.Object("Card"),s.set("id",e),o=new c.Object("User"),o.set("id",i),l=new c.Object("User"),l.set("id",n),a=new c.Object("Comment"),u=new c.ACL(o),u.setRoleReadAccess(""+i+"_Friends",!0),u.setRoleReadAccess(""+n+"_Friends",!0),a.set("peggee",l),a.set("card",s),a.set("text",t),a.set("author",o),a.set("userImg",r),a.set("ACL",u),a.save()},t.prototype.getUser=function(t,e){var n;return n=new c.Query(f),n.equalTo("objectId",t),n.first({success:function(){return function(t){var n;return n={firstName:t.get("first_name"),lastName:t.get("last_name"),gender:t.get("gender"),pic:t.get("avatar_url")},e(n)}}(this),error:function(t){return console.log("Error: "+t.code+"  "+t.message),e(null)}})},t.prototype.getComments=function(t,e){var n,i,r;return r=new c.Query(a),n=new c.Object("Card"),n.set("id",t),i=new c.Object("User"),i.set("id",e),r.equalTo("peggee",i),r.equalTo("card",n),r.include("author"),r.descending("createdAt"),r.find().then(function(){return function(t){var e,n,i,r;for(n=[],i=0,r=t.length;r>i;i++)e=t[i],n.push({userImg:e.get("userImg"),text:e.get("text")});return null!=t?n:null}}(this))},t.prototype.savePegg=function(t,e,n,i,r){var o,s,a,u,l,h,p;return s=new c.Object("Card"),s.set("id",e),p=new c.Object("User"),p.set("id",r),l=new c.ACL(p),l.setRoleReadAccess(""+r+"_Friends",!0),h=new c.Object("User"),h.set("id",t),a=new c.Object("Choice"),a.set("id",n),o=new c.Object("Choice"),o.set("id",i),u=new c.Object("Pegg"),u.set("guess",a),u.set("answer",o),u.set("card",s),u.set("user",p),u.set("ACL",l),u.set("peggee",h),u.save()},t.prototype.savePref=function(t,e,n,i,r,o){var s,a,u,l,h,p;return a=new c.Object("Card"),a.set("id",t),p=new c.Object("User"),p.set("id",r),u=new c.Object("Category"),u.set("id",o),h=new c.ACL(p),h.setRoleReadAccess(""+r+"_Friends",!0),s=new c.Object("Choice"),s.set("id",e),l=new c.Object("Pref"),l.set("answer",s),l.set("card",a),l.set("plug",n),l.set("plugThumb",i),l.set("user",p),l.set("mood",u),l.set("ACL",h),l.save()},t.prototype.savePlug=function(t,e,n,i){var r,o,s,a;return r=new c.Object("Card"),r.set("id",t),o=new c.Object("User"),o.set("id",i),s=new c.Query(p),s.equalTo("user",o),s.equalTo("card",r),a=c.Promise(),s.first({success:function(){return function(t){return t.set("plug",e),t.set("plugThumb",n),t.save().then(function(){return a.resolve()}).fail(function(t){return a.reject(t)})}}(this),error:function(t){return a.reject(t)}}),a},t.prototype.savePrefCount=function(t,e){var n,i,r;return n=new c.Object("Card"),n.set("id",t),i=new c.Object("Choice"),i.set("id",e),r=new c.Object("PrefCounts"),r.set("card",n),r.set("choice",i),this.getPrefCount(e).then(function(t){var e;return t?(e=t.get("count"),e+=1,t.set("count",e),t.save()):(r.set("count",1),r.save())})},t.prototype.savePoints=function(t,e,n){var i,r,o;return o=new c.Query("Points"),r=new c.Object("User"),r.set("id",t),i=new c.Object("User"),i.set("id",e),o.equalTo("pegger",r),o.equalTo("peggee",i),o.first().then(function(){return function(t){var e,o,s;return null!=t?(n=t.get("points")+n,e=t.get("cardsPlayed")+1,t.set("cardsPlayed",e),t.set("points",n),t.save()):(s=new c.ACL(r),s.setPublicReadAccess(!0),o=new c.Object("Points"),o.set("pegger",r),o.set("peggee",i),o.set("points",n),o.set("cardsPlayed",1),o.set("ACL",s),o.save()),n}}(this))},t.prototype.saveMood=function(t,e){var n,i,r,o;return n=new c.Object("Category"),n.set("id",t),o=new c.Object("User"),o.set("id",e),r=new c.ACL(o),r.setRoleReadAccess(""+e+"_Friends",!0),i=new c.Object("UserMood"),i.set("mood",n),i.set("user",o),i.set("ACL",r),i.save()},t.prototype.getUnpreffedCards=function(t,e,n){var i;return i=new c.Query(r),i.limit(t),i.notContainedIn("hasPreffed",[n.id]),null!=e&&i.containedIn("categories",[e.text]),i.find().then(function(){return function(t){var e,i,r,o;for(e={},r=0,o=t.length;o>r;r++)i=t[r],e[i.id]={id:i.id,firstName:n.get("first_name"),pic:n.get("avatar_url"),question:i.get("question")};return null!=t?e:null}}(this))},t.prototype.getCategories=function(t){var e;return e=new c.Query(o),e.find({success:function(){return function(e){return t(e)}}(this),error:function(e){return console.log("Error fetching categories: "+e.code+" "+e.message),t(null)}})},t.prototype.getPeggCards=function(t,e,n,i){var r,o,s,a;return a=new c.Object("User"),a.set("id",e.id),o=new c.Object("User"),o.set("id",i),r=new c.Object("Category"),r.set("id",n),s=new c.Query(p),s.limit(t),s.include("user"),s.include("card"),s.include("answer"),null!=i&&s.equalTo("user",o),null!=n&&s.equalTo("mood",r),s.notEqualTo("user",a),s.notContainedIn("hasPegged",[e.id]),s.find().then(function(){return function(t){var e,n,i,r,o,s;for(n={},o=0,s=t.length;s>o;o++)r=t[o],e=r.get("card"),i=r.get("user"),n[e.id]={id:e.id,peggeeId:i.id,firstName:i.get("first_name"),pic:i.get("avatar_url"),question:e.get("question")||"",answer:{id:r.get("answer").id,text:r.get("answer").get("text"),plug:r.get("plug")},hasPreffed:e.get("hasPreffed")};return null!=t?n:null}}(this))},t.prototype.getCard=function(t,e){var n;return n=new c.Query(r),n.equalTo("objectId",t),n.first({success:function(){return function(t){var n;return null!=t?(n={id:t.id,question:t.get("question"),hasPreffed:t.get("hasPreffed"),choices:[]},e(n)):e(null)}}(this),error:function(t){return console.log("Error fetching card: "+t.code+" "+t.message),e(null)}})},t.prototype.getPrefCard=function(t,e){var n,i,r;return i=new c.Object("User"),i.set("id",e),n=new c.Object("Card"),n.set("id",t),r=new c.Query(p),r.include("user"),r.include("card"),r.include("answer"),r.equalTo("user",i),r.equalTo("card",n),r.first().then(function(){return function(t){var e;return null!=t?(n=t.get("card"),i=t.get("user"),e={id:n.id,peggeeId:i.id,firstName:i.get("first_name"),pic:i.get("avatar_url"),gender:i.get("gender"),hasPegged:t.get("hasPegged"),question:n.get("question"),choices:[],answer:{id:t.get("answer").id,text:t.get("answer").get("text"),plug:t.get("plug")}}):null}}(this))},t.prototype.getPrefCards=function(t,e){var n,i,r;return i=new c.Object("User"),i.set("id",e),n=c._.map(t,function(t){var e;return e=new c.Object("Card"),e.set("id",t),e}),r=new c.Query(p),r.include("user"),r.include("card"),r.include("answer"),r.equalTo("user",i),r.containedIn("card",n),r.find().then(function(){return function(t){var e,n,r,o,s,a;for(o={},s=0,a=t.length;a>s;s++)r=t[s],e=r.get("card"),i=r.get("user"),n={id:e.id,peggeeId:i.id,firstName:i.get("first_name"),pic:i.get("avatar_url"),gender:i.get("gender"),hasPegged:r.get("hasPegged".id),question:e.get("question"),choices:[],answer:{id:r.get("answer").id,text:r.get("answer").get("text"),plug:r.get("plug")}},o[e.id]=n;return null!=t?o:null}}(this))},t.prototype.getChoices=function(t){var e,n;return n=new c.Query(s),e=new c.Object("Card"),e.set("id",t),n.equalTo("card",e),n.find().then(function(){return function(t){var e,n,i,r,o,s,a;for(n={},s=0,a=t.length;a>s;s++)e=t[s],r=e.get("text"),i=e.get("plug"),null!=i&&(i=i.S3),o=e.get("plugThumb"),null!=o&&(o=o.S3),""!==r&&(n[e.id]={id:e.id,text:r,plug:i,thumb:o});return null!=t?n:null}}(this))},t.prototype.getUserMood=function(t,e){var n,i,r;return n=new c.Object("Category"),n.set("id",t),i=new c.Object("User"),i.set("id",e),r=new c.Query(g),r.include("user"),r.include("mood"),r.equalTo("mood",n),r.equalTo("user",i),r.first({success:function(){return function(t){return null!=t?(i=t.get("user"),n=t.get("mood"),{firstName:i.get("first_name"),name:n.get("name"),pic:n.get("iconUrl")}):null}}(this)})},t.prototype.getActivity=function(t,e,n){var r,o,s;return r=[],s=new c.Object("User"),s.set("id",t),o=new c.Query(i),o.include("card"),o.include("user"),o.include("peggee"),o.descending("createdAt"),o.find({success:function(){return function(t){var e,i,o,s,a;for(i=0,o=t.length;o>i;i++)e=t[i],r.push({message:e.get("message"),pic:e.get("pic"),userId:e.get("user").id,cardId:null!=(s=e.get("card"))?s.id:void 0,peggeeId:null!=(a=e.get("peggee"))?a.id:void 0});return t.length?n(r):void 0}}(this),error:function(t){return console.log("Error: "+t.code+" "+t.message),n(null)}})},t.prototype.getPeggsByUser=function(t,e,n){var i,r,o;return r=[],o=new _.object("user"),o.set("id",userid),i=new _.query(pegg),i.include("card"),i.include("guess"),i.include("peggee"),i.include("user"),i.notequalto("user",o),i.find({success:function(){return function(t){var e,i,o;for(i=0,o=t.length;o>i;i++)e=t[i],r.push({pegger:e.get("user"),peggee:e.get("peggee"),card:e.get("card"),guess:e.get("guess")});return t.length?n(r):void 0}}(this),error:function(t){return console.log("Error: "+t.code+" "+t.message),n(null)}})},t.prototype.getNewBadge=function(t){var e,n;return e=new c.Object("User"),e.set("id",t),n=new c.Query("UserBadges"),n.equalTo("user",e),n.equalTo("hasViewed",!1),n.first().then(function(t){var e;return null!=t?(e=new c.Query("Badges"),e.equalTo("objectId",t.get("badge").id),e.first().then(function(){return function(e){var n;return n={userBadgeId:t.id,image:e.get("image"),name:e.get("name"),criteria:e.get("criteria")},null!=e?n:null}}(this))):null})},t.prototype.getTopPeggers=function(t){var e,n,i,r,o,s;for(i=[],o=0,s=t.length;s>o;o++)e=t[o],n=new c.Object("User"),n.set("id",e),i.push(n);return r=new c.Query(h),r.descending("points"),r.containedIn("peggee",i),r.include("pegger"),r.include("peggee"),r.find().then(function(){return function(t){var e,n,i,r,o,s;for(i={},r=0,o=t.length;o>r;r++)n=t[r],e=n.get("peggee"),null==i[s=e.id]&&(i[s]=[]),i[e.id].push({peggee:e,pegger:n.get("pegger"),points:n.get("points"),cardsPlayed:n.get("cardsPlayed")});return i}}(this))},t.prototype.getTodaysMoods=function(){var t;return t=new c.Query(o),t.find()},t.prototype.getPrefCount=function(t){var e,n;return e=new c.Object("Choice"),e.set("id",t),n=new c.Query(d),n.equalTo("choice",e),n.first()},t.prototype.getPrefPopularities=function(t){var e,n,i,r,o;i=[];for(r in t)y.call(t,r)&&(e=t[r],n=new c.Object("Card"),n.set("id",r),i.push(n));return o=new c.Query(d),o.containedIn("card",i),o.include("card"),o.include("choice"),o.find().then(function(){return function(n){var i,r,o,s,a;if(null!=n)for(s=0,a=n.length;a>s;s++)o=n[s],i=o.get("choice"),r=o.get("count"),e=o.get("card"),t[e.id].choices[i.id].count=r,t[e.id].total+=r;return t}}(this))},t.prototype.getPrefImages=function(t,e){var n,i;return i=new c.Object("User"),i.set("id",t),n=new c.Query(p),n.equalTo("user",i),"recent"===e&&n.addDescending("updatedAt"),n.find().then(function(n){return function(i){var r,o,s,a,c,u;for(o={},c=0,u=i.length;u>c;c++)a=i[c],s=a.get("plug"),r=a.get("card"),s&&(o[r.id]={cardId:r.id,imageUrl:s,userId:t});return"popular"===e?n.getPrefPopularities(o).then(function(t){return o.sort(function(e,n){return t[n.cardId].total-t[e.cardId].total}),o}):o}}(this))},t.prototype.getProfileActivity=function(t,e,n){var i,r,o;return i=[],o=new c.Object("User"),o.set("id",t),r=new c.Query(p),r.include("card"),r.include("answer"),r.equalTo("user",o),"recent"===e&&r.addDescending("updatedAt"),r.find({success:function(){return function(e){var r,o,s,a;for(s=0,a=e.length;a>s;s++)r=e[s],o=r.get("card"),i.push({cardId:o.id,userId:t,question:o.get("question"),answer:r.get("answer").get("text"),plug:r.get("plugThumb"),hasPegged:r.get("hasPegged")});return e.length?n(i):void 0}}(this),error:function(t){return console.log("Error: "+t.code+" "+t.message),n(null)}})},t.prototype.saveQuestion=function(t,e,n){var i,r,o;return o=new c.Object("User"),o.set("id",t),r=new c.ACL(o),r.setRoleReadAccess(""+t+"_Friends",!0),i=new c.Object("Card"),i.set("question",e),i.set("ACL",r),i.save({success:function(){return function(t){return n(t.id)}}(this),error:function(){return function(t){return console.log("Error: "+t.code+" "+t.message),n(null)}}(this)})},t.prototype.saveChoices=function(t,e){var n,i,r,o,s,a;for(a=[],o=0,s=e.length;s>o;o++)n=e[o],r=new c.Object("Choice"),r.set("text",n),i=new c.Object("Card"),i.set("id",t),r.set("card",i),a.push(r.save());return a},t.prototype.saveCategories=function(t,e,n){var i;return i=new c.Query("Card"),i.equalTo("objectId",t),i.first({success:function(){return function(t){var i,r,o;for(r=0,o=e.length;o>r;r++)i=e[r],t.addUnique("categories",i),t.save();return n("catgories saved.")}}(this),error:function(){return n("catgories save failed.")}})},t.prototype.saveBadgeView=function(t){var e;return e=new c.Query("UserBadges"),e.equalTo("objectId",t),e.first().then(function(t){return t.set("hasViewed",!0),t.save()})},t}(),_=new u,t.exports=_},function(t,e,n){n(14)(n(198))},function(t,e,n){var i;i=function(t,e,i){function r(){b.runLoop?(p.step(),window.requestAnimationFrame(r)):_=!1}function o(){for(var t=0;t<d.length;t++)d[t].emit("resize");v.emit("resize")}function s(){window.addEventListener("touchmove",function(t){t.preventDefault()},!0),document.body.classList.add("famous-root"),document.documentElement.classList.add("famous-root")}var a,c,u=n(48),l=n(12),h=n(19),p={},d=[],f=[],g=[],m=Date.now(),_=!0,y={},v=new l,b={containerType:"div",containerClass:"famous-container",fpsCap:void 0,runLoop:!0,appMode:!0},w=new h(b),P=10;p.step=function(){var t=Date.now();if(!(c&&c>t-m)){var e=0;for(a=t-m,m=t,v.emit("prerender"),e=0;e<f.length;e++)f[e].call(this);for(f.splice(0);g.length&&Date.now()-t<P;)g.shift().call(this);for(e=0;e<d.length;e++)d[e].update();v.emit("postrender")}},window.requestAnimationFrame(r),window.addEventListener("resize",o,!1),o();var x=!1;p.pipe=function(t){return t.subscribe instanceof Function?t.subscribe(p):v.pipe(t)},p.unpipe=function(t){return t.unsubscribe instanceof Function?t.unsubscribe(p):v.unpipe(t)},p.on=function(t,e){return t in y||(y[t]=v.emit.bind(v,t),document.body?document.body.addEventListener(t,y[t]):p.nextTick(function(t,e){document.body.addEventListener(t,e)}.bind(this,t,y[t]))),v.on(t,e)},p.emit=function(t,e){return v.emit(t,e)},p.removeListener=function(t,e){return v.removeListener(t,e)},p.getFPS=function(){return 1e3/a},p.setFPSCap=function(t){c=Math.floor(1e3/t)},p.getOptions=function(t){return w.getOptions(t)},p.setOptions=function(){return w.setOptions.apply(w,arguments)},p.createContext=function(t){!x&&b.appMode&&p.nextTick(s);var e=!1;t||(t=document.createElement(b.containerType),t.classList.add(b.containerClass),e=!0);var n=new u(t);return p.registerContext(n),e&&p.nextTick(function(t,e){document.body.appendChild(e),t.emit("resize")}.bind(this,n,t)),n},p.registerContext=function(t){return d.push(t),t},p.getContexts=function(){return d},p.deregisterContext=function(t){var e=d.indexOf(t);e>=0&&d.splice(e,1)},p.nextTick=function(t){f.push(t)},p.defer=function(t){g.push(t)},w.on("change",function(t){"fpsCap"===t.id?p.setFPSCap(t.value):"runLoop"===t.id&&!_&&t.value&&(_=!0,window.requestAnimationFrame(r))}),i.exports=p}.call(e,n,e,t),/* This Source Code Form is subject to the terms of the Mozilla Public
	 * License, v. 2.0. If a copy of the MPL was not distributed with this
	 * file, You can obtain one at http://mozilla.org/MPL/2.0/.
	 *
	 * Owner: mark@famo.us
	 * @license MPL 2.0
	 * @copyright Famous Industries, Inc. 2014
	 */
!(void 0!==i&&(t.exports=i))},function(t,e,n){var i;i=function(t,e,n){function i(t){return a[t]}function r(t,e){a[t]=e}function o(t){var e=a.length;return r(e,t),e}function s(t){r(t,null)}var a=[];n.exports={register:o,unregister:s,get:i,set:r}}.call(e,n,e,t),/* This Source Code Form is subject to the terms of the Mozilla Public
	 * License, v. 2.0. If a copy of the MPL was not distributed with this
	 * file, You can obtain one at http://mozilla.org/MPL/2.0/.
	 *
	 * Owner: mark@famo.us
	 * @license MPL 2.0
	 * @copyright Famous Industries, Inc. 2014
	 */
!(void 0!==i&&(t.exports=i))},function(t,e,n){var i;i=function(t,e,i){function r(t){this.options=Object.create(r.DEFAULT_OPTIONS),this._optionsManager=new u(this.options),t&&this.setOptions(t),this._showing=!1,this.nodes=[],this.transforms=[],this.states=[]}var o=n(1),s=n(16),a=n(20),c=n(15),u=n(19),l=n(21),h=n(43);r.DEFAULT_OPTIONS={inTransform:o.scale(.001,.001,.001),inOpacity:0,inOrigin:[.5,.5],inAlign:[.5,.5],outTransform:o.scale(.001,.001,.001),outOpacity:0,outOrigin:[.5,.5],outAlign:[.5,.5],showTransform:o.identity,showOpacity:1,showOrigin:[.5,.5],showAlign:[.5,.5],inTransition:!0,outTransition:!0,overlap:!1},r.prototype.setOptions=function(t){return this._optionsManager.setOptions(t)},r.prototype.show=function(t,e,n){if(!t)return this.hide(n);if(e instanceof Function&&(n=e,e=void 0),this._showing){if(!this.options.overlap)return this.hide(this.show.bind(this,t,e,n));this.hide()}this._showing=!0;var i={transform:new h(this.options.inTransform),origin:new l(this.options.inOrigin),align:new l(this.options.inAlign),opacity:new l(this.options.inOpacity)},r=new s({transform:i.transform,opacity:i.opacity,origin:i.origin,align:i.align}),o=new a;o.add(r).add(t),this.nodes.push(o),this.states.push(i),this.transforms.push(r);var u=n?c.after(3,n):void 0;e||(e=this.options.inTransition),i.transform.set(this.options.showTransform,e,u),i.opacity.set(this.options.showOpacity,e,u),i.origin.set(this.options.showOrigin,e,u),i.align.set(this.options.showAlign,e,u)},r.prototype.hide=function(t,e){if(this._showing){this._showing=!1,t instanceof Function&&(e=t,t=void 0);var n=this.nodes[this.nodes.length-1],i=this.transforms[this.transforms.length-1],r=this.states[this.states.length-1],o=c.after(3,function(){this.nodes.splice(this.nodes.indexOf(n),1),this.states.splice(this.states.indexOf(r),1),this.transforms.splice(this.transforms.indexOf(i),1),e&&e.call(this)}.bind(this));t||(t=this.options.outTransition),r.transform.set(this.options.outTransform,t,o),r.opacity.set(this.options.outOpacity,t,o),r.origin.set(this.options.outOrigin,t,o),r.align.set(this.options.outAlign,t,o)}},r.prototype.render=function(){for(var t=[],e=0;e<this.nodes.length;e++)t.push(this.nodes[e].render());return t},i.exports=r}.call(e,n,e,t),!(void 0!==i&&(t.exports=i))},function(t,e,n){var i,r,o,s,a,c,u,l,h,p={}.hasOwnProperty,d=function(t,e){function n(){this.constructor=t}for(var i in e)p.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};a=n(29),s=n(7),r=n(18),i=n(62),l=n(28),u=n(50),c=n(24),o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return d(e,t),e.prototype._currentPageID="play",e.prototype._loadPage=function(t){return this._currentPageID=t,c.history.navigate(t,{trigger:!1}),"login"===t||"signup"===t?this.emit(s.stores.LOGIN_CHANGE):"activity"===t?(i.load(0),this.emit(s.stores.MENU_CHANGE)):"profile"===t?(l.load(),this.emit(s.stores.MENU_CHANGE)):this.emit(s.stores.MENU_CHANGE)},e.prototype._loadCard=function(t,e,n){var i;return c.history.navigate(""+this._currentPageID+"/"+t+"/"+e,{trigger:!1}),this._currentPageID="card",i=null!=e?"/"+e:"",console.log(""+this._currentPageID+"/"+t+i),u.load(t,e,n),null!=n?this.emit(s.stores.MENU_CHANGE):void 0},e.prototype._logout=function(){return this._currentPageID="/",c.history.navigate(this._currentPageID,{trigger:!1})},e.prototype._login=function(){return this._currentPageID="home",this.emit(s.stores.MENU_CHANGE),this.emit(s.stores.LOGIN_CHANGE)},e.prototype.getCurrentPageID=function(){return this._currentPageID},e}(a),h=new o,r.register(function(t){var e;switch(e=t.action,e.actionType){case s.actions.MENU_SELECT:return h._loadPage(e.pageId);case s.actions.CARD_SELECT:return h._loadCard(e.cardId,e.peggeeId,e.referrer);case s.actions.LOGOUT:return h._logout();case s.actions.LOGIN:return h._login(e.referrer)}}),t.exports=h},function(t,e,n){var i;i=function(t,e,n){function i(t){t||(t=[]),t instanceof Array&&(t={array:t}),this._=null,this.index=t.index||0,t.array?this._=new this.constructor.Backing(t.array):t._&&(this._=t._),this.index===this._.firstIndex&&(this._.firstNode=this),this.index===this._.firstIndex+this._.array.length-1&&(this._.lastNode=this),void 0!==t.loop&&(this._.loop=t.loop),void 0!==t.trackSize&&(this._.trackSize=t.trackSize),this._previousNode=null,this._nextNode=null}i.Backing=function(t){this.array=t,this.firstIndex=0,this.loop=!1,this.firstNode=null,this.lastNode=null,this.cumulativeSizes=[[0,0]],this.sizeDirty=!0,this.trackSize=!1},i.Backing.prototype.getValue=function(t){var e=t-this.firstIndex;return 0>e||e>=this.array.length?null:this.array[e]},i.Backing.prototype.setValue=function(t,e){this.array[t-this.firstIndex]=e},i.Backing.prototype.getSize=function(t){return this.cumulativeSizes[t]},i.Backing.prototype.calculateSize=function(t){t=t||this.array.length;for(var e=[0,0],n=0;t>n;n++){var i=this.array[n].getSize();if(!i)return void 0;void 0!==e[0]&&(void 0===i[0]?e[0]=void 0:e[0]+=i[0]),void 0!==e[1]&&(void 0===i[1]?e[1]=void 0:e[1]+=i[1]),this.cumulativeSizes[n+1]=e.slice()}return this.sizeDirty=!1,e},i.Backing.prototype.reindex=function(t,e,n){if(this.array[0]){for(var i=0,r=this.firstIndex,o=n-e,s=this.firstNode;t-1>r;)s=s.getNext(),r++;var a=s;for(i=0;e>i;i++)s=s.getNext(),s&&(s._previousNode=a);var c=s?s.getNext():null;for(a._nextNode=null,s=a,i=0;n>i;i++)s=s.getNext();if(r+=n,s!==c&&(s._nextNode=c,c&&(c._previousNode=s)),c)for(s=c,r++;s&&r<this.array.length+this.firstIndex;)s._nextNode?s.index+=o:s.index=r,s=s.getNext(),r++;this.trackSize&&(this.sizeDirty=!0)}},i.prototype.getPrevious=function(){var t=this._.array.length;return t?this.index===this._.firstIndex?this._.loop?(this._previousNode=this._.lastNode||new this.constructor({_:this._,index:this._.firstIndex+t-1}),this._previousNode._nextNode=this):this._previousNode=null:this._previousNode||(this._previousNode=new this.constructor({_:this._,index:this.index-1}),this._previousNode._nextNode=this):this._previousNode=null,this._previousNode},i.prototype.getNext=function(){var t=this._.array.length;return t?this.index===this._.firstIndex+t-1?this._.loop?(this._nextNode=this._.firstNode||new this.constructor({_:this._,index:this._.firstIndex}),this._nextNode._previousNode=this):this._nextNode=null:this._nextNode||(this._nextNode=new this.constructor({_:this._,index:this.index+1}),this._nextNode._previousNode=this):this._nextNode=null,this._nextNode},i.prototype.indexOf=function(t){return this._.array.indexOf(t)},i.prototype.getIndex=function(){return this.index},i.prototype.toString=function(){return""+this.index},i.prototype.unshift=function(){this._.array.unshift.apply(this._.array,arguments),this._.firstIndex-=arguments.length,this._.trackSize&&(this._.sizeDirty=!0)},i.prototype.push=function(){this._.array.push.apply(this._.array,arguments),this._.trackSize&&(this._.sizeDirty=!0)},i.prototype.splice=function(t,e){var n=Array.prototype.slice.call(arguments,2);this._.array.splice.apply(this._.array,[t-this._.firstIndex,e].concat(n)),this._.reindex(t,e,n.length)},i.prototype.swap=function(t){var e=t.get(),n=this.get();this._.setValue(this.index,e),this._.setValue(t.index,n);var i=this._previousNode,r=this._nextNode,o=this.index,s=t._previousNode,a=t._nextNode,c=t.index;this.index=c,this._previousNode=s===this?t:s,this._previousNode&&(this._previousNode._nextNode=this),this._nextNode=a===this?t:a,this._nextNode&&(this._nextNode._previousNode=this),t.index=o,t._previousNode=i===t?this:i,t._previousNode&&(t._previousNode._nextNode=t),t._nextNode=r===t?this:r,t._nextNode&&(t._nextNode._previousNode=t),this.index===this._.firstIndex?this._.firstNode=this:this.index===this._.firstIndex+this._.array.length-1&&(this._.lastNode=this),t.index===this._.firstIndex?this._.firstNode=t:t.index===this._.firstIndex+this._.array.length-1&&(this._.lastNode=t),this._.trackSize&&(this._.sizeDirty=!0)},i.prototype.get=function(){return this._.getValue(this.index)},i.prototype.getSize=function(){var t=this.get();return t?t.getSize():null},i.prototype.render=function(){this._.trackSize&&this._.sizeDirty&&this._.calculateSize();var t=this.get();return t?t.render.apply(t,arguments):null},n.exports=i}.call(e,n,e,t),/* This Source Code Form is subject to the terms of the Mozilla Public
	 * License, v. 2.0. If a copy of the MPL was not distributed with this
	 * file, You can obtain one at http://mozilla.org/MPL/2.0/.
	 *
	 * Owner: mark@famo.us
	 * @license MPL 2.0
	 * @copyright Famous Industries, Inc. 2014
	 */
!(void 0!==i&&(t.exports=i))},function(t,e,n){var i;i=function(t,e,i){function r(t,e){this._eventInput=new s,this._eventOutput=new s,s.setInputHandler(this,this._eventInput),s.setOutputHandler(this,this._eventOutput),this._syncs={},t&&this.addSync(t),e&&this.setOptions(e)}function o(t,e){a[t]&&(this._syncs[t]=new a[t](e),this.pipeSync(t))}var s=n(12);r.DIRECTION_X=0,r.DIRECTION_Y=1,r.DIRECTION_Z=2;var a={};r.register=function(t){for(var e in t){if(a[e]){if(a[e]===t[e])return;throw new Error("this key is registered to a different sync class")}a[e]=t[e]}},r.prototype.setOptions=function(t){for(var e in this._syncs)this._syncs[e].setOptions(t)},r.prototype.pipeSync=function(t){var e=this._syncs[t];this._eventInput.pipe(e),e.pipe(this._eventOutput)},r.prototype.unpipeSync=function(t){var e=this._syncs[t];this._eventInput.unpipe(e),e.unpipe(this._eventOutput)},r.prototype.addSync=function(t){if(t instanceof Array)for(var e=0;e<t.length;e++)o.call(this,t[e]);else if(t instanceof Object)for(var n in t)o.call(this,n,t[n])},i.exports=r}.call(e,n,e,t),/* This Source Code Form is subject to the terms of the Mozilla Public
	 * License, v. 2.0. If a copy of the MPL was not distributed with this
	 * file, You can obtain one at http://mozilla.org/MPL/2.0/.
	 *
	 * Owner: mark@famo.us
	 * @license MPL 2.0
	 * @copyright Famous Industries, Inc. 2014
	 */
!(void 0!==i&&(t.exports=i))},function(t,e,n){var i;i=function(t,e,i){function r(t){this.options=Object.create(r.DEFAULT_OPTIONS),this._optionsManager=new l(this.options),t&&this.setOptions(t),this._eventOutput=new u,this._touchTracker=new c({touchLimit:this.options.touchLimit}),u.setOutputHandler(this,this._eventOutput),u.setInputHandler(this,this._touchTracker),this._touchTracker.on("trackstart",o.bind(this)),this._touchTracker.on("trackmove",s.bind(this)),this._touchTracker.on("trackend",a.bind(this)),this._payload={delta:null,position:null,velocity:null,clientX:void 0,clientY:void 0,count:0,touch:void 0},this._position=null}function o(t){var e,n;void 0!==this.options.direction?(this._position=0,e=0,n=0):(this._position=[0,0],e=[0,0],n=[0,0]);var i=this._payload;i.delta=n,i.position=this._position,i.velocity=e,i.clientX=t.x,i.clientY=t.y,i.count=t.count,i.touch=t.identifier,this._eventOutput.emit("start",i)}function s(t){var e=t.history,n=e[e.length-1],i=e[e.length-2],o=e[e.length-this.options.velocitySampleLength]?e[e.length-this.options.velocitySampleLength]:e[e.length-2],s=o.timestamp,a=n.timestamp,c=n.x-i.x,u=n.y-i.y,l=n.x-o.x,p=n.y-o.y;this.options.rails&&(Math.abs(c)>Math.abs(u)?u=0:c=0,Math.abs(l)>Math.abs(p)?p=0:l=0);var d,f,g=Math.max(a-s,h),m=l/g,_=p/g,y=this.options.scale;this.options.direction===r.DIRECTION_X?(f=y*c,d=y*m,this._position+=f):this.options.direction===r.DIRECTION_Y?(f=y*u,d=y*_,this._position+=f):(f=[y*c,y*u],d=[y*m,y*_],this._position[0]+=f[0],this._position[1]+=f[1]);var v=this._payload;v.delta=f,v.velocity=d,v.position=this._position,v.clientX=t.x,v.clientY=t.y,v.count=t.count,v.touch=t.identifier,this._eventOutput.emit("update",v)}function a(t){this._payload.count=t.count,this._eventOutput.emit("end",this._payload)}var c=n(88),u=n(12),l=n(19);r.DEFAULT_OPTIONS={direction:void 0,rails:!1,touchLimit:1,velocitySampleLength:10,scale:1},r.DIRECTION_X=0,r.DIRECTION_Y=1;var h=8;r.prototype.setOptions=function(t){return this._optionsManager.setOptions(t)},r.prototype.getOptions=function(){return this.options},i.exports=r}.call(e,n,e,t),/* This Source Code Form is subject to the terms of the Mozilla Public
	 * License, v. 2.0. If a copy of the MPL was not distributed with this
	 * file, You can obtain one at http://mozilla.org/MPL/2.0/.
	 *
	 * Owner: mark@famo.us
	 * @license MPL 2.0
	 * @copyright Famous Industries, Inc. 2014
	 */
!(void 0!==i&&(t.exports=i))},function(t,e,n){var i;i=function(t,e,n){function i(t,e,n){return 1===arguments.length&&void 0!==t?this.set(t):(this.x=t||0,this.y=e||0,this.z=n||0),this}function r(t,e,n){return this.x=t,this.y=e,this.z=n,this}function o(t){return r.call(this,t[0],t[1],t[2]||0)}function s(t){return r.call(this,t.x,t.y,t.z)}function a(t){return r.call(this,t,0,0)}var c=new i(0,0,0);i.prototype.add=function(t){return r.call(c,this.x+t.x,this.y+t.y,this.z+t.z)},i.prototype.sub=function(t){return r.call(c,this.x-t.x,this.y-t.y,this.z-t.z)},i.prototype.mult=function(t){return r.call(c,t*this.x,t*this.y,t*this.z)},i.prototype.div=function(t){return this.mult(1/t)},i.prototype.cross=function(t){var e=this.x,n=this.y,i=this.z,o=t.x,s=t.y,a=t.z;return r.call(c,i*s-n*a,e*a-i*o,n*o-e*s)},i.prototype.equals=function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},i.prototype.rotateX=function(t){var e=this.x,n=this.y,i=this.z,o=Math.cos(t),s=Math.sin(t);return r.call(c,e,n*o-i*s,n*s+i*o)},i.prototype.rotateY=function(t){var e=this.x,n=this.y,i=this.z,o=Math.cos(t),s=Math.sin(t);return r.call(c,i*s+e*o,n,i*o-e*s)},i.prototype.rotateZ=function(t){var e=this.x,n=this.y,i=this.z,o=Math.cos(t),s=Math.sin(t);return r.call(c,e*o-n*s,e*s+n*o,i)},i.prototype.dot=function(t){return this.x*t.x+this.y*t.y+this.z*t.z},i.prototype.normSquared=function(){return this.dot(this)},i.prototype.norm=function(){return Math.sqrt(this.normSquared())},i.prototype.normalize=function(t){0===arguments.length&&(t=1);var e=this.norm();return e>1e-7?s.call(c,this.mult(t/e)):r.call(c,t,0,0)},i.prototype.clone=function(){return new i(this)},i.prototype.isZero=function(){return!(this.x||this.y||this.z)},i.prototype.set=function(t){return t instanceof Array?o.call(this,t):"number"==typeof t?a.call(this,t):s.call(this,t)},i.prototype.setXYZ=function(){return r.apply(this,arguments)},i.prototype.set1D=function(t){return a.call(this,t)},i.prototype.put=function(t){this===c?s.call(t,c):s.call(t,this)},i.prototype.clear=function(){return r.call(this,0,0,0)},i.prototype.cap=function u(u){if(1/0===u)return s.call(c,this);var t=this.norm();return t>u?s.call(c,this.mult(u/t)):s.call(c,this)},i.prototype.project=function(t){return t.mult(this.dot(t))},i.prototype.reflectAcross=function(t){return t.normalize().put(t),s(c,this.sub(this.project(t).mult(2)))},i.prototype.get=function(){return[this.x,this.y,this.z]},i.prototype.get1D=function(){return this.x},n.exports=i}.call(e,n,e,t),/* This Source Code Form is subject to the terms of the Mozilla Public
	 * License, v. 2.0. If a copy of the MPL was not distributed with this
	 * file, You can obtain one at http://mozilla.org/MPL/2.0/.
	 *
	 * Owner: david@famo.us
	 * @license MPL 2.0
	 * @copyright Famous Industries, Inc. 2014
	 */
!(void 0!==i&&(t.exports=i))},function(t,e,n){var i;i=function(t,e,i){function r(t){this._final=c.identity.slice(),this._finalTranslate=[0,0,0],this._finalRotate=[0,0,0],this._finalSkew=[0,0,0],this._finalScale=[1,1,1],this.translate=new a(this._finalTranslate),this.rotate=new a(this._finalRotate),this.skew=new a(this._finalSkew),this.scale=new a(this._finalScale),t&&this.set(t)}function o(){return c.build({translate:this.translate.get(),rotate:this.rotate.get(),skew:this.skew.get(),scale:this.scale.get()})}function s(){return c.build({translate:this._finalTranslate,rotate:this._finalRotate,skew:this._finalSkew,scale:this._finalScale})}var a=n(21),c=n(1),u=n(15);r.prototype.setTranslate=function(t,e,n){return this._finalTranslate=t,this._final=s.call(this),this.translate.set(t,e,n),this},r.prototype.setScale=function(t,e,n){return this._finalScale=t,this._final=s.call(this),this.scale.set(t,e,n),this},r.prototype.setRotate=function(t,e,n){return this._finalRotate=t,this._final=s.call(this),this.rotate.set(t,e,n),this},r.prototype.setSkew=function(t,e,n){return this._finalSkew=t,this._final=s.call(this),this.skew.set(t,e,n),this},r.prototype.set=function(t,e,n){var i=c.interpret(t);this._finalTranslate=i.translate,this._finalRotate=i.rotate,this._finalSkew=i.skew,this._finalScale=i.scale,this._final=t;var r=n?u.after(4,n):null;return this.translate.set(i.translate,e,r),this.rotate.set(i.rotate,e,r),this.skew.set(i.skew,e,r),this.scale.set(i.scale,e,r),this},r.prototype.setDefaultTransition=function(t){this.translate.setDefault(t),this.rotate.setDefault(t),this.skew.setDefault(t),this.scale.setDefault(t)},r.prototype.get=function(){return this.isActive()?o.call(this):this._final},r.prototype.getFinal=function(){return this._final},r.prototype.isActive=function(){return this.translate.isActive()||this.rotate.isActive()||this.scale.isActive()||this.skew.isActive()},r.prototype.halt=function(){return this.translate.halt(),this.rotate.halt(),this.skew.halt(),this.scale.halt(),this._final=this.get(),this._finalTranslate=this.translate.get(),this._finalRotate=this.rotate.get(),this._finalSkew=this.skew.get(),this._finalScale=this.scale.get(),this},i.exports=r}.call(e,n,e,t),/* This Source Code Form is subject to the terms of the Mozilla Public
	 * License, v. 2.0. If a copy of the MPL was not distributed with this
	 * file, You can obtain one at http://mozilla.org/MPL/2.0/.
	 *
	 * Owner: david@famo.us
	 * @license MPL 2.0
	 * @copyright Famous Industries, Inc. 2014
	 */
!(void 0!==i&&(t.exports=i))},function(t,e,n){var i;i=function(t,e,i){function r(){l.apply(this,arguments),this._showing=-1,this._outgoingRenderables=[],this._nextRenderable=null,this._renderables=[],this._nodes=[],this._modifiers=[],this._states=[],this.inTransformMap=r.DefaultMap.transform,this.inOpacityMap=r.DefaultMap.opacity,this.inOriginMap=r.DefaultMap.origin,this.outTransformMap=r.DefaultMap.transform,this.outOpacityMap=r.DefaultMap.opacity,this.outOriginMap=r.DefaultMap.origin,this._output=[]}function o(t,e){return t(e.get())}var s=n(16),a=n(20),c=n(1),u=n(21),l=n(4);r.prototype=Object.create(l.prototype),r.prototype.constructor=r,r.DEFAULT_OPTIONS={inTransition:!0,outTransition:!0,overlap:!0},r.DefaultMap={transform:function(){return c.identity},opacity:function(t){return t},origin:null},r.prototype.inTransformFrom=function(t){if(t instanceof Function)this.inTransformMap=t;else{if(!t||!t.get)throw new Error("inTransformFrom takes only function or getter object");this.inTransformMap=t.get.bind(t)}return this},r.prototype.inOpacityFrom=function(t){if(t instanceof Function)this.inOpacityMap=t;else{if(!t||!t.get)throw new Error("inOpacityFrom takes only function or getter object");this.inOpacityMap=t.get.bind(t)}return this},r.prototype.inOriginFrom=function(t){if(t instanceof Function)this.inOriginMap=t;else{if(!t||!t.get)throw new Error("inOriginFrom takes only function or getter object");this.inOriginMap=t.get.bind(t)}return this},r.prototype.outTransformFrom=function(t){if(t instanceof Function)this.outTransformMap=t;else{if(!t||!t.get)throw new Error("outTransformFrom takes only function or getter object");this.outTransformMap=t.get.bind(t)}return this},r.prototype.outOpacityFrom=function(t){if(t instanceof Function)this.outOpacityMap=t;else{if(!t||!t.get)throw new Error("outOpacityFrom takes only function or getter object");this.outOpacityMap=t.get.bind(t)}return this},r.prototype.outOriginFrom=function(t){if(t instanceof Function)this.outOriginMap=t;else{if(!t||!t.get)throw new Error("outOriginFrom takes only function or getter object");this.outOriginMap=t.get.bind(t)}return this},r.prototype.show=function(t,e,n){if(!t)return this.hide(n);if(e instanceof Function&&(n=e,e=null),this._showing>=0){if(!this.options.overlap)return void(this._nextRenderable?this._nextRenderable=t:(this._nextRenderable=t,this.hide(function(){this._nextRenderable===t&&this.show(this._nextRenderable,n),this._nextRenderable=null})));this.hide()}var i=null,r=this._renderables.indexOf(t);if(r>=0){this._showing=r,i=this._states[r],i.halt();var c=this._outgoingRenderables.indexOf(t);c>=0&&this._outgoingRenderables.splice(c,1)}else{i=new u(0);var l=new s({transform:this.inTransformMap?o.bind(this,this.inTransformMap,i):null,opacity:this.inOpacityMap?o.bind(this,this.inOpacityMap,i):null,origin:this.inOriginMap?o.bind(this,this.inOriginMap,i):null}),h=new a;h.add(l).add(t),this._showing=this._nodes.length,this._nodes.push(h),this._modifiers.push(l),this._states.push(i),this._renderables.push(t)}e||(e=this.options.inTransition),i.set(1,e,n)},r.prototype.hide=function(t,e){if(!(this._showing<0)){var n=this._showing;this._showing=-1,t instanceof Function&&(e=t,t=void 0);var i=this._nodes[n],r=this._modifiers[n],s=this._states[n],a=this._renderables[n];r.transformFrom(this.outTransformMap?o.bind(this,this.outTransformMap,s):null),r.opacityFrom(this.outOpacityMap?o.bind(this,this.outOpacityMap,s):null),r.originFrom(this.outOriginMap?o.bind(this,this.outOriginMap,s):null),this._outgoingRenderables.indexOf(a)<0&&this._outgoingRenderables.push(a),t||(t=this.options.outTransition),s.halt(),s.set(0,t,function(t,n,i,r){if(this._outgoingRenderables.indexOf(r)>=0){var o=this._nodes.indexOf(t);this._nodes.splice(o,1),this._modifiers.splice(o,1),this._states.splice(o,1),this._renderables.splice(o,1),this._outgoingRenderables.splice(this._outgoingRenderables.indexOf(r),1),this._showing>=o&&this._showing--}e&&e.call(this)}.bind(this,i,r,s,a))}},r.prototype.render=function(){var t=this._output;t.length>this._nodes.length&&t.splice(this._nodes.length);for(var e=0;e<this._nodes.length;e++)t[e]=this._nodes[e].render();return t},i.exports=r}.call(e,n,e,t),/* This Source Code Form is subject to the terms of the Mozilla Public
	 * License, v. 2.0. If a copy of the MPL was not distributed with this
	 * file, You can obtain one at http://mozilla.org/MPL/2.0/.
	 *
	 * Owner: felix@famo.us
	 * @license MPL 2.0
	 * @copyright Famous Industries, Inc. 2014
	 */
!(void 0!==i&&(t.exports=i))},function(t,e,n){var i;i=function(t,e,i){function r(t){this._items=null,this._size=null,this._outputFunction=r.DEFAULT_OUTPUT_FUNCTION,this.options=c.clone(this.constructor.DEFAULT_OPTIONS||r.DEFAULT_OPTIONS),this.optionsManager=new o(this.options),t&&this.setOptions(t)}var o=n(19),s=n(1),a=n(39),c=n(15);r.DEFAULT_OPTIONS={direction:c.Direction.Y,itemSpacing:0},r.DEFAULT_OUTPUT_FUNCTION=function(t,e){var n=this.options.direction===c.Direction.X?s.translate(e,0):s.translate(0,e);return{transform:n,target:t.render()}},r.prototype.getSize=function(){return this._size||this.render(),this._size},r.prototype.sequenceFrom=function(t){return t instanceof Array&&(t=new a(t)),this._items=t,this},r.prototype.setOptions=function(){return this.optionsManager.setOptions.apply(this.optionsManager,arguments),this},r.prototype.setOutputFunction=function(t){return this._outputFunction=t,this},r.prototype.render=function(){var t=0,e=1^this.options.direction,n=this._items,i=null,r=[],o={},s=[],a=0;for(this._size=[0,0];n&&(i=n.get());)i.getSize&&(r=i.getSize()),o=this._outputFunction.call(this,i,t,a++),s.push(o),r&&(r[this.options.direction]&&(t+=r[this.options.direction]),r[e]>this._size[e]&&(this._size[e]=r[e])),n=n.getNext(),this.options.itemSpacing&&n&&(t+=this.options.itemSpacing);return this._size[this.options.direction]=t,s},i.exports=r}.call(e,n,e,t),/* This Source Code Form is subject to the terms of the Mozilla Public
	 * License, v. 2.0. If a copy of the MPL was not distributed with this
	 * file, You can obtain one at http://mozilla.org/MPL/2.0/.
	 *
	 * Owner: felix@famo.us
	 * @license MPL 2.0
	 * @copyright Famous Industries, Inc. 2014
	 */
!(void 0!==i&&(t.exports=i))},function(t,e,n){"use strict";t.exports=function(t){function e(e){var n=new i(e),r=t.rejected(n),o=r._peekContext();return null!=o&&o._attachExtraTrace(n),r}var i=n(17).TypeError;return e}},function(t,e,n){t.exports={"public":n(177)}},function(t,e,n){var i;i=function(t,e,i){function r(t){return[t.clientWidth,t.clientHeight]}function o(t){this.container=t,this._allocator=new c(t),this._node=new s,this._eventOutput=new a,this._size=r(this.container),this._perspectiveState=new l(0),this._perspective=void 0,this._nodeContext={allocator:this._allocator,transform:u.identity,opacity:1,origin:h,align:h,size:this._size},this._eventOutput.on("resize",function(){this.setSize(r(this.container))}.bind(this))}var s=n(20),a=n(12),c=n(83),u=n(1),l=n(21),h=[0,0],p=!("perspective"in document.documentElement.style),d=p?function(t,e){t.style.webkitPerspective=e?e.toFixed()+"px":""}:function(t,e){t.style.perspective=e?e.toFixed()+"px":""};o.prototype.getAllocator=function(){return this._allocator},o.prototype.add=function(t){return this._node.add(t)},o.prototype.migrate=function(t){t!==this.container&&(this.container=t,this._allocator.migrate(t))},o.prototype.getSize=function(){return this._size},o.prototype.setSize=function(t){t||(t=r(this.container)),this._size[0]=t[0],this._size[1]=t[1]},o.prototype.update=function(t){t&&(t.transform&&(this._nodeContext.transform=t.transform),t.opacity&&(this._nodeContext.opacity=t.opacity),t.origin&&(this._nodeContext.origin=t.origin),t.align&&(this._nodeContext.align=t.align),t.size&&(this._nodeContext.size=t.size));var e=this._perspectiveState.get();e!==this._perspective&&(d(this.container,e),this._perspective=e),this._node.commit(this._nodeContext)},o.prototype.getPerspective=function(){return this._perspectiveState.get()},o.prototype.setPerspective=function(t,e,n){return this._perspectiveState.set(t,e,n)},o.prototype.emit=function(t,e){return this._eventOutput.emit(t,e)},o.prototype.on=function(t,e){return this._eventOutput.on(t,e)},o.prototype.removeListener=function(t,e){return this._eventOutput.removeListener(t,e)},o.prototype.pipe=function(t){return this._eventOutput.pipe(t)},o.prototype.unpipe=function(t){return this._eventOutput.unpipe(t)},i.exports=o}.call(e,n,e,t),/* This Source Code Form is subject to the terms of the Mozilla Public
	 * License, v. 2.0. If a copy of the MPL was not distributed with this
	 * file, You can obtain one at http://mozilla.org/MPL/2.0/.
	 *
	 * Owner: mark@famo.us
	 * @license MPL 2.0
	 * @copyright Famous Industries, Inc. 2014
	 */
!(void 0!==i&&(t.exports=i))},function(t,e,n){var i;i=function(t,e,i){function r(t){this.options=Object.create(r.DEFAULT_OPTIONS),this._optionsManager=new l(this.options),t&&this.setOptions(t),this._eventInput=new u,this._eventOutput=new u,u.setInputHandler(this,this._eventInput),u.setOutputHandler(this,this._eventOutput),this._eventInput.on("mousedown",o.bind(this)),this._eventInput.on("mousemove",s.bind(this)),this._eventInput.on("mouseup",a.bind(this)),this.options.propogate?this._eventInput.on("mouseleave",c.bind(this)):this._eventInput.on("mouseleave",a.bind(this)),this._payload={delta:null,position:null,velocity:null,clientX:0,clientY:0,offsetX:0,offsetY:0},this._positionHistory=[],this._position=null,this._prevCoord=void 0,this._prevTime=void 0,this._down=!1,this._moved=!1,this._documentActive=!1}function o(t){var e,n;this.options.preventDefault&&t.preventDefault();var i=t.clientX,r=t.clientY;this._prevCoord=[i,r],this._prevTime=Date.now(),this._down=!0,this._move=!1,void 0!==this.options.direction?(this._position=0,e=0,n=0):(this._position=[0,0],e=[0,0],n=[0,0]);var o=this._payload;o.delta=e,o.position=this._position,o.velocity=n,o.clientX=i,o.clientY=r,o.offsetX=t.offsetX,o.offsetY=t.offsetY,this._positionHistory.push({position:o.position.slice?o.position.slice(0):o.position,time:this._prevTime}),this._eventOutput.emit("start",o),this._documentActive=!1}function s(t){if(this._prevCoord){var e=this._prevCoord,n=(this._prevTime,t.clientX),i=t.clientY,o=Date.now(),s=n-e[0],a=i-e[1];this.options.rails&&(Math.abs(s)>Math.abs(a)?a=0:s=0);var c,u,l=Math.max(o-this._positionHistory[0].time,h),p=this.options.scale;this.options.direction===r.DIRECTION_X?(u=p*s,this._position+=u,c=p*(this._position-this._positionHistory[0].position)/l):this.options.direction===r.DIRECTION_Y?(u=p*a,this._position+=u,c=p*(this._position-this._positionHistory[0].position)/l):(u=[p*s,p*a],c=[p*(this._position[0]-this._positionHistory[0].position[0])/l,p*(this._position[1]-this._positionHistory[0].position[1])/l],this._position[0]+=u[0],this._position[1]+=u[1]);var d=this._payload;d.delta=u,d.position=this._position,d.velocity=c,d.clientX=n,d.clientY=i,d.offsetX=t.offsetX,d.offsetY=t.offsetY,this._positionHistory.length===this.options.velocitySampleLength&&this._positionHistory.shift(),this._positionHistory.push({position:d.position.slice?d.position.slice(0):d.position,time:o}),this._eventOutput.emit("update",d),this._prevCoord=[n,i],this._prevTime=o,this._move=!0}}function a(){this._down&&(this._eventOutput.emit("end",this._payload),this._prevCoord=void 0,this._prevTime=void 0,this._down=!1,this._move=!1,this._positionHistory=[])}function c(t){if(this._down&&this._move&&!this._documentActive){var e=s.bind(this),n=function(t){a.call(this,t),document.removeEventListener("mousemove",e),document.removeEventListener("mouseup",n)}.bind(this,t);document.addEventListener("mousemove",e),document.addEventListener("mouseup",n),this._documentActive=!0}}var u=n(12),l=n(19);r.DEFAULT_OPTIONS={direction:void 0,rails:!1,scale:1,propogate:!0,velocitySampleLength:10,preventDefault:!0},r.DIRECTION_X=0,r.DIRECTION_Y=1;var h=8;r.prototype.getOptions=function(){return this.options},r.prototype.setOptions=function(t){return this._optionsManager.setOptions(t)},i.exports=r}.call(e,n,e,t),/* This Source Code Form is subject to the terms of the Mozilla Public
	 * License, v. 2.0. If a copy of the MPL was not distributed with this
	 * file, You can obtain one at http://mozilla.org/MPL/2.0/.
	 *
	 * Owner: mark@famo.us
	 * @license MPL 2.0
	 * @copyright Famous Industries, Inc. 2014
	 */
!(void 0!==i&&(t.exports=i))},function(t,e,n){var i,r,o;i=n(18),r=n(7).actions,o={load:function(t,e,n){return i.handleViewAction({actionType:r.SINGLE_CARD_LOAD,card:t,peggee:e,referrer:n})},comment:function(t){return i.handleViewAction({actionType:r.SINGLE_CARD_COMMENT,comment:t})},plug:function(t,e,n){return i.handleViewAction({actionType:r.SINGLE_CARD_PLUG,card:t,full:e,thumb:n})},pref:function(t,e,n){return i.handleViewAction({actionType:r.SINGLE_CARD_PREF,card:t,choice:e,plug:n})},pegg:function(t,e,n,o){return i.handleViewAction({actionType:r.SINGLE_CARD_PEGG,peggee:t,card:e,choice:n,answer:o})}},t.exports=o},function(t,e,n){var i,r,o,s,a,c,u,l,h,p=function(t,e){return function(){return t.apply(e,arguments)}},d={}.hasOwnProperty,f=function(t,e){function n(){this.constructor=t}for(var i in e)d.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};n(207),h=n(4),c=n(3),a=n(5),i=n(10),o=n(58),u=n(1),r=n(8),l=n(2),s=function(t){function e(t){this.clear=p(this.clear,this),this.setValue=p(this.setValue,this),this.getValue=p(this.getValue,this),this.setAlign=p(this.setAlign,this),this.onInputBlur=p(this.onInputBlur,this),this.onInputFocus=p(this.onInputFocus,this),this.init=p(this.init,this),e.__super__.constructor.call(this,t),this.init()}return f(e,t),e.DEFAULT_OPTIONS={cssPrefix:"input__text"},e.prototype.init=function(){return this.textInput=new o({size:this.options.size,placeholder:this.options.placeholder,classes:[""+this.options.cssPrefix]}),this.textInputMod=new a,this.add(this.textInputMod).add(this.textInput),this.textInput.on("click",function(t){return function(){return t.onInputFocus()}}(this)),this.textInput.on("keypress",function(t){return function(e){return 13===e.keyCode?(t.onInputBlur(),t._eventOutput.emit("submit",e.currentTarget.value),t.textInput.setValue(e.currentTarget.value)):void 0}}(this))},e.prototype.onInputFocus=function(){return this.textInput.focus(),this.textInput.setClasses([""+this.options.cssPrefix+"--big"]),this.textInput.setSize([l.getViewportWidth(),l.getViewportHeight()/2+50]),this.textInputMod.setAlign([.5,0]),this.textInputMod.setOrigin([.5,0])},e.prototype.onInputBlur=function(){return this.textInput.blur(),this.textInput.setClasses([""+this.options.cssPrefix]),this.textInput.setSize(this.options.size),this.textInputMod.setAlign(this.options.align),this.textInputMod.setOrigin(this.options.origin),null!=this.options.transform?this.textInputMod.setTransform(this.options.transform):void 0},e.prototype.setAlign=function(t){return this.textInputMod.setAlign(t)},e.prototype.getValue=function(){return this.textInput.getValue()},e.prototype.setValue=function(t){return this.textInput.setValue(t)},e.prototype.clear=function(){return this.textInput.setValue("")},e}(h),t.exports=s},function(t,e,n){n(14)(n(185))},function(t,e,n){n(14)(n(190))},function(t,e,n){var i;i=function(t,e,i){function r(t){this.options=Object.create(r.DEFAULT_OPTIONS),t&&this.setOptions(t),this._particles=[],this._bodies=[],this._agentData={},this._forces=[],this._constraints=[],this._buffer=0,this._prevTime=x(),this._isSleeping=!1,this._eventHandler=null,this._currAgentId=0,this._hasBodies=!1,this._eventHandler=null}function o(t){return t.applyForce?this._forces:t.applyConstraint?this._constraints:void 0}function s(t,e,n){return void 0===e&&(e=this.getParticlesAndBodies()),e instanceof Array||(e=[e]),t.on("change",this.wake.bind(this)),this._agentData[this._currAgentId]={agent:t,id:this._currAgentId,targets:e,source:n},o.call(this,t).push(this._currAgentId),this._currAgentId++}function a(t){return this._agentData[t]}function c(t){var e=a.call(this,this._forces[t]);e.agent.applyForce(e.targets,e.source)}function u(){for(var t=this._forces.length-1;t>-1;t--)c.call(this,t)}function l(t,e){var n=this._agentData[this._constraints[t]];return n.agent.applyConstraint(n.targets,n.source,e)}function h(t){for(var e=0;e<this.options.constraintSteps;){for(var n=this._constraints.length-1;n>-1;n--)l.call(this,n,t);e++}}function p(t,e){t.integrateVelocity(e),this.options.velocityCap&&t.velocity.cap(this.options.velocityCap).put(t.velocity)}function d(t,e){t.integrateAngularMomentum(e),t.updateAngularVelocity(),this.options.angularVelocityCap&&t.angularVelocity.cap(this.options.angularVelocityCap).put(t.angularVelocity)}function f(t,e){t.integrateOrientation(e)}function g(t,e){t.integratePosition(e),t.emit(k.update,t)}function m(t){u.call(this,t),this.forEach(p,t),this.forEachBody(d,t),h.call(this,t),this.forEachBody(f,t),this.forEach(g,t)}function _(){var t=0,e=0;return this.forEach(function(n){e=n.getEnergy(),t+=e}),t}function y(){var t=0;for(var e in this._agentData)t+=this.getAgentEnergy(e);return t}var v=n(12),b=17,w=1e3/120,P=17,x=Date.now,k={start:"start",update:"update",end:"end"};r.DEFAULT_OPTIONS={constraintSteps:1,sleepTolerance:1e-7,velocityCap:void 0,angularVelocityCap:void 0},r.prototype.setOptions=function(t){for(var e in t)this.options[e]&&(this.options[e]=t[e])},r.prototype.addBody=function(t){return t._engine=this,t.isBody?(this._bodies.push(t),this._hasBodies=!0):this._particles.push(t),t.on("start",this.wake.bind(this)),t},r.prototype.removeBody=function(t){var e=t.isBody?this._bodies:this._particles,n=e.indexOf(t);if(n>-1){for(var i in this._agentData)this.detachFrom(i.id,t);e.splice(n,1)}0===this.getBodies().length&&(this._hasBodies=!1)},r.prototype.attach=function(t,e,n){if(this.wake(),t instanceof Array){for(var i=[],r=0;r<t.length;r++)i[r]=s.call(this,t[r],e,n);return i}return s.call(this,t,e,n)},r.prototype.attachTo=function(t,e){a.call(this,t).targets.push(e)},r.prototype.detach=function(t){var e=this.getAgent(t),n=o.call(this,e),i=n.indexOf(t);n.splice(i,1),delete this._agentData[t]},r.prototype.detachFrom=function(t,e){var n=a.call(this,t);if(n.source===e)this.detach(t);else{var i=n.targets,r=i.indexOf(e);r>-1&&i.splice(r,1)}},r.prototype.detachAll=function(){this._agentData={},this._forces=[],this._constraints=[],this._currAgentId=0},r.prototype.getAgent=function(t){return a.call(this,t).agent},r.prototype.getParticles=function(){return this._particles},r.prototype.getBodies=function(){return this._bodies},r.prototype.getParticlesAndBodies=function(){return this.getParticles().concat(this.getBodies())},r.prototype.forEachParticle=function(t,e){for(var n=this.getParticles(),i=0,r=n.length;r>i;i++)t.call(this,n[i],e)},r.prototype.forEachBody=function(t,e){if(this._hasBodies)for(var n=this.getBodies(),i=0,r=n.length;r>i;i++)t.call(this,n[i],e)},r.prototype.forEach=function(t,e){this.forEachParticle(t,e),this.forEachBody(t,e)},r.prototype.getAgentEnergy=function(t){var e=a.call(this,t);return e.agent.getEnergy(e.targets,e.source)},r.prototype.getEnergy=function(){return _.call(this)+y.call(this)},r.prototype.step=function(){if(!this.isSleeping()){var t=x(),e=t-this._prevTime;this._prevTime=t,w>e||(e>P&&(e=P),m.call(this,b),this.emit(k.update,this),this.getEnergy()<this.options.sleepTolerance&&this.sleep())}},r.prototype.isSleeping=function(){return this._isSleeping},r.prototype.isActive=function(){return!this._isSleeping},r.prototype.sleep=function(){this._isSleeping||(this.forEach(function(t){t.sleep()}),this.emit(k.end,this),this._isSleeping=!0)},r.prototype.wake=function(){this._isSleeping&&(this._prevTime=x(),this.emit(k.start,this),this._isSleeping=!1)},r.prototype.emit=function(t,e){null!==this._eventHandler&&this._eventHandler.emit(t,e)},r.prototype.on=function(t,e){null===this._eventHandler&&(this._eventHandler=new v),this._eventHandler.on(t,e)},i.exports=r}.call(e,n,e,t),/* This Source Code Form is subject to the terms of the Mozilla Public
	 * License, v. 2.0. If a copy of the MPL was not distributed with this
	 * file, You can obtain one at http://mozilla.org/MPL/2.0/.
	 *
	 * @license MPL 2.0
	 * @copyright Famous Industries, Inc. 2014
	 */
!(void 0!==i&&(t.exports=i))},function(t,e,n){var i;i=function(t,e,i){function r(t){t=t||{};var e=r.DEFAULT_OPTIONS;this.position=new s,this.velocity=new s,this.force=new s,this._engine=null,this._isSleeping=!0,this._eventOutput=null,this.mass=void 0!==t.mass?t.mass:e.mass,this.inverseMass=1/this.mass,this.setPosition(t.position||e.position),this.setVelocity(t.velocity||e.velocity),this.force.set(t.force||[0,0,0]),this.transform=a.identity.slice(),this._spec={size:[!0,!0],target:{transform:this.transform,origin:[.5,.5],target:null}}}function o(){this._eventOutput=new c,this._eventOutput.bindThis(this),c.setOutputHandler(this,this._eventOutput)}var s=n(42),a=n(1),c=n(12),u=n(90);r.DEFAULT_OPTIONS={position:[0,0,0],velocity:[0,0,0],mass:1};var l={start:"start",update:"update",end:"end"},h=Date.now;r.prototype.isBody=!1,r.prototype.isActive=function(){return!this._isSleeping},r.prototype.sleep=function(){this._isSleeping||(this.emit(l.end,this),this._isSleeping=!0)},r.prototype.wake=function(){this._isSleeping&&(this.emit(l.start,this),this._isSleeping=!1,this._prevTime=h(),this._engine&&this._engine.wake())},r.prototype.setPosition=function(t){this.position.set(t)},r.prototype.setPosition1D=function(t){this.position.x=t},r.prototype.getPosition=function(){return this._engine.step(),this.position.get()},r.prototype.getPosition1D=function(){return this._engine.step(),this.position.x},r.prototype.setVelocity=function(t){this.velocity.set(t),(0!==t[0]||0!==t[1]||0!==t[2])&&this.wake()},r.prototype.setVelocity1D=function(t){this.velocity.x=t,0!==t&&this.wake()},r.prototype.getVelocity=function(){return this.velocity.get()},r.prototype.setForce=function(t){this.force.set(t),this.wake()},r.prototype.getVelocity1D=function(){return this.velocity.x},r.prototype.setMass=function(t){this.mass=t,this.inverseMass=1/t},r.prototype.getMass=function(){return this.mass},r.prototype.reset=function(t,e){this.setPosition(t||[0,0,0]),this.setVelocity(e||[0,0,0])},r.prototype.applyForce=function(t){t.isZero()||(this.force.add(t).put(this.force),this.wake())},r.prototype.applyImpulse=function(t){if(!t.isZero()){var e=this.velocity;e.add(t.mult(this.inverseMass)).put(e)}},r.prototype.integrateVelocity=function(t){u.integrateVelocity(this,t)},r.prototype.integratePosition=function(t){u.integratePosition(this,t)},r.prototype._integrate=function(t){this.integrateVelocity(t),this.integratePosition(t)},r.prototype.getEnergy=function(){return.5*this.mass*this.velocity.normSquared()},r.prototype.getTransform=function(){this._engine.step();var t=this.position,e=this.transform;return e[12]=t.x,e[13]=t.y,e[14]=t.z,e},r.prototype.modify=function(t){var e=this._spec.target;return e.transform=this.getTransform(),e.target=t,this._spec},r.prototype.emit=function(t,e){this._eventOutput&&this._eventOutput.emit(t,e)},r.prototype.on=function(){return o.call(this),this.on.apply(this,arguments)},r.prototype.removeListener=function(){return o.call(this),this.removeListener.apply(this,arguments)},r.prototype.pipe=function(){return o.call(this),this.pipe.apply(this,arguments)},r.prototype.unpipe=function(){return o.call(this),this.unpipe.apply(this,arguments)},i.exports=r}.call(e,n,e,t),/* This Source Code Form is subject to the terms of the Mozilla Public
	 * License, v. 2.0. If a copy of the MPL was not distributed with this
	 * file, You can obtain one at http://mozilla.org/MPL/2.0/.
	 *
	 * Owner: david@famo.us
	 * @license MPL 2.0
	 * @copyright Famous Industries, Inc. 2014
	 */
!(void 0!==i&&(t.exports=i))},function(t,e,n){var i;i=function(t,e,i){function r(t){this.force=new o(t),this._eventOutput=new s,s.setOutputHandler(this,this._eventOutput)}var o=n(42),s=n(12);r.prototype.setOptions=function(t){this._eventOutput.emit("change",t)},r.prototype.applyForce=function(t){for(var e=t.length;e--;)t[e].applyForce(this.force)},r.prototype.getEnergy=function(){return 0},i.exports=r}.call(e,n,e,t),/* This Source Code Form is subject to the terms of the Mozilla Public
	 * License, v. 2.0. If a copy of the MPL was not distributed with this
	 * file, You can obtain one at http://mozilla.org/MPL/2.0/.
	 *
	 * Owner: david@famo.us
	 * @license MPL 2.0
	 * @copyright Famous Industries, Inc. 2014
	 */
!(void 0!==i&&(t.exports=i))},function(t,e,n){var i;i=function(t,e,i){function r(t){c.call(this),this.options=Object.create(this.constructor.DEFAULT_OPTIONS),t&&this.setOptions(t),this.disp=new u(0,0,0),a.call(this)}function o(){var t=this.options;t.stiffness=Math.pow(2*l/t.period,2)}function s(){var t=this.options;t.damping=4*l*t.dampingRatio/t.period}function a(){o.call(this),s.call(this)}var c=n(56),u=n(42);r.prototype=Object.create(c.prototype),r.prototype.constructor=r;var l=Math.PI,h=150;r.FORCE_FUNCTIONS={FENE:function(t,e){var n=.99*e,i=Math.max(Math.min(t,n),-n);return i/(1-i*i/(e*e))},HOOK:function(t){return t}},r.DEFAULT_OPTIONS={period:300,dampingRatio:.1,length:0,maxLength:1/0,anchor:void 0,forceFunction:r.FORCE_FUNCTIONS.HOOK},r.prototype.setOptions=function(t){void 0!==t.anchor&&(t.anchor.position instanceof u&&(this.options.anchor=t.anchor.position),t.anchor instanceof u&&(this.options.anchor=t.anchor),t.anchor instanceof Array&&(this.options.anchor=new u(t.anchor))),void 0!==t.period&&(t.period<h&&(t.period=h,console.warn("The period of a SpringTransition is capped at "+h+" ms. Use a SnapTransition for faster transitions")),this.options.period=t.period),void 0!==t.dampingRatio&&(this.options.dampingRatio=t.dampingRatio),void 0!==t.length&&(this.options.length=t.length),void 0!==t.forceFunction&&(this.options.forceFunction=t.forceFunction),void 0!==t.maxLength&&(this.options.maxLength=t.maxLength),a.call(this),c.prototype.setOptions.call(this,t)},r.prototype.applyForce=function(t,e){var n,i,r,o,s,a,c=this.force,u=this.disp,l=this.options,h=l.stiffness,p=l.damping,d=l.length,f=l.maxLength,g=l.anchor||e.position,m=l.forceFunction;for(n=0;n<t.length;n++){if(i=t[n],r=i.position,o=i.velocity,g.sub(r).put(u),s=u.norm()-d,0===s)return;a=i.mass,h*=a,p*=a,u.normalize(h*m(s,f)).put(c),p&&(e?c.add(o.sub(e.velocity).mult(-p)).put(c):c.add(o.mult(-p)).put(c)),i.applyForce(c),e&&e.applyForce(c.mult(-1))}},r.prototype.getEnergy=function(t,e){for(var n=this.options,i=n.length,r=e?e.position:n.anchor,o=n.stiffness,s=0,a=0;a<t.length;a++){var c=t[a],u=r.sub(c.position).norm()-i;s+=.5*o*u*u}return s},i.exports=r}.call(e,n,e,t),/* This Source Code Form is subject to the terms of the Mozilla Public
	 * License, v. 2.0. If a copy of the MPL was not distributed with this
	 * file, You can obtain one at http://mozilla.org/MPL/2.0/.
	 *
	 * Owner: david@famo.us
	 * @license MPL 2.0
	 * @copyright Famous Industries, Inc. 2014
	 */
!(void 0!==i&&(t.exports=i))},function(t,e,n){var i;i=function(t,e,i){function r(t){this._placeholder=t.placeholder||"",this._value=t.value||"",this._type=t.type||"text",this._name=t.name||"",o.apply(this,arguments),this.on("click",this.focus.bind(this)),window.addEventListener("click",function(t){t.target!==this._currentTarget&&this.blur()}.bind(this))}var o=n(3);r.prototype=Object.create(o.prototype),r.prototype.constructor=r,r.prototype.elementType="input",r.prototype.elementClass="famous-surface",r.prototype.setPlaceholder=function(t){return this._placeholder=t,this._contentDirty=!0,this},r.prototype.focus=function(){return this._currentTarget&&this._currentTarget.focus(),this},r.prototype.blur=function(){return this._currentTarget&&this._currentTarget.blur(),this},r.prototype.setValue=function(t){return this._value=t,this._contentDirty=!0,this},r.prototype.setType=function(t){return this._type=t,this._contentDirty=!0,this},r.prototype.getValue=function(){return this._currentTarget?this._currentTarget.value:this._value},r.prototype.setName=function(t){return this._name=t,this._contentDirty=!0,this},r.prototype.getName=function(){return this._name},r.prototype.deploy=function(t){""!==this._placeholder&&(t.placeholder=this._placeholder),t.value=this._value,t.type=this._type,t.name=this._name},i.exports=r}.call(e,n,e,t),/* This Source Code Form is subject to the terms of the Mozilla Public
	 * License, v. 2.0. If a copy of the MPL was not distributed with this
	 * file, You can obtain one at http://mozilla.org/MPL/2.0/.
	 *
	 * Owner: mark@famo.us
	 * @license MPL 2.0
	 * @copyright Famous Industries, Inc. 2014
	 */
!(void 0!==i&&(t.exports=i))},function(t,e,n){var i;i=function(t,e,i){function r(t){this.options=Object.create(r.DEFAULT_OPTIONS),this.optionsManager=new d(this.options),t&&this.setOptions(t),this.id=c.register(this),this._modifiers=[],this._states=[],this._contextSizeCache=[0,0],this._dimensionsCache=[0,0],this._activeCount=0,this._eventOutput=new h,h.setOutputHandler(this,this._eventOutput)}function o(t,e,n){var i=[t[0],t[1]];i[0]-=this.options.gutterSize[0]*(e-1),i[1]-=this.options.gutterSize[1]*(n-1);for(var r,o=Math.round(i[1]/n),c=Math.round(i[0]/e),u=0,l=0,h=0;n>h;h++){r=0;for(var p=0;e>p;p++)void 0===this._modifiers[l]?s.call(this,l,[c,o],[r,u,0],1):a.call(this,l,[c,o],[r,u,0],1),l++,r+=c+this.options.gutterSize[0];u+=o+this.options.gutterSize[1]}for(this._dimensionsCache=[this.options.dimensions[0],this.options.dimensions[1]],this._contextSizeCache=[t[0],t[1]],this._activeCount=n*e,h=this._activeCount;h<this._modifiers.length;h++)a.call(this,h,[Math.round(c),Math.round(o)],[0,0],0);this._eventOutput.emit("reflow")}function s(t,e,n,i){var r={transform:new g(u.translate.apply(null,n)),opacity:new f(i),size:new f(e)},o=new p({transform:r.transform,opacity:r.opacity,size:r.size});this._states[t]=r,this._modifiers[t]=o}function a(t,e,n,i){var r=this._states[t],o=r.size,s=r.opacity,a=r.transform,c=this.options.transition;a.halt(),s.halt(),o.halt(),a.setTranslate(n,c),o.set(e,c),s.set(i,c)}var c=n(36),u=(n(20),n(1)),l=n(39),h=n(12),p=n(16),d=n(19),f=n(21),g=n(43);r.DEFAULT_OPTIONS={dimensions:[1,1],transition:!1,gutterSize:[0,0]},r.prototype.render=function(){return this.id},r.prototype.setOptions=function(t){return this.optionsManager.setOptions(t)},r.prototype.sequenceFrom=function(t){t instanceof Array&&(t=new l(t)),this.sequence=t},r.prototype.commit=function(t){var e=t.transform,n=t.opacity,i=t.origin,r=t.size,s=this.options.dimensions[0],a=this.options.dimensions[1];(r[0]!==this._contextSizeCache[0]||r[1]!==this._contextSizeCache[1]||s!==this._dimensionsCache[0]||a!==this._dimensionsCache[1])&&o.call(this,r,s,a);for(var c=this.sequence,l=[],h=0;c&&h<this._modifiers.length;){var p=c.get(),d=this._modifiers[h];h>=this._activeCount&&this._states[h].opacity.isActive()&&(this._modifiers.splice(h,1),this._states.splice(h,1)),p&&l.push(d.modify({origin:i,target:p.render()})),c=c.getNext(),h++}return r&&(e=u.moveThen([-r[0]*i[0],-r[1]*i[1],0],e)),{transform:e,opacity:n,size:r,target:l}},i.exports=r}.call(e,n,e,t),/* This Source Code Form is subject to the terms of the Mozilla Public
	 * License, v. 2.0. If a copy of the MPL was not distributed with this
	 * file, You can obtain one at http://mozilla.org/MPL/2.0/.
	 *
	 * Owner: felix@famo.us
	 * @license MPL 2.0
	 * @copyright Famous Industries, Inc. 2014
	 */
!(void 0!==i&&(t.exports=i))},function(t,e,n){"use strict";function i(t){return t instanceof Error&&f.getPrototypeOf(t)===Error.prototype}function r(t){var e;return e=i(t)?new h(t):t,u.markAsOriginatingFromRejection(e),e}function o(t){function e(e,n){if(null!==t){if(e){var i=r(c(e));t._attachExtraTrace(i),t._reject(i)}else if(arguments.length>2){for(var o=arguments.length,s=new Array(o-1),a=1;o>a;++a)s[a-1]=arguments[a];t._fulfill(s)}else t._fulfill(n);t=null}}return e}var s,a=n(9),c=a.maybeWrapAsError,u=n(17),l=u.TimeoutError,h=u.RejectionError,p=n(31),d=a.haveGetters,f=n(30);if(s=d?function(t){this.promise=t}:function(t){this.promise=t,this.asCallback=o(t),this.callback=this.asCallback},d){var g={get:function(){return o(this.promise)}};f.defineProperty(s.prototype,"asCallback",g),f.defineProperty(s.prototype,"callback",g)}s._nodebackForPromise=o,s.prototype.toString=function(){return"[object PromiseResolver]"},s.prototype.resolve=s.prototype.fulfill=function(t){var e=this.promise;if(void 0===e||void 0===e._tryFollow)throw new TypeError("Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.");e._tryFollow(t)||p.invoke(e._fulfill,e,t)},s.prototype.reject=function(t){var e=this.promise;if(void 0===e||void 0===e._attachExtraTrace)throw new TypeError("Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.");u.markAsOriginatingFromRejection(t);var n=u.canAttach(t)?t:new Error(t+"");e._attachExtraTrace(n),p.invoke(e._reject,e,t),n!==t&&p.invoke(this._setCarriedStackTrace,this,n)},s.prototype.progress=function(t){p.invoke(this.promise._progress,this.promise,t)},s.prototype.cancel=function(){p.invoke(this.promise.cancel,this.promise,void 0)},s.prototype.timeout=function(){this.reject(new l("timeout"))},s.prototype.isResolved=function(){return this.promise.isResolved()},s.prototype.toJSON=function(){return this.promise.toJSON()},s.prototype._setCarriedStackTrace=function(t){this.promise.isRejected()&&this.promise._setCarriedStackTrace(t)},t.exports=s},function(t,e,n){"use strict";t.exports=function(t){function e(t,e){this.constructor$(t,e),this._howMany=0,this._unwrap=!1,this._initialized=!1}var i=n(9),r=n(17).RangeError,o=i.inherits,s=i.isArray;return o(e,t),e.prototype._init=function(){if(this._initialized){if(0===this._howMany)return void this._resolve([]);this._init$(void 0,-2);var t=s(this._values);if(this._holes=t?this._values.length-this.length():0,!this._isResolved()&&t&&this._howMany>this._canPossiblyFulfill()){var e="(Promise.some) input array contains less than "+this._howMany+" promises";this._reject(new r(e))}}},e.prototype.init=function(){this._initialized=!0,this._init()},e.prototype.setUnwrap=function(){this._unwrap=!0},e.prototype.howMany=function(){return this._howMany},e.prototype.setHowMany=function(t){this._isResolved()||(this._howMany=t)},e.prototype._promiseFulfilled=function(t){this._isResolved()||(this._addFulfilled(t),this._fulfilled()===this.howMany()&&(this._values.length=this.howMany(),this._resolve(1===this.howMany()&&this._unwrap?this._values[0]:this._values)))},e.prototype._promiseRejected=function(t){this._isResolved()||(this._addRejected(t),this.howMany()>this._canPossiblyFulfill()&&this._reject(this._values.length===this.length()?[]:this._values.slice(this.length()+this._holes)))},e.prototype._fulfilled=function(){return this._totalResolved},e.prototype._rejected=function(){return this._values.length-this.length()-this._holes},e.prototype._addRejected=function(t){this._values.push(t)},e.prototype._addFulfilled=function(t){this._values[this._totalResolved++]=t},e.prototype._canPossiblyFulfill=function(){return this.length()-this._rejected()},e}},function(t,e,n){var i,r,o;r=n(18),o=n(7).actions,i={load:function(t){return r.handleViewAction({actionType:o.LOAD_ACTIVITY,page:t})}},t.exports=i},function(t,e,n){var i,r,o;i=n(18),o=n(7),r={addQuestion:function(t){return i.handleViewAction({actionType:o.actions.ADD_QUESTION,question:t})},addAnswers:function(t){return i.handleViewAction({actionType:o.actions.ADD_ANSWERS,answers:t})},loadCategories:function(){return i.handleViewAction({actionType:o.actions.LOAD_CATEGORIES})},addCategories:function(t){return i.handleViewAction({actionType:o.actions.ADD_CATEGORIES,categories:t})}},t.exports=r},function(t,e,n){var i,r,o,s,a,c,u,l={}.hasOwnProperty,h=function(t,e){function n(){this.constructor=t}for(var i in e)l.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};o=n(33),i=n(18),r=n(7),c=n(11),s=n(29),a=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return h(e,t),e.prototype._messages={tutorial__first_unpreffed_card:"Yo! This is a new question for you. Answer about yourself so friends can pegg you.",tutorial__first_pegg_card:"Time to rally! Tap each card to answer questions about your friends."},e.prototype._show=function(t){return o.getUserSetting("show:"+t,c.getUser().id,!0).then(function(e){return function(n){return n?(e.emit(r.stores.SHOW_MESSAGE,{type:t,message:e._messages[t]}),e._dismiss(t)):void 0}}(this))},e.prototype._dismiss=function(t){return o.saveUserSetting("show:"+t,!1,c.getUser().id)},e.prototype._loading=function(){return this.emit(r.stores.SHOW_MESSAGE,{type:"loading"})},e.prototype._doneLoading=function(){return this.emit(r.stores.HIDE_MESSAGE)},e}(s),u=new a,i.register(function(t){var e;switch(e=t.action,e.actionType){case r.actions.SHOW_MESSAGE:return u._show(e.type);case r.actions.LOADING_START:return u._loading(e.context);case r.actions.LOADING_DONE:return u._doneLoading(e.context)}}),t.exports=u},function(t,e,n){var i,r,o,s,a,c,u,l,h,p,d,f,g,m=function(t,e){return function(){return t.apply(e,arguments)}},_={}.hasOwnProperty,y=function(t,e){function n(){this.constructor=t}for(var i in e)_.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};n(72),g=n(4),a=n(10),l=n(25),p=n(3),i=n(134),r=n(131),s=n(7),f=n(2),c=n(6),u=n(16),h=n(5),d=n(1),o=function(t){function e(){this.loadActivity=m(this.loadActivity,this),e.__super__.constructor.apply(this,arguments),this.items=[],this.initListeners(),this.initSurfaces()}return y(e,t),e.prototype.initListeners=function(){return r.on(s.stores.ACTIVITY_CHANGE,this.loadActivity)},e.prototype.initSurfaces=function(){var t,e,n,i,r,o;return n=new c({size:[46,31],content:"/images/GoBack_Arrow_on@2x.png"}),i=new h({align:[0,0],origin:[0,0],transform:d.translate(20,20,10)}),n.on("click",function(t){return function(){return t._eventOutput.emit("back","Home")}}(this)),this.add(i).add(n),r=new p({content:"Activity",size:[f.getViewportWidth()/2-50,50],classes:["activity__title"]}),o=new u({origin:[.5,0],align:[.5,0],transform:d.translate(null,20,null)}),this.add(o).add(r),this.activities=[],this.activityScrollview=new l({size:[f.getViewportWidth(),f.getViewportHeight()]}),this.activityScrollview.sequenceFrom(this.activities),t=new a({size:[void 0,f.getViewportHeight()-110],properties:{overflow:"hidden"}}),t.add(this.activityScrollview),e=new u({origin:[.5,.5],align:[.5,.5],transform:d.translate(null,40,null)}),this.add(e).add(t)},e.prototype.loadActivity=function(){var t,e,n,o,s,a;for(this.activities.length=0,this.items=r.getActivity(),s=this.items,a=[],n=0,o=s.length;o>n;n++)t=s[n],e=new i(t),e.on("scroll",function(t){return function(){return t._eventOutput.emit("scroll")}}(this)),e.pipe(this.activityScrollview),a.push(this.activities.push(e));return a},e}(g),t.exports=o},function(t,e,n){var i,r,o,s,a,c,u,l,h,p,d,f,g={}.hasOwnProperty,m=function(t,e){function n(){this.constructor=t}for(var i in e)g.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};n(34),f=n(4),u=n(3),o=n(6),c=n(5),h=n(1),l=n(13),s=n(27),a=n(26),i=n(10),p=n(11),d=n(2),r=function(t){function e(t){e.__super__.constructor.call(this,t),this.init()}var n,i;return m(e,t),n="",i="",e.prototype.init=function(){var t;return i=new u({classes:["status__done__title"],size:[d.getViewportWidth()-20,200],content:"All Done!<br/>Play again?"}),t=new c({align:[.5,.28],origin:[.5,0]}),this.add(t).add(i)},e.prototype.load=function(){},e}(f),t.exports=r},function(t,e,n){var i,r,o,s,a,c,u={}.hasOwnProperty,l=function(t,e){function n(){this.constructor=t}for(var i in e)u.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};n(75),c=n(4),s=n(1),o=n(3),r=n(5),a=n(2),i=function(t){function e(){e.__super__.constructor.apply(this,arguments),this.init()}return l(e,t),e.DEFAULT_OPTIONS={itemID:null,message:null,pic:null,height:100},e.prototype.init=function(){return this.build()},e.prototype.build=function(){var t,e,n;return n=this.options.get("message"),t=new o({size:[a.getViewportWidth(),this.options.height],content:n,properties:{width:a.getViewportWidth()},classes:["peggbox__item"]}),t.pipe(this._eventOutput),t.on("click",function(t){return function(){return t._eventOutput.emit("selectItem",t)}}(this)),t.on("mousedown",function(t){return function(){return t._eventOutput.emit("scroll",t)}}(this)),e=new r,this.add(e).add(t)},e}(c),t.exports=i},function(t,e,n){var i,r,o,s,a,c,u,l,h={}.hasOwnProperty,p=function(t,e){function n(){this.constructor=t}for(var i in e)h.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};n(53),l=n(4),a=n(3),i=n(6),s=n(5),c=n(28),u=n(2),r=n(23),o=function(t){function e(t){e.__super__.constructor.call(this,t),this.layoutManager=new r,this.layout=this.layoutManager.getViewLayout("LoginView"),this.initSplash(),this.initLogin()}return p(e,t),e.prototype.initSplash=function(){var t,e,n,r;return t=new i({size:this.layout.logo.size,classes:this.layout.logo.classes,content:"images/cosmic-unicorn-noback.svg"}),e=new s({align:this.layout.logo.align,origin:this.layout.logo.origin}),n=new a({size:this.layout.text.size,classes:this.layout.text.classes,content:"LOGIN"}),r=new s({align:this.layout.text.align,origin:this.layout.text.origin}),this.add(e).add(t),this.add(r).add(n),u.animateAll(e,this.layout.logo.states),u.animateAll(r,this.layout.text.states)},e.prototype.initLogin=function(){var t,e;return t=new a({size:this.layout.fbButton.size,content:"Login with Facebook",classes:this.layout.fbButton.classes,properties:{lineHeight:""+this.layout.fbButton.size[1]+"px"}}),e=new s({align:this.layout.fbButton.align,origin:this.layout.fbButton.origin}),t.on("click",function(){return c.login()}),this.add(e).add(t),u.animateAll(e,this.layout.fbButton.states)},e}(l),t.exports=o},function(t,e,n){var i,r,o,s,a,c,u,l,h=function(t,e){return function(){return t.apply(e,arguments)}},p={}.hasOwnProperty,d=function(t,e){function n(){this.constructor=t}for(var i in e)p.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};n(34),l=n(4),a=n(3),r=n(6),s=n(5),c=n(1),i=n(10),u=n(2),o=function(t){function e(t){this.load=h(this.load,this),e.__super__.constructor.call(this,t),this.init()}return d(e,t),e.prototype.init=function(){var t,e,n,o;return t=new i({size:[u.getViewportWidth(),70],properties:{overflow:"hidden"}}),this.peggerPic=new r({classes:["status__pegger__pic"],size:[50,50],properties:{borderRadius:"50px"}}),n=new s({align:[.1,0],origin:[0,0]}),t.add(n).add(this.peggerPic),this.peggerName=new a({classes:["status__pegger__name"],size:[u.getViewportWidth(),30]}),e=new s({align:[.3,.1],origin:[0,0]}),t.add(e).add(this.peggerName),this.points=new a({classes:["status__pegger__points"],size:[u.getViewportWidth(),30]}),o=new s({align:[.3,.34],origin:[0,0]}),t.add(o).add(this.points),this.add(t)},e.prototype.load=function(t){var e;return null!=t?(e=t.pegger,this.peggerPic.setContent(""+e.get("avatar_url")+"?height=50&type=normal&width=50"),this.peggerName.setContent(""+e.get("first_name")+" "+e.get("last_name")),this.points.setContent(""+t.points+" points")):void 0},e}(l),t.exports=o},function(t,e,n){var i,r,o,s,a,c,u,l,h,p,d,f,g,m,_,y={}.hasOwnProperty,v=function(t,e){function n(){this.constructor=t}for(var i in e)y.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};n(34),_=n(4),h=n(3),r=n(6),l=n(5),d=n(1),p=n(13),a=n(27),i=n(10),f=n(11),g=n(15),u=n(25),o=n(69),m=n(2),c=n(20),s=function(t){function e(t){e.__super__.constructor.call(this,t),this.init()}var n,s,p;return v(e,t),p="",s="",n=[],e.prototype.init=function(){var t,e,o,d,f,_,y,v;return this.container=new i({size:[m.getViewportWidth(),void 0]}),this.itemsScrollView=new u({direction:g.Direction.Y,paginated:!1,margin:300}),this.itemsScrollView.sequenceFrom(n),e=new l,this.container.add(e).add(this.itemsScrollView),this.container.pipe(this.itemsScrollView),t=new l({align:[.5,.5],origin:[.5,.5]}),this.add(t).add(this.container),this.picNode=new c,s=new r({classes:["status__pegg__pic"],size:[150,150],properties:{borderRadius:"200px"}}),s.pipe(this.itemsScrollView),f=new l({align:[.5,.01],origin:[.5,0]}),this.picNode.add(f).add(s),this.titleNode=new c,p=new h({classes:["status__pegg__title"],size:[m.getViewportWidth(),120],properties:{marginTop:"20px"}}),v=new l({align:[.5,0],origin:[.5,0]}),this.titleNode.add(p).add(v),this.nextNode=new c,o=new r({content:"images/continue_big_text.png",size:[60,120]}),d=new l({align:[.6,0],origin:[0,0]}),this.nextNode.add(d).add(o),this.shareNode=new c,_=new r({content:"images/share_big_text.png",size:[48,95]}),y=new l({align:[.2,0],origin:[0,1]}),this.shareNode.add(y).add(_),o.on("click",function(){return a.nextPage()})},e.prototype.load=function(t){var e,i,r,a,c;for(console.log("PeggStatusView.load.data: "+t),n.length=0,n.push(this.picNode),n.push(this.titleNode),i=t[0].peggee,p.setContent(""+i.get("first_name")+" "+i.get("last_name")+"'s <br/>Top Peggers:"),s.setContent(""+i.get("avatar_url")+"?height=150&type=normal&width=150"),a=0,c=t.length;c>a;a++)r=t[a],e=new o,e.load(r),n.push(e);return n.push(this.nextNode),n.push(this.shareNode),this.itemsScrollView.goToPage(0)},e}(_),t.exports=s},function(t,e,n){var i,r,o,s,a,c,u,l,h,p,d,f,g,m,_,y,v={}.hasOwnProperty,b=function(t,e){function n(){this.constructor=t}for(var i in e)v.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};n(34),y=n(4),p=n(3),r=n(6),h=n(5),f=n(1),d=n(13),o=n(27),i=n(10),l=n(25),g=n(11),m=n(15),a=n(156),u=n(20),s=n(26),_=n(2),c=function(t){function e(t){e.__super__.constructor.call(this,t),this.init()}return b(e,t),e.prototype._itemViews=[],e.prototype._title="",e.prototype._userPic="",e.prototype.init=function(){var t,e,n,i,s,a,c;return this.itemsScrollView=new l({direction:m.Direction.Y,paginated:!1,margin:300}),this.itemsScrollView.sequenceFrom(this._itemViews),e=new h({align:[.5,.5],origin:[.5,.5]}),this.add(e).add(this.itemsScrollView),t=new p({size:[_.getViewportWidth(),_.getViewportHeight()],transform:f.translate(null,null,-1),classes:["status__pref__bg"]}),t.pipe(this.itemsScrollView),this.add(t),this.titleNode=new u,this._title=new p({classes:["status__pref__title"],size:[_.getViewportWidth()-60,200],content:"Good choice! <br/> Here's what other people picked"}),c=new h({align:[.5,.1],origin:[.5,0]}),this.titleNode.add(c).add(this._title),this._title.pipe(this.itemsScrollView),n=new r({content:"images/continue_big_text.png",size:[60,120]}),i=new h({align:[.6,0],origin:[0,0]}),this.nextNode=new u,this.nextNode.add(i).add(n),n.pipe(this.itemsScrollView),s=new r({content:"images/share_big_text.png",size:[48,95]}),a=new h({align:[.2,0],origin:[0,1]}),this.shareNode=new u,this.shareNode.add(a).add(s),s.pipe(this.itemsScrollView),n.on("click",function(){return o.nextPage()})},e.prototype.load=function(t){var e;return this._itemViews.length=0,this._itemViews.push(this.titleNode),e=new a,e.load(t),e.pipe(this.itemsScrollView),this._itemViews.push(e),this._itemViews.push(this.nextNode),this._itemViews.push(this.shareNode),this.itemsScrollView.goToPage(0)},e}(y),t.exports=c},function(t,e,n){n(14)(n(183))},function(t,e,n){n(14)(n(186))},function(t,e,n){n(14)(n(192))},function(t,e,n){n(14)(n(194))},function(t,e,n){n(14)(n(195))},function(t,e,n){n(14)(n(196))},function(t,e,n){n(14)(n(199))},function(t){function e(){}var n=t.exports={};n.nextTick=function(){var t="undefined"!=typeof window&&window.setImmediate,e="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(t)return function(t){return window.setImmediate(t)};if(e){var n=[];return window.addEventListener("message",function(t){var e=t.source;if((e===window||null===e)&&"process-tick"===t.data&&(t.stopPropagation(),n.length>0)){var i=n.shift();i()}},!0),function(t){n.push(t),window.postMessage("process-tick","*")}}return function(t){setTimeout(t,0)}}(),n.title="browser",n.browser=!0,n.env={},n.argv=[],n.on=e,n.addListener=e,n.once=e,n.off=e,n.removeListener=e,n.removeAllListeners=e,n.emit=e,n.binding=function(){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(){throw new Error("process.chdir is not supported")}},function(){/*! @source http://purl.eligrey.com/github/classList.js/blob/master/classList.js*/
"undefined"==typeof document||"classList"in document.createElement("a")||!function(t){"use strict";var e="classList",n="prototype",i=(t.HTMLElement||t.Element)[n],r=Object,o=String[n].trim||function(){return this.replace(/^\s+|\s+$/g,"")},s=Array[n].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1},a=function(t,e){this.name=t,this.code=DOMException[t],this.message=e},c=function(t,e){if(""===e)throw new a("SYNTAX_ERR","An invalid or illegal string was specified");if(/\s/.test(e))throw new a("INVALID_CHARACTER_ERR","String contains an invalid character");return s.call(t,e)},u=function(t){for(var e=o.call(t.className),n=e?e.split(/\s+/):[],i=0,r=n.length;r>i;i++)this.push(n[i]);this._updateClassName=function(){t.className=this.toString()}},l=u[n]=[],h=function(){return new u(this)};if(a[n]=Error[n],l.item=function(t){return this[t]||null},l.contains=function(t){return t+="",-1!==c(this,t)},l.add=function(t){t+="",-1===c(this,t)&&(this.push(t),this._updateClassName())},l.remove=function(t){t+="";var e=c(this,t);-1!==e&&(this.splice(e,1),this._updateClassName())},l.toggle=function(t){t+="",-1===c(this,t)?this.add(t):this.remove(t)},l.toString=function(){return this.join(" ")},r.defineProperty){var p={get:h,enumerable:!0,configurable:!0};try{r.defineProperty(i,e,p)}catch(d){-2146823252===d.number&&(p.enumerable=!1,r.defineProperty(i,e,p))}}else r[n].__defineGetter__&&i.__defineGetter__(e,h)}(self)},function(){Function.prototype.bind||(Function.prototype.bind=function(t){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var e=Array.prototype.slice.call(arguments,1),n=this,i=function(){},r=function(){return n.apply(this instanceof i&&t?this:t,e.concat(Array.prototype.slice.call(arguments)))};return i.prototype=this.prototype,r.prototype=new i,r})},function(){window.requestAnimationFrame||(window.requestAnimationFrame=window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){return window.setTimeout(function(){t(+new Date)},1e3/60)})},function(t,e,n){var i;i=function(t,e,n){function i(t){t||(t=document.createDocumentFragment()),this.container=t,this.detachedNodes={},this.nodeCount=0}i.prototype.migrate=function(t){var e=this.container;if(t!==e){if(e instanceof DocumentFragment)t.appendChild(e);else for(;e.hasChildNodes();)t.appendChild(e.removeChild(e.firstChild));this.container=t}},i.prototype.allocate=function(t){t=t.toLowerCase(),t in this.detachedNodes||(this.detachedNodes[t]=[]);var e,n=this.detachedNodes[t];return n.length>0?e=n.pop():(e=document.createElement(t),this.container.appendChild(e)),this.nodeCount++,e},i.prototype.deallocate=function(t){var e=t.nodeName.toLowerCase(),n=this.detachedNodes[e];n.push(t),this.nodeCount--},i.prototype.getNodeCount=function(){return this.nodeCount},n.exports=i}.call(e,n,e,t),/* This Source Code Form is subject to the terms of the Mozilla Public
	 * License, v. 2.0. If a copy of the MPL was not distributed with this
	 * file, You can obtain one at http://mozilla.org/MPL/2.0/.
	 *
	 * Owner: mark@famo.us
	 * @license MPL 2.0
	 * @copyright Famous Industries, Inc. 2014
	 */
!(void 0!==i&&(t.exports=i))},function(t,e,n){var i;i=function(t,e,i){function r(t){this._matrix=null,this._opacity=1,this._origin=null,this._size=null,this._eventOutput=new h,this._eventOutput.bindThis(this),this.eventForwarder=function(t){this._eventOutput.emit(t.type,t)}.bind(this),this.id=l.register(this),this._element=null,this._sizeDirty=!1,this._originDirty=!1,this._transformDirty=!1,this._invisible=!1,t&&this.attach(t)}function o(t){for(var e in this._eventOutput.listeners)t.addEventListener(e,this.eventForwarder)}function s(t){for(var e in this._eventOutput.listeners)t.removeEventListener(e,this.eventForwarder)}function a(t){t[12]=Math.round(t[12]*f)/f,t[13]=Math.round(t[13]*f)/f;for(var e="matrix3d(",n=0;15>n;n++)e+=t[n]<1e-6&&t[n]>-1e-6?"0,":t[n]+",";return e+=t[15]+")"}function c(t){return 100*t[0]+"% "+100*t[1]+"%"}function u(t,e){return t&&e?t[0]!==e[0]||t[1]!==e[1]:t!==e}var l=n(36),h=n(12),p=n(1),d=!("transform"in document.documentElement.style),f=window.devicePixelRatio||1;r.prototype.on=function(t,e){this._element&&this._element.addEventListener(t,this.eventForwarder),this._eventOutput.on(t,e)},r.prototype.removeListener=function(t,e){this._eventOutput.removeListener(t,e)},r.prototype.emit=function(t,e){e&&!e.origin&&(e.origin=this);var n=this._eventOutput.emit(t,e);return n&&e&&e.stopPropagation&&e.stopPropagation(),n},r.prototype.pipe=function(t){return this._eventOutput.pipe(t)},r.prototype.unpipe=function(t){return this._eventOutput.unpipe(t)},r.prototype.render=function(){return this.id};var g;g=navigator.userAgent.toLowerCase().indexOf("firefox")>-1?function(t,e){t.style.zIndex=1e6*e[14]|0,t.style.transform=a(e)}:d?function(t,e){t.style.webkitTransform=a(e)}:function(t,e){t.style.transform=a(e)};var m=d?function(t,e){t.style.webkitTransformOrigin=c(e)}:function(t,e){t.style.transformOrigin=c(e)},_=d?function(t){t.style.webkitTransform="scale3d(0.0001,0.0001,0.0001)",t.style.opacity=0}:function(t){t.style.transform="scale3d(0.0001,0.0001,0.0001)",t.style.opacity=0};r.prototype.commit=function(t){var e=this._element;if(e){{var n=t.transform,i=t.opacity,r=t.origin;t.size}if(!n&&this._matrix)return this._matrix=null,this._opacity=0,void _(e);if(u(this._origin,r)&&(this._originDirty=!0),p.notEquals(this._matrix,n)&&(this._transformDirty=!0),this._invisible&&(this._invisible=!1,this._element.style.display=""),this._opacity!==i&&(this._opacity=i,e.style.opacity=i>=1?"0.999999":i),this._transformDirty||this._originDirty||this._sizeDirty){this._sizeDirty&&(this._sizeDirty=!1),this._originDirty&&(r?(this._origin||(this._origin=[0,0]),this._origin[0]=r[0],this._origin[1]=r[1]):this._origin=null,m(e,this._origin),this._originDirty=!1),n||(n=p.identity),this._matrix=n;var o=this._size?p.thenMove(n,[-this._size[0]*r[0],-this._size[1]*r[1],0]):n;g(e,o),this._transformDirty=!1}}},r.prototype.cleanup=function(){this._element&&(this._invisible=!0,this._element.style.display="none")},r.prototype.attach=function(t){this._element=t,o.call(this,t)},r.prototype.detach=function(){var t=this._element;return t&&(s.call(this,t),this._invisible&&(this._invisible=!1,this._element.style.display="")),this._element=null,t},i.exports=r}.call(e,n,e,t),/* This Source Code Form is subject to the terms of the Mozilla Public
	 * License, v. 2.0. If a copy of the MPL was not distributed with this
	 * file, You can obtain one at http://mozilla.org/MPL/2.0/.
	 *
	 * Owner: mark@famo.us
	 * @license MPL 2.0
	 * @copyright Famous Industries, Inc. 2014
	 */
!(void 0!==i&&(t.exports=i))},function(t,e,n){var i;i=function(t,e,i){function r(t){a.call(this,t),this._shouldRecalculateSize=!1,this._container=document.createDocumentFragment(),this.context=new o(this._container),this.setContent(this._container),this._groupSize=[void 0,void 0]}var o=n(48),s=n(1),a=n(3);r.SIZE_ZERO=[0,0],r.prototype=Object.create(a.prototype),r.prototype.elementType="div",r.prototype.elementClass="famous-group",r.prototype.add=function(){return this.context.add.apply(this.context,arguments)},r.prototype.render=function(){return a.prototype.render.call(this)},r.prototype.deploy=function(t){this.context.migrate(t)},r.prototype.recall=function(){this._container=document.createDocumentFragment(),this.context.migrate(this._container)},r.prototype.commit=function(t){var e=t.transform,n=t.origin,i=t.opacity,o=t.size,c=a.prototype.commit.call(this,{allocator:t.allocator,transform:s.thenMove(e,[-n[0]*o[0],-n[1]*o[1],0]),opacity:i,origin:n,size:r.SIZE_ZERO});return(o[0]!==this._groupSize[0]||o[1]!==this._groupSize[1])&&(this._groupSize[0]=o[0],this._groupSize[1]=o[1],this.context.setSize(o)),this.context.update({transform:s.translate(-n[0]*o[0],-n[1]*o[1],0),origin:n,size:o}),c},i.exports=r}.call(e,n,e,t),/* This Source Code Form is subject to the terms of the Mozilla Public
	 * License, v. 2.0. If a copy of the MPL was not distributed with this
	 * file, You can obtain one at http://mozilla.org/MPL/2.0/.
	 *
	 * Owner: mark@famo.us
	 * @license MPL 2.0
	 * @copyright Famous Industries, Inc. 2014
	 */
!(void 0!==i&&(t.exports=i))},function(t,e,n){var i;i=function(t,e,i){function r(){this.result={}}function o(t,e){return[t[0]*e[0]+t[1]*e[4]+t[2]*e[8],t[0]*e[1]+t[1]*e[5]+t[2]*e[9],t[0]*e[2]+t[1]*e[6]+t[2]*e[10]]}var s=n(1);r._instance=new r,r.parse=function(t,e){return r._instance.parse(t,e)},r.prototype.parse=function(t,e){return this.reset(),this._parseSpec(t,e,s.identity),this.result},r.prototype.reset=function(){this.result={}};var a=[0,0];r.prototype._parseSpec=function(t,e,n){var i,r,c,u,l,h,p;if("number"==typeof t){if(i=t,c=e.transform,h=e.align||a,e.size&&h&&(h[0]||h[1])){var d=[h[0]*e.size[0],h[1]*e.size[1],0];c=s.thenMove(c,o(d,n))}this.result[i]={transform:c,opacity:e.opacity,origin:e.origin||a,align:e.align||a,size:e.size}}else{if(!t)return;if(t instanceof Array)for(var f=0;f<t.length;f++)this._parseSpec(t[f],e,n);else{r=t.target,c=e.transform,u=e.opacity,l=e.origin,h=e.align,p=e.size;var g=n;if(void 0!==t.opacity&&(u=e.opacity*t.opacity),t.transform&&(c=s.multiply(e.transform,t.transform)),t.origin&&(l=t.origin,g=e.transform),t.align&&(h=t.align),t.size||t.proportions){var m=p;p=[p[0],p[1]],t.size&&(void 0!==t.size[0]&&(p[0]=t.size[0]),void 0!==t.size[1]&&(p[1]=t.size[1])),t.proportions&&(void 0!==t.proportions[0]&&(p[0]=p[0]*t.proportions[0]),void 0!==t.proportions[1]&&(p[1]=p[1]*t.proportions[1])),m&&(h&&(h[0]||h[1])&&(c=s.thenMove(c,o([h[0]*m[0],h[1]*m[1],0],n))),l&&(l[0]||l[1])&&(c=s.moveThen([-l[0]*p[0],-l[1]*p[1],0],c))),g=e.transform,l=null,h=null}this._parseSpec(r,{transform:c,opacity:u,origin:l,align:h,size:p},g)}}},i.exports=r}.call(e,n,e,t),/* This Source Code Form is subject to the terms of the Mozilla Public
	 * License, v. 2.0. If a copy of the MPL was not distributed with this
	 * file, You can obtain one at http://mozilla.org/MPL/2.0/.
	 *
	 * Owner: mark@famo.us
	 * @license MPL 2.0
	 * @copyright Famous Industries, Inc. 2014
	 */
!(void 0!==i&&(t.exports=i))},function(t,e,n){var i;i=function(t,e,i){function r(t){this.options=Object.create(r.DEFAULT_OPTIONS),this._optionsManager=new u(this.options),t&&this.setOptions(t),this._payload={delta:null,position:null,velocity:null,slip:!0},this._eventInput=new a,this._eventOutput=new a,a.setInputHandler(this,this._eventInput),a.setOutputHandler(this,this._eventOutput),this._position=void 0===this.options.direction?[0,0]:0,this._prevTime=void 0,this._prevVel=void 0,this._eventInput.on("mousewheel",s.bind(this)),this._eventInput.on("wheel",s.bind(this)),this._inProgress=!1,this._loopBound=!1}function o(){if(this._inProgress&&h()-this._prevTime>this.options.stallTime){this._inProgress=!1;var t=Math.abs(this._prevVel)>=this.options.minimumEndSpeed?this._prevVel:0,e=this._payload;e.position=this._position,e.velocity=t,e.slip=!0,this._eventOutput.emit("end",e)}}function s(t){this.options.preventDefault&&t.preventDefault(),this._inProgress||(this._inProgress=!0,this._position=void 0===this.options.direction?[0,0]:0,m=this._payload,m.slip=!0,m.position=this._position,m.clientX=t.clientX,m.clientY=t.clientY,m.offsetX=t.offsetX,m.offsetY=t.offsetY,this._eventOutput.emit("start",m),this._loopBound||(c.on("prerender",o.bind(this)),this._loopBound=!0));var e=h(),n=this._prevTime||e,i=void 0!==t.wheelDeltaX?t.wheelDeltaX:-t.deltaX,s=void 0!==t.wheelDeltaY?t.wheelDeltaY:-t.deltaY;1===t.deltaMode&&(i*=this.options.lineHeight,s*=this.options.lineHeight),this.options.rails&&(Math.abs(i)>Math.abs(s)?s=0:i=0);var a,u,p=Math.max(e-n,l),d=i/p,f=s/p,g=this.options.scale;this.options.direction===r.DIRECTION_X?(u=g*i,a=g*d,this._position+=u):this.options.direction===r.DIRECTION_Y?(u=g*s,a=g*f,this._position+=u):(u=[g*i,g*s],a=[g*d,g*f],this._position[0]+=u[0],this._position[1]+=u[1]);var m=this._payload;m.delta=u,m.velocity=a,m.position=this._position,m.slip=!0,this._eventOutput.emit("update",m),this._prevTime=e,this._prevVel=a}var a=n(12),c=n(35),u=n(19);r.DEFAULT_OPTIONS={direction:void 0,minimumEndSpeed:1/0,rails:!1,scale:1,stallTime:50,lineHeight:40,preventDefault:!0},r.DIRECTION_X=0,r.DIRECTION_Y=1;var l=8,h=Date.now;r.prototype.getOptions=function(){return this.options},r.prototype.setOptions=function(t){return this._optionsManager.setOptions(t)},i.exports=r}.call(e,n,e,t),/* This Source Code Form is subject to the terms of the Mozilla Public
	 * License, v. 2.0. If a copy of the MPL was not distributed with this
	 * file, You can obtain one at http://mozilla.org/MPL/2.0/.
	 *
	 * Owner: mark@famo.us
	 * @license MPL 2.0
	 * @copyright Famous Industries, Inc. 2014
	 */
!(void 0!==i&&(t.exports=i))},function(t,e,n){var i;i=function(t,e,i){function r(t,e,n){return{x:t.clientX,y:t.clientY,identifier:t.identifier,origin:e.origin,timestamp:h(),count:e.touches.length,history:n}}function o(t){if(!(t.touches.length>this.touchLimit)){this.isTouched=!0;for(var e=0;e<t.changedTouches.length;e++){var n=t.changedTouches[e],i=r(n,t,null);this.eventOutput.emit("trackstart",i),this.selective||this.touchHistory[n.identifier]||this.track(i)}}}function s(t){if(!(t.touches.length>this.touchLimit))for(var e=0;e<t.changedTouches.length;e++){var n=t.changedTouches[e],i=this.touchHistory[n.identifier];if(i){var o=r(n,t,i);this.touchHistory[n.identifier].push(o),this.eventOutput.emit("trackmove",o)}}}function a(t){if(this.isTouched){for(var e=0;e<t.changedTouches.length;e++){var n=t.changedTouches[e],i=this.touchHistory[n.identifier];if(i){var o=r(n,t,i);this.eventOutput.emit("trackend",o),delete this.touchHistory[n.identifier]}}this.isTouched=!1}}function c(){for(var t in this.touchHistory){var e=this.touchHistory[t];this.eventOutput.emit("trackend",{touch:e[e.length-1].touch,timestamp:Date.now(),count:0,history:e}),delete this.touchHistory[t]}}function u(t){this.selective=t.selective,this.touchLimit=t.touchLimit||1,this.touchHistory={},this.eventInput=new l,this.eventOutput=new l,l.setInputHandler(this,this.eventInput),l.setOutputHandler(this,this.eventOutput),this.eventInput.on("touchstart",o.bind(this)),this.eventInput.on("touchmove",s.bind(this)),this.eventInput.on("touchend",a.bind(this)),this.eventInput.on("touchcancel",a.bind(this)),this.eventInput.on("unpipe",c.bind(this)),this.isTouched=!1}var l=n(12),h=Date.now;u.prototype.track=function(t){this.touchHistory[t.identifier]=[t]},i.exports=u}.call(e,n,e,t),/* This Source Code Form is subject to the terms of the Mozilla Public
	 * License, v. 2.0. If a copy of the MPL was not distributed with this
	 * file, You can obtain one at http://mozilla.org/MPL/2.0/.
	 *
	 * Owner: mark@famo.us
	 * @license MPL 2.0
	 * @copyright Famous Industries, Inc. 2014
	 */
!(void 0!==i&&(t.exports=i))},function(t,e,n){var i;i=function(t,e,i){function r(t){this.options=Object.create(this.constructor.DEFAULT_OPTIONS),t&&this.setOptions(t),o.call(this)}var o=n(56);r.prototype=Object.create(o.prototype),r.prototype.constructor=r,r.FORCE_FUNCTIONS={LINEAR:function(t){return t},QUADRATIC:function(t){return t.mult(t.norm())}},r.DEFAULT_OPTIONS={strength:.01,forceFunction:r.FORCE_FUNCTIONS.LINEAR},r.prototype.applyForce=function(t){var e,n,i=this.options.strength,r=this.options.forceFunction,o=this.force;for(e=0;e<t.length;e++)n=t[e],r(n.velocity).mult(-i).put(o),n.applyForce(o)},r.prototype.setOptions=function(t){for(var e in t)this.options[e]=t[e]},i.exports=r}.call(e,n,e,t),/* This Source Code Form is subject to the terms of the Mozilla Public
	 * License, v. 2.0. If a copy of the MPL was not distributed with this
	 * file, You can obtain one at http://mozilla.org/MPL/2.0/.
	 *
	 * Owner: david@famo.us
	 * @license MPL 2.0
	 * @copyright Famous Industries, Inc. 2014
	 */
!(void 0!==i&&(t.exports=i))},function(t,e,n){var i;i=function(t,e,n){var i={};i.integrateVelocity=function(t,e){var n=t.velocity,i=t.inverseMass,r=t.force;r.isZero()||(n.add(r.mult(e*i)).put(n),r.clear())},i.integratePosition=function(t,e){var n=t.position,i=t.velocity;n.add(i.mult(e)).put(n)},i.integrateAngularMomentum=function(t,e){var n=t.angularMomentum,i=t.torque;i.isZero()||(n.add(i.mult(e)).put(n),i.clear())},i.integrateOrientation=function(t,e){var n=t.orientation,i=t.angularVelocity;i.isZero()||n.add(n.multiply(i).scalarMultiply(.5*e)).put(n)},n.exports=i}.call(e,n,e,t),/* This Source Code Form is subject to the terms of the Mozilla Public
	 * License, v. 2.0. If a copy of the MPL was not distributed with this
	 * file, You can obtain one at http://mozilla.org/MPL/2.0/.
	 *
	 * Owner: david@famo.us
	 * @license MPL 2.0
	 * @copyright Famous Industries, Inc. 2014
	 */
!(void 0!==i&&(t.exports=i))},function(t,e,n){var i;i=function(t,e,i){function r(t){this.method=t,this._instances=[],this.state=[]}var o=n(15);r.SUPPORTS_MULTIPLE=!0,r.prototype.get=function(){for(var t=0;t<this._instances.length;t++)this.state[t]=this._instances[t].get();return this.state},r.prototype.set=function(t,e,n){for(var i=o.after(t.length,n),r=0;r<t.length;r++)this._instances[r]||(this._instances[r]=new this.method),this._instances[r].set(t[r],e,i)},r.prototype.reset=function(t){for(var e=0;e<t.length;e++)this._instances[e]||(this._instances[e]=new this.method),this._instances[e].reset(t[e])},i.exports=r}.call(e,n,e,t),/* This Source Code Form is subject to the terms of the Mozilla Public
	 * License, v. 2.0. If a copy of the MPL was not distributed with this
	 * file, You can obtain one at http://mozilla.org/MPL/2.0/.
	 *
	 * Owner: david@famo.us
	 * @license MPL 2.0
	 * @copyright Famous Industries, Inc. 2014
	 */
!(void 0!==i&&(t.exports=i))},function(t,e,n){var i;i=function(t,e,i){function r(t){t=t||0,this.endState=new b(t),this.initState=new b,this._dimensions=void 0,this._restTolerance=1e-10,this._absRestTolerance=this._restTolerance,this._callback=void 0,this.PE=new _,this.spring=new v({anchor:this.endState}),this.particle=new y,this.PE.addBody(this.particle),this.PE.attach(this.spring,this.particle)}function o(){return this.particle.getEnergy()+this.spring.getEnergy([this.particle])}function s(t){this.particle.setPosition(t)}function a(t){this.particle.setVelocity(t)}function c(){return 0===this._dimensions?this.particle.getPosition1D():this.particle.getPosition()}function u(){return 0===this._dimensions?this.particle.getVelocity1D():this.particle.getVelocity()}function l(t){this._callback=t}function h(){this.PE.wake()}function p(){this.PE.sleep()}function d(){if(this.PE.isSleeping()){if(this._callback){var t=this._callback;this._callback=void 0,t()}}else o.call(this)<this._absRestTolerance&&(s.call(this,this.endState),a.call(this,[0,0,0]),p.call(this))}function f(t){var e=r.DEFAULT_OPTIONS;void 0===t.period&&(t.period=e.period),void 0===t.dampingRatio&&(t.dampingRatio=e.dampingRatio),void 0===t.velocity&&(t.velocity=e.velocity),t.period<150&&(t.period=150,console.warn("The period of a SpringTransition is capped at 150 ms. Use a SnapTransition for faster transitions")),this.spring.setOptions({period:t.period,dampingRatio:t.dampingRatio}),a.call(this,t.velocity)}function g(){var t=this.endState.sub(this.initState).normSquared();this._absRestTolerance=0===t?this._restTolerance:this._restTolerance*t}function m(t){this.endState.set(t),g.call(this)}var _=n(54),y=n(55),v=n(57),b=n(42);r.SUPPORTS_MULTIPLE=3,r.DEFAULT_OPTIONS={period:300,dampingRatio:.5,velocity:0},r.prototype.reset=function(t,e){this._dimensions=t instanceof Array?t.length:0,this.initState.set(t),s.call(this,t),m.call(this,t),e&&a.call(this,e),l.call(this,void 0)},r.prototype.getVelocity=function(){return u.call(this)},r.prototype.setVelocity=function(t){this.call(this,a(t))},r.prototype.isActive=function(){return!this.PE.isSleeping()},r.prototype.halt=function(){this.set(this.get())},r.prototype.get=function(){return d.call(this),c.call(this)},r.prototype.set=function(t,e,n){return e?(this._dimensions=t instanceof Array?t.length:0,h.call(this),f.call(this,e),m.call(this,t),void l.call(this,n)):(this.reset(t),void(n&&n()))},i.exports=r}.call(e,n,e,t),/* This Source Code Form is subject to the terms of the Mozilla Public
	 * License, v. 2.0. If a copy of the MPL was not distributed with this
	 * file, You can obtain one at http://mozilla.org/MPL/2.0/.
	 *
	 * Owner: david@famo.us
	 * @license MPL 2.0
	 * @copyright Famous Industries, Inc. 2014
	 */
!(void 0!==i&&(t.exports=i))},function(t,e,n){var i;i=function(t,e,n){function i(t){this.options=Object.create(i.DEFAULT_OPTIONS),t&&this.setOptions(t),this._startTime=0,this._startValue=0,this._updateTime=0,this._endValue=0,this._curve=void 0,this._duration=0,this._active=!1,this._callback=void 0,this.state=0,this.velocity=void 0}function r(t,e,n){return(1-n)*t+n*e}function o(t){return t instanceof Object?t instanceof Array?t.slice(0):Object.create(t):t}function s(t,e){var n={curve:e.curve};return e.duration&&(n.duration=e.duration),e.speed&&(n.speed=e.speed),t instanceof Object&&(void 0!==t.duration&&(n.duration=t.duration),t.curve&&(n.curve=t.curve),t.speed&&(n.speed=t.speed)),"string"==typeof n.curve&&(n.curve=i.getCurve(n.curve)),n}function a(t,e,n,i,r){var o,s=1e-7,a=(n(r)-n(r-s))/s;if(t instanceof Array){o=[];for(var c=0;c<t.length;c++)o[c]="number"==typeof t[c]?a*(t[c]-e[c])/i:0}else o=a*(t-e)/i;return o}function c(t,e,n){var i;if(t instanceof Array){i=[];for(var o=0;o<t.length;o++)i[o]="number"==typeof t[o]?r(t[o],e[o],n):t[o]}else i=r(t,e,n);return i}i.Curves={linear:function(t){return t},easeIn:function(t){return t*t},easeOut:function(t){return t*(2-t)},easeInOut:function(t){return.5>=t?2*t*t:-2*t*t+4*t-1},easeOutBounce:function(t){return t*(3-2*t)},spring:function(t){return(1-t)*Math.sin(6*Math.PI*t)+t}},i.SUPPORTS_MULTIPLE=!0,i.DEFAULT_OPTIONS={curve:i.Curves.linear,duration:500,speed:0};var u={};i.registerCurve=function(t,e){return u[t]?!1:(u[t]=e,!0)},i.unregisterCurve=function(t){return u[t]?(delete u[t],!0):!1},i.getCurve=function(t){var e=u[t];if(void 0!==e)return e;throw new Error("curve not registered")},i.getCurves=function(){return u},i.prototype.setOptions=function(t){void 0!==t.curve&&(this.options.curve=t.curve),void 0!==t.duration&&(this.options.duration=t.duration),void 0!==t.speed&&(this.options.speed=t.speed)},i.prototype.set=function(t,e,n){if(!e)return this.reset(t),void(n&&n());if(this._startValue=o(this.get()),e=s(e,this.options),e.speed){var i=this._startValue;if(i instanceof Object){var r=0;for(var a in i)r+=(t[a]-i[a])*(t[a]-i[a]);e.duration=Math.sqrt(r)/e.speed}else e.duration=Math.abs(t-i)/e.speed}this._startTime=Date.now(),this._endValue=o(t),this._startVelocity=o(e.velocity),this._duration=e.duration,this._curve=e.curve,this._active=!0,this._callback=n},i.prototype.reset=function(t,e){if(this._callback){var n=this._callback;this._callback=void 0,n()}this.state=o(t),this.velocity=o(e),this._startTime=0,this._duration=0,this._updateTime=0,this._startValue=this.state,this._startVelocity=this.velocity,this._endValue=this.state,this._active=!1},i.prototype.getVelocity=function(){return this.velocity},i.prototype.get=function(t){return this.update(t),this.state},i.prototype.update=function(t){if(this._active){if(t||(t=Date.now()),!(this._updateTime>=t)){this._updateTime=t;var e=t-this._startTime;if(e>=this._duration)this.state=this._endValue,this.velocity=a(this.state,this._startValue,this._curve,this._duration,1),this._active=!1;else if(0>e)this.state=this._startValue,this.velocity=this._startVelocity;else{var n=e/this._duration;this.state=c(this._startValue,this._endValue,this._curve(n)),this.velocity=a(this.state,this._startValue,this._curve,this._duration,n)}}}else if(this._callback){var i=this._callback;this._callback=void 0,i()}},i.prototype.isActive=function(){return this._active},i.prototype.halt=function(){this.reset(this.get())},i.registerCurve("linear",i.Curves.linear),i.registerCurve("easeIn",i.Curves.easeIn),i.registerCurve("easeOut",i.Curves.easeOut),i.registerCurve("easeInOut",i.Curves.easeInOut),i.registerCurve("easeOutBounce",i.Curves.easeOutBounce),i.registerCurve("spring",i.Curves.spring),i.customCurve=function(t,e){return t=t||0,e=e||0,function(n){return t*n+(-2*t-e+3)*n*n+(t+e-2)*n*n*n}},n.exports=i}.call(e,n,e,t),/* This Source Code Form is subject to the terms of the Mozilla Public
	 * License, v. 2.0. If a copy of the MPL was not distributed with this
	 * file, You can obtain one at http://mozilla.org/MPL/2.0/.
	 *
	 * Owner: david@famo.us
	 * @license MPL 2.0
	 * @copyright Famous Industries, Inc. 2014
	 */
!(void 0!==i&&(t.exports=i))},function(t,e,n){var i;i=function(t,e,i){function r(t){this.options=Object.create(r.DEFAULT_OPTIONS),this._optionsManager=new a(this.options),t&&this.setOptions(t),this.angle=new s(0),this.frontNode=void 0,this.backNode=void 0,this.flipped=!1}var o=n(1),s=n(21),a=(n(20),n(19));r.DIRECTION_X=0,r.DIRECTION_Y=1;var c=1;r.DEFAULT_OPTIONS={transition:!0,direction:r.DIRECTION_X},r.prototype.flip=function(t,e){var n=this.flipped?0:Math.PI;this.setAngle(n,t,e),this.flipped=!this.flipped},r.prototype.setAngle=function(t,e,n){void 0===e&&(e=this.options.transition),this.angle.isActive()&&this.angle.halt(),this.angle.set(t,e,n)},r.prototype.setOptions=function(t){return this._optionsManager.setOptions(t)},r.prototype.setFront=function(t){this.frontNode=t},r.prototype.setBack=function(t){this.backNode=t},r.prototype.render=function(){var t,e,n=this.angle.get();this.options.direction===r.DIRECTION_X?(t=o.rotateY(n),e=o.rotateY(n+Math.PI)):(t=o.rotateX(n),e=o.rotateX(n+Math.PI));var i=[];return this.frontNode&&i.push({transform:t,target:this.frontNode.render()}),this.backNode&&i.push({transform:o.moveThen([0,0,c],e),target:this.backNode.render()}),i},i.exports=r}.call(e,n,e,t),/* This Source Code Form is subject to the terms of the Mozilla Public
	 * License, v. 2.0. If a copy of the MPL was not distributed with this
	 * file, You can obtain one at http://mozilla.org/MPL/2.0/.
	 *
	 * Owner: felix@famo.us
	 * @license MPL 2.0
	 * @copyright Famous Industries, Inc. 2014
	 */
!(void 0!==i&&(t.exports=i))},function(t,e,n){var i;i=function(t,e,i){function r(t){this.options=Object.create(r.DEFAULT_OPTIONS),this._optionsManager=new h(this.options),t&&this.setOptions(t),this._entityId=c.register(this),this.header=new u,this.footer=new u,this.content=new u}function o(t,e){var n=t.getSize();return n?n[this.options.direction]:e}function s(t){return this.options.direction===r.DIRECTION_X?l.translate(t,0,0):l.translate(0,t,0)}function a(t,e){return this.options.direction===r.DIRECTION_X?[t,e[1]]:[e[0],t]}var c=n(36),u=n(20),l=n(1),h=n(19);r.DIRECTION_X=0,r.DIRECTION_Y=1,r.DEFAULT_OPTIONS={direction:r.DIRECTION_Y,headerSize:void 0,footerSize:void 0,defaultHeaderSize:0,defaultFooterSize:0},r.prototype.render=function(){return this._entityId},r.prototype.setOptions=function(t){return this._optionsManager.setOptions(t)},r.prototype.commit=function(t){var e=t.transform,n=t.origin,i=t.size,r=t.opacity,c=void 0!==this.options.headerSize?this.options.headerSize:o.call(this,this.header,this.options.defaultHeaderSize),u=void 0!==this.options.footerSize?this.options.footerSize:o.call(this,this.footer,this.options.defaultFooterSize),h=i[this.options.direction]-c-u;i&&(e=l.moveThen([-i[0]*n[0],-i[1]*n[1],0],e));var p=[{size:a.call(this,c,i),target:this.header.render()},{transform:s.call(this,c),size:a.call(this,h,i),target:this.content.render()},{transform:s.call(this,c+h),size:a.call(this,u,i),target:this.footer.render()}];return{transform:e,opacity:r,size:i,target:p}},i.exports=r}.call(e,n,e,t),/* This Source Code Form is subject to the terms of the Mozilla Public
	 * License, v. 2.0. If a copy of the MPL was not distributed with this
	 * file, You can obtain one at http://mozilla.org/MPL/2.0/.
	 *
	 * Owner: felix@famo.us
	 * @license MPL 2.0
	 * @copyright Famous Industries, Inc. 2014
	 */
!(void 0!==i&&(t.exports=i))},function(t,e,n){var i;i=function(t,e,i){function r(t){this.options=Object.create(r.DEFAULT_OPTIONS),this._optionsManager=new c(this.options),t&&this.setOptions(t),this.container=new o(this.options.container),this.scrollview=new a(this.options.scrollview),this.container.add(this.scrollview),this._eventInput=new s,s.setInputHandler(this,this._eventInput),this._eventInput.pipe(this.scrollview),this._eventOutput=new s,s.setOutputHandler(this,this._eventOutput),this.container.pipe(this._eventOutput),this.scrollview.pipe(this._eventOutput)}var o=n(10),s=n(12),a=n(25),c=(n(15),n(19));r.DEFAULT_OPTIONS={container:{properties:{overflow:"hidden"}},scrollview:{}},r.prototype.setOptions=function(t){return this._optionsManager.setOptions(t)},r.prototype.sequenceFrom=function(){return this.scrollview.sequenceFrom.apply(this.scrollview,arguments)},r.prototype.getSize=function(){return this.container.getSize.apply(this.container,arguments)},r.prototype.render=function(){return this.container.render()},i.exports=r}.call(e,n,e,t),/* This Source Code Form is subject to the terms of the Mozilla Public
	 * License, v. 2.0. If a copy of the MPL was not distributed with this
	 * file, You can obtain one at http://mozilla.org/MPL/2.0/.
	 *
	 * Owner: felix@famo.us
	 * @license MPL 2.0
	 * @copyright Famous Industries, Inc. 2014
	 */
!(void 0!==i&&(t.exports=i))},function(t,e,n){var i;i=function(t,e,i){function r(t){this.options=Object.create(this.constructor.DEFAULT_OPTIONS),this._optionsManager=new h(this.options),t&&this._optionsManager.setOptions(t),this._node=null,this._position=0,this._positionOffset=0,this._positionGetter=null,this._outputFunction=null,this._masterOutputFunction=null,this.outputFrom(),this._onEdge=0,this.group=new l,this.group.add({render:c.bind(this)}),this._entityId=u.register(this),this._size=[void 0,void 0],this._contextSize=[void 0,void 0],this._eventInput=new g,this._eventOutput=new g,g.setInputHandler(this,this._eventInput),g.setOutputHandler(this,this._eventOutput)}function o(t){t||(t=this._contextSize);var e=this.options.direction;return void 0===t[e]?this._contextSize[e]:t[e]}function s(t,e,n){var i=t.getSize?t.getSize():this._contextSize,r=this._outputFunction(e);return n.push({transform:r,target:t.render()}),o.call(this,i)}function a(){return void 0!==this.options.clipSize?this.options.clipSize:this._contextSize[this.options.direction]>this.getCumulativeSize()[this.options.direction]?o.call(this,this.getCumulativeSize()):o.call(this,this._contextSize)}function c(){for(var t=null,e=this._position,n=[],i=-this._positionOffset,r=a.call(this),c=this._node;c&&i-e<r+this.options.margin;)i+=s.call(this,c,i,n),c=c.getNext?c.getNext():null;var u=this._node,l=o.call(this,u.getSize());if(r>i){for(;u&&r>l;)u=u.getPrevious(),u&&(l+=o.call(this,u.getSize()));for(u=this._node;u&&r>l;)u=u.getNext(),u&&(l+=o.call(this,u.getSize()))}for(!c&&r-m>i-e?1!==this._onEdge&&(this._onEdge=1,this._eventOutput.emit("onEdge",{position:i-r})):!this._node.getPrevious()&&-m>e?-1!==this._onEdge&&(this._onEdge=-1,this._eventOutput.emit("onEdge",{position:0})):0!==this._onEdge&&(this._onEdge=0,this._eventOutput.emit("offEdge")),c=this._node&&this._node.getPrevious?this._node.getPrevious():null,i=-this._positionOffset,c&&(t=c.getSize?c.getSize():this._contextSize,i-=o.call(this,t));c&&i-e>-(r+this.options.margin);)s.call(this,c,i,n),c=c.getPrevious?c.getPrevious():null,c&&(t=c.getSize?c.getSize():this._contextSize,i-=o.call(this,t));return n}var u=n(36),l=n(85),h=n(19),p=n(1),d=n(15),f=n(39),g=n(12);r.DEFAULT_OPTIONS={direction:d.Direction.Y,margin:0,clipSize:void 0,groupScroll:!1};var m=0;r.prototype.getCumulativeSize=function(t){return void 0===t&&(t=this._node._.cumulativeSizes.length-1),this._node._.getSize(t)},r.prototype.setOptions=function(t){t.groupScroll!==this.options.groupScroll&&(t.groupScroll?this.group.pipe(this._eventOutput):this.group.unpipe(this._eventOutput)),this._optionsManager.setOptions(t)},r.prototype.onEdge=function(){return this._onEdge},r.prototype.outputFrom=function(t,e){t||(t=function(t){return this.options.direction===d.Direction.X?p.translate(t,0):p.translate(0,t)}.bind(this),e||(e=t)),this._outputFunction=t,this._masterOutputFunction=e?e:function(e){return p.inverse(t(-e))}},r.prototype.positionFrom=function(t){t instanceof Function?this._positionGetter=t:t&&t.get?this._positionGetter=t.get.bind(t):(this._positionGetter=null,this._position=t),this._positionGetter&&(this._position=this._positionGetter.call(this))},r.prototype.sequenceFrom=function(t){t instanceof Array&&(t=new f({array:t})),this._node=t,this._positionOffset=0},r.prototype.getSize=function(t){return t?this._contextSize:this._size},r.prototype.render=function(){return this._node?(this._positionGetter&&(this._position=this._positionGetter.call(this)),this._entityId):null},r.prototype.commit=function(t){var e=t.transform,n=t.opacity,i=t.origin,r=t.size;this.options.clipSize||r[0]===this._contextSize[0]&&r[1]===this._contextSize[1]||(this._onEdge=0,this._contextSize[0]=r[0],this._contextSize[1]=r[1],this.options.direction===d.Direction.X?(this._size[0]=a.call(this),this._size[1]=void 0):(this._size[0]=void 0,this._size[1]=a.call(this)));var o=this._masterOutputFunction(-this._position);return{transform:p.multiply(e,o),size:r,opacity:n,origin:i,target:this.group.render()}},i.exports=r}.call(e,n,e,t),!(void 0!==i&&(t.exports=i))},function(t,e,n){"use strict";t.exports=function(t,e,i){function r(t,n){var i=e(t,o,n===!0&&t._isBound()?t._boundTo:void 0),r=i.promise();return r.isRejected()?r:(i.setHowMany(1),i.setUnwrap(),i.init(),r)}var o=n(61)(i);t.any=function(t){return r(t,!1)},t.prototype.any=function(){return r(this,!0)}}},function(t,e,n){"use strict";var i=n(111)();t.exports=i},function(t){"use strict";t.exports=function(t){function e(t){var e="string"==typeof this?this:""+this;return t[e]}t.prototype.call=function(t){for(var e=arguments.length,n=new Array(e-1),i=1;e>i;++i)n[i-1]=arguments[i];return this._then(function(e){return e[t].apply(e,n)},void 0,void 0,void 0,void 0)},t.prototype.get=function(t){return this._then(e,void 0,void 0,t,void 0)}}},function(t,e,n){"use strict";t.exports=function(t,e){var i=n(17),r=n(31),o=i.CancellationError;t.prototype._cancel=function(){if(!this.isCancellable())return this;for(var t,e=this;void 0!==(t=e._cancellationParent)&&t.isCancellable();)e=t;var n=new o;e._attachExtraTrace(n),e._rejectUnchecked(n)},t.prototype.cancel=function(){return this.isCancellable()?(r.invokeLater(this._cancel,this,void 0),this):this},t.prototype.cancellable=function(){return this._cancellable()?this:(this._setCancellable(),this._cancellationParent=void 0,this)},t.prototype.uncancellable=function(){var n=new t(e);return n._setTrace(this),n._follow(this),n._unsetCancellable(),this._isBound()&&n._setBoundTo(this._boundTo),n},t.prototype.fork=function(t,e,n){var i=this._then(t,e,n,void 0,void 0);return i._setCancellable(),i._cancellationParent=void 0,i}}},function(t,e,n){"use strict";t.exports=function(){function t(t){var n;if("function"==typeof t)n="[function "+(t.name||"anonymous")+"]";else{n=t.toString();var i=/\[object [a-zA-Z0-9$_]+\]/;if(i.test(n))try{var r=JSON.stringify(t);n=r}catch(o){}0===n.length&&(n="(empty array)")}return"(<"+e(n)+">, no stack trace)"}function e(t){var e=41;return t.length<e?t:t.substr(0,e-3)+"..."}function i(t,e){this.captureStackTrace(i,e)}var r=n(9).inherits,o=n(30).defineProperty,s=new RegExp("\\b(?:[a-zA-Z0-9.]+\\$_\\w+|tryCatch(?:1|2|Apply)|new \\w*PromiseArray|\\w*PromiseArray\\.\\w*PromiseArray|setTimeout|CatchFilter\\$_\\w+|makeNodePromisified|processImmediate|process._tickCallback|nextTick|Async\\$\\w+)\\b"),a=null,c=null;r(i,Error),i.prototype.captureStackTrace=function(t,e){u(this,t,e)},i.possiblyUnhandledRejection=function(t){if("object"==typeof console){var e;if("object"==typeof t||"function"==typeof t){var n=t.stack;e="Possibly unhandled "+c(n,t)}else e="Possibly unhandled "+String(t);"function"==typeof console.error||"object"==typeof console.error?console.error(e):("function"==typeof console.log||"object"==typeof console.log)&&console.log(e)}},i.combine=function(t,e){for(var n=t.length-1,i=e.length-1;i>=0;--i){var r=e[i];if(t[n]!==r)break;t.pop(),n--}t.push("From previous event:");for(var o=t.concat(e),c=[],i=0,u=o.length;u>i;++i)s.test(o[i])||i>0&&!a.test(o[i])&&"From previous event:"!==o[i]||c.push(o[i]);return c},i.isSupported=function(){return"function"==typeof u};var u=function l(){if("number"==typeof Error.stackTraceLimit&&"function"==typeof Error.captureStackTrace){a=/^\s*at\s*/,c=function(e,n){return"string"==typeof e?e:void 0!==n.name&&void 0!==n.message?n.name+". "+n.message:t(n)};var e=Error.captureStackTrace;return function(t,n){e(t,n)}}var n=new Error;if("string"==typeof n.stack&&"function"==typeof"".startsWith&&n.stack.startsWith("stackDetection@")&&"stackDetection"===l.name){o(Error,"stackTraceLimit",{writable:!0,enumerable:!1,configurable:!1,value:25}),a=/@/;var i=/[@\n]/;return c=function(e,n){return"string"==typeof e?n.name+". "+n.message+"\n"+e:void 0!==n.name&&void 0!==n.message?n.name+". "+n.message:t(n)},function(t){for(var e=(new Error).stack,n=e.split(i),r=n.length,o="",s=0;r>s;s+=2)o+=n[s],o+="@",o+=n[s+1],o+="\n";t.stack=o}}return c=function(e,n){return"string"==typeof e?e:"object"!=typeof n&&"function"!=typeof n||void 0===n.name||void 0===n.message?t(n):n.name+". "+n.message},null}();return i}},function(t,e,n){"use strict";t.exports=function(t){function e(t,e,n){this._instances=t,this._callback=e,this._promise=n}function i(t,e){var n={},i=s(t,n,e);if(i===a)return i;var r=c(n);return r.length?(a.e=new u("Catch filter must inherit from Error or be a simple predicate function"),a):i}var r=n(9),o=n(17),s=r.tryCatch1,a=r.errorObj,c=n(30).keys,u=o.TypeError;return e.prototype.doFilter=function(e){for(var n=this._callback,r=this._promise,c=r._isBound()?r._boundTo:void 0,u=0,l=this._instances.length;l>u;++u){var h=this._instances[u],p=h===Error||null!=h&&h.prototype instanceof Error;if(p&&e instanceof h){var d=s(n,c,e);return d===a?(t.e=d.e,t):d}if("function"==typeof h&&!p){var f=i(h,e);if(f===a){var g=o.canAttach(a.e)?a.e:new Error(a.e+"");this._promise._attachExtraTrace(g),e=a.e;break}if(f){var d=s(n,c,e);return d===a?(t.e=d.e,t):d}}}return t.e=e,t},e}},function(t,e,n){"use strict";var i=n(9),r=i.isPrimitive,o=i.wrapsPrimitiveReceiver;t.exports=function(t){var e=function(){return this},n=function(){throw this},i=function(t,e){return 1===e?function(){throw t}:2===e?function(){return t}:void 0};t.prototype["return"]=t.prototype.thenReturn=function(t){return o&&r(t)?this._then(i(t,2),void 0,void 0,void 0,void 0):this._then(e,void 0,void 0,t,void 0)},t.prototype["throw"]=t.prototype.thenThrow=function(t){return o&&r(t)?this._then(i(t,1),void 0,void 0,void 0,void 0):this._then(n,void 0,void 0,t,void 0)}}},function(t,e,n){"use strict";t.exports=function(t){function e(e){for(var n=this instanceof t?this._settledValue:this,i=n.length,r=new Array(i),o=0,s=0;i>s;++s)e[s]&&(r[o++]=n[s]);return r.length=o,r}var i=(n(9).isArray,{ref:null});t.filter=function(n,r){return t.map(n,r,i)._then(e,void 0,void 0,i.ref,void 0)},t.prototype.filter=function(t){return this.map(t,i)._then(e,void 0,void 0,i.ref,void 0)}}},function(t,e,n){"use strict";t.exports=function(t,e){function i(){return this}function r(){throw this}function o(t){return function(){return t}}function s(t){return function(){throw t}}function a(t,e,n){var a;return a=h&&p(e)?n?o(e):s(e):n?i:r,t._then(a,d,void 0,e,void 0)}function c(n){var i=this.promise,r=this.handler,o=i._isBound()?r.call(i._boundTo):r();if(void 0!==o){var s=t._cast(o,void 0);if(s instanceof t)return a(s,n,i.isFulfilled())}return i.isRejected()?(e.e=n,e):n}function u(e){var n=this.promise,i=this.handler,r=n._isBound()?i.call(n._boundTo,e):i(e);if(void 0!==r){var o=t._cast(r,void 0);if(o instanceof t)return a(o,e,!0)}return e}var l=n(9),h=l.wrapsPrimitiveReceiver,p=l.isPrimitive,d=l.thrower;t.prototype._passThroughHandler=function(t,e){if("function"!=typeof t)return this.then();var n={promise:this,handler:t};return this._then(e?c:u,e?c:void 0,void 0,n,void 0)},t.prototype.lastly=t.prototype["finally"]=function(t){return this._passThroughHandler(t,!0)},t.prototype.tap=function(t){return this._passThroughHandler(t,!1)}}},function(t,e,n){"use strict";t.exports=function(t,e,i){var r=n(113)(t,i),o=n(17),s=o.TypeError,a=n(9).deprecated;t.coroutine=function(t){if("function"!=typeof t)throw new s("generatorFunction must be a function");var e=r;return function(){var n=t.apply(this,arguments),i=new e(void 0,void 0);return i._generator=n,i._next(void 0),i.promise()}},t.coroutine.addYieldHandler=r.addYieldHandler,t.spawn=function(n){if(a("Promise.spawn is deprecated. Use Promise.coroutine instead."),"function"!=typeof n)return e("generatorFunction must be a function");var i=new r(n,this),o=i.promise();return i._run(t.spawn),o}}},function(t,e,n){"use strict";t.exports=function(t,e,i,r){function o(t){return s(t,this[0],this[1],this[2])}function s(e,n,s,c){if("function"!=typeof n)return r("fn must be a function");var u=void 0;s===!0?e._isBound()&&(u=e._boundTo):s!==!1&&(u=s);var l=void 0!==c;if(l&&(c.ref=e),e instanceof t){var p=[n,u,c];return e._then(o,void 0,void 0,p,void 0)}if(!h(e))return r("expecting an array, a promise or a thenable");var d=new t(i);void 0!==u&&d._setBoundTo(u),d._setTrace(void 0);var f=new a(d,n,e,u,l);return f.init(),d}function a(t,e,n,i,r){this.shouldUnwrapItems=r,this.index=0,this.items=n,this.callback=e,this.receiver=i,this.promise=t,this.result=new Array(n.length)}var c=t.all,u=n(9),l=n(17).canAttach,h=u.isArray,p=t._cast,d={};u.inherits(a,e),a.prototype.init=function(){for(var e=this.items,n=e.length,i=this.result,r=!1,o=0;n>o;++o){var s=p(e[o],void 0);s instanceof t?s.isPending()?(i[o]=d,s._proxyPromiseArray(this,o)):s.isFulfilled()?i[o]=s.value():(s._unsetRejectionIsUnhandled(),r||(this.reject(s.reason()),r=!0)):i[o]=s}r||this.iterate()},a.prototype.isResolved=function(){return null===this.promise},a.prototype._promiseProgressed=function(t){this.isResolved()||this.promise._progress(t)},a.prototype._promiseFulfilled=function(t,e){this.isResolved()||(this.result[e]=t,this.shouldUnwrapItems&&(this.items[e]=t),this.index===e&&this.iterate())},a.prototype._promiseRejected=function(t){this.reject(t)},a.prototype.reject=function(t){if(!this.isResolved()){var e=l(t)?t:new Error(t+"");this.promise._attachExtraTrace(e),this.promise._reject(t,e)}},a.prototype.iterate=function(){for(var t=this.index,e=this.items,n=this.result,i=e.length,n=this.result,r=this.receiver,o=this.callback;i>t;++t){var s=n[t];if(s===d)return void(this.index=t);try{n[t]=o.call(r,s,t,i)}catch(a){return this.reject(a)}}this.promise._follow(c(n)),this.items=this.result=this.callback=this.promise=null},t.prototype.map=function(t,e){return s(this,t,!0,e)},t.map=function(t,e,n){return s(t,e,!1,n)}}},function(t,e,n){"use strict";t.exports=function(t){function e(t){throw t}function i(t,n){var i=this,r=void 0===t?c(i,n,null):a(i,n,null,t);r===u&&s.invokeLater(e,void 0,r.e)}function r(t,n){var i=this,r=c(i,n,t);r===u&&s.invokeLater(e,void 0,r.e)}var o=n(9),s=n(31),a=o.tryCatch2,c=o.tryCatch1,u=o.errorObj;t.prototype.nodeify=function(t){return"function"==typeof t&&this._then(i,r,void 0,t,this._isBound()?this._boundTo:null),this}}},function(t,e,n){"use strict";t.exports=function(t,e){var i=n(9),r=n(31),o=n(17),s=i.tryCatch1,a=i.errorObj;t.prototype.progressed=function(t){return this._then(void 0,void 0,t,void 0,void 0)},t.prototype._progress=function(t){this._isFollowingOrFulfilledOrRejected()||this._progressUnchecked(t)},t.prototype._progressHandlerAt=function(t){return 0===t?this._progressHandler0:this[t+2-5]},t.prototype._doProgressWith=function(e){var n=e.value,i=e.handler,r=e.promise,c=e.receiver;this._pushContext();var u=s(i,c,n);if(this._popContext(),u===a){if(null!=u.e&&"StopProgressPropagation"!==u.e.name){var l=o.canAttach(u.e)?u.e:new Error(u.e+"");r._attachExtraTrace(l),r._progress(u.e)}}else u instanceof t?u._then(r._progress,null,null,r,void 0):r._progress(u)},t.prototype._progressUnchecked=function(n){if(this.isPending())for(var i=this._length(),o=this._progress,s=0;i>s;s+=5){var a=this._progressHandlerAt(s),c=this._promiseAt(s);if(c instanceof t)"function"==typeof a?r.invoke(this._doProgressWith,this,{handler:a,promise:c,receiver:this._receiverAt(s),value:n}):r.invoke(o,c,n);else{var u=this._receiverAt(s);"function"==typeof a?a.call(u,n,c):u instanceof t&&u._isProxied()?u._progressUnchecked(n):e(u,c)&&u._promiseProgressed(n,c)}}}}},function(t,e,n){(function(e){"use strict";t.exports=function(){function t(t){return void 0===t?!1:t instanceof r}function i(t,e){return t instanceof f?e>=0:!1}function r(t){if("function"!=typeof t)throw new k("the promise constructor requires a resolver function");if(this.constructor!==r)throw new k("the promise constructor cannot be invoked directly");this._bitField=0,this._fulfillmentHandler0=void 0,this._rejectionHandler0=void 0,this._promise0=void 0,this._receiver0=void 0,this._settledValue=void 0,this._boundTo=void 0,t!==h&&this._resolveFromResolver(t)}function o(t,e){return s(t,f,e===!0&&t._isBound()?t._boundTo:void 0).promise()}function s(e,n,i){var o=null;return y(e)?o=e:(o=r._cast(e,void 0),o!==e?o._setBoundTo(i):t(o)||(o=null)),null!==o?new n(o,i):{promise:function(){return I("expecting an array, a promise or a thenable")}}}var a=n(32),c=n(9),u=n(31),l=n(17),h=function(){},p={},d={e:null},f=n(112)(r,h),g=n(102)(),m=n(103)(d),_=n(60),y=c.isArray,v=c.errorObj,b=c.tryCatch1,w=c.tryCatch2,P=c.tryCatchApply,x=l.RangeError,k=l.TypeError,O=l.CancellationError,j=l.TimeoutError,C=l.RejectionError,S=l.originatesFromRejection,A=l.markAsOriginatingFromRejection,T=l.canAttach,E=c.thrower,I=n(46)(r),N=function(){return new k("circular promise resolution chain")};r.prototype.bind=function(t){var e=new r(h);return e._setTrace(this),e._follow(this),e._setBoundTo(t),this._cancellable()&&(e._setCancellable(),e._cancellationParent=this),e},r.prototype.toString=function(){return"[object Promise]"},r.prototype.caught=r.prototype["catch"]=function(t){var e=arguments.length;if(e>1){var n,i=new Array(e-1),r=0;for(n=0;e-1>n;++n){var o=arguments[n];if("function"!=typeof o){var s=new k("A catch filter must be an error constructor or a filter function");return this._attachExtraTrace(s),void u.invoke(this._reject,this,s)}i[r++]=o}i.length=r,t=arguments[n],this._resetTrace();var a=new m(i,t,this);return this._then(void 0,a.doFilter,void 0,a,void 0)}return this._then(void 0,t,void 0,void 0,void 0)},r.prototype.then=function(t,e,n){return this._then(t,e,n,void 0,void 0)},r.prototype.done=function(t,e,n){var i=this._then(t,e,n,void 0,void 0);i._setIsFinal()},r.prototype.spread=function(t,e){return this._then(t,e,void 0,p,void 0)},r.prototype.isCancellable=function(){return!this.isResolved()&&this._cancellable()},r.prototype.toJSON=function(){var t={isFulfilled:!1,isRejected:!1,fulfillmentValue:void 0,rejectionReason:void 0};return this.isFulfilled()?(t.fulfillmentValue=this._settledValue,t.isFulfilled=!0):this.isRejected()&&(t.rejectionReason=this._settledValue,t.isRejected=!0),t},r.prototype.all=function(){return o(this,!0)},r.is=t,r.all=function(t){return o(t,!1)},r.join=function(){for(var t=arguments.length,e=new Array(t),n=0;t>n;++n)e[n]=arguments[n];return s(e,f,void 0).promise()},r.resolve=r.fulfilled=function(t){var e=new r(h);return e._setTrace(void 0),e._tryFollow(t)?e:(e._cleanValues(),e._setFulfilled(),e._settledValue=t,e)},r.reject=r.rejected=function(t){var e=new r(h);if(e._setTrace(void 0),A(t),e._cleanValues(),e._setRejected(),e._settledValue=t,!T(t)){var n=new Error(t+"");e._setCarriedStackTrace(n)}return e._ensurePossibleRejectionHandled(),e},r.prototype.error=function(t){return this.caught(S,t)},r.prototype._resolveFromSyncValue=function(t){if(t===v)this._cleanValues(),this._setRejected(),this._settledValue=t.e,this._ensurePossibleRejectionHandled();else{var e=r._cast(t,void 0);e instanceof r?this._follow(e):(this._cleanValues(),this._setFulfilled(),this._settledValue=t)}},r.method=function(t){if("function"!=typeof t)throw new k("fn must be a function");return function(){var e;switch(arguments.length){case 0:e=b(t,this,void 0);break;case 1:e=b(t,this,arguments[0]);break;case 2:e=w(t,this,arguments[0],arguments[1]);break;default:for(var n=arguments.length,i=new Array(n),o=0;n>o;++o)i[o]=arguments[o];e=P(t,i,this)}var s=new r(h);return s._setTrace(void 0),s._resolveFromSyncValue(e),s}},r.attempt=r["try"]=function(t,e,n){if("function"!=typeof t)return I("fn must be a function");var i=y(e)?P(t,e,n):b(t,n,e),o=new r(h);return o._setTrace(void 0),o._resolveFromSyncValue(i),o},r.defer=r.pending=function(){var t=new r(h);return t._setTrace(void 0),new _(t)},r.bind=function(t){var e=new r(h);return e._setTrace(void 0),e._setFulfilled(),e._setBoundTo(t),e},r.cast=function(t){var e=r._cast(t,void 0);return e instanceof r?e:r.resolve(e)},r.onPossiblyUnhandledRejection=function(t){g.possiblyUnhandledRejection="function"==typeof t?t:void 0};var R;r.onUnhandledRejectionHandled=function(t){R="function"==typeof t?t:void 0};var M=!1||!("undefined"==typeof e||"string"!=typeof e.execPath||!{NODE_ENV:"production"}.BLUEBIRD_DEBUG&&"development"!=={NODE_ENV:"production"}.NODE_ENV);r.longStackTraces=function(){if(u.haveItemsQueued()&&M===!1)throw new Error("cannot enable long stack traces after promises have been created");M=g.isSupported()},r.hasLongStackTraces=function(){return M&&g.isSupported()},r.prototype._setProxyHandlers=function(t,e){var n=this._length();if(n>=524282&&(n=0,this._setLength(0)),0===n)this._promise0=e,this._receiver0=t;else{var i=n-5;this[i+3]=e,this[i+4]=t,this[i+0]=this[i+1]=this[i+2]=void 0}this._setLength(n+5)},r.prototype._proxyPromiseArray=function(t,e){this._setProxyHandlers(t,e)},r.prototype._proxyPromise=function(t){t._setProxied(),this._setProxyHandlers(t,-1)},r.prototype._then=function(t,e,n,i,o){var s=void 0!==o,a=s?o:new r(h);if(M&&!s){var c=this._peekContext()===this._traceParent;a._traceParent=c?this._traceParent:this,a._setTrace(this)}!s&&this._isBound()&&a._setBoundTo(this._boundTo);var l=this._addCallbacks(t,e,n,a,i);return!s&&this._cancellable()&&(a._setCancellable(),a._cancellationParent=this),this.isResolved()&&u.invoke(this._queueSettleAt,this,l),a},r.prototype._length=function(){return 524287&this._bitField},r.prototype._isFollowingOrFulfilledOrRejected=function(){return(939524096&this._bitField)>0},r.prototype._isFollowing=function(){return 536870912===(536870912&this._bitField)},r.prototype._setLength=function(t){this._bitField=-524288&this._bitField|524287&t},r.prototype._setFulfilled=function(){this._bitField=268435456|this._bitField},r.prototype._setRejected=function(){this._bitField=134217728|this._bitField},r.prototype._setFollowing=function(){this._bitField=536870912|this._bitField},r.prototype._setIsFinal=function(){this._bitField=33554432|this._bitField},r.prototype._isFinal=function(){return(33554432&this._bitField)>0},r.prototype._cancellable=function(){return(67108864&this._bitField)>0},r.prototype._setCancellable=function(){this._bitField=67108864|this._bitField},r.prototype._unsetCancellable=function(){this._bitField=-67108865&this._bitField},r.prototype._setRejectionIsUnhandled=function(){this._bitField=2097152|this._bitField},r.prototype._unsetRejectionIsUnhandled=function(){this._bitField=-2097153&this._bitField,this._isUnhandledRejectionNotified()&&(this._unsetUnhandledRejectionIsNotified(),this._notifyUnhandledRejectionIsHandled())},r.prototype._isRejectionUnhandled=function(){return(2097152&this._bitField)>0},r.prototype._setUnhandledRejectionIsNotified=function(){this._bitField=524288|this._bitField},r.prototype._unsetUnhandledRejectionIsNotified=function(){this._bitField=-524289&this._bitField},r.prototype._isUnhandledRejectionNotified=function(){return(524288&this._bitField)>0},r.prototype._setCarriedStackTrace=function(t){this._bitField=1048576|this._bitField,this._fulfillmentHandler0=t},r.prototype._unsetCarriedStackTrace=function(){this._bitField=-1048577&this._bitField,this._fulfillmentHandler0=void 0},r.prototype._isCarryingStackTrace=function(){return(1048576&this._bitField)>0},r.prototype._getCarriedStackTrace=function(){return this._isCarryingStackTrace()?this._fulfillmentHandler0:void 0},r.prototype._receiverAt=function(t){var e;return e=0===t?this._receiver0:this[t+4-5],this._isBound()&&void 0===e?this._boundTo:e},r.prototype._promiseAt=function(t){return 0===t?this._promise0:this[t+3-5]},r.prototype._fulfillmentHandlerAt=function(t){return 0===t?this._fulfillmentHandler0:this[t+0-5]},r.prototype._rejectionHandlerAt=function(t){return 0===t?this._rejectionHandler0:this[t+1-5]},r.prototype._unsetAt=function(t){0===t?(this._rejectionHandler0=this._progressHandler0=this._promise0=this._receiver0=void 0,this._isCarryingStackTrace()||(this._fulfillmentHandler0=void 0)):this[t-5+0]=this[t-5+1]=this[t-5+2]=this[t-5+3]=this[t-5+4]=void 0},r.prototype._resolveFromResolver=function(t){function e(t){i._tryFollow(t)||i._fulfill(t)}function n(t){var e=T(t)?t:new Error(t+"");i._attachExtraTrace(e),A(t),i._reject(t,e===t?void 0:e)}var i=this;this._setTrace(void 0),this._pushContext();var r=w(t,void 0,e,n);if(this._popContext(),void 0!==r&&r===v){var o=r.e,s=T(o)?o:new Error(o+"");i._reject(o,s)}},r.prototype._addCallbacks=function(t,e,n,i,r){var o=this._length();if(o>=524282&&(o=0,this._setLength(0)),0===o)this._promise0=i,void 0!==r&&(this._receiver0=r),"function"!=typeof t||this._isCarryingStackTrace()||(this._fulfillmentHandler0=t),"function"==typeof e&&(this._rejectionHandler0=e),"function"==typeof n&&(this._progressHandler0=n);else{var s=o-5;this[s+3]=i,this[s+4]=r,this[s+0]="function"==typeof t?t:void 0,this[s+1]="function"==typeof e?e:void 0,this[s+2]="function"==typeof n?n:void 0}return this._setLength(o+5),o},r.prototype._setBoundTo=function(t){void 0!==t?(this._bitField=8388608|this._bitField,this._boundTo=t):this._bitField=-8388609&this._bitField},r.prototype._isBound=function(){return 8388608===(8388608&this._bitField)},r.prototype._spreadSlowCase=function(t,e,n,i){var r=s(n,f,i).promise()._then(function(){return t.apply(i,arguments)},void 0,void 0,p,void 0);e._follow(r)},r.prototype._callSpread=function(e,n,i,o){var s=this._isBound()?this._boundTo:void 0;if(y(i))for(var a=0,c=i.length;c>a;++a)if(t(r._cast(i[a],void 0)))return void this._spreadSlowCase(e,n,i,s);return o&&n._pushContext(),P(e,i,s)},r.prototype._callHandler=function(t,e,n,i,r){var o;return e!==p||this.isRejected()?(r&&n._pushContext(),o=b(t,e,i)):o=this._callSpread(t,n,i,r),r&&n._popContext(),o},r.prototype._settlePromiseFromHandler=function(e,n,i,o){if(!t(o))return void e.call(n,i,o);var s=M,a=this._callHandler(e,n,o,i,s);if(!o._isFollowing())if(a===v||a===o||a===d){var c=a===o?N():a.e,u=T(c)?c:new Error(c+"");a!==d&&o._attachExtraTrace(u),o._rejectUnchecked(c,u)}else{var l=r._cast(a,o);if(t(l)){if(l.isRejected()&&!l._isCarryingStackTrace()&&!T(l._settledValue)){var u=new Error(l._settledValue+"");o._attachExtraTrace(u),l._setCarriedStackTrace(u)}o._follow(l),l._cancellable()&&(o._cancellationParent=l,o._setCancellable())}else o._fulfillUnchecked(a)}},r.prototype._follow=function(t){this._setFollowing(),t.isPending()?(t._cancellable()&&(this._cancellationParent=t,this._setCancellable()),t._proxyPromise(this)):t.isFulfilled()?this._fulfillUnchecked(t._settledValue):this._rejectUnchecked(t._settledValue,t._getCarriedStackTrace()),t._isRejectionUnhandled()&&t._unsetRejectionIsUnhandled(),M&&null==t._traceParent&&(t._traceParent=this)},r.prototype._tryFollow=function(e){if(this._isFollowingOrFulfilledOrRejected()||e===this)return!1;var n=r._cast(e,void 0);return t(n)?(this._follow(n),!0):!1},r.prototype._resetTrace=function(){M&&(this._trace=new g(void 0===this._peekContext()))},r.prototype._setTrace=function(t){if(M){var e=this._peekContext();this._traceParent=e;var n=void 0===e;this._trace=void 0!==t&&t._traceParent===e?t._trace:new g(n)}return this},r.prototype._attachExtraTrace=function(t){if(M){var e=this,n=t.stack;n="string"==typeof n?n.split("\n"):[];for(var i=1;null!=e&&null!=e._trace;)n=g.combine(n,e._trace.stack.split("\n")),e=e._traceParent;var r=Error.stackTraceLimit+i,o=n.length;o>r&&(n.length=r),t.stack=n.length<=i?"(No stack trace)":n.join("\n")}},r.prototype._cleanValues=function(){this._cancellable()&&(this._cancellationParent=void 0)},r.prototype._fulfill=function(t){this._isFollowingOrFulfilledOrRejected()||this._fulfillUnchecked(t)},r.prototype._reject=function(t,e){this._isFollowingOrFulfilledOrRejected()||this._rejectUnchecked(t,e)},r.prototype._settlePromiseAt=function(t){var e=this.isFulfilled()?this._fulfillmentHandlerAt(t):this._rejectionHandlerAt(t),n=this._settledValue,o=this._receiverAt(t),s=this._promiseAt(t);if("function"==typeof e)this._settlePromiseFromHandler(e,o,n,s);else{var a=!1,c=this.isFulfilled();void 0!==o&&(o instanceof r&&o._isProxied()?(o._unsetProxied(),c?o._fulfillUnchecked(n):o._rejectUnchecked(n,this._getCarriedStackTrace()),a=!0):i(o,s)&&(c?o._promiseFulfilled(n,s):o._promiseRejected(n,s),a=!0)),a||(c?s._fulfill(n):s._reject(n,this._getCarriedStackTrace()))}t>=256&&this._queueGC()},r.prototype._isProxied=function(){return 4194304===(4194304&this._bitField)},r.prototype._setProxied=function(){this._bitField=4194304|this._bitField},r.prototype._unsetProxied=function(){this._bitField=-4194305&this._bitField},r.prototype._isGcQueued=function(){return-1073741824===(-1073741824&this._bitField)},r.prototype._setGcQueued=function(){this._bitField=-1073741824|this._bitField},r.prototype._unsetGcQueued=function(){this._bitField=1073741823&this._bitField},r.prototype._queueGC=function(){this._isGcQueued()||(this._setGcQueued(),u.invokeLater(this._gc,this,void 0))},r.prototype._gc=function(){var t=this._length();this._unsetAt(0);for(var e=0;t>e;e++)delete this[e];this._setLength(0),this._unsetGcQueued()},r.prototype._queueSettleAt=function(t){this._isRejectionUnhandled()&&this._unsetRejectionIsUnhandled(),u.invoke(this._settlePromiseAt,this,t)},r.prototype._fulfillUnchecked=function(t){if(this.isPending()){if(t===this){var e=N();return this._attachExtraTrace(e),this._rejectUnchecked(e,void 0)}this._cleanValues(),this._setFulfilled(),this._settledValue=t;var n=this._length();n>0&&u.invoke(this._settlePromises,this,n)}},r.prototype._rejectUncheckedCheckError=function(t){var e=T(t)?t:new Error(t+"");this._rejectUnchecked(t,e===t?void 0:e)},r.prototype._rejectUnchecked=function(t,e){if(this.isPending()){if(t===this){var n=N();return this._attachExtraTrace(n),this._rejectUnchecked(n)}if(this._cleanValues(),this._setRejected(),this._settledValue=t,this._isFinal())return void u.invokeLater(E,void 0,void 0===e?t:e);var i=this._length();void 0!==e&&this._setCarriedStackTrace(e),i>0?u.invoke(this._rejectPromises,this,null):this._ensurePossibleRejectionHandled()}},r.prototype._rejectPromises=function(){this._settlePromises(),this._unsetCarriedStackTrace()},r.prototype._settlePromises=function(){for(var t=this._length(),e=0;t>e;e+=5)this._settlePromiseAt(e)},r.prototype._ensurePossibleRejectionHandled=function(){this._setRejectionIsUnhandled(),void 0!==g.possiblyUnhandledRejection&&u.invokeLater(this._notifyUnhandledRejection,this,void 0)},r.prototype._notifyUnhandledRejectionIsHandled=function(){"function"==typeof R&&u.invokeLater(R,void 0,this)},r.prototype._notifyUnhandledRejection=function(){if(this._isRejectionUnhandled()){var t=this._settledValue,e=this._getCarriedStackTrace();this._setUnhandledRejectionIsNotified(),void 0!==e&&(this._unsetCarriedStackTrace(),t=e),"function"==typeof g.possiblyUnhandledRejection&&g.possiblyUnhandledRejection(t,this)}};var F=[];r.prototype._peekContext=function(){var t=F.length-1;return t>=0?F[t]:void 0},r.prototype._pushContext=function(){M&&F.push(this)},r.prototype._popContext=function(){M&&F.pop()};var z=a.Promise;return r.noConflict=function(){return a.Promise===r&&(a.Promise=z),r},g.isSupported()||(r.longStackTraces=function(){},M=!1),r._makeSelfResolutionError=N,n(106)(r,d),n(104)(r),n(125)(r,h),n(124)(r),r.RangeError=x,r.CancellationError=O,r.TimeoutError=j,r.TypeError=k,r.RejectionError=C,c.toFastProperties(r),c.toFastProperties(r.prototype),n(126)(r,h),n(98)(r,s,f),n(118)(r,h),n(100)(r),n(105)(r,s,f,I),n(107)(r,I,h),n(108)(r,f,h,I),n(109)(r),n(114)(r,h),n(116)(r,f),n(119)(r,s,f,I,h),n(121)(r,s,f),n(123)(r,s,f,I),n(110)(r,i),n(101)(r,h),r.prototype=r.prototype,r}}).call(e,n(79))},function(t,e,n){"use strict";t.exports=function(t,e){function i(t){switch(t){case-1:return void 0;case-2:return[];case-3:return{}}}function r(n,i){var r=this._promise=new t(e),o=void 0;n instanceof t&&(o=n,n._cancellable()&&(r._setCancellable(),r._cancellationParent=n),n._isBound()&&r._setBoundTo(i)),r._setTrace(o),this._values=n,this._length=0,this._totalResolved=0,this._init(void 0,-2)}var o=n(17).canAttach,s=n(9),a=n(31),c={}.hasOwnProperty,u=s.isArray;return r.PropertiesPromiseArray=function(){},r.prototype.length=function(){return this._length},r.prototype.promise=function(){return this._promise},r.prototype._init=function(e,n){var o=this._values;if(o instanceof t){if(!o.isFulfilled())return o.isPending()?void o._then(this._init,this._reject,void 0,this,n):(o._unsetRejectionIsUnhandled(),void this._reject(o._settledValue));
if(o=o._settledValue,!u(o)){var s=new t.TypeError("expecting an array, a promise or a thenable");return void this.__hardReject__(s)}this._values=o}if(0===o.length)return void this._resolve(i(n));var l,h=o.length,p=h;l=this instanceof r.PropertiesPromiseArray?this._values:new Array(h);for(var d=!1,f=0;h>f;++f){var g=o[f];if(void 0!==g||c.call(o,f)){var m=t._cast(g,void 0);m instanceof t?m.isPending()?m._proxyPromiseArray(this,f):(m._unsetRejectionIsUnhandled(),d=!0):d=!0,l[f]=m}else p--}if(0===p)return void this._resolve(-2===n?l:i(n));if(this._values=l,this._length=p,d){var _=p===h?this._scanDirectValues:this._scanDirectValuesHoled;a.invoke(_,this,h)}},r.prototype._settlePromiseAt=function(e){var n=this._values[e];n instanceof t?n.isFulfilled()?this._promiseFulfilled(n._settledValue,e):n.isRejected()&&this._promiseRejected(n._settledValue,e):this._promiseFulfilled(n,e)},r.prototype._scanDirectValuesHoled=function(t){for(var e=0;t>e&&!this._isResolved();++e)c.call(this._values,e)&&this._settlePromiseAt(e)},r.prototype._scanDirectValues=function(t){for(var e=0;t>e&&!this._isResolved();++e)this._settlePromiseAt(e)},r.prototype._isResolved=function(){return null===this._values},r.prototype._resolve=function(t){this._values=null,this._promise._fulfill(t)},r.prototype.__hardReject__=r.prototype._reject=function(t){this._values=null;var e=o(t)?t:new Error(t+"");this._promise._attachExtraTrace(e),this._promise._reject(t,e)},r.prototype._promiseProgressed=function(t,e){this._isResolved()||this._promise._progress({index:e,value:t})},r.prototype._promiseFulfilled=function(t,e){if(!this._isResolved()){this._values[e]=t;var n=++this._totalResolved;n>=this._length&&this._resolve(this._values)}},r.prototype._promiseRejected=function(t){this._isResolved()||(this._totalResolved++,this._reject(t))},r}},function(t,e,n){"use strict";t.exports=function(t,e){function i(e){for(var n=h,r=u,o=t,s=n.length,a=0;s>a;++a){var c=l(n[a],void 0,e);if(c===r)return o.reject(r.e);var p=o._cast(c,i,void 0);if(p instanceof o)return p}return null}function r(n,i){var r=this._promise=new t(e);r._setTrace(void 0),this._generatorFunction=n,this._receiver=i,this._generator=void 0}var o=n(17),s=o.TypeError,a=n(9),c=a.isArray,u=a.errorObj,l=a.tryCatch1,h=[];return r.prototype.promise=function(){return this._promise},r.prototype._run=function(){this._generator=this._generatorFunction.call(this._receiver),this._receiver=this._generatorFunction=void 0,this._next(void 0)},r.prototype._continue=function p(e){if(e===u){this._generator=void 0;var n=o.canAttach(e.e)?e.e:new Error(e.e+"");return this._promise._attachExtraTrace(n),void this._promise._reject(e.e,n)}var r=e.value;if(e.done===!0)this._generator=void 0,this._promise._tryFollow(r)||this._promise._fulfill(r);else{var a=t._cast(r,p,void 0);if(!(a instanceof t)&&(a=c(a)?t.all(a):i(a),null===a))return void this._throw(new s("A value was yielded that could not be treated as a promise"));a._then(this._next,this._throw,void 0,this,null)}},r.prototype._throw=function(t){o.canAttach(t)&&this._promise._attachExtraTrace(t),this._continue(l(this._generator["throw"],this._generator,t))},r.prototype._next=function(t){this._continue(l(this._generator.next,this._generator,t))},r.addYieldHandler=function(t){if("function"!=typeof t)throw new s("fn must be a function");h.push(t)},r}},function(t,e,n){"use strict";t.exports=function(t,e){function i(t){return t.__isPromisified__===!0}function r(t,e){var n=e+"Async"in t;return n?i(t[e+"Async"]):!1}function o(t){for(var e=0;e<t.length;e+=2){var n=t[e];if(P.test(n))for(var i=n.replace(P,""),r=0;r<t.length;r+=2)if(t[r]===i)throw new w("Cannot promisify an API that has normal methods with Async-suffix")}}function s(t){for(var e=[t],n=Math.max(0,t-1-5),i=t-1;i>=n;--i)i!==t&&e.push(i);for(var i=t+1;5>=i;++i)e.push(i);return e}function a(t){for(var e=new Array(t),n=0;n<e.length;++n)e[n]="_arg"+n;return e.join(", ")}function c(t){return"number"==typeof t.length?Math.max(Math.min(t.length,1024),0):0}function u(t){return k.test(t)?"."+t:"['"+t.replace(/(['\\])/g,"\\$1")+"']"}function l(n,i,r,o){function l(t){for(var e=new Array(t),r=0,o=e.length;o>r;++r)e[r]="arguments["+r+"]";var s=t>0?",":"";return"string"==typeof n&&i===d?"this"+u(n)+"("+e.join(",")+s+" fn);break;":(void 0===i?"callback("+e.join(",")+s+" fn);":"callback.call("+(i===d?"this":"receiver")+", "+e.join(",")+s+" fn);")+"break;"}function h(){for(var t="",e=0;e<f.length;++e)t+="case "+f[e]+":"+l(f[e]);return t+="default: var args = new Array(len + 1);var i = 0;for (var i = 0; i < len; ++i) {    args[i] = arguments[i];}args[i] = fn;"+("string"==typeof n?"this"+u(n)+".apply(":"callback.apply(")+(i===d?"this":"receiver")+", args); break;"}var p=Math.max(0,c(o)-1),f=s(p),g="string"==typeof r?r+"Async":"promisified";return k.test(g)||(g="promisified"),new Function("Promise","callback","receiver","withAppended","maybeWrapAsError","nodebackForPromise","INTERNAL","var ret = function "+g+"("+a(p)+') {"use strict";var len = arguments.length;var promise = new Promise(INTERNAL);promise._setTrace(void 0);var fn = nodebackForPromise(promise);try {switch(len) {'+h()+"}}catch(e){ var wrapped = maybeWrapAsError(e);promise._attachExtraTrace(wrapped);promise._reject(wrapped);}return promise;}; ret.__isPromisified__ = true; return ret;")(t,n,i,_,y,m,e)}function h(n,i){function r(){var r=i;i===d&&(r=this),"string"==typeof n&&(n=r[n]);var o=new t(e);o._setTrace(void 0);var s=m(o);try{n.apply(r,_(arguments,s))}catch(a){var c=y(a);o._attachExtraTrace(c),o._reject(c)}return o}return r.__isPromisified__=!0,r}function p(t,e,n){if(n){for(var i=x(t),r=0,o=i.length;o>r;r+=2){var s=i[r],a=i[r+1],c=s+"Async";t[c]=O(s,d,s,a)}return f.toFastProperties(t),t}return O(t,e,void 0,t)}var d={},f=n(9),g=n(30),m=n(60)._nodebackForPromise,_=f.withAppended,y=f.maybeWrapAsError,v=f.canEvaluate,b=f.deprecated,w=n(17).TypeError,P=new RegExp("Async$"),x=function(){if(g.isES5){var t=Object.create,e=Object.getOwnPropertyDescriptor;return function(n){for(var s=[],a=t(null),c=n;null!==n;){for(var u=g.keys(n),l=0,h=u.length;h>l;++l){var p=u[l];if(!a[p]){a[p]=!0;var d=e(n,p);null==d||"function"!=typeof d.value||i(d.value)||r(c,p)||s.push(p,d.value)}}n=g.getPrototypeOf(n)}return o(s),s}}return function(t){var e=[];for(var n in t){var s=t[n];"function"!=typeof s||i(s)||r(t,n)||e.push(n,s)}return o(e),e}}(),k=/^[a-z$_][a-z$_0-9]*$/i,O=v?l:h;t.promisify=function(t,e){if("object"==typeof t&&null!==t)return b("Promise.promisify for promisifying entire objects is deprecated. Use Promise.promisifyAll instead."),p(t,e,!0);if("function"!=typeof t)throw new w("fn must be a function");return i(t)?t:p(t,arguments.length<2?d:e,!1)},t.promisifyAll=function(t){if("function"!=typeof t&&"object"!=typeof t)throw new w("the target of promisifyAll must be an object or a function");return p(t,void 0,!0)}}},function(t,e,n){"use strict";t.exports=function(t,e){function i(t,e){for(var n=s.keys(t),i=new Array(n.length),r=0,o=i.length;o>r;++r)i[r]=t[n[r]];if(this.constructor$(i,e),!this._isResolved())for(var r=0,o=n.length;o>r;++r)i.push(n[r])}var r=n(9),o=r.inherits,s=n(30);return o(i,e),i.prototype._init=function(){this._init$(void 0,-3)},i.prototype._promiseFulfilled=function(t,e){if(!this._isResolved()){this._values[e]=t;var n=++this._totalResolved;if(n>=this._length){for(var i={},r=this.length(),o=0,s=this.length();s>o;++o)i[this._values[o+r]]=this._values[o];this._resolve(i)}}},i.prototype._promiseProgressed=function(t,e){this._isResolved()||this._promise._progress({key:this._values[e+this.length()],value:t})},e.PropertiesPromiseArray=i,i}},function(t,e,n){"use strict";t.exports=function(t,e){function i(e,n){var i,o=t._cast(e,void 0);return a(o)?(o instanceof t?i=o._then(t.props,void 0,void 0,void 0,void 0):(i=new r(o,n===!0&&o._isBound()?o._boundTo:void 0).promise(),n=!1),n===!0&&o._isBound()&&i._setBoundTo(o._boundTo),i):s("cannot await properties of a non-object")}var r=n(115)(t,e),o=n(9),s=n(46)(t),a=o.isObject;t.prototype.props=function(){return i(this,!0)},t.props=function(t){return i(t,!1)}}},function(t){"use strict";function e(t,e,n,i,r){for(var o=0;r>o;++o)n[o+i]=t[o+e]}function n(t){return t>>>=0,t-=1,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,t+1}function i(t){return"number"!=typeof t?16:n(Math.min(Math.max(16,t),1073741824))}function r(t){this._capacity=i(t),this._length=0,this._front=0,this._makeCapacity()}r.prototype._willBeOverCapacity=function(t){return this._capacity<t},r.prototype._pushOne=function(t){var e=this.length();this._checkCapacity(e+1);var n=this._front+e&this._capacity-1;this[n]=t,this._length=e+1},r.prototype.push=function(t,e,n){var i=this.length()+3;if(this._willBeOverCapacity(i))return this._pushOne(t),this._pushOne(e),void this._pushOne(n);var r=this._front+i-3;this._checkCapacity(i);var o=this._capacity-1;this[r+0&o]=t,this[r+1&o]=e,this[r+2&o]=n,this._length=i},r.prototype.shift=function(){var t=this._front,e=this[t];return this[t]=void 0,this._front=t+1&this._capacity-1,this._length--,e},r.prototype.length=function(){return this._length},r.prototype._makeCapacity=function(){for(var t=this._capacity,e=0;t>e;++e)this[e]=void 0},r.prototype._checkCapacity=function(t){this._capacity<t&&this._resizeTo(this._capacity<<3)},r.prototype._resizeTo=function(t){var n=this._front,i=this._capacity,r=new Array(i),o=this.length();if(e(this,0,r,0,i),this._capacity=t,this._makeCapacity(),this._front=0,i>=n+o)e(r,n,this,0,o);else{var s=o-(n+o&i-1);e(r,n,this,0,s),e(r,0,this,s,o-s)}},t.exports=r},function(t,e,n){"use strict";t.exports=function(t,e){function i(n,i){var c=t._cast(n,void 0);if(c instanceof t)return s(c);if(!o(n))return r("expecting an array, a promise or a thenable");var u=new t(e);u._setTrace(i),void 0!==i&&(i._isBound()&&u._setBoundTo(i._boundTo),i._cancellable()&&(u._setCancellable(),u._cancellationParent=i));for(var l=u._fulfill,h=u._reject,p=0,d=n.length;d>p;++p){var f=n[p];(void 0!==f||a.call(n,p))&&t.cast(f)._then(l,h,void 0,u,null)}return u}var r=n(46)(t),o=n(9).isArray,s=function(t){return t.then(function(e){return i(e,t)})},a={}.hasOwnProperty;t.race=function(t){return i(t,void 0)},t.prototype.race=function(){return i(this,void 0)}}},function(t){"use strict";t.exports=function(t,e,n,i,r){function o(e,n,i,o,s){this.promise=new t(r),this.index=n,this.length=o.length,this.items=o,this.callback=e,this.receiver=s,this.accum=i}function s(t,e){var n=this,i=void 0;"function"!=typeof n&&(i=n.receiver,n=n.fn);var r=t.length,s=void 0,a=0;void 0!==e?(s=e,a=0):(a=1,r>0&&(s=t[0]));var c=a;if(c>=r)return s;var u=new o(n,c,s,t,i);return u.iterate(),u.promise}function a(t){var e=this.fn,n=this.initialValue;return s.call(e,t,n)}function c(t,e,n,i){return n._then(function(n){return u(t,e,n,i)},void 0,void 0,void 0,void 0)}function u(r,o,u,l){if("function"!=typeof o)return i("fn must be a function");if(l===!0&&r._isBound()&&(o={fn:o,receiver:r._boundTo}),void 0!==u){if(u instanceof t){if(!u.isFulfilled())return c(r,o,u,l);u=u._settledValue}return e(r,n,l===!0&&r._isBound()?r._boundTo:void 0).promise()._then(a,void 0,void 0,{fn:o,initialValue:u},void 0)}return e(r,n,l===!0&&r._isBound()?r._boundTo:void 0).promise()._then(s,void 0,void 0,o,void 0)}o.prototype.reject=function(t){this.promise._reject(t)},o.prototype.fulfill=function(t,e){this.accum=t,this.index=e+1,this.iterate()},o.prototype.iterate=function(){for(var e=this.index,n=this.length,i=this.items,r=this.accum,o=this.receiver,s=this.callback;n>e;++e)if(r=s.call(o,r,i[e],e,n),r=t._cast(r,void 0),r instanceof t)return void r._then(this.fulfill,this.reject,void 0,this,e);this.promise._fulfill(r)},t.reduce=function(t,e,n){return u(t,e,n,!1)},t.prototype.reduce=function(t,e){return u(this,t,e,!0)}}},function(t,e,n){(function(e){"use strict";var i,r=n(32);if("undefined"!=typeof e&&null!==e&&"function"==typeof e.cwd&&"function"==typeof e.nextTick&&"string"==typeof e.version)i=function(t){e.nextTick(t)};else if("function"!=typeof r.MutationObserver&&"function"!=typeof r.WebkitMutationObserver&&"function"!=typeof r.WebKitMutationObserver||"undefined"==typeof document||"function"!=typeof document.createElement)if("function"==typeof r.postMessage&&"function"!=typeof r.importScripts&&"function"==typeof r.addEventListener&&"function"==typeof r.removeEventListener){var o="bluebird_message_key_"+Math.random();i=function(){function t(t){if(t.source===r&&t.data===o){var n=e;e=void 0,n()}}var e=void 0;return r.addEventListener("message",t,!1),function(t){e=t,r.postMessage(o,"*")}}()}else i="function"==typeof r.MessageChannel?function(){var t=void 0,e=new r.MessageChannel;return e.port1.onmessage=function(){var e=t;t=void 0,e()},function(n){t=n,e.port2.postMessage(null)}}():r.setTimeout?function(t){setTimeout(t,4)}:function(t){t()};else i=function(){var t=r.MutationObserver||r.WebkitMutationObserver||r.WebKitMutationObserver,e=document.createElement("div"),n=void 0,i=new t(function(){var t=n;n=void 0,t()});return i.observe(e,{attributes:!0}),function(t){n=t,e.setAttribute("class","foo")}}();t.exports=i}).call(e,n(79))},function(t,e,n){"use strict";t.exports=function(t,e,i){function r(t,n){return e(t,o,n===!0&&t._isBound()?t._boundTo:void 0).promise()}var o=n(122)(t,i);t.settle=function(t){return r(t,!1)},t.prototype.settle=function(){return r(this,!0)}}},function(t,e,n){"use strict";t.exports=function(t,e){function i(t,e){this.constructor$(t,e)}var r=t.PromiseInspection,o=n(9),s=o.inherits;return s(i,e),i.prototype._promiseResolved=function(t,e){this._values[t]=e;var n=++this._totalResolved;n>=this._length&&this._resolve(this._values)},i.prototype._promiseFulfilled=function(t,e){if(!this._isResolved()){var n=new r;n._bitField=268435456,n._settledValue=t,this._promiseResolved(e,n)}},i.prototype._promiseRejected=function(t,e){if(!this._isResolved()){var n=new r;n._bitField=134217728,n._settledValue=t,this._promiseResolved(e,n)}},i}},function(t,e,n){"use strict";t.exports=function(t,e,i,r){function o(t,n,i){if((0|n)!==n||0>n)return r("expecting a positive integer");var o=e(t,s,i===!0&&t._isBound()?t._boundTo:void 0),a=o.promise();return a.isRejected()?a:(o.setHowMany(n),o.init(),a)}var s=n(61)(i);t.some=function(t,e){return o(t,e,!1)},t.prototype.some=function(t){return o(this,t,!0)}}},function(t){"use strict";t.exports=function(t){function e(t){void 0!==t?(this._bitField=t._bitField,this._settledValue=t.isResolved()?t._settledValue:void 0):(this._bitField=0,this._settledValue=void 0)}e.prototype.isFulfilled=t.prototype.isFulfilled=function(){return(268435456&this._bitField)>0},e.prototype.isRejected=t.prototype.isRejected=function(){return(134217728&this._bitField)>0},e.prototype.isPending=t.prototype.isPending=function(){return 0===(402653184&this._bitField)},e.prototype.value=t.prototype.value=function(){if(!this.isFulfilled())throw new TypeError("cannot get fulfillment value of a non-fulfilled promise");return this._settledValue},e.prototype.error=t.prototype.reason=function(){if(!this.isRejected())throw new TypeError("cannot get rejection reason of a non-rejected promise");return this._settledValue},e.prototype.isResolved=t.prototype.isResolved=function(){return(402653184&this._bitField)>0},t.prototype.inspect=function(){return new e(this)},t.PromiseInspection=e}},function(t,e,n){"use strict";t.exports=function(t,e){function i(t){try{return t.then}catch(e){return u.e=e,u}}function r(n,r){if(l(n)){if(n instanceof t)return n;if(o(n)){var a=new t(e);return a._setTrace(void 0),n._then(a._fulfillUnchecked,a._rejectUncheckedCheckError,a._progressUnchecked,a,null),a._setFollowing(),a}var h=i(n);if(h===u)return void 0!==r&&c(h.e)&&r._attachExtraTrace(h.e),t.reject(h.e);if("function"==typeof h)return s(n,h,r)}return n}function o(t){return h.call(t,"_promise0")}function s(e,n,i){function r(n){if(!u){if(u=!0,e===n){var r=t._makeSelfResolutionError();return void 0!==i&&i._attachExtraTrace(r),void a.promise._reject(r,void 0)}a.resolve(n)}}function o(t){if(!u){u=!0;var e=c(t)?t:new Error(t+"");void 0!==i&&i._attachExtraTrace(e),a.promise._reject(t,e)}}function s(t){if(!u){var e=a.promise;"function"==typeof e._progress&&e._progress(t)}}var a=t.defer(),u=!1;try{n.call(e,r,o,s)}catch(l){if(!u){u=!0;var h=c(l)?l:new Error(l+"");void 0!==i&&i._attachExtraTrace(h),a.promise._reject(l,h)}}return a.promise}var a=n(9),c=n(17).canAttach,u=a.errorObj,l=a.isObject,h={}.hasOwnProperty;t._cast=r}},function(t,e,n){"use strict";var i=n(32),r=function(t,e){for(var n=arguments.length,r=new Array(n-2),o=2;n>o;++o)r[o-2]=arguments[o];i.setTimeout(function(){t.apply(void 0,r)},e)};t.exports=function(t,e){var i=(n(9),n(17)),o=(n(46)(t),t.TimeoutError),s=function(t,e,n){if(t.isPending()){"string"!=typeof e&&(e="operation timed out after "+n+" ms");var r=new o(e);i.markAsOriginatingFromRejection(r),t._attachExtraTrace(r),t._rejectUnchecked(r)}},a=function(t,e){e._fulfill(t)},c=t.delay=function(n,i){void 0===i&&(i=n,n=void 0),i=+i;var o=t._cast(n,void 0),s=new t(e);return o instanceof t?(o._isBound()&&s._setBoundTo(o._boundTo),o._cancellable()&&(s._setCancellable(),s._cancellationParent=o),s._setTrace(o),s._follow(o),s.then(function(e){return t.delay(e,i)})):(s._setTrace(void 0),r(a,i,n,s),s)};t.prototype.delay=function(t){return c(this,t)},t.prototype.timeout=function(n,i){n=+n;var o=new t(e);return o._setTrace(this),this._isBound()&&o._setBoundTo(this._boundTo),this._cancellable()&&(o._setCancellable(),o._cancellationParent=this),o._follow(this),r(s,n,o,i,n),o}}},function(t,e,n){var i,r,o;i=n(18),r=n(7).actions,o={show:function(t){return i.handleViewAction({actionType:r.SHOW_MESSAGE,type:t})},loading:function(t){return i.handleViewAction({actionType:r.LOADING_START,context:t})},doneLoading:function(t){return i.handleViewAction({actionType:r.LOADING_DONE,context:t})}},t.exports=o},function(t){t.exports=[{pageID:"home",title:"home",iconUrl:"images/activity_60px.png"},{pageID:"play",title:"play",iconUrl:"images/mark_tiny-square.png"},{pageID:"create",title:"create",iconUrl:"images/deck_new2.png"},{pageID:"profile",title:"profile",iconUrl:"images/settings_medium.png"}]},function(t,e,n){var i,r;r=n(99),i=function(){function t(){this._callbacks=[],this._promises=[]}return t.prototype._callbacks=[],t.prototype._promises=[],t.prototype.register=function(t){return this._callbacks.push(t),this._callbacks.length-1},t.prototype.dispatch=function(t){var e,n;return n=[],e=[],this._promises=this._callbacks.map(function(t,i){return new r(function(t,r){return n[i]=t,e[i]=r})}),this._callbacks.forEach(function(i,o){return r.resolve(i(t)).then(function(){return n[o](t)},function(){return e[o](new Error("Dispatcher callback unsuccessful"))})}),this._promises=[]},t.prototype.waitFor=function(t,e){var n;return n=t.map(function(t){return function(e){return t._promises[e]}}(this)),r.all(n).then(e)},t}(),t.exports=i},function(t,e,n){var i,r,o,s,a,c;o=n(24),r=n(22),s=n(50),a=n(28),i=o.Router.extend({routes:{login:"login",play:"play",activity:"activity",create:"create",settings:"settings",profile:"profile","card/:card":"card","card/:card/:peggee":"card",":code":"auth"},login:function(){},card:function(t,e){return null!=t?r.selectSingleCardItem(t,e):void 0},activity:function(){return r.selectMenuItem("activity")},profile:function(){return r.selectMenuItem("profile")},settings:function(){return r.selectMenuItem("settings")},create:function(){return r.selectMenuItem("create")},play:function(){return r.selectMenuItem("play")},auth:function(t){return a.auth(t)}}),c=new i,o.history.start()},function(t,e,n){var i,r,o,s,a,c,u,l={}.hasOwnProperty,h=function(t,e){function n(){this.constructor=t}for(var i in e)l.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};a=n(29),o=n(7),r=n(18),c=n(11),s=n(33),i=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return h(e,t),e.prototype._activity=[],e.prototype._fetchActivities=function(t){var e;return e=c.getUser().id,s.getActivity(e,t,function(t){return function(e){return null!=e?(t._activity=e,t.emit(o.stores.ACTIVITY_CHANGE)):void 0}}(this))},e.prototype.getActivity=function(){return this._activity},e}(a),u=new i,r.register(function(t){var e;switch(e=t.action,e.actionType){case o.actions.LOAD_ACTIVITY:return u._fetchActivities(e.page)}}),t.exports=u},function(t,e,n){var i,r,o,s,a,c,u,l={}.hasOwnProperty,h=function(t,e){function n(){this.constructor=t}for(var i in e)l.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};s=n(29),i=n(18),r=n(7),o=n(33),c=n(11),a=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return h(e,t),e.prototype._cardId=null,e.prototype._author=null,e.prototype._question=null,e.prototype._answers=[],e.prototype._categories=[],e.prototype._addQuestion=function(t){return this._author=this._getUser(),this._question=t,o.saveQuestion(this._author,this._question,function(t){return function(e){return t._cardId=e}}(this))},e.prototype._addAnswers=function(t){var e;return this._answers=[],(e=this._answers).push.apply(e,t),o.saveChoices(this._cardId,this._answers)},e.prototype._addCategories=function(t){var e;return this._categories=[],(e=this._categories).push.apply(e,t),o.saveCategories(this._cardId,this._categories,function(t){return function(e){var n,i;return i=c.getUser(),n=c.getAvatar(),e=""+i.get("first_name")+" created a card: "+t._question,o.saveActivity(e,n,i.id,t._cardId)}}(this))},e.prototype.newCard=function(){return this._cardId=null,this._author=null,this._question=null,this._answers=[],this._categories=[]},e.prototype._getUser=function(){var t;return t=c.getUser(),null!=t.id?t.id:"not logged in"},e.prototype._loadCategories=function(){return o.getCategories(function(t){return function(e){return t._categories=e,t.emit(r.stores.CATEGORIES_CHANGE)}}(this))},e.prototype.getCard=function(){return{id:this._cardId,author:this._author,question:this._question,answers:this._answers,categories:this._categories}},e.prototype.getCategories=function(){return this._categories},e}(s),u=new a,i.register(function(t){var e;switch(e=t.action,e.actionType){case r.actions.ADD_QUESTION:return u._addQuestion(e.question);case r.actions.ADD_ANSWERS:return u._addAnswers(e.answers);case r.actions.LOAD_CATEGORIES:return u._loadCategories();case r.actions.ADD_CATEGORIES:return u._addCategories(e.categories)}}),t.exports=u},function(t,e,n){var i,r,o,s,a,c,u,l,h=function(t,e){return function(){return t.apply(e,arguments)}},p={}.hasOwnProperty,d=function(t,e){function n(){this.constructor=t}for(var i in e)p.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};s=n(29),r=n(7),i=n(18),c=n(11),o=n(33),l=n(24)._,a=function(t){function e(){return this._setCardState=h(this._setCardState,this),this._fetchPrefCard=h(this._fetchPrefCard,this),e.__super__.constructor.apply(this,arguments)}return d(e,t),e.prototype._card=null,e.prototype._comments=[],e.prototype._message="",e.prototype._fail=0,e.prototype._referrer=null,e.prototype._peggeeId=null,e.prototype._setReferrer=function(t){return this._referrer=t},e.prototype._fetchCard=function(t,e){return this._loggedIn=c.getLoggedIn(),this._loggedIn&&(this._userId=c.getUser().id),this._peggeeId=this._loggedIn&&null==e?this._userId:e,o.getCard(t,function(t){return function(e){return t._card=e,t._hasPreffed=!1,null!=t._card&&null!=t._card.hasPreffed&&(t._hasPreffed=l.contains(t._card.hasPreffed,t._peggeeId)),t._hasPreffed?t._fetchPrefCard():t._setCardState()}}(this))},e.prototype._fetchPrefCard=function(){return console.log("_fetchPrefCard :: card: ",this._card),console.log("_fetchPrefCard :: peggeeId: ",this._peggeeId),o.getPrefCard(this._card.id,this._peggeeId,function(t){return function(e){return t._card=e,t._hasPegged=!1,null!=t._card&&null!=t._card.hasPegged&&t._loggedIn&&(t._hasPegged=l.contains(t._card.hasPegged,t._userId)),t._setCardState()}}(this))},e.prototype._setCardState=function(){return this._loggedIn&&null!=this._card&&this._peggeeId===this._userId&&this._hasPreffed?this._doReview():this._loggedIn&&null!=this._card&&this._peggeeId===this._userId&&!this._hasPreffed?this._doPref():this._loggedIn&&null!=this._card&&this._hasPegged?this._doReview():this._loggedIn&&null!=this._card&&this._peggeeId&&!this._hasPreffed?this._doDeny():this._loggedIn&&null!=this._card&&!this._hasPegged?this._doPegg():this._loggedIn&&null!=this._peggeeId&&null==this._card?this._doDeny():this._loggedIn||null==this._card||null==this._peggeeId?(this._loggedIn||null==this._peggeeId||null!=this._card)&&(this._loggedIn||null!=this._card)?this._loggedIn||null==this._card||null!=this._peggeeId?void 0:this._doPref():this._doRequireLogin():this._doPegg()},e.prototype._doPegg=function(){return console.log("SingleCardStore :: _doPegg called"),this._card.type="play",this._fetchChoices(),this.emit(r.stores.CARD_CHANGE)},e.prototype._doPref=function(){return console.log("SingleCardStore :: _doPref called"),this._card.type="play",this._card.pic=c.getAvatar(),this._fetchChoices(),this.emit(r.stores.CARD_CHANGE)},e.prototype._doReview=function(){return console.log("SingleCardStore :: _doReview called"),this._card.type="review",this.emit(r.stores.CARD_CHANGE)},e.prototype._doDeny=function(){return console.log("SingleCardStore :: _doDeny called"),this._card={question:"Ruh roh!<br/><br/>Either this card doesn't exist, or you don't have access to it.",pic:"/images/access_denied_icon.jpg",answer:{plug:"/images/access_denied_plug.jpg"},type:"deny"},this.emit(r.stores.CARD_CHANGE)},e.prototype._doRequireLogin=function(){return console.log("SingleCardStore :: _doRequireLogin called"),this.emit(r.stores.REQUIRE_LOGIN)},e.prototype._fetchChoices=function(){return this._card.choices.length=0,o.getChoices(this._card.id,function(t){return function(e){var n,i,o,s,a;for(s=0,a=e.length;a>s;s++)n=e[s],o=n.get("text"),i=n.get("image"),""!==o&&t._card.choices.push({id:n.id,text:o,image:i});return t.emit(r.stores.CHOICES_CHANGE,{cardId:t._card.id,choices:t._card.choices})}}(this))},e.prototype._fetchComments=function(t,e){return o.getComments(t,e,function(t){return function(e){return null!=e?(t._comments=e,t.emit(r.stores.COMMENTS_CHANGE)):void 0}}(this))},e.prototype._comment=function(t){return console.log("review comment: "+t+"  peggee: "+this._peggeeId+"  user: "+c.getUser().id+"  card: "+this._card.id),o.saveComment(t,this._card.id,this._peggeeId,c.getUser().id,c.getAvatar("type=square"),function(t){return function(e){return t._comments.unshift(e),t.emit(r.stores.COMMENTS_CHANGE)}}(this))},e.prototype._plug=function(t,e,n){var i;return console.log("save Plug: card: "+t+" image: "+url),i=c.getUser().id,o.savePlug(t,e,n,i,function(t){return function(){return t.emit(r.stores.PLUG_SAVED)}}(this))},e.prototype._pegg=function(t,e,n,i){var s,a;return console.log("save Pegg: card: "+e+" choice: "+n),a=c.getUser().id,this._card.answered=!0,o.savePegg(t,e,n,i,a,function(){}),n===i?(s=10-3*this._fail,o.savePoints(a,t,s,function(){}),this._fail=0,this.emit(r.stores.CARD_WIN,s)):(this._fail++,this.emit(r.stores.CARD_FAIL))},e.prototype._pref=function(t,e,n){var i;return console.log("save Pref: card: "+t+" choice: "+e),i=c.getUser().id,this._card.answered=!0,o.savePref(t,e,n,i,function(){return function(t){return null!=t?console.log(t):void 0}}(this)),o.savePrefCount(t,e,function(t){return function(e){return null!=e&&console.log(e),t.emit(r.stores.PREF_SAVED)}}(this))},e.prototype.getCard=function(){return this._card},e.prototype.getComments=function(){return this._comments},e.prototype.getMessage=function(){return this._message},e.prototype.getReferrer=function(){return this._referrer},e}(s),u=new a,i.register(function(t){var e;switch(e=t.action,e.actionType){case r.actions.SINGLE_CARD_LOAD:if(u._setReferrer(e.referrer),u._fetchCard(e.card,e.peggee),null!=e.peggee)return u._fetchComments(e.card,e.peggee);break;case r.actions.SINGLE_CARD_COMMENT:return u._comment(e.comment);case r.actions.SINGLE_CARD_PLUG:return u._plug(e.card,e.full,e.thumb);case r.actions.SINGLE_CARD_PEGG:return u._pegg(e.peggee,e.card,e.choice,e.answer);case r.actions.SINGLE_CARD_PREF:return u._pref(e.card,e.choice,e.plug)}}),t.exports=u},function(t,e,n){var i,r,o,s,a,c,u,l,h,p,d={}.hasOwnProperty,f=function(t,e){function n(){this.constructor=t}for(var i in e)d.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};n(75),p=n(4),l=n(1),u=n(3),c=n(5),o=n(6),r=n(10),s=n(22),a=n(50),h=n(2),i=function(t){function e(t){e.__super__.constructor.call(this,t),this.init()}return f(e,t),e.DEFAULT_OPTIONS={itemID:null,message:null,pic:null,height:100},e.prototype.init=function(){return this.build()},e.prototype.build=function(){var t,e,n,i,a,p;return t=new r({size:[h.getViewportWidth(),this.options.height],properties:{overflow:"hidden"},classes:["peggbox__item"]}),t.pipe(this._eventOutput),e="<div class='peggbox__item__text__child'> "+this.options.message.truncate(55)+" </div>",a=new u({size:[h.getViewportWidth()-80,this.options.height],content:e,properties:{width:h.getViewportWidth()},classes:["peggbox__item__text"]}),p=new c({origin:[0,0],align:[0,0],transform:l.translate(80,null,null)}),t.add(p).add(a),n=new o({size:[50,50],classes:["peggbox__item__pic"],content:this.options.pic}),i=new c({origin:[0,.5],align:[.05,.5]}),t.add(i).add(n),this.add(t),null!=this.options.cardId?t.on("click",function(){return s.selectSingleCardItem(this.options.cardId,this.options.peggeeId,"activity")}.bind(this)):void 0},e}(p),t.exports=i},function(t,e,n){var i,r,o,s,a,c,u,l,h,p,d,f,g,m,_,y,v,b,w,P,x,k,O,j,C,S,A,T,E,I,N,R,M,F=function(t,e){return function(){return t.apply(e,arguments)}},z={}.hasOwnProperty,D=function(t,e){function n(){this.constructor=t}for(var i in e)z.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};n(204),M=n(4),N=n(15),c=n(95),C=n(3),A=n(1),T=n(21),_=n(16),j=n(5),p=n(37),a=n(8),x=n(44),R=n(2),s=n(7),r=n(38),I=n(11),g=n(64),O=n(133),f=n(128),i=n(65),u=n(143),l=n(145),h=n(23),d=n(68),m=n(147),v=n(148),b=n(149),w=n(155),P=n(159),k=n(161),S=n(164),y=n(22),r=n(38),E=n(28),o=function(t){function e(){this.onScroll=F(this.onScroll,this),this.requireLogin=F(this.requireLogin,this),this.togglePage=F(this.togglePage,this),this.hideMessage=F(this.hideMessage,this),this.showMessage=F(this.showMessage,this),e.__super__.constructor.apply(this,arguments),this.layoutManager=new h,this.footerLayout=this.layoutManager.getViewLayout("FooterView"),this.initLayout(),this.initPages(),this.initListeners(),this.initMessage()}return D(e,t),e.DEFAULT_OPTIONS={menu:{model:f},header:{height:0}},e.prototype.pages={},e.prototype.menuOpen=!1,e.prototype.initListeners=function(){return r.on(s.stores.MENU_CHANGE,this.togglePage),O.on(s.stores.REQUIRE_LOGIN,this.requireLogin),g.on(s.stores.SHOW_MESSAGE,this.showMessage),g.on(s.stores.HIDE_MESSAGE,this.hideMessage)},e.prototype.initLayout=function(){return this.layout=new c({headerSize:this.options.header.height,footerSize:this.footerLayout.height}),this.layout.header.add(this.initHeader()),this.layout.footer.add(this.initFooter()),this.layout.content.add(this.initViewManager()),this.layoutState=new j({origin:[.5,.5],align:[.5,.5]}),this.add(this.layoutState).add(this.layout)},e.prototype.initHeader=function(){return this.header=new u({height:50}),this.header.on("toggleMenu",function(){return function(){return y.selectMenuItem("home")}}(this)),this.header},e.prototype.initFooter=function(){return this.footer=new S(this.options.menu),this.footer},e.prototype.initMessage=function(){return this.messageRC=new x({inTransition:{duration:500,curve:a.outCubic},outTransition:{duration:350,curve:a.outCubic}}),this.messageView=new m,this.messageView.on("hide",this.hideMessage),this.add(this.messageRC)},e.prototype.initPages=function(){return this.pages.play=new w,this.pages.create=new v,this.pages.settings=new k,this.pages.activity=new i,this.pages.profile=new P,this.pages.login=new d,this.pages.home=new l,this.togglePage()
},e.prototype.initViewManager=function(){var t;return t=R.getViewportHeight(),this.lightbox=new p({inOpacity:1,outOpacity:0,inOrigin:[1,1],outOrigin:[0,0],showOrigin:[.5,.5],inTransform:A.translate(0,t,-300),outTransform:A.translate(0,-t,-1e3),inTransition:{duration:500,curve:a.outCubic},outTransition:{duration:350,curve:a.outCubic}})},e.prototype.showMessage=function(t){return this.messageRC.show(this.messageView),this.messageView.load(t)},e.prototype.hideMessage=function(){return this.messageRC.hide(this.messageView)},e.prototype.showPage=function(t){return this.lightbox.show(t)},e.prototype.getPage=function(t){return this.pages[t]},e.prototype.togglePage=function(){var t;return t=r.getCurrentPageID(),I.getLoggedIn()||"card"===t?(this.showPage(this.getPage(t)),this.footer.bounceTabs()):this.requireLogin()},e.prototype.requireLogin=function(){return this.showPage(this.getPage("login"))},e.prototype.onScroll=function(){return this.tabsOpen?(this.footer.hideTabs(),this.tabsOpen=!1):(this.footer.showTabs(),this.tabsOpen=!0)},e}(M),t.exports=o},function(t,e,n){var i,r,o,s,a,c,u,l,h,p,d,f,g,m,_,y,v,b,w,P,x,k=function(t,e){return function(){return t.apply(e,arguments)}},O={}.hasOwnProperty,j=function(t,e){function n(){this.constructor=t}for(var i in e)O.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};n(52),x=n(24)._,s=n(8),a=n(40),u=n(6),h=n(16),p=n(49),d=n(44),f=n(5),g=n(3),m=n(13),_=n(41),y=n(1),b=n(15),P=n(4),r=n(138),o=n(7),c=n(146),l=n(23),v=n(11),w=n(2),i=function(t){function e(t){this.toggleZoom=k(this.toggleZoom,this),this.loadAnswer=k(this.loadAnswer,this),this.flip=k(this.flip,this),this.pickAnswer=k(this.pickAnswer,this),this.toggleChoices=k(this.toggleChoices,this),e.__super__.constructor.call(this,t),this.layoutManager=new l,this.layout=this.layoutManager.getViewLayout("CardView"),this.initCard(),this.initQuestion(),this.initChoices(),this.initAnswer(),this.initGestures()}return j(e,t),e.prototype.initCard=function(){var t,e;return this.state=new f({origin:this.layout.card.origin}),this.mainNode=this.add(this.state),this.front=new u({size:this.layout.card.size,content:"images/Card.svg"}),e=new h({transform:this.layout.card.front.transform}),this.mainNode.add(e).add(this.front),this.back=new u({size:this.layout.card.size,content:"images/Card.svg"}),t=new h({transform:this.layout.card.back.transform}),this.mainNode.add(t).add(this.back)},e.prototype.initQuestion=function(){return this.frontProfilePic=new u({size:this.layout.profilePic.size,classes:this.layout.profilePic.big.classes,properties:{borderRadius:""+this.layout.profilePic.size[0]+"px"}}),this.frontProfilePicMod=new f({origin:this.layout.profilePic.big.origin,align:this.layout.profilePic.big.align,transform:this.layout.profilePic.big.transform}),this.mainNode.add(this.frontProfilePicMod).add(this.frontProfilePic),this.frontQuestion=new g({size:this.layout.question.big.size,classes:this.layout.question.big.classes}),this.frontQuestionMod=new f({origin:this.layout.question.big.origin,align:this.layout.question.big.align,transform:this.layout.question.big.transform}),this.mainNode.add(this.frontQuestionMod).add(this.frontQuestion)},e.prototype.initChoices=function(){return this.choicesView=new r(this.layout.choices),this.choicesMod=new f({transform:this.layout.choices.show}),this.rc=new d({inTransition:{duration:500,curve:s.outCubic},outTransition:{duration:350,curve:s.outCubic}}),this.mainNode.add(this.choicesMod).add(this.rc),this.rc.show(this.choicesView),this.choiceShowing=!0,this.choicesView.on("choice:doneShowingStatus",this.flip)},e.prototype.initAnswer=function(){var t,e;return this.backImage=new u({size:this.layout.answerImage.size,classes:this.layout.answerImage.classes,properties:{borderRadius:""+this.layout.answerImage.borderRadius+"px",maxHeight:""+this.layout.answerImage.maxHeight+"px"}}),this.backImage.on("click",function(){return function(){}}(this)),this.backImageModifier=new f({transform:this.layout.answerImage.transform}),this.mainNode.add(this.backImageModifier).add(this.backImage),this.backText=new g({size:this.layout.answerText.size,classes:this.layout.answerText.classes}),this.backTextModifier=new f({transform:this.layout.answerText.transform}),this.mainNode.add(this.backTextModifier).add(this.backText),this.addImageButton=new u({size:this.layout.addImage.size,content:this.layout.addImage.content,classes:this.layout.addImage.classes}),t=new f({origin:this.layout.addImage.origin,align:this.layout.addImage.align,transform:this.layout.addImage.transform}),this.addImageRenderer=new d,e=new c,this.addImageButton.on("click",function(t){return function(){return e.pick(function(e){return console.log(JSON.stringify(e)),t.backImage.setContent(e.fullS3),t._eventOutput.emit("plug",{id:t.card.id,full:e.key,thumb:e.thumb.key})})}}(this)),this.mainNode.add(e),this.mainNode.add(t).add(this.addImageRenderer)},e.prototype.initGestures=function(){return this.front.pipe(this._eventOutput),this.frontProfilePic.pipe(this._eventOutput),this.frontQuestion.pipe(this._eventOutput),this.back.pipe(this._eventOutput),this.backImage.pipe(this._eventOutput),this.backText.pipe(this._eventOutput)},e.prototype.clearCard=function(){return this.backImage.setContent(""),this.backText.setContent(""),this.choicesView.clearChoices(),this.frontProfilePic.setContent(""),this.frontQuestion.setContent(""),this.addImageRenderer.hide(this.addImageButton),this.back.removeListener("click",this.flip),this.backImage.removeListener("click",this.flip),this.backText.removeListener("click",this.flip),this.front.removeListener("click",this.flip),this.front.removeListener("click",this.toggleChoices),this.frontProfilePic.removeListener("click",this.flip),this.frontProfilePic.removeListener("click",this.toggleChoices),this.frontQuestion.removeListener("click",this.flip),this.frontQuestion.removeListener("click",this.toggleChoices),this.choicesView.removeListener("choice",this.pickAnswer),this.choiceShowing?this.toggleChoices():void 0},e.prototype.loadCard=function(t,e){return this.clearCard(),this.card=t,null!=this.card.answer&&this.loadAnswer(this.card.answer.plug,this.card.answer.text),("review"===e||"deny"===e)&&(this.front.on("click",this.flip),this.back.on("click",this.flip),this.frontProfilePic.on("click",this.flip),this.frontQuestion.on("click",this.flip),this.backImage.on("click",this.flip),this.backText.on("click",this.flip)),"review"===e?(this.loadAnswer(this.card.answer.plug,this.card.answer.text),this.frontProfilePic.setContent(""+this.card.pic+"/?height=100&type=normal&width=100"),t.peggeeId===v.getUser().id&&this.addImageRenderer.show(this.addImageButton)):"deny"===e?(this.frontProfilePic.setContent(""+this.card.pic),this.loadAnswer(this.card.answer.plug,null)):(this.front.on("click",this.toggleChoices),this.back.on("click",function(t){return function(){return t._eventOutput.emit("comment",t)}}(this)),this.frontProfilePic.on("click",this.toggleChoices),this.frontQuestion.on("click",this.toggleChoices),this.frontProfilePic.setContent(""+this.card.pic+"/?height=100&type=normal&width=100")),this.card.question.length>90&&(this.layout.question.classes=[""+this.layout.question.big.classes+"--medium"]),this.frontQuestion.setContent(this.card.question),1===this.currentSide&&this.flip(),this.choicesView.load(this.card.choices,this.card.answer),this.choicesView.on("choice",this.pickAnswer)},e.prototype.toggleChoices=function(){return this.choiceShowing?(this.frontQuestion.setClasses(this.layout.question.big.classes),this.frontQuestion.setSize(this.layout.question.big.size),w.animate(this.frontQuestionMod,this.layout.question.big),w.animate(this.frontProfilePicMod,this.layout.profilePic.big),this.rc.hide(this.choicesView),this._eventOutput.emit("choices:hidden",this),this.choiceShowing=!1):(this.frontQuestion.setClasses(this.layout.question.small.classes),this.frontQuestion.setSize(this.layout.question.small.size),w.animate(this.frontQuestionMod,this.layout.question.small),w.animate(this.frontProfilePicMod,this.layout.profilePic.small),this.rc.show(this.choicesView),this._eventOutput.emit("choices:showing",this),this.choiceShowing=!0)},e.prototype.pickAnswer=function(t){var e;return e=this.card.choices[t],null!=this.card.answer?this._eventOutput.emit("pegg",{peggeeId:this.card.peggeeId,id:this.card.id,choiceId:e.id,answerId:this.card.answer.id}):(this._eventOutput.emit("pref",{id:this.card.id,choiceId:e.id,plug:e.plug,thumb:e.thumb}),this.loadAnswer(e.plug,e.text),this.addImageRenderer.show(this.addImageButton),this.flip())},e.prototype.flip=function(){return this.currentSide=1===this.currentSide?0:1,this.rc.hide(this.choicesView),this.state.setTransform(y.rotateY(Math.PI*this.currentSide),this.layout.card.transition),this._eventOutput.emit("card:flipped",this)},e.prototype.loadAnswer=function(t,e){return this.backImage.setContent(t),this.backText.setContent(e)},e.prototype.toggleZoom=function(){return this.big?(this.big=!1,this.backImage.setSize(this.layout.answerPic.size)):(this.big=!0,this.backImage.setSize([w.getViewportWidth(),w.getViewportHeight()]))},e}(P),t.exports=i},function(t,e,n){var i,r,o,s,a,c,u,l,h,p,d,f=function(t,e){return function(){return t.apply(e,arguments)}},g={}.hasOwnProperty,m=function(t,e){function n(){this.constructor=t}for(var i in e)g.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};n(52),d=n(4),l=n(13),u=n(3),c=n(5),h=n(1),s=n(94),a=n(26),p=n(2),o=function(t){function e(){this.remove=f(this.remove,this),this.showStatusMsg=f(this.showStatusMsg,this),e.__super__.constructor.apply(this,arguments),this.state=new c({size:this.options.size}),this.mainNode=this.add(this.state),this.createFlipper(),this.mainNode.add(this.flipper)}return m(e,t),e.DEFAULT_OPTIONS={size:null,innerWidth:0,choiceText:"",color:""},e.prototype.createFlipper=function(){return this.createFront(),this.createBack(),this.flipper=new s({direction:s.DIRECTION_Y}),this.flipper.setFront(this.front),this.flipper.setBack(this.back)},e.prototype.createFront=function(){return this.front=new r(this.options),this.front.pipe(this._eventOutput)},e.prototype.createBack=function(){return this.back=new i(this.options),this.back.pipe(this._eventOutput)},e.prototype.showStatusMsg=function(t){return this.back.update(t),this.flipper.flip(void 0,function(e){return function(){return"fail"===t&&l.setTimeout(e.remove,500),"win"===t?l.setTimeout(function(){return e._eventOutput.emit("choice:doneShowingStatus")},500):void 0}}(this))},e.prototype.remove=function(){var t;return t={curve:"linear",duration:300},this.state.setOpacity(.001,t),this.state.setSize([this.options.size[0],0],t,function(t){return function(){return t.state.setTransform(h.translate(0,0,-10))}}(this))},e}(d),r=function(t){function e(){e.__super__.constructor.apply(this,arguments),this.state=new c({size:this.options.size,align:this.options.align,origin:this.options.origin}),this.createBacking(),this.mainNode=this.add(this.state),this.mainNode.add(this.backing)}return m(e,t),e.prototype.createBacking=function(){return this.backing=new u({classes:["card__front__option","option__front"],content:"<div class='outerContainer' style='width: "+this.options.innerWidth+"px; height: "+this.options.height+"px;'> <div class='innerContainer'> "+this.options.choiceText+" </div> </div>"}),this.backing.pipe(this._eventOutput)},e}(d),i=function(t){function e(){e.__super__.constructor.apply(this,arguments),this.state=new c({size:this.options.size,align:this.options.align,origin:this.options.origin}),this.createBacking(),this.mainNode=this.add(this.state),this.mainNode.add(this.backing)}return m(e,t),e.prototype.createBacking=function(){return this.backing=new u({content:""}),this.backing.pipe(this._eventOutput)},e.prototype.update=function(t){var e;return e=a.getMessage(t),this.backing.setClasses(["card__front__option","option__back",""+t]),this.backing.setContent("<div class='outerContainer' style='width: "+this.options.innerWidth+"px; height: "+this.options.height+"px;'> <div class='innerContainer'> "+e+" </div> </div>")},e}(d),t.exports=o},function(t,e,n){var i,r,o,s,a,c,u,l,h,p,d,f,g,m={}.hasOwnProperty,_=function(t,e){function n(){this.constructor=t}for(var i in e)m.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};n(52),g=n(24)._,f=n(4),c=n(96),u=n(25),l=n(5),h=n(3),s=n(67),a=n(26),i=n(137),p=n(1),d=n(2),o=n(23),r=function(t){function e(){e.__super__.constructor.apply(this,arguments),this.choices=[],this.scrollView=new c({container:{size:this.options.size,classes:["card__options__box"]}}),this.scrollMod=new l({align:this.options.align,origin:this.options.origin}),this.scrollView.sequenceFrom(this.choices),this.add(this.scrollMod).add(this.scrollView)}return _(e,t),e.prototype.load=function(t,e){var n,r,o,s,a,c;this.clearChoices(),c=[];for(s in t)m.call(t,s)&&(n=t[s],r=n.text,r?(this.options.choice.choiceText=r,o=new i(this.options.choice),a=null,null!=e&&(a=e.id===s?"win":"fail"),o.on("click",function(t,e,n){return this._eventOutput.emit("choice",t),null!=e?n.showStatusMsg(e):void 0}.bind(this,s,a,o)),o.on("choice:doneShowingStatus",function(t){return this._eventOutput.emit("choice:doneShowingStatus",t)}.bind(this,s)),this.choices.push(o),c.push(o.pipe(this.scrollView))):c.push(void 0));return c},e.prototype.clearChoices=function(){return this.choices.length=0},e}(f),t.exports=r},function(t,e,n){var i,r,o,s,a,c,u,l,h,p,d,f={}.hasOwnProperty,g=function(t,e){function n(){this.constructor=t}for(var i in e)f.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};n(73),p=n(4),c=n(3),o=n(6),a=n(5),l=n(1),u=n(13),s=n(26),r=n(10),d=n(24)._,h=n(2),i=function(t){function e(t,n){n=d.defaults(n,this.constructor.DEFAULT_OPTIONS),e.__super__.constructor.call(this,n),this.comment=t,this.addItem()}return g(e,t),e.DEFAULT_OPTIONS={width:void 0,height:60,text:{width:h.getViewportWidth()-87,height:15},pic:{width:35,height:35}},e.prototype.addItem=function(){var t,e,n;return e=new o({size:[this.options.pic.width,this.options.pic.height],content:this.comment.userImg,classes:["comments__pic"]}),n=new c({size:[this.options.text.width,this.options.text.height],classes:["comments__text"],content:this.comment.text,properties:{marginLeft:this.options.pic.width+10+"px"}}),t=new r({size:[this.options.width,this.options.height],classes:["comments__item"],properties:{overflow:"hidden"}}),t.add(e),t.add(n),this.add(t),t.pipe(this._eventOutput)},e}(p),t.exports=i},function(t,e,n){var i,r,o,s,a,c,u,l,h,p,d,f,g,m={}.hasOwnProperty,_=function(t,e){function n(){this.constructor=t}for(var i in e)m.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};n(73),g=n(4),l=n(3),s=n(6),u=n(5),p=n(1),h=n(13),a=n(26),d=n(15),c=n(25),i=n(139),o=n(10),f=n(2),r=function(t){function e(){e.__super__.constructor.apply(this,arguments),this.init()}return _(e,t),e.DEFAULT_OPTIONS={width:f.getViewportWidth()-50,height:f.getViewportHeight()-290},e.prototype.init=function(){return this.comments=new c,this.container=new o({size:[this.options.width,this.options.height],properties:{overflow:"hidden"}}),this.container.add(this.comments),this.addCommentText=new l({classes:["comments__text"]}),this.container.add(this.addCommentText),this.add(this.container)},e.prototype.load=function(t){var e,n;for(n=[],this.comments.sequenceFrom(n),this.i=0;this.i<t.length;)this.addCommentText.setContent(""),e=new i(t[this.i],{size:[this.options.width,this.options.height]}),e.pipe(this.comments),n.push(e),this.i++;return 0===t.length?this.addCommentText.setContent("Don't be a weeniecorn, say something!"):void 0},e.prototype.getCount=function(){return this.i},e}(g),t.exports=r},function(t,e,n){var i,r,o,s,a,c,u={}.hasOwnProperty,l=function(t,e){function n(){this.constructor=t}for(var i in e)u.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};c=n(4),o=n(3),r=n(5),s=n(1),a=n(2),i=function(t){function e(){e.__super__.constructor.apply(this,arguments),this.init()}return l(e,t),e.DEFAULT_OPTIONS={showTransform:s.translate(0,70,20),showTransition:!0,hideTransform:s.translate(0,150,20),hideTransition:!0,doneCallback:function(){},cancelCallback:function(){},size:[void 0,50],btnSize:[a.getViewportWidth(),30],classes:[]},e.prototype.init=function(){return this.mainMod=new r({size:this.options.size,origin:[.5,1],align:[.5,1],transform:this.options.showTransform}),this.initSurfaces(),this.initListeners(),this.hide()},e.prototype.initSurfaces=function(){var t;return this.backing=new o({classes:this.options.classes.concat(["confirmOrCancel"])}),this.doneBtn=new o({classes:this.options.classes.concat(["confirmOrCancel__btn","btn","done-btn"]),content:"Done",properties:{textAlign:"center",lineHeight:this.options.btnSize[1]+"px"}}),this.doneBtnMod=new r({size:this.options.btnSize,origin:[.5,.5],align:[.5,.5]}),t=this.add(this.mainMod),t.add(this.backing),t.add(this.doneBtnMod).add(this.doneBtn)},e.prototype.initListeners=function(){return this.doneBtn.on("click",function(t){return function(){return t._eventOutput.emit("click:done"),t.hide()}}(this))},e.prototype.show=function(t){return t=t||function(){},this.mainMod.setTransform(this.options.showTransform,this.options.showTransition,t)},e.prototype.hide=function(t){return t=t||function(){},this.mainMod.setTransform(this.options.hideTransform,this.options.hideTransition,t)},e}(c),t.exports=i},function(t,e,n){var i,r,o,s,a,c,u,l=function(t,e){return function(){return t.apply(e,arguments)}},h={}.hasOwnProperty,p=function(t,e){function n(){this.constructor=t}for(var i in e)h.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};n(205),u=n(4),s=n(3),o=n(16),i=n(35),a=n(13),c=n(1),r=function(t){function e(){this.update=l(this.update,this),this.toggleState=l(this.toggleState,this),this.tick=l(this.tick,this),e.__super__.constructor.apply(this,arguments),this.initTime(),this.surface=new s({size:[70,20],classes:["fpsmeter"],content:""}),this.add(new o({origin:[1,0],align:[1,0],transform:c.inFront})).add(this.surface),this.surface.on("click",this.toggleState),this.start()}return p(e,t),e.prototype.currTime=0,e.prototype.lastTime=0,e.prototype.frameTime=0,e.prototype.state=!0,e.prototype.filterStrength=10,e.prototype.updateFrequency=100,e.prototype.initTime=function(){var t,e;return t=window.performance,t&&(t.now||t.webkitNow)&&(e=t.now?"now":"webkitNow",this.getTime=t[e].bind(t)),this.lastTime=this.getTime()},e.prototype.tick=function(){var t;return this.currTime=this.getTime(),t=this.currTime-this.lastTime,this.frameTime+=(t-this.frameTime)/this.filterStrength,this.lastTime=this.currTime},e.prototype.toggleState=function(){return this.state?this.stop():this.start(),this.state=!this.state},e.prototype.start=function(){return i.on("prerender",this.tick),this.interval=a.setInterval(this.update,this.updateFrequency)},e.prototype.stop=function(){return i.removeListener("prerender",this.tick),a.clear(this.interval)},e.prototype.update=function(){return this.surface.setContent(""+(1e3/this.frameTime).toFixed(1)+" fps")},e.prototype.getTime=function(){return+new Date},e}(u),t.exports=r},function(t,e,n){var i,r,o,s,a,c,u,l,h,p,d,f,g,m,_,y=function(t,e){return function(){return t.apply(e,arguments)}},v={}.hasOwnProperty,b=function(t,e){function n(){this.constructor=t}for(var i in e)v.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};n(206),_=n(4),m=n(15),h=n(3),a=n(6),c=n(16),d=n(1),f=n(28),g=n(11),i=n(38),r=n(7),u=n(22),o=n(8),p=n(13),l=n(5),s=function(t){function e(){this._update=y(this._update,this),this._build=y(this._build,this),e.__super__.constructor.apply(this,arguments),g.on(r.stores.CHANGE,this._update),this._build(),this.initEvents()}return b(e,t),e.prototype.cssPrefix="header",e.prototype.height=50,e.prototype._build=function(){var t,e,n,i,r;return this.mainMod=new l({transform:d.translate(0,0,10)}),this.background=new h({classes:[""+this.cssPrefix+"__background"]}),this.menuIcon=new a({size:[30,50],classes:[""+this.cssPrefix+"__logo"],content:"images/hamburger.svg"}),n=new c({transform:d.translate(8,0,0)}),this.logo=new a({size:[40,40],classes:[""+this.cssPrefix+"__logo"],content:"images/home.svg"}),t=new l({transform:d.translate(10,10,0)}),this.pic=new a({size:[this.options.height,this.options.height],classes:[""+this.cssPrefix+"__profilePic"],content:g.getAvatar("type=square"),properties:{borderRadius:""+(this.options.height-10)+"px",padding:"10px"}}),r=new c({origin:[1,0],align:[1,0],transform:d.translate(-8,0,0)}),this.me=new h({classes:[""+this.cssPrefix+"__text"],content:"Me",size:[50,50]}),e=new c({origin:[1,0],align:[1,0],transform:d.translate(-28,16,11)}),i=this.add(this.mainMod),i.add(this.background)},e.prototype._update=function(){return this.pic.setContent(g.getAvatar("type=square"))},e.prototype.initEvents=function(){return this.logo.on("click",function(t){return function(){return t._eventOutput.emit("toggleMenu")}}(this)),this.menuIcon.on("click",function(t){return function(){return t._eventOutput.emit("toggleMenu")}}(this)),this.pic.on("click",function(){return u.selectMenuItem("profile")}),this.me.on("click",function(){return u.selectMenuItem("profile")})},e}(_),t.exports=s},function(t,e,n){var i,r,o,s,a,c,u,l,h,p,d,f,g,m=function(t,e){return function(){return t.apply(e,arguments)}},_={}.hasOwnProperty,y=function(t,e){function n(){this.constructor=t}for(var i in e)_.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};n(74),g=n(4),h=n(3),a=n(6),l=n(5),c=n(16),p=n(1),r=n(8),o=n(59),f=n(2),i=n(10),u=n(27),d=n(165),s=function(t){function e(){this._addDashboardItem=m(this._addDashboardItem,this),e.__super__.constructor.apply(this,arguments),this.init()}return y(e,t),e.prototype.cssPrefix="moods",e.DEFAULT_OPTIONS={cols:2},e.prototype.init=function(){var t,e,n,i,r,s,a;return n=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],a=new Date,t=a.getDay(),this.day=new h({size:[f.getViewportWidth(),100],classes:[""+this.cssPrefix+"__welcome",""+this.cssPrefix+"__text--yellow"],content:"Happy "+n[t]+"!"}),e=new c({origin:[.5,0],align:[.5,.05]}),this.add(e).add(this.day),r=new h({size:[f.getViewportWidth(),100],content:"DASHBOARD",classes:[""+this.cssPrefix+"__title"]}),s=new c({origin:[.5,0],align:[.5,.1]}),this.add(s).add(r),this.grid=new o({cellSize:[f.getViewportWidth()/2-10,f.getViewportWidth()/2-10],dimensions:[2,2],transition:{curve:"easeInOut",duration:800},gutterSize:[0,0]}),this.surfaces=[],this.grid.sequenceFrom(this.surfaces),i=new l({size:[f.getViewportWidth(),f.getViewportWidth()],origin:[.5,0],align:[.5,.3]}),this.add(i).add(this.grid),this._addDashboardItem(0,"images/Deck-Red.svg","Activity"),this._addDashboardItem(0,"images/Deck-Blue.svg","Challenges"),this._addDashboardItem(0,"images/Deck-Yellow.svg","Stats"),this._addDashboardItem(0,"images/Deck-Green.svg","Peggbox")},e.prototype._addDashboardItem=function(t,e,n){var r,o,s,u,l;return r=new i({size:[f.getViewportWidth()/2,f.getViewportWidth()/2],classes:[""+this.cssPrefix+"__box"]}),r.on("click",function(t){return function(){return t._eventOutput.emit("pageSelect",n)}}(this)),o=new a({content:e,size:[f.getViewportWidth()/2-65,f.getViewportWidth()/2-65],classes:[""+this.cssPrefix+"__box__image"]}),s=new c({origin:[.5,0],align:[.5,0]}),r.add(s).add(o),u=new h({content:n,size:[f.getViewportWidth()/2-50,50],classes:[""+this.cssPrefix+"__box__text"]}),l=new c({origin:[.5,.9],align:[.5,.94]}),r.add(l).add(u),this.surfaces.push(r)},e.prototype.rearrange=function(){return this.grid.setOptions({dimensions:[3,2]})},e}(g),t.exports=s},function(t,e,n){var i,r,o,s,a,c,u,l,h,p,d=function(t,e){return function(){return t.apply(e,arguments)}},f={}.hasOwnProperty,g=function(t,e){function n(){this.constructor=t}for(var i in e)f.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};p=n(4),l=n(1),c=n(37),o=n(8),r=n(7),u=n(26),s=n(144),i=n(65),h=n(2),a=function(t){function e(t){this.reverseLightbox=d(this.reverseLightbox,this),this.loadPage=d(this.loadPage,this),e.__super__.constructor.call(this,t),this.initViews()}return g(e,t),e.prototype.initViews=function(){var t;return this.homeMenuView=new s,this.homeMenuView.on("pageSelect",function(t){return function(e){return t.loadPage(e)}}(this)),this.activityView=new i,this.activityView.on("back",this.loadPage),t=h.getViewportWidth(),this.lightbox=new c({inOrigin:[0,0],outOrigin:[1,0],showOrigin:[.5,.5],inTransform:l.translate(t,0,-300),outTransform:l.translate(-t,0,-1e3),inTransition:{duration:500,curve:o.outCubic},outTransition:{duration:350,curve:o.outCubic}}),this.add(this.lightbox),this.lightbox.show(this.homeMenuView),this.direction=1},e.prototype.loadPage=function(t){switch(t){case"Home":return this.reverseLightbox(),this.lightbox.show(this.homeMenuView);case"Activity":return this.reverseLightbox(),this.lightbox.show(this.activityView)}},e.prototype.reverseLightbox=function(){return-1===this.direction?(this.lightbox.setOptions({inTransform:l.translate(-h.getViewportWidth(),0,-1e3),outTransform:l.translate(h.getViewportWidth(),0,-300)}),this.direction=1):(this.lightbox.setOptions({outTransform:l.translate(-h.getViewportWidth(),0,-1e3),inTransform:l.translate(h.getViewportWidth(),0,-300)}),this.direction=-1)},e}(p),t.exports=a},function(t,e,n){var i,r,o,s,a={}.hasOwnProperty,c=function(t,e){function n(){this.constructor=t}for(var i in e)a.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};i=n(47)["public"],s=n(4),o=n(3),r=function(t){function e(t){e.__super__.constructor.call(this,t),filepicker.setKey(i.filepicker.apiKey)}return c(e,t),e.prototype.pick=function(t){return filepicker.pickAndStore({mimetype:"image/*"},{path:"/uploaded/"},function(e){var n;return n=e[0],n.fullS3=i.s3.bucket+e[0].key,filepicker.convert(e[0],{width:100,height:100,fit:"clip",format:"jpg"},{path:"/processed/"},function(){return function(e){return e.s3=i.s3.bucket+e.key,n.thumb=e,t(n)}}(this))})},e}(s),t.exports=r},function(t,e,n){var i,r,o,s,a,c,u,l,h,p,d,f=function(t,e){return function(){return t.apply(e,arguments)}},g={}.hasOwnProperty,m=function(t,e){function n(){this.constructor=t}for(var i in e)g.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};n(208),p=n(2),o=n(23),s=n(64),d=n(4),l=n(3),r=n(6),u=n(5),c=n(16),h=n(1),i=n(8),a=function(t){function e(){this.load=f(this.load,this),e.__super__.constructor.apply(this,arguments),this.layoutManager=new o,this.layout=this.layoutManager.getViewLayout("MessageView"),this.init()}return m(e,t),e.prototype.init=function(){var t,e;return this.mainMod=new c({origin:this.layout.wrapper.origin,align:this.layout.wrapper.align,transform:this.layout.wrapper.transform}),this.mainNode=this.add(this.mainMod),this.overlay=new l({classes:["message__overlay"]}),t=new c({size:this.layout.overlay.size}),this.mainNode.add(t).add(this.overlay),this.box=new l({classes:["message__box"]}),this.boxMod=new c({size:this.layout.box.size,origin:this.layout.box.origin,align:this.layout.box.align}),this.mainNode.add(this.boxMod).add(this.box),this.text=new l({content:"Help Text",classes:["message__text"]}),e=new c({size:this.layout.text.size,transform:this.layout.text.transform}),this.mainNode.add(e).add(this.text),this.okButton=new l({content:"OK",classes:["message__button"]}),this.okButtonMod=new c({size:this.layout.okButton.size,transform:this.layout.okButton.transform}),this.okButton.on("click",function(t){return function(){return t._eventOutput.emit("hide")}}(this)),this.mainNode.add(this.okButtonMod).add(this.okButton)},e.prototype.load=function(t){return"loading"===t.type?(t.message="loading...",this.boxMod.setOpacity(0),this.okButtonMod.setOpacity(0),this.text.setClasses(["message__text--loading"])):(this.text.setClasses(["message__text"]),this.okButtonMod.setOpacity(1),this.boxMod.setOpacity(1)),this.text.setContent(t.message)},e}(d),t.exports=a},function(t,e,n){var i,r,o,s,a,c,u,l,h,p,d,f,g,m,_,y,v,b,w,P,x,k,O=function(t,e){return function(){return t.apply(e,arguments)}},j={}.hasOwnProperty,C=function(t,e){function n(){this.constructor=t}for(var i in e)j.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};n(209),s=n(10),s=n(10),a=n(8),c=n(6),u=n(58),p=n(16),d=n(22),m=n(44),_=n(25),y=n(5),v=n(3),b=n(13),w=n(1),x=n(2),k=n(4),i=n(63),r=n(141),o=n(7),l=n(51),f=n(132),P=n(11),h=n(23),g=function(t){function e(){this.loadCategories=O(this.loadCategories,this),e.__super__.constructor.apply(this,arguments),this._numOfselectedCategories=0,this._selectedCategories={},this._selectedCategoriesSurface=null,this.layoutManager=new h,this.layout=this.layoutManager.getViewLayout("NewCardView"),this.initSurfaces(),this.initListeners()}return C(e,t),e.prototype.initListeners=function(){return f.on(o.stores.CATEGORIES_CHANGE,this.loadCategories),this.on("click:category",function(t){return function(e){var n;return n=t._selectedCategories[e.name],null!=n?(e.surface.removeClass("selected"),delete t._selectedCategories[e.name],t._numOfselectedCategories--):(e.surface.addClass("selected"),t._selectedCategories[e.name]=e.surface,t._numOfselectedCategories++),t._numOfselectedCategories?t.categoriesConfirm.show():t.categoriesConfirm.hide()}}(this)),this.categoriesConfirm.on("click:done",function(t){return function(){return t.hideCategories(),t._setCategoryText()}}(this))},e.prototype.loadCategories=function(){var t,e,n,i,r,o,s;for(t=f.getCategories(),i=o=0,s=t.length;s>o;i=++o)e=t[i],n=new v({size:this.layout.category.size,classes:this.layout.category.classes,content:"<span class='category-name'>"+e.get("name")+"</span>"}),this.categorySurfaces.push(n),n.on("click",function(t,e){return this._eventOutput.emit("click:category",{surface:t,id:e.id,name:e.get("name")})}.bind(this,n,e)),n.pipe(this.categoryScrollview);return r=new v({size:this.layout.categoriesConfirm.size,classes:this.layout.category.classes}),r.pipe(this.categoryScrollview),this.categorySurfaces.push(r)},e.prototype.initSurfaces=function(){var t,e,n,o,a;for(this.step1Mods=[],this.step1Inputs=[],this.step2Mods=[],this.step2Inputs=[],this.step4Mods=[],this.step3Mods=[],t=new c({size:this.layout.cardIcon.size,classes:this.layout.cardIcon.classes,content:"images/newcard_medium2.png"}),e=new y({origin:this.layout.cardIcon.origin,align:this.layout.cardIcon.align}),this.add(e).add(t),this.newCardTitle=new v({size:this.layout.newCardTitle.size,content:"NEW CARD",classes:this.layout.newCardTitle.classes}),o=new y({origin:this.layout.newCardTitle.origin,align:this.layout.newCardTitle.align}),this.add(o).add(this.newCardTitle),this.container=new s({size:[x.getViewportWidth(),x.getViewportHeight()],classes:["categoriesContainer"],properties:{overflow:"hidden"}}),this.categoryScrollviewMod=new y({origin:this.layout.categories.origin,align:this.layout.categories.align}),this.categoryScrollview=new _,this.categorySurfaces=[],this.categoryScrollview.sequenceFrom(this.categorySurfaces),this.container.add(this.categoryScrollview),this.add(this.categoryScrollviewMod).add(this.container),this.categoriesConfirm=new r({classes:["newcard"],size:this.layout.categoriesConfirm.size}),this.add(this.categoriesConfirm),this.addNum(1,0),this.addInputView(1,1,"Enter a question"),this.addButton(1,2,"Continue",function(t){return function(){var e;return e=t.step1Inputs[0].getValue(),e.length>5?(i.addQuestion(e),t.hideStep("step1",t.step1Mods,t.step1Inputs),t.step2()):alert("Please enter a question.")}}(this)),this.addNum(2,0),n=a=1;4>=a;n=++a)this.addInputView(2,n,"Answer option "+n);return this.addButton(2,5,"Continue",function(t){return function(){var e,n,r,o,s,a;for(n=[],a=t.step2Inputs,o=0,s=a.length;s>o;o++)r=a[o],e=r.getValue(),e.length>0&&n.push(e);
return n.length>=2?(i.addAnswers(n),t.hideStep("step2",t.step2Mods,t.step2Inputs),t.step3()):alert("Please enter at least 2 answer options.")}}(this)),this.addNum(3,0),this.addLinkContainer(3,1,"images/deck_existing.png","Choose mood(s) for this card",function(t){return function(){return t.showCategories()}}(this)),this._selectedCategoriesSurface=this.addSurface(3,2,""),this._resetSelectedCategories(),this.addButton(3,3,"Finish",function(t){return function(){return Object.keys(t._selectedCategories).length>0?(t.hideStep("step3",t.step3Mods),i.addCategories(Object.keys(t._selectedCategories)),t.step4()):alert("Please select a mood.")}}(this)),this.addSurface(4,0,"CREATED!"),this.addButton(4,1,"Play this card",function(t){return function(){var e;return e=f.getCard().id,t.hideStep("step4",t.step4Mods),f.newCard(),t.step1(),d.selectSingleCardItem(e,P.getUser().id,"create")}}(this)),this.addButton(4,2,"Create another card",function(t){return function(){return t.hideStep("step4",t.step4Mods),f.newCard(),t.step1()}}(this)),this.step1()},e.prototype.step1=function(){return this._resetSelectedCategories(),this.showStep("step1",this.step1Mods)},e.prototype.step2=function(){return b.after(function(t){return function(){return t.showStep("step2",t.step2Mods)}}(this),30)},e.prototype.step3=function(){return b.after(function(t){return function(){return t.showStep("step3",t.step3Mods)}}(this),30)},e.prototype.step4=function(){return b.after(function(t){return function(){return t.showStep("step4",t.step4Mods)}}(this),30)},e.prototype.showStep=function(t,e){var n,i,r,o,s;for(s=[],n=r=0,o=e.length;o>r;n=++r)i=e[n],s.push(x.animate(i,this.layout[""+t+"_"+n].states[0]));return s},e.prototype.hideStep=function(t,e,n){var i,r,o,s,a,c,u,l;for(n||(n=[]),i=s=0,c=e.length;c>s;i=++s)o=e[i],x.animate(o,this.layout[""+t+"_"+i].states[1]);for(l=[],a=0,u=n.length;u>a;a++)r=n[a],l.push(r.clear());return l},e.prototype.showCategories=function(){return x.animate(this.categoryScrollviewMod,this.layout.categories.states[0]),this._numOfselectedCategories?this.categoriesConfirm.show():void 0},e.prototype.hideCategories=function(){return x.animate(this.categoryScrollviewMod,this.layout.categories.states[1])},e.prototype._resetSelectedCategories=function(){var t,e,n;n=this._selectedCategories;for(t in n)e=n[t],e.removeClass("selected");return this._numOfselectedCategories=0,this._selectedCategories={},this._selectedCategoriesSurface.setContent("(no moods selected)")},e.prototype._setCategoryText=function(){var t;return t=Object.keys(this._selectedCategories),this._selectedCategoriesSurface.setContent(t.join(", "))},e.prototype.addInputView=function(t,e,n){var i,r;return i=new l({size:this.layout["step"+t+"_"+e].size,placeholder:n,align:this.layout["step"+t+"_"+e].states[0].align,origin:this.layout["step"+t+"_"+e].origin,transform:this.layout["step"+t+"_"+e].states[0].transform}),r=new y({origin:this.layout["step"+t+"_"+e].origin,align:this.layout["step"+t+"_"+e].align}),this["step"+t+"Mods"].push(r),this["step"+t+"Inputs"].push(i),this.add(r).add(i)},e.prototype.addSurface=function(t,e,n){var i,r;return i=new v({size:this.layout["step"+t+"_"+e].size,content:n,classes:this.layout["step"+t+"_"+e].classes}),r=new y({align:this.layout["step"+t+"_"+e].align,origin:this.layout["step"+t+"_"+e].origin}),this["step"+t+"Mods"].push(r),this.add(r).add(i),i},e.prototype.addNum=function(t,e){var n,i;return i=new v({size:this.layout["step"+t+"_"+e].size,content:t,classes:this.layout["step"+t+"_"+e].classes}),n=new y({origin:this.layout["step"+t+"_"+e].origin,align:this.layout["step"+t+"_"+e].align}),this["step"+t+"Mods"].push(n),this.add(n).add(i)},e.prototype.addButton=function(t,e,n,i){var r,o;return r=new v({size:this.layout["step"+t+"_"+e].size,content:n,classes:this.layout["step"+t+"_"+e].classes,properties:{lineHeight:this.layout["step"+t+"_"+e].size[1]+"px"}}),o=new y({origin:this.layout["step"+t+"_"+e].origin,align:this.layout["step"+t+"_"+e].align}),this["step"+t+"Mods"].push(o),this.add(o).add(r),r.on("click",i)},e.prototype.addLinkContainer=function(t,e,n,i,r){var o,a,u,l,h,p;return l=new c({size:this.layout["step"+t+"_"+e].size[1],classes:this.layout["step"+t+"_"+e].classes.image,content:n}),u=new y({origin:[0,.5],align:[0,.5]}),p=new v({size:this.layout["step"+t+"_"+e].size[2],content:i,classes:this.layout["step"+t+"_"+e].classes.text,properties:{lineHeight:""+this.layout["step"+t+"_"+e].size[0]+"px"}}),h=new y({origin:[0,.5],align:[.25,.5]}),o=new s({size:this.layout["step"+t+"_"+e].size[0]}),o.add(u).add(l),o.add(h).add(p),a=new y({origin:this.layout["step"+t+"_"+e].origin,align:this.layout["step"+t+"_"+e].align}),this["step"+t+"Mods"].push(a),this.add(a).add(o),o.on("click",r)},e}(k),t.exports=g},function(t,e,n){var i,r,o,s,a,c,u={}.hasOwnProperty,l=function(t,e){function n(){this.constructor=t}for(var i in e)u.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};n(72),c=n(4),i=n(10),s=n(25),r=n(67),a=n(2),o=function(t){function e(){e.__super__.constructor.apply(this,arguments),this.init()}return l(e,t),e.DEFAULT_OPTIONS={itemDensity:null},e.prototype.init=function(){return this.items=[]},e.prototype.load=function(t){var e,n,o,c,u;for(this.items=t,u=[],c=new s({size:[a.getViewportWidth(),a.getViewportHeight()]}),c.sequenceFrom(u),n=0;n<this.items.length;)o=new r(this.items[n]),o.on("scroll",function(t){return function(){return t._eventOutput.emit("scroll")}}(this)),o.pipe(c),u.push(o),n++;return e=new i({size:[void 0,void 0],properties:{overflow:"hidden"}}),e.add(c),this.add(e)},e}(c),t.exports=o},function(t,e,n){var i,r,o,s,a,c,u,l,h,p,d,f,g={}.hasOwnProperty,m=function(t,e){function n(){this.constructor=t}for(var i in e)g.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};n(74),f=n(4),h=n(3),s=n(6),l=n(5),a=n(16),p=n(1),r=n(8),o=n(59),d=n(2),i=n(10),u=n(27),c=function(t){function e(){e.__super__.constructor.apply(this,arguments),this.init()}return m(e,t),e.prototype.cssPrefix="moods",e.DEFAULT_OPTIONS={cols:2},e.prototype.init=function(){var t,e,n,i;return this.day=new h({size:[d.getViewportWidth(),100],classes:[""+this.cssPrefix+"__welcome",""+this.cssPrefix+"__text--yellow"]}),t=new a({origin:[.5,0],align:[.5,.05]}),this.add(t).add(this.day),n=new h({size:[d.getViewportWidth(),100],content:"How are you <br/> feeling?",classes:[""+this.cssPrefix+"__title"]}),i=new a({origin:[.5,0],align:[.5,.1]}),this.add(i).add(n),this.grid=new o({cellSize:[d.getViewportWidth()/2-10,d.getViewportWidth()/2-10],dimensions:[2,2],transition:{curve:"easeInOut",duration:800},gutterSize:[0,0]}),this.surfaces=[],this.grid.sequenceFrom(this.surfaces),e=new l({size:[d.getViewportWidth(),d.getViewportWidth()],origin:[.5,0],align:[.5,.3]}),this.add(e).add(this.grid)},e.prototype.load=function(t){var e,n,i,r,o,s,a;for(r=[],o=Math.floor(Math.random()*t.length),r.push(o),i=a=0;3>=a;i=++a){for(;-1!==r.indexOf(o);)o=Math.floor(Math.random()*t.length);r.push(o),this._addMood(t[o].id,t[o].get("iconUrl"),t[o].get("name"))}return n=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],s=new Date,e=s.getDay(),this.day.setContent("Happy "+n[e]+"!")},e.prototype._addMood=function(t,e,n){var r,o,c,l,p;return r=new i({size:[d.getViewportWidth()/2,d.getViewportWidth()/2],classes:[""+this.cssPrefix+"__box"]}),r.on("click",function(){return function(){return u.mood(n,t,e)}}(this)),o=new s({content:e,size:[d.getViewportWidth()/2-80,d.getViewportWidth()/2-80],classes:[""+this.cssPrefix+"__box__image"]}),c=new a({origin:[.5,0],align:[.5,0]}),r.add(c).add(o),l=new h({content:n,size:[d.getViewportWidth()/2-50,50],classes:[""+this.cssPrefix+"__box__text"]}),p=new a({origin:[.5,.9],align:[.5,.9]}),r.add(p).add(l),this.surfaces.push(r)},e.prototype.rearrange=function(){return this.grid.setOptions({dimensions:[3,2]})},e}(f),t.exports=c},function(t,e,n){var i,r,o,s,a,c,u,l,h,p,d,f,g,m,_,y,v={}.hasOwnProperty,b=function(t,e){function n(){this.constructor=t}for(var i in e)v.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};n(34),y=n(4),p=n(3),r=n(6),h=n(5),f=n(1),d=n(13),s=n(27),i=n(10),g=n(11),m=n(15),u=n(25),o=n(69),_=n(2),c=n(20),l=n(45),a=function(t){function e(t){e.__super__.constructor.call(this,t),this._sequence=[],this.scrollview=null,this.init()}return b(e,t),e.DEFAULT_OPTIONS={width:_.getViewportWidth(),height:_.getViewportHeight()-50,origin:[0,1],align:[0,1]},e.prototype.init=function(){var t,e,n,o,a,l;return this.scrollview=new u({size:[_.getViewportWidth(),_.getViewportHeight()-50],align:[0,1],origin:[0,1]}),this.scrollview.sequenceFrom(this._sequence),t=new i({size:[_.getViewportWidth(),_.getViewportHeight()-50],align:[0,1],origin:[0,1]}),t.add(this.scrollview),t.pipe(this.scrollview),this.add(t),this.titleNode=new c,this.title=new p({classes:["status__pegg__title"],properties:{marginTop:"50px"},size:[_.getViewportWidth(),160]}),l=new h({align:[.5,0],origin:[.5,0]}),this.titleNode.add(this.title).add(l),this.title.pipe(this.scrollview),this.nextNode=new c,e=new r({content:"images/continue_big_text.png",size:[60,120]}),n=new h({align:[.6,0],origin:[0,1]}),e.pipe(this.scrollview),this.nextNode.add(n).add(e),this.shareNode=new c,o=new r({content:"images/share_big_text.png",size:[48,95]}),a=new h({align:[.2,0],origin:[0,0]}),o.pipe(this.scrollview),this.shareNode.add(a).add(o),e.on("click",function(t){return function(){return s.badgesViewed(t.badge)}}(this)),this.load()},e.prototype.load=function(t){var e,n,i,o,s,a;if(null!=t)return this.badge=t,this._sequence.length=0,this.title.setContent("Congratulations! <br/> You've leveled up, unicorn."),this._sequence.push(this.titleNode),a=new c,o=new r({classes:["status__pegg__pic"],size:[150,150],properties:{borderRadius:"200px"}}),s=new h({align:[.5,0],origin:[.5,0]}),a.add(s).add(o),o.pipe(this.scrollview),o.setContent(this.badge.image),this._sequence.push(a),i=new c,e=new p({classes:["status__pegg__title"],size:[_.getViewportWidth(),120],properties:{marginTop:"20px"}}),n=new h({align:[.5,0],origin:[.5,0]}),i.add(e).add(n),e.pipe(this.scrollview),e.setContent(this.badge.name),this._sequence.push(i),this._sequence.push(this.shareNode),this._sequence.push(this.nextNode),this.scrollview.goToPage(0)},e}(y),t.exports=a},function(t,e,n){var i,r,o,s,a,c,u,l,h,p,d,f,g,m,_,y,v,b,w,P,x,k,O,j,C,S,A=function(t,e){return function(){return t.apply(e,arguments)}},T={}.hasOwnProperty,E=function(t,e){function n(){this.constructor=t}for(var i in e)T.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};n(76),S=n(4),p=n(16),v=n(5),s=n(10),u=n(6),j=n(15),b=n(3),x=n(1),c=n(40),d=n(49),P=n(41),w=n(13),k=n(21),C=n(2),o=n(7),_=n(26),f=n(27),i=n(136),r=n(140),l=n(51),m=n(153),h=n(23),O=n(11),y=n(44),a=n(8),g=function(t){function e(t){this._translateToAlign=A(this._translateToAlign,this),this.expandComments=A(this.expandComments,this),this.collapseComments=A(this.collapseComments,this),this.hideComments=A(this.hideComments,this),this.showComments=A(this.showComments,this),this.showPoints=A(this.showPoints,this),this.cardWin=A(this.cardWin,this),this.cardFail=A(this.cardFail,this),this.cardPref=A(this.cardPref,this),this.prevPage=A(this.prevPage,this),this.nextPage=A(this.nextPage,this),this.loadComments=A(this.loadComments,this),this.load=A(this.load,this),e.__super__.constructor.call(this,t),this.layoutManager=new h,this.layout=this.layoutManager.getViewLayout("PlayView"),this._viewportHeight=C.getViewportHeight(),this._viewportWidth=C.getViewportWidth(),this.cardYPos=new k(0),this.cardXAlign=new k(0),this.initViews(),this.initListeners(),this.initGestures()}return E(e,t),e.prototype.initListeners=function(){return _.on(o.stores.PREF_SAVED,this.cardPref),_.on(o.stores.CARD_FAIL,this.cardFail),_.on(o.stores.CARD_WIN,function(t){return function(e){return t.cardWin(e)}}(this)),this.cardView.on("comment",function(t){return function(){return t.collapseComments()}}(this)),this.cardView.on("pegg",function(){return function(t){return f.pegg(t.peggeeId,t.id,t.choiceId,t.answerId)}}(this)),this.cardView.on("pref",function(){return function(t){return f.pref(t.id,t.choiceId,t.plug,t.thumb)}}(this)),this.cardView.on("plug",function(){return function(t){return f.plug(t.id,t.full,t.thumb)}}(this)),this.cardView.pipe(this)},e.prototype.initViews=function(){return this.cardView=new i,this.cardViewMod=new p({align:function(t){return function(){var e;return e=t._translateToAlign(t.cardYPos.get(),"Y"),[t.layout.cards.align[0],t.layout.cards.align[1]+e]}}(this),origin:this.layout.cards.origin}),this.add(this.cardViewMod).add(this.cardView),this.navView=new m,this.navView._eventOutput.on("click",function(t){return function(e){return"prevPage"===e?t.prevPage():"nextPage"===e?t.nextPage():void 0}}(this)),this.add(this.navView),this.navView.hideRightArrow(),this.commentsView=new r,this.newComment=new l({size:this.layout.newComment.size,placeholder:"Enter a comment...",align:this.layout.newComment.states[1].align,origin:this.layout.newComment.origin}),this.newCommentMod=new v({align:this.layout.newComment.align,origin:this.layout.newComment.origin}),this.add(this.newCommentMod).add(this.newComment),this.newComment.on("submit",function(t){return function(e){return t.newComment.setValue(""),t.saveComment(e)}}(this)),this.numComments=new b({size:this.layout.numComments.size,content:"x comments...",classes:["comments__text","comments__num"]}),this.numCommentsMod=new v({align:this.layout.numComments.align,origin:this.layout.numComments.origin}),this.add(this.numCommentsMod).add(this.numComments),this.numComments.on("click",function(t){return function(){return t.expandComments()}}(this)),this.hideComments(),this.rc=new y({inTransition:{duration:500,curve:a.outCubic},outTransition:{duration:350,curve:a.outCubic}}),this.rc.hide(this.commentsView),this.rcMod=new v({align:this.layout.comments.align,origin:this.layout.comments.origin}),this.add(this.rcMod).add(this.rc),this.points=new b({size:this.layout.points.size,classes:this.layout.points.classes}),this.pointsMod=new p({align:this.layout.points.align,origin:this.layout.points.origin,transform:this.layout.points.transform}),this.add(this.pointsMod).add(this.points)},e.prototype.initGestures=function(){var t,e,n,i;return c.register({mouse:d}),c.register({touch:P}),n=.5,e=100,this.sync=new c(["mouse","touch"]),this._eventInput.on("card:flipped",function(t){return function(){return t._commentsIsExpanded?t.collapseComments():void 0}}(this)),this._eventInput.pipe(this.sync),t=!1,i=0,this.sync.on("start",function(t){return function(){return i=t.cardYPos.get()}}(this)),this.sync.on("update",function(e){var n,i,r,o;return i=e.delta[1],t||Math.abs(i)>0&&(t=!0),t?(n=this.cardYPos.get(),r=this.layout.cards.states[1].align[1]*C.getViewportHeight(),o=Math.min(Math.abs(r),Math.abs(n+i)),this.cardYPos.set(-o)):void 0}.bind(this)),this.sync.on("end",function(r){var o,s;return t&&(s=r.velocity[1],o=i-this.cardYPos.get(),o>e&&Math.abs(s)>n?this.expandComments():-e>o&&Math.abs(s)>n?this.collapseComments():o&&(this._commentsIsExpanded?this.expandComments():this.collapseComments())),t=!1}.bind(this))},e.prototype.load=function(t){return this.card=t,this.cardView.loadCard(t,"play"),null!=t.comments?this.loadComments():void 0},e.prototype.loadComments=function(){return this.commentsView.load(this.card.comments),this.numComments.setContent(""+this.commentsView.getCount()+" comments.")},e.prototype.nextPage=function(){return f.nextPage(),this.navView.hideRightArrow(),this.hideComments()},e.prototype.prevPage=function(){return f.prevPage()},e.prototype.cardPref=function(){return this.showComments(),this.navView.showRightArrow()},e.prototype.cardFail=function(){},e.prototype.cardWin=function(t){return this.showPoints(t),this.showComments(),this.navView.showRightArrow()},e.prototype.showPoints=function(t){return console.log("points: "+t),this.points.setContent("+"+t),C.animateAll(this.pointsMod,this.layout.points.states)},e.prototype.showComments=function(){return C.animate(this.numCommentsMod,this.layout.numComments.states[0])},e.prototype.hideComments=function(){return C.animate(this.numCommentsMod,this.layout.numComments.states[1])},e.prototype.saveComment=function(t){var e;return f.comment(t,this.card.id,this.card.peggeeId),e={userImg:O.getAvatar("type=square"),text:t},this.card.comments.unshift(e),this.loadComments()},e.prototype.collapseComments=function(){return this.rc.hide(this.commentsView),this.navView.showNav(),this.cardYPos.set(0,this.layout.cards.states[0].transition),C.animate(this.numCommentsMod,this.layout.numComments.states[0]),this._commentsIsExpanded=!1,this.newComment.setAlign(this.layout.newComment.states[0].align)},e.prototype.expandComments=function(){var t;return this.rc.show(this.commentsView),this.navView.hideNav(),t=this.layout.cards.states[1].align[1]*C.getViewportHeight(),this.cardYPos.set(t,this.layout.cards.states[1].transition),C.animate(this.numCommentsMod,this.layout.numComments.states[1]),this._commentsIsExpanded=!0,this.newComment.setAlign(this.layout.newComment.states[1].align)},e.prototype._translateToAlign=function(t,e){return"Y"===e?t/this._viewportHeight:"X"===e?t/this._viewportWidth:null},e}(S),t.exports=g},function(t,e,n){var i,r,o,s,a,c,u,l,h,p,d,f,g=function(t,e){return function(){return t.apply(e,arguments)}},m={}.hasOwnProperty,_=function(t,e){function n(){this.constructor=t}for(var i in e)m.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};f=n(4),l=n(5),h=n(3),r=n(6),p=n(1),u=n(20),d=n(2),i=n(7),a=n(26),o=n(23),c=n(160),s=function(t){function e(t){this.updateNav=g(this.updateNav,this),this.hideRightArrow=g(this.hideRightArrow,this),this.showRightArrow=g(this.showRightArrow,this),this.hideLeftArrow=g(this.hideLeftArrow,this),this.showLeftArrow=g(this.showLeftArrow,this),this.loadNav=g(this.loadNav,this),this.hideNav=g(this.hideNav,this),this.showNav=g(this.showNav,this),this.initEvents=g(this.initEvents,this),this.initSurfaces=g(this.initSurfaces,this),e.__super__.constructor.call(this,t),this.layoutManager=new o,this.layout=this.layoutManager.getViewLayout("PlayNavView"),this.initSurfaces(),this.initEvents(),this.initListeners()}return _(e,t),e.DEFAULT_OPTIONS={cardType:"pegg"},e.prototype.initListeners=function(){return a.on(i.stores.GAME_LOADED,this.loadNav),a.on(i.stores.PAGE_CHANGE,this.updateNav)},e.prototype.initSurfaces=function(){return this.mainMod=new l({size:this.layout.wrapper.size,align:this.layout.wrapper.align,origin:this.layout.wrapper.origin,transform:this.layout.wrapper.transform}),this.leftArrow=new r({size:this.layout.leftArrow.size,content:"/images/left-arrow.png",classes:this.layout.leftArrow.classes}),this.leftArrowMod=new l({align:this.layout.leftArrow.align,origin:this.layout.leftArrow.origin}),this.moodImage=new r({size:this.layout.moodImage.size,classes:this.layout.moodImage.classes}),this.moodImageMod=new l({align:this.layout.moodImage.align,origin:this.layout.moodImage.origin}),this.progressBar=new c,this.progressBarMod=new l({align:this.layout.progress.align,origin:this.layout.progress.origin}),this.rightArrow=new r({size:this.layout.rightArrow.size,content:"/images/right-arrow.png",classes:this.layout.rightArrow.classes}),this.rightArrowMod=new l({align:this.layout.rightArrow.align,origin:this.layout.rightArrow.origin}),this.title=new h({size:this.layout.title.size,content:"",classes:this.layout.title.classes}),this.titleMod=new l({align:this.layout.title.align,origin:this.layout.title.origin,transform:this.layout.title.transform}),this.node=this.add(this.mainMod),this.node.add(this.rightArrowMod).add(this.rightArrow),this.node.add(this.titleMod).add(this.title),this.node.add(this.moodImageMod).add(this.moodImage),this.node.add(this.progressBarMod).add(this.progressBar)},e.prototype.initEvents=function(){return this.leftArrow.on("click",function(t){return function(){return t._eventOutput.emit("click","prevPage")}}(this)),this.rightArrow.on("click",function(t){return function(){return t._eventOutput.emit("click","nextPage")}}(this))},e.prototype.showNav=function(){return d.animate(this.mainMod,this.layout.wrapper.states[0])},e.prototype.hideNav=function(){return d.animate(this.mainMod,this.layout.wrapper.states[1])},e.prototype.loadNav=function(){var t;return t=a.getGameState(),this.moodImage.setContent(t.mood.url),this.progressBar.reset(t.size)},e.prototype.showLeftArrow=function(){return d.animate(this.leftArrowMod,this.layout.leftArrow.states[0])},e.prototype.hideLeftArrow=function(){return d.animate(this.leftArrowMod,this.layout.leftArrow.states[1])},e.prototype.showRightArrow=function(){return d.animate(this.rightArrowMod,this.layout.rightArrow.states[0])},e.prototype.hideRightArrow=function(){return d.animate(this.rightArrowMod,this.layout.rightArrow.states[1])},e.prototype.updateNav=function(){var t;return t=a.getGameState(),this.title.setContent(t.title),this.progressBar.increment(1)},e}(f),t.exports=s},function(t,e,n){var i,r,o,s,a,c,u,l,h,p,d,f,g,m,_,y={}.hasOwnProperty,v=function(t,e){function n(){this.constructor=t}for(var i in e)y.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};_=n(4),d=n(3),s=n(6),p=n(5),g=n(1),f=n(13),u=n(27),i=n(10),c=n(70),h=n(71),r=n(66),m=n(2),a=n(37),o=n(8),l=function(t){function e(t){e.__super__.constructor.call(this,t),this.init()}return v(e,t),e.prototype.init=function(){var t;return this.prefStatus=new h(this.options.view),this.peggStatus=new c(this.options.view),this.doneStatus=new r(this.options.view),t=m.getViewportWidth(),this.lightbox=new a({inOrigin:[0,0],outOrigin:[1,0],showOrigin:[.5,.5],inTransform:g.translate(t,0,-300),outTransform:g.translate(-t,0,-1e3),inTransition:{duration:500,curve:o.outCubic},outTransition:{duration:350,curve:o.outCubic}}),this.add(this.lightbox)},e.prototype.load=function(t){switch(t.type){case"friend_ranking":return this.peggStatus.load(t),this.lightbox.show(this.peggStatus);case"likeness_report":return this.prefStatus.load(t),this.lightbox.show(this.prefStatus);case"peggs_done":case"prefs_done":return this.doneStatus.load(t),this.lightbox.show(this.doneStatus)}},e.prototype.hide=function(){return this.lightbox.hide()},e}(_),t.exports=l},function(t,e,n){var i,r,o,s,a,c,u,l,h,p,d,f,g,m,_,y=function(t,e){return function(){return t.apply(e,arguments)}},v={}.hasOwnProperty,b=function(t,e){function n(){this.constructor=t}for(var i in e)v.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};_=n(4),g=n(1),s=n(37),o=n(8),i=n(7),p=n(26),l=n(152),h=n(154),u=n(151),c=n(150),a=n(70),f=n(71),r=n(66),m=n(2),d=function(t){function e(t){this.loadPage=y(this.loadPage,this),this.loadBadge=y(this.loadBadge,this),this.loadMoods=y(this.loadMoods,this),e.__super__.constructor.call(this,t),this.initViews(),this.initListeners()}return b(e,t),e.prototype.initListeners=function(){return p.on(i.stores.PAGE_CHANGE,this.loadPage),p.on(i.stores.BADGE_CHANGE,this.loadBadge),p.on(i.stores.MOODS_LOADED,this.loadMoods)},e.prototype.initViews=function(){var t;return this.pickMood=new c,this.playCardView=new l,this.badgesView=new u,this.prefStatus=new f,this.peggStatus=new a,this.doneStatus=new r,t=m.getViewportWidth(),this.lightbox=new s({inOrigin:[0,0],outOrigin:[1,0],showOrigin:[.5,.5],inTransform:g.translate(t,0,-300),outTransform:g.translate(-t,0,-1e3),inTransition:{duration:500,curve:o.outCubic},outTransition:{duration:350,curve:o.outCubic}}),this.add(this.lightbox)},e.prototype.loadMoods=function(){return this.pickMood.load(p.getMoods()),this.lightbox.show(this.pickMood)},e.prototype.loadBadge=function(){return this.badgesView.load(p.getBadge()),this.lightbox.show(this.badgesView)},e.prototype.loadPage=function(){var t;switch(t=p.getCurrentPage(),t.type){case"card":return this.playCardView.load(t.card),this.lightbox.show(this.playCardView);case"topPeggers":return this.peggStatus.load(t.stats),this.lightbox.show(this.peggStatus);case"prefPopularities":return this.prefStatus.load(t.stats),this.lightbox.show(this.prefStatus);case"done":return this.lightbox.show(this.doneStatus)}},e}(_),t.exports=d},function(t,e,n){var i,r,o,s,a,c,u,l,h,p,d=function(t,e){return function(){return t.apply(e,arguments)}},f={}.hasOwnProperty,g=function(t,e){function n(){this.constructor=t}for(var i in e)f.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};n(34),p=n(4),u=n(3),r=n(6),c=n(5),l=n(1),i=n(10),a=n(45),s=n(20),h=n(2),o=function(t){function e(t){this.load=d(this.load,this),e.__super__.constructor.call(this,t),this._sequence=[],this._choices=[],this._percentages=[],this._question="",this._total=0,this._init()}return g(e,t),e.prototype._init=function(){var t,e,n,i;for(i=new a({align:[.5,.5],origin:[.5,.5],itemSpacing:10}),i.sequenceFrom(this._sequence),n=new s({size:[h.getViewportWidth()-60,40]}),this._question=new u({classes:["status__pref__question"],size:[h.getContentWidth()-40,!0]}),this._question.pipe(this._eventOutput),e=new c({align:[0,0],origin:[0,0],transform:l.translate(30,null,null)}),n.add(e).add(this._question),this._sequence.push(n),t=0;4>t;)this._addChoice(t),t++;return this.add(i)},e.prototype._addChoice=function(t){var e,n,i,r,o,a,p,d,f,g;switch(t){case 0:r=["status__pref__percentage--red"];break;case 1:r=["status__pref__percentage--yellow"];break;case 2:r=["status__pref__percentage--green"];break;case 3:r=["status__pref__percentage--blue"]}return g=new c({align:[0,0],origin:[0,0],size:[void 0,40]}),p=new s(g),o=new u({classes:r}),o.pipe(this._eventOutput),d=new u({classes:["status__pref__percentage"],content:"0%"}),d.pipe(this._eventOutput),a=new c({align:[0,0],origin:[0,0],size:[3,40],transform:l.translate(30,null,null)}),f=new c({align:[0,0],origin:[0,0],size:[null,40],transform:l.translate(30,null,null)}),p.add(a).add(o),p.add(f).add(d),this._sequence.push(p),this._percentages.push({bar:o,barMod:a,text:d,textMod:f}),i=new s({size:[h.getViewportWidth()-60,40]}),e=new u({classes:["status__pref__choice"],size:[h.getViewportWidth()-60,!0]}),n=new c({align:[0,0],origin:[0,0],transform:l.translate(30,null,null)}),e.pipe(this._eventOutput),i.add(n).add(e),this._sequence.push(i),this._choices.push(e)},e.prototype.load=function(t){var e,n,i,r,o,s,a;this._question.setContent(t.question),this._total=t.total,null==this._total&&(this._total=1),console.log(t),i=0,s=t.choices,a=[];for(r in s)if(f.call(s,r)){if(e=s[r],null==e.count&&(e.count=0),this._choices[i].setContent(e.text),this._choices[i].setSize([h.getViewportWidth()-60,!0]),n=e.count/this._total,isFinite(n)||(n=0),o=(h.getViewportWidth()-60)*n+3,this._percentages[i].bar.setSize([o,40]),this._percentages[i].text.setContent(""+Math.round(100*n)+"%"),.25>n&&this._percentages[i].textMod.setTransform(l.translate(o+30,null,null)),this._question.setSize([h.getContentWidth()-40,!0]),3===i)break;a.push(i++)}return a},e}(p),t.exports=o},function(t,e,n){var i,r,o,s,a,c,u,l,h,p={}.hasOwnProperty,d=function(t,e){function n(){this.constructor=t}for(var i in e)p.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};n(77),h=n(4),u=n(1),c=n(3),a=n(5),r=n(6),i=n(10),o=n(22),l=n(2),s=function(t){function e(t){e.__super__.constructor.call(this,t),this.init()}return d(e,t),e.DEFAULT_OPTIONS={itemID:null,message:null,pic:null,height:100},e.prototype.init=function(){return this.build()},e.prototype.build=function(){var t,e,n,s,h,p,d,f,g;return t=new i({size:[l.getViewportWidth(),this.options.height],classes:["profile__activity__item"]}),t.pipe(this._eventOutput),d=this.options.data.question,p=this.options.data.plug,n=null!=this.options.data.hasPegged?this.options.data.hasPegged.length:0,e="<div class='outerContainer'> <div class='innerContainer'> "+d.truncate(55)+" <br/> <span class='numPeggers'>Peggs "+n+"</span> </div> </div>",f=new c({size:[l.getViewportWidth()-100,void 0],content:e,classes:["profile__activity__item__text"]}),g=new a({origin:[0,0],align:[0,0],transform:u.translate(70,null,null)}),t.add(g).add(f),s=new r({size:[50,50],classes:["profile__activity__item__pic"],content:p}),h=new a({origin:[0,.5],align:[0,.5]}),t.add(h).add(s),this.add(t),t.on("click",function(){return o.selectSingleCardItem(this.options.data.cardId,this.options.data.userId,"profile")}.bind(this))},e}(h),t.exports=s},function(t,e,n){var i,r,o,s,a,c,u,l,h,p,d,f={}.hasOwnProperty,g=function(t,e){function n(){this.constructor=t}for(var i in e)f.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};d=n(4),u=n(3),i=n(10),o=n(6),c=n(5),l=n(1),r=n(8),h=n(11),s=n(22),p=n(2),a=function(t){function e(t){e.__super__.constructor.call(this,t),this.init()}return g(e,t),e.DEFAULT_OPTIONS={avatarWidth:150,avatarHeight:150,width:p.getViewportWidth(),height:200,avatar:"",firstname:"",bio:"User one liner here"},e.prototype.init=function(){var t,e,n,i,a;return this.mainMod=new c({origin:[0,0],align:[0,0],size:[this.options.width,this.options.height]}),this.backing=new u({size:[this.options.width,this.options.height],classes:["profileHeader","profileHeader__backing"],properties:{background:"url('"+this.options.avatar+"')",backgroundSize:"100%"}}),this.pic=new o({size:[this.options.avatarWidth,this.options.avatarWidth],content:this.options.avatar,classes:["profileHeader","profile__pic"],properties:{borderRadius:"99em"}}),a=new c({align:[.5,0],origin:[.5,0]}),this.name=new u({size:[270,35],classes:["profileHeader","profile__name__box"],content:""+this.options.firstname+"'s <strong>profile</strong>"}),n=new c({align:[.5,0],origin:[.5,1]}),t=new u({size:[200,40],content:"Logout",classes:["profileHeader","profile__logout"]}),e=new c({align:[.5,1],origin:[.5,1]}),t.on("click",function(){return h.logout(),s.logout()}),i=this.add(this.mainMod),i.add(this.backing),i.add(n).add(this.name),i.add(e).add(t),n.setTransform(l.translate(0,160,0),{duration:500,easing:r.outCubic})},e.prototype.setAvatar=function(t){return this.setOptions({avatar:t}),this.backing.setProperties({background:"url('"+t+"')"})},e.prototype.setFirstname=function(t){return this.setOptions({firstname:t}),this.name.setContent(""+this.options.firstname+"'s <strong>profile</strong>")},e}(d),t.exports=a},function(t,e,n){var i,r,o,s,a,c,u,l,h,p,d,f,g,m,_,y,v,b,w,P,x,k,O,j,C,S=function(t,e){return function(){return t.apply(e,arguments)}},A={}.hasOwnProperty,T=function(t,e){function n(){this.constructor=t}for(var i in e)A.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};n(77),o=n(10),s=n(8),a=n(40),c=n(6),u=n(16),l=n(49),f=n(20),g=n(25),m=n(45),_=n(5),y=n(3),v=n(13),b=n(41),w=n(1),P=n(21),O=n(15),C=n(4),i=n(38),r=n(7),h=n(157),p=n(158),x=n(28),k=n(11),j=n(2),d=function(t){function e(t){this._loadActivity=S(this._loadActivity,this),this._loadUser=S(this._loadUser,this),e.__super__.constructor.call(this,t),this.setOptions({profileContainerHeight:(j.getViewportHeight()-this.options.headerHeight)*this.options.profileContainerRatio}),this.init(),this.initListeners()}return T(e,t),e.DEFAULT_OPTIONS={headerHeight:50,profileContainerWidth:j.getViewportWidth(),profileContainerHeight:j.getViewportHeight(),profileContainerRatio:.4,width:j.getViewportWidth(),height:j.getViewportHeight(),transition:{duration:500,curve:s.outExpo}},e.prototype.initListeners=function(){return k.on(r.stores.CHANGE,this._loadUser),k.on(r.stores.PROFILE_ACTIVITY_CHANGE,this._loadActivity)},e.prototype.init=function(){return this._initFilterBar(),this.mainMod=new u({align:[0,0],origin:[0,0]}),this.profileHeader=new p({avatarWidth:150,avatarHeight:150,width:this.options.profileContainerWidth,height:this.options.profileContainerHeight}),this.container=new o({size:[this.options.width,this.options.height-this.options.headerHeight],classes:["profilepage"],properties:{overflow:"hidden"}}),this.scrollview=new g({direction:O.Direction.Y,paginated:!1}),this.permanentRows=[this.profileHeader,this.prefBoardHeaderNode],this.rows=[].concat(this.permanentRows),this.mainNode=this.add(this.mainMod),this.container.add(this.scrollview),this.mainNode.add(this.container)
},e.prototype._initFilterBar=function(){var t,e,n;return this.prefBoardHeaderNode=new f,this.prefBoardHeaderButtons=[],e=new _({size:[void 0,this.options.headerHeight]}),t=new y({size:[void 0,this.options.headerHeight],classes:["peggBoardHeader","peggBoardHeader__bg"]}),this._addFilterBarButton("Recent",function(){return x.filterPrefs("recent")}),this._addFilterBarButton("Popular",function(){return x.filterPrefs("popular")}),this._addFilterBarButton("Search",function(){return x.filterPrefs("search")}),n=new m({direction:O.Direction.X}),n.sequenceFrom(this.prefBoardHeaderButtons),this.prefBoardHeaderNode=this.prefBoardHeaderNode.add(e),this.prefBoardHeaderNode.add(t),this.prefBoardHeaderNode.add(n)},e.prototype._addFilterBarButton=function(t,e,n){var i,r,o;return t=t||"",e=e||function(){},n=n||3,r=j.getViewportWidth()/n,i=this.options.headerHeight,o=new y({content:t,size:[r,i],classes:["peggBoardHeader","peggBoardHeader__button"],properties:{textAlign:"center",lineHeight:i+"px"}}),o.on("click",e),this.prefBoardHeaderButtons.push(o)},e.prototype._loadUser=function(){return this.profileHeader.setAvatar(k.getAvatar("height=150&type=normal&width=150")),this.profileHeader.setFirstname(k.getName("first"))},e.prototype._loadActivity=function(){var t,e,n,i,r;if(this.rows=[].concat(this.permanentRows),t=k.getProfileActivity(),null!=t)for(i=0,r=t.length;r>i;i++)e=t[i],n=new h({data:e}),n.pipe(this.scrollview),this.rows.push(n);return this.scrollview.sequenceFrom(this.rows)},e}(C),t.exports=d},function(t,e,n){var i,r,o,s,a,c,u,l,h,p,d,f=function(t,e){return function(){return t.apply(e,arguments)}},g={}.hasOwnProperty,m=function(t,e){function n(){this.constructor=t}for(var i in e)g.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};n(76),d=n(4),u=n(3),r=n(6),c=n(5),h=n(1),l=n(13),p=n(2),i=n(10),a=n(45),o=n(23),s=function(t){function e(t){this.increment=f(this.increment,this),this.reset=f(this.reset,this),e.__super__.constructor.call(this,t),this.last=0,this.layoutManager=new o,this.layout=this.layoutManager.getViewLayout("PlayNavView"),this.init()}return m(e,t),e.prototype.reset=function(t){return this.steps=t,this.last=0,this.activeBar.setSize([this.last,this.layout.progress.bar.size[1]]),this.percentage.setContent("0%")},e.prototype.init=function(){var t,e,n,o;return t=new i({size:this.layout.progress.size}),this.activeBar=new r({content:"images/progress_active.png",classes:this.layout.progress.bar.active.classes}),this.activeBarMod=new c({align:this.layout.progress.bar.align,origin:this.layout.progress.bar.origin}),t.add(this.activeBarMod).add(this.activeBar),e=new r({content:"images/progress_inactive.png",size:this.layout.progress.bar.size}),n=new c({align:this.layout.progress.bar.align,origin:this.layout.progress.bar.origin}),t.add(n).add(e),this.percentage=new u({size:this.layout.progress.percentage.size,classes:this.layout.progress.percentage.classes}),o=new c({align:this.layout.progress.percentage.align,origin:this.layout.progress.percentage.origin,transform:this.layout.progress.percentage.transform}),this.add(o).add(this.percentage),this.add(t)},e.prototype.increment=function(t){var e,n,i;return n=this.layout.progress.size[0],i=n/this.steps,e=this.last+i*t,this.activeBar.setSize([e,this.layout.progress.bar.size[1]]),this.percentage.setContent(""+Math.floor(e/n*100)+"%"),this.last=e},e}(d),t.exports=s},function(t,e,n){var i,r,o,s,a,c,u,l={}.hasOwnProperty,h=function(t,e){function n(){this.constructor=t}for(var i in e)l.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};n(210),u=n(4),s=n(3),o=n(5),c=n(2),a=n(11),i=n(22),r=function(t){function e(){e.__super__.constructor.apply(this,arguments),this.init()}return h(e,t),e.prototype.cssPrefix="settings",e.prototype.init=function(){var t,e;return t=new s({size:[200,50],content:"Logout",classes:[""+this.cssPrefix+"__logout__button"]}),e=new o({align:[.5,.32],origin:[.5,0]}),t.on("click",function(){return a.logout(),i.logout()}),this.add(e).add(t)},e}(u),t.exports=r},function(t,e,n){var i,r,o,s,a,c,u,l,h,p,d,f,g,m=function(t,e){return function(){return t.apply(e,arguments)}},_={}.hasOwnProperty,y=function(t,e){function n(){this.constructor=t}for(var i in e)_.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};n(53),g=n(4),h=n(3),o=n(6),s=n(51),l=n(5),p=n(28),d=n(11),i=n(7),r=n(35),c=n(22),f=n(2),a=n(23),u=function(t){function e(t){this.showMessage=m(this.showMessage,this),this.onSubmit=m(this.onSubmit,this),e.__super__.constructor.call(this,t),this.layoutManager=new a,this.layout=this.layoutManager.getViewLayout("SignupView"),this.letmeinCount=0,this.initListeners(),this.initSplash()}return y(e,t),e.prototype.initListeners=function(){return d.on(i.stores.SUBSCRIBE_PASS,this.showMessage),d.on(i.stores.SUBSCRIBE_FAIL,this.showMessage)},e.prototype.initSplash=function(){var t,e,n,i;return e=new o({size:this.layout.logo.size,classes:this.layout.logo.classes,content:"images/cosmic-unicorn-noback.svg"}),t=new l({origin:this.layout.logo.origin,align:this.layout.logo.align}),i=new h({size:this.layout.mark.size,classes:this.layout.mark.classes,content:'<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="150px" height="70px" viewBox="0 0 425.197 198.425" enable-background="new 0 0 425.197 198.425" xml:space="preserve"> <path fill="none" class="path" stroke="#FFFFFF" stroke-width="8" stroke-linecap="round" d="M309.802,83.75 c3.945,7.073,10.229,12.376,18.097,14.392c16.811,4.306,34.493-8.025,39.494-27.545c0.718-2.799,1.126-5.595,1.265-8.342 c0,0-6.574,97.333-33.43,112.123c-26.854,14.79-40.866-28.254-7.784-41.255c33.083-13.001,68.5-35.805,76.284-47.871"/> <path fill="none" class="path" stroke="#FFFFFF" stroke-width="8" stroke-linecap="round" d="M273.732,62.255c0,0-6.574,97.333-33.429,112.123 c-26.855,14.79-40.867-28.254-7.784-41.255c33.081-13.001,69.085-36.109,77.283-49.372c-4.484-8.04-5.948-18.366-3.288-28.75 c5.001-19.52,22.682-31.854,39.493-27.546c14.401,3.69,23.482,18.392,22.65,34.8"/> <path fill="none" class="path" stroke="#FFFFFF" stroke-width="8" stroke-linecap="round" d="M212.481,78.462 c3.461,9.672,10.766,17.188,20.492,19.68c16.811,4.306,34.495-8.025,39.493-27.545c5.001-19.519-4.572-38.834-21.385-43.142 c-16.812-4.308-34.493,8.026-39.494,27.546C209.48,63.227,209.961,71.417,212.481,78.462c0,0-8.471,18.661-23.552,20.538 c-17.835,2.22-40.319-9.586-43.979-37.021c-3.309-24.795,10.282-42.55,23.546-35.381c16.346,8.834,1.341,39.668-13.427,57.486 c-16.542,19.957-39.441,23.19-72.134,2.173C50.241,65.24,42.979,97.316,74.893,98.873c31.915,1.556,54.116-61.671,17.125-72.391 c-33.117-9.598-49.817,32.303-49.817,32.303l-0.929,1.521l4.431-33.823l-19.071,145.56"/>'}),n=new l({origin:this.layout.mark.origin,align:this.layout.mark.align}),this.add(t).add(e),this.add(n).add(i),f.animateAll(t,this.layout.logo.states),f.animateAll(n,this.layout.mark.states),this.initSignUp(),e.on("click",function(){return function(){return c.selectMenuItem("login")}}(this))},e.prototype.initSignUp=function(){var t,e;return this.signupInput=new s({size:this.layout.signupInput.size,placeholder:"Enter your email",classes:this.layout.signupInput.classes}),this.signupInputMod=new l({origin:this.layout.signupInput.origin,align:this.layout.signupInput.align}),this.add(this.signupInputMod).add(this.signupInput),t=new h({size:this.layout.signupButton.size,content:"I'm sexy and I know it.",classes:this.layout.signupButton.classes,properties:{lineHeight:""+this.layout.signupButton.size[1]+"px"}}),e=new l({origin:this.layout.signupButton.origin,align:this.layout.signupButton.align}),this.add(e).add(t),f.animateAll(e,this.layout.signupButton.states),f.animateAll(this.signupInputMod,this.layout.signupInput.states),t.on("click",function(t){return function(){return t.onSubmit()}}(this)),this.signupInput.on("click",function(t){return function(){return t.onInputFocus()}}(this)),this.signupInput.on("keypress",function(t){return function(e){return 13===e.keyCode?t.onInputBlur():void 0}}(this))},e.prototype.onSubmit=function(){var t;return t=this.signupInput.getValue(),this.signupInput.setValue(""),p.subscribe(t)},e.prototype.showMessage=function(){var t,e,n,i;return d.getSubscriptionStatus()?(e="Ooh, yeah! ttyl.",t=[""+this.layout.signupMessage.classes+"--success"]):(e="Nah, guess not. Fail.",t=[""+this.layout.signupMessage.classes+"--fail"]),i=new h({size:this.layout.signupMessage.size,content:e,classes:t}),n=new l({origin:this.layout.signupMessage.origin,align:this.layout.signupMessage.align}),this.add(n).add(i),n.setAlign(this.layout.signupMessage.states[0].align,this.layout.signupMessage.states[0].transition)},e}(g),t.exports=u},function(t,e,n){var i,r,o,s,a,c,u,l={}.hasOwnProperty,h=function(t,e){function n(){this.constructor=t}for(var i in e)l.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};n(78),u=n(4),s=n(3),o=n(5),c=n(1),i=n(6),r=n(22),a=function(t){function e(){e.__super__.constructor.apply(this,arguments),this.createBackground()}return h(e,t),e.DEFAULT_OPTIONS={pageID:null,width:null,height:null,angle:-.2,iconUrl:"images/mark_tiny.png",title:"pegg",color:"white",iconSize:50},e.prototype.createBackground=function(){return this.background=new s({size:[this.options.width,this.options.height],classes:["tabmenu__item","tabmenu__item--"+this.options.pageID]}),this.backgroundMod=new o,this.add(this.backgroundMod).add(this.background),this.background.on("click",function(t){return function(){return t.menuSelect()}}(this))},e.prototype.createIcon=function(){return this.icon=new i({size:[this.options.iconSize,this.options.iconSize],content:this.options.iconUrl,properties:this.options.properties}),this.iconState=new o({transform:c.translate(17,10,null)}),this.add(this.iconState).add(this.icon),this.icon.on("click",function(t){return function(){return t.menuSelect()}}(this))},e.prototype.createTitle=function(){return this.title=new s({size:[this.options.width,this.options.height],content:this.options.title,classes:["tabmenu__item__title"]}),this.titleState=new o({transform:c.translate(0,this.options.height/2,null)}),this.add(this.titleState).add(this.title)},e.prototype.getID=function(){return this.options.pageID},e.prototype.menuSelect=function(){return r.selectMenuItem(this.getID()),this.background.setClasses(["tabmenu__item","tabmenu__item--"+this.options.pageID]),this.backgroundMod.setOpacity(1)},e}(u),t.exports=a},function(t,e,n){var i,r,o,s,a,c,u,l,h,p,d,f={}.hasOwnProperty,g=function(t,e){function n(){this.constructor=t}for(var i in e)f.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};n(78),p=n(4),o=n(3),r=n(5),u=n(1),c=n(13),d=n(24)._,s=n(163),h=n(2),l=n(11),i=n(23),a=function(t){function e(t){t=d.defaults(t,this.constructor.DEFAULT_OPTIONS),e.__super__.constructor.call(this,t),this.layoutManager=new i,this.layout=this.layoutManager.getViewLayout("FooterView"),this.init()}return g(e,t),e.DEFAULT_OPTIONS={model:null},e.prototype.init=function(){var t,e,n,i,r;for(this.tabs=[],this.tabModifiers=[],t=0,i=0,r=[];t<this.options.model.length;)t===this.options.model.length-1?(e=l.getAvatar("type=square"),n={borderRadius:""+this.layout.height+"px",padding:"4px"}):e=this.options.model[t].iconUrl,this.addTab({pageID:this.options.model[t].pageID,title:this.options.model[t].title,icon:e,xOffset:i,width:h.getViewportWidth()/this.options.model.length,height:this.layout.height,properties:n}),t++,r.push(i+=1/this.options.model.length);return r},e.prototype.addTab=function(t){var e,n;return e=new s({pageID:t.pageID,title:t.title,iconUrl:t.icon,width:t.width,height:t.height,xOffset:t.xOffset,properties:t.properties}),n=new r({origin:[0,0],align:[t.xOffset,0],transform:u.translate(0,t.height,10)}),this.tabModifiers.push(n),this.tabs.push(e),this.add(n).add(e)},e.prototype.showTabs=function(){var t,e,n,i;for(n=this.layout.transition,t=this.layout.staggerDelay,e=0,i=[];e<this.tabModifiers.length;)c.setTimeout(function(t){this.tabModifiers[t].setTransform(u.translate(0,0,19),n)}.bind(this,e),e*t),i.push(e++);return i},e.prototype.hideTabs=function(){var t,e,n,i;for(n=this.layout.transition,t=this.layout.staggerDelay,e=0,i=[];e<this.tabModifiers.length;)c.setTimeout(function(t){this.tabModifiers[t].setTransform(u.translate(0,this.layout.height,19),n)}.bind(this,e),e*t),i.push(e++);return i},e.prototype.bounceTabs=function(){var t,e,n,i,r,o;for(i=this.layout.transition,t=this.layout.staggerDelay,e=0,n=0,r=this.layout.height,o=[];e<2*this.tabModifiers.length;)c.setTimeout(function(){this.tabModifiers[n].setTransform(u.translate(0,r,19),i),n++,n===this.tabModifiers.length&&(n=0,r=0)}.bind(this,e),e*t),o.push(e++);return o},e}(p),t.exports=a},function(t,e,n){var i,r,o,s,a,c={}.hasOwnProperty,u=function(t,e){function n(){this.constructor=t}for(var i in e)c.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};n(53),a=n(4),o=n(3),i=n(6),r=n(5),s=function(t){function e(t){e.__super__.constructor.call(this,t),this.init()}return u(e,t),e.prototype.init=function(){var t,e;return e=new o({size:this.options.size,classes:this.options.classes,content:"<svg version='1.1' id='Layer_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' width='"+this.options.size[0]+"px' height='"+this.options.size[1]+"px' viewBox='0 0 425.197 198.425' enable-background='new 0 0 425.197 198.425' xml:space='preserve'> <path fill='none' class='path' stroke='#FFFFFF' stroke-width='8' stroke-linecap='round' d='M309.802,83.75 c3.945,7.073,10.229,12.376,18.097,14.392c16.811,4.306,34.493-8.025,39.494-27.545c0.718-2.799,1.126-5.595,1.265-8.342 c0,0-6.574,97.333-33.43,112.123c-26.854,14.79-40.866-28.254-7.784-41.255c33.083-13.001,68.5-35.805,76.284-47.871'/> <path fill='none' class='path' stroke='#FFFFFF' stroke-width='8' stroke-linecap='round' d='M273.732,62.255c0,0-6.574,97.333-33.429,112.123 c-26.855,14.79-40.867-28.254-7.784-41.255c33.081-13.001,69.085-36.109,77.283-49.372c-4.484-8.04-5.948-18.366-3.288-28.75 c5.001-19.52,22.682-31.854,39.493-27.546c14.401,3.69,23.482,18.392,22.65,34.8'/> <path fill='none' class='path' stroke='#FFFFFF' stroke-width='8' stroke-linecap='round' d='M212.481,78.462 c3.461,9.672,10.766,17.188,20.492,19.68c16.811,4.306,34.495-8.025,39.493-27.545c5.001-19.519-4.572-38.834-21.385-43.142 c-16.812-4.308-34.493,8.026-39.494,27.546C209.48,63.227,209.961,71.417,212.481,78.462c0,0-8.471,18.661-23.552,20.538 c-17.835,2.22-40.319-9.586-43.979-37.021c-3.309-24.795,10.282-42.55,23.546-35.381c16.346,8.834,1.341,39.668-13.427,57.486 c-16.542,19.957-39.441,23.19-72.134,2.173C50.241,65.24,42.979,97.316,74.893,98.873c31.915,1.556,54.116-61.671,17.125-72.391 c-33.117-9.598-49.817,32.303-49.817,32.303l-0.929,1.521l4.431-33.823l-19.071,145.56'/>"}),t=new r({origin:this.options.origin,align:this.options.align}),this.add(t).add(e)},e}(a),t.exports=s},function(t,e,n){var i,r,o,s,a;i=n(8),r=n(1),o=n(2),a=o.getViewportWidth(),s=o.getViewportHeight(),t.exports={question:{big:{delay:0,size:[a-50,150],classes:["card__front__question"],transform:r.translate(0,210,3),transition:{duration:500,curve:i.outQuad}},small:{delay:0,size:[a-120,75],classes:["card__front__question--small"],transform:r.translate(30,100,3),transition:{duration:500,curve:i.outQuad}}},profilePic:{size:[100,100],big:{delay:0,transform:r.multiply(r.scale(1,1,1),r.translate(0,100,3)),transition:{duration:500,curve:i.outQuad},classes:["card__front__pic--big"]},small:{delay:0,transform:r.multiply(r.scale(.5,.5,1),r.translate(-210,200,3)),transition:{duration:500,curve:i.outQuad},classes:["card__front__pic--small"]}},card:{origin:[.5,0],align:[.5,0],size:[a-20,s-180],transition:{duration:1e3,curve:i.outQuad},front:{transform:r.translate(0,78,null)},back:{transform:r.multiply(r.translate(0,78,2),r.multiply(r.rotateZ(Math.PI),r.rotateX(Math.PI)))}},answerImage:{size:[a-60,null],borderRadius:10,maxHeight:a-.1*a-100,classes:["card__back__image"],transform:r.multiply(r.translate(0,200,3),r.multiply(r.rotateZ(Math.PI),r.rotateX(Math.PI)))},answerText:{size:[a-60,100],classes:["card__back__text"],transform:r.multiply(r.translate(0,105,3),r.multiply(r.rotateZ(Math.PI),r.rotateX(Math.PI)))},addImage:{size:[43,48],classes:["card__back__addImage"],content:"images/add-image.png",origin:[.5,1],align:[.5,1],transform:r.multiply(r.translate(0,-80,3),r.multiply(r.rotateZ(Math.PI),r.rotateX(Math.PI)))},choices:{size:[a-.1*a,s-300],show:r.translate(0,180,null),hide:r.translate(0,180,3),choice:{size:[a-.1*a,65],align:[.5,.5],origin:[.5,.5],innerWidth:a-.2*a,height:60}},answerPic:{borderRadius:10,size:[a-.1*a,s-.25*s]}}},function(t,e,n){var i,r,o;i=n(8),r=n(1),o=n(2),t.exports={height:60,width:o.getViewportWidth()-60,staggerDelay:35,transition:{duration:300,curve:"easeOut"}}},function(t,e,n){var i,r,o;i=n(8),r=n(1),o=n(2),t.exports={logo:{size:[320,220],classes:["login__logo"],align:[.5,0],origin:[.5,1],states:[{delay:10,transition:{duration:500,curve:i.inBounce}},{delay:50,align:[.5,.4],transition:{duration:500,curve:i.inOutBack}}]},mark:{size:[130,null],classes:["login__mark"],align:[.5,1],origin:[.5,0],states:[{delay:35,align:[.5,.5],origin:[.5,.5],transition:{duration:500,curve:i.inOutBack}},{delay:100,align:[.5,.4],origin:[.5,0],transition:{duration:500,curve:i.outBounce}}]},text:{size:[130,null],classes:["login__text--header"],align:[.5,0],origin:[.5,1],states:[{delay:35,align:[.5,.5],origin:[.5,.5],transition:{duration:500,curve:i.inOutBack}},{delay:50,align:[.5,.4],origin:[.5,0],transition:{duration:500,curve:i.outBounce}}]},gpButton:{size:[o.getViewportWidth(),o.getViewportHeight()/4],classes:["login__button--google"],align:[1,.45],origin:[0,0],states:[{delay:150,align:[0,.5],transform:r.translate(null,null,1),transition:{duration:600,curve:i.inOutBack}}]},fbButton:{size:[o.getViewportWidth(),o.getViewportHeight()/4],classes:["login__button--facebook"],align:[1,.7],origin:[0,0],states:[{delay:150,align:[0,.75],transform:r.translate(null,null,1),transition:{duration:600,curve:i.inOutBack}}]}}},function(t,e,n){var i,r,o;i=n(8),r=n(1),o=n(2),t.exports={wrapper:{origin:[.5,.5],align:[.5,.5],transform:r.translate(null,null,30)},text:{transform:r.translate(null,-10,null),size:[o.getViewportWidth()-100,160]},okButton:{transform:r.translate(null,80,null),size:[o.getViewportWidth()-100,60]},overlay:{size:[o.getViewportWidth(),o.getViewportHeight()]},box:{size:[o.getViewportWidth()-40,280]}}},function(t,e,n){var i,r,o;i=n(8),r=n(1),o=n(2),t.exports={cardIcon:{size:[83,58],classes:["newcard_card_icon"],align:[.5,.15],origin:[.35,.5]},newCardTitle:{size:[o.getViewportWidth()-50,50],classes:["newcard__header"],align:[.5,.28],origin:[.5,.5]},categories:{size:[window.innerWidth,window.innerHeight],classes:["newcard__categories"],align:[0,1.5],origin:[0,0],states:[{delay:10,align:[0,0],transform:r.translate(null,null,10),transition:{duration:1e3,curve:i.outCubic}},{delay:20,align:[0,1.5],transition:{duration:500,curve:i.inCubic}}]},category:{size:[window.innerWidth,100],classes:["newcard__category"]},categoriesConfirm:{size:[void 0,50]},step1_0:{size:[30,30],classes:["newcard__number"],align:[.5,1.5],origin:[.5,0],states:[{delay:10,align:[.5,.3],transform:r.rotateZ(0),transition:{duration:1e3,curve:i.outCubic}},{delay:20,align:[.5,1.5],transform:r.rotateZ(1),transition:{duration:500,curve:i.inCubic}}]},step1_1:{size:[o.getViewportWidth()-50,40],align:[.5,1.5],origin:[.5,0],states:[{delay:10,align:[.5,.4],transform:r.rotateZ(0),transition:{duration:1e3,curve:i.outCubic}},{delay:10,align:[.5,1.5],transform:r.rotateZ(1),transition:{duration:500,curve:i.inCubic}}]},step1_2:{size:[o.getViewportWidth()-50,40],classes:["newcard__button"],align:[.5,1.5],origin:[.5,0],states:[{delay:10,align:[.5,.5],transform:r.rotateZ(0),transition:{duration:1e3,curve:i.outCubic}},{delay:0,align:[.5,1.5],transform:r.rotateZ(1),transition:{duration:500,curve:i.inCubic}}]},step2_0:{size:[30,30],classes:["newcard__number"],align:[.5,1.5],origin:[.5,0],states:[{delay:10,align:[.5,.3],transform:r.rotateZ(0),transition:{duration:1e3,curve:i.outCubic}},{delay:50,align:[.5,1.5],transform:r.rotateZ(1),transition:{duration:500,curve:i.inCubic}}]},step2_1:{size:[o.getViewportWidth()-50,40],align:[.5,1.5],origin:[.5,0],states:[{delay:0,align:[.5,.4],transform:r.rotateZ(0),transition:{duration:1e3,curve:i.outCubic}},{delay:40,align:[.5,1.5],transform:r.rotateZ(1),transition:{duration:500,curve:i.inCubic}}]},step2_2:{size:[o.getViewportWidth()-50,40],align:[.5,1.5],origin:[.5,0],states:[{delay:10,align:[.5,.5],transform:r.rotateZ(0),transition:{duration:1e3,curve:i.outCubic}},{delay:30,align:[.5,1.5],transform:r.rotateZ(1),transition:{duration:500,curve:i.inCubic}}]},step2_3:{size:[o.getViewportWidth()-50,40],align:[.5,1.5],origin:[.5,0],states:[{delay:20,align:[.5,.6],transform:r.rotateZ(0),transition:{duration:1e3,curve:i.outCubic}},{delay:20,align:[.5,1.5],transform:r.rotateZ(1),transition:{duration:500,curve:i.inCubic}}]},step2_4:{size:[o.getViewportWidth()-50,40],align:[.5,1.5],origin:[.5,0],states:[{delay:30,align:[.5,.7],transform:r.rotateZ(0),transition:{duration:1e3,curve:i.outCubic}},{delay:10,align:[.5,1.5],transform:r.rotateZ(1),transition:{duration:500,curve:i.inCubic}}]},step2_5:{size:[o.getViewportWidth()-50,40],classes:["newcard__button"],align:[.5,1.5],origin:[.5,-.5],states:[{delay:10,align:[.5,.8],transform:r.rotateZ(0),transition:{duration:1e3,curve:i.outCubic}},{delay:0,align:[.5,1.5],transform:r.rotateZ(1),transition:{duration:500,curve:i.inCubic}}]},step3_0:{size:[30,30],classes:["newcard__number"],align:[.5,1.5],origin:[.5,0],states:[{delay:10,align:[.5,.3],transform:r.rotateZ(0),transition:{duration:1e3,curve:i.outCubic}},{delay:30,align:[.5,1.5],transform:r.rotateZ(1),transition:{duration:500,curve:i.inCubic}}]},step3_1:{size:[[o.getViewportWidth()-30,55],[59,55],[o.getViewportWidth()-100,55]],align:[.5,1.5],origin:[.5,0],classes:{image:["newcard__step3__deckIcon"],text:["newcard__step3__deckText"]},states:[{delay:0,align:[.5,.45],transform:r.rotateZ(0),transition:{duration:1e3,curve:i.outCubic}},{delay:20,align:[.5,1.5],transform:r.rotateZ(1),transition:{duration:500,curve:i.inCubic}}]},step3_2:{size:[o.getViewportWidth()-50,40],align:[.5,1.5],origin:[.5,0],classes:["newcard__step3__deckText","newcard__center"],states:[{delay:10,align:[.5,.57],transform:r.rotateZ(0),transition:{duration:1e3,curve:i.outCubic}},{delay:10,align:[.5,1.5],transform:r.rotateZ(1),transition:{duration:500,curve:i.inCubic}}]},step3_3:{size:[o.getViewportWidth()-50,40],classes:["newcard__button"],align:[.5,1.5],origin:[.5,0],states:[{delay:10,align:[.5,.9],transform:r.rotateZ(0),transition:{duration:1e3,curve:i.outCubic}},{delay:0,align:[.5,1.5],transform:r.rotateZ(1),transition:{duration:500,curve:i.inCubic}}]},step4_0:{size:[o.getViewportWidth()-100,40],classes:["newcard__header--big"],align:[.5,1.5],origin:[.5,0],states:[{delay:10,align:[.5,.3],transform:r.rotateZ(0),transition:{duration:1e3,curve:i.outCubic}},{delay:0,align:[.5,1.5],transform:r.rotateZ(1),transition:{duration:500,curve:i.inCubic}}]},step4_1:{size:[o.getViewportWidth()-50,40],classes:["newcard__button","newcard__button--blue"],align:[.5,1.5],origin:[.5,0],states:[{delay:10,align:[.5,.45],transform:r.rotateZ(0),transition:{duration:1e3,curve:i.outCubic}},{delay:0,align:[.5,1.5],transform:r.rotateZ(1),transition:{duration:500,curve:i.inCubic}}]},step4_2:{size:[o.getViewportWidth()-50,40],classes:["newcard__button","newcard__button--blue"],align:[.5,1.5],origin:[.5,0],states:[{delay:20,align:[.5,.55],transform:r.rotateZ(0),transition:{duration:1e3,curve:i.outCubic}},{delay:0,align:[.5,1.5],transform:r.rotateZ(1),transition:{duration:500,curve:i.inCubic}}]}}},function(t,e,n){var i,r,o;i=n(8),r=n(1),o=n(2),t.exports={wrapper:{size:[o.getViewportWidth(),80],origin:[.5,0],align:[.5,.07],transform:r.translate(null,null,-5),states:[{delay:0,align:[.5,.07],transition:{duration:500,curve:i.outQuad}},{delay:0,align:[.5,-1],transition:{duration:500,curve:i.inQuad}}]},leftArrow:{origin:[.5,.5],align:[.1,.08],size:[36,36],states:[{delay:0,transform:r.translate(null,0,null),transition:{duration:500,curve:i.inQuad}},{delay:0,transform:r.translate(null,-200,null),transition:{duration:500,curve:i.inQuad}}]},moodImage:{origin:[.5,.5],align:[.15,.03],size:[50,50],states:[{delay:0,transform:r.translate(null,0,null),transition:{duration:500,curve:i.inQuad}},{delay:0,transform:r.translate(null,-200,null),transition:{duration:500,curve:i.inQuad}}]},title:{size:[180,50],classes:["card__title"],align:[.5,.05],origin:[.5,.5],states:[{delay:0,align:[.5,.05],transform:r.translate(null,null,null),transition:{duration:500,curve:i.inQuad}},{delay:15,align:[.5,-.5],transition:{duration:500,curve:i.inExpo}}]},progress:{size:[160,55],origin:[.5,.5],align:[.5,.29],bar:{align:[.5,.1],origin:[.5,0],size:[160,15],active:{classes:["progressBar__active"]}},percentage:{align:[.5,0],origin:[.5,0],size:[25,15],classes:["progressBar__percentage"]}},rightArrow:{origin:[.5,.5],align:[.9,.08],size:[36,36],states:[{delay:0,transform:r.translate(null,0,null),transition:{duration:500,curve:i.inQuad}},{delay:0,transform:r.translate(null,-200,null),transition:{duration:500,curve:i.inQuad}}]},backArrow:{origin:[.5,.5],align:[.1,.08],size:[46,31],states:[{delay:0,transform:r.translate(null,0,null),transition:{duration:500,curve:i.inQuad}},{delay:0,transform:r.translate(null,-200,null),transition:{duration:500,curve:i.inQuad}}]}}},function(t,e,n){var i,r,o;i=n(8),r=n(1),o=n(2),t.exports={cards:{align:[.5,0],origin:[0,0],states:[{delay:0,align:[.5,.5],transition:{duration:500,curve:i.outQuad}},{delay:0,align:[.5,-.6],transition:{duration:500,curve:i.outQuad}},{delay:0,align:[-1,0],transition:{duration:500,curve:i.outQuad}},{delay:0,align:[3,0]}]},comments:{origin:[.5,0],align:[.5,.35]},numComments:{size:[o.getViewportWidth()-50,40],origin:[.5,0],align:[.5,.94],states:[{delay:0,opacity:1,transition:{duration:500,curve:i.inQuad}},{delay:0,opacity:0,transition:{duration:500,curve:i.inQuad}}]},newComment:{size:[o.getViewportWidth()-50,40],origin:[.5,0],align:[.5,1.5],states:[{delay:0,align:[.5,1.5],transition:{duration:500,curve:i.inQuad}},{delay:0,align:[.5,.9],transition:{duration:500,curve:i.outQuad}}]},status:{origin:[.5,0],align:[.5,1],size:[o.getViewportWidth()],states:[{delay:0,align:[2,0],transition:{duration:500,curve:i.inQuad}},{delay:0,align:[.5,0],transition:{duration:500,curve:i.outQuad}},{delay:0,align:[-1,0],transition:{duration:1e3,curve:i.outQuad}}]},points:{origin:[.5,.5],align:[.5,1.5],transform:r.scale(0,0,0),size:[80,80],classes:["play__points"],states:[{delay:80,transform:r.scale(1,1,1),transition:{duration:400,curve:i.outQuad}},{delay:80,align:[.5,.5],transition:{duration:400,curve:i.outQuad}},{delay:100,transform:r.scale(2,2,2),transition:{duration:400,curve:i.outQuad}},{delay:120,transform:r.scale(1,1,1),transition:{duration:400,curve:i.outQuad}},{delay:150,transform:r.scale(0,0,0),transition:{duration:200,curve:i.outQuad}},{delay:150,align:[.5,1.5],transition:{duration:500,curve:i.outQuad}}]}}},function(t,e,n){var i,r;i=n(8),r=n(1),t.exports={logo:{size:[void 0,250],classes:["login__logo"],align:[.5,0],origin:[.5,1],states:[{delay:0},{delay:30,align:[.5,0],origin:[.5,0],transition:{duration:800,curve:i.outExpo}}]},mark:{size:[150,70],classes:["login__mark"],align:[.5,.5],origin:[.5,0],states:[{delay:35,transition:{duration:300,curve:i.outExpo}},{delay:55,transition:{duration:300,curve:i.outExpo}}]},signupText:{size:[300,50],classes:["signup__text--header"],align:[.5,1],origin:[.5,0],states:[{delay:100,align:[.5,.9],origin:[.5,0],transition:{duration:1e3,curve:i.outBounce}}]},signupInput:{size:[300,50],classes:["signup__email__input"],align:[1,.8],origin:[0,.5],states:[{delay:40,align:[.5,.75],origin:[.5,.5],transform:r.translate(null,null,1),transition:{duration:600,curve:i.inOutBack}}]},signupButton:{size:[300,50],classes:["signup__submit"],align:[1,.9],origin:[0,.5],states:[{delay:60,align:[.5,.85],origin:[.5,.5],transform:r.translate(null,null,1),transition:{duration:600,curve:i.inOutBack}}]},signupMessage:{size:[300,50],classes:["signup__response"],origin:[.5,.5],align:[.5,-.07],states:[{align:[.5,.95],origin:[.5,.5],transition:{duration:1e3,curve:i.outBounce}}]}}},function(t,e,n){var i,r,o;i=n(8),r=n(1),o=n(2),t.exports={card:{align:[.5,0],origin:[.5,0],states:[{delay:0,align:[.5,.5],transition:{duration:500,curve:i.outQuad}},{delay:0,align:[.5,-.6],transition:{duration:500,curve:i.outQuad}}]},comments:{origin:[.5,0],align:[.5,1],states:[{delay:0,align:[.5,1],transition:{duration:500,curve:i.inQuad}},{delay:0,align:[.5,.92],transition:{duration:500,curve:i.outQuad}},{delay:0,align:[.5,.35],transition:{duration:500,curve:i.outQuad}}]},newComment:{size:[o.getViewportWidth()-50,40],origin:[.5,0],align:[.5,1],states:[{delay:0,align:[.5,1],transition:{duration:500,curve:i.inQuad}},{delay:0,align:[.5,.9],transition:{duration:500,curve:i.outQuad}}]},points:{origin:[.5,.5],align:[.5,1.5],transform:r.scale(0,0,0),size:[80,80],classes:["play__points"],states:[{delay:80,transform:r.scale(1,1,1),transition:{duration:400,curve:i.outQuad}},{delay:80,align:[.5,.5],transition:{duration:400,curve:i.outQuad}},{delay:100,transform:r.scale(2,2,2),transition:{duration:400,curve:i.outQuad}},{delay:120,transform:r.scale(1,1,1),transition:{duration:400,curve:i.outQuad}},{delay:150,transform:r.scale(0,0,0),transition:{duration:200,curve:i.outQuad}},{delay:150,align:[.5,1.5],transition:{duration:500,curve:i.outQuad}}]}}},function(t,e,n){var i,r,o;i=n(8),r=n(1),o=n(2),t.exports={view:{origin:[.5,0],align:[.5,1],size:[o.getViewportWidth(),o.getViewportHeight()]}}},function(t){var e;e={scripts:{cosmic_unicorn:{fail:["Almost... but not quite.<br/>Try again.","You're awesome!<br/>But that guess wasn't.","Don't worry,<br/>that fail is safe with us.","Hmm... try again.<br/>You got this."],win:["Hooray!! You rule!","Crushin' it!","Way to be a decent friend.","Friend points earned!","Dude!<br/>Way to not suck at this."],pref:["Pegg yourself!"],pegg:["Pegg your friend.","What did your friend choose?","This isn't all about you.","Can you pegg your friend?"],unicorn:["images/Unicorn_Rookie1@2x.png","images/Unicorn_Space1@2x.png","images/Unicorn_Glowing1@2x.png","images/Unicorn_Cosmic1@2x.png","images/Unicorn_Fire1@2x.png"],pref_status:["How do you stack up?","Here's how you compare:","Good choices...","You're not the only one!","Hah, really? Great job..."],prefs_done:["Impressive! You played all the cards in Pegg.","No more cards! Why don't you create one?","You've pegged yourself plenty. Give it a rest for now.","That's it for now! Come back later for more.","All out of cards. :( Don't worry, we'll let you know when there are more."],peggs_done:["You've nobody left to pegg! Invite some friends..."],review:[""]}}},t.exports=e},function(t){var e,n,i;e="dev",i={dev:{parse:{jsKey:"APlTN2pD4nis5r3DYMfblkDk9fknMYplkqYafXNm",appId:"zogf8qxK4ULBBRBn2EhYWwddyUczTDks9w56mNsr"}},production:{parse:{jsKey:"oBVGtJcA1YL8qAHtRHE1sm46edv3CdxSDCCBAyH3",appId:"jOzfgxXTgD83QGnSyEcJgdCGEE4tNQz2bMEP4Zxe"}}},n={parse:i.production.parse,s3:{bucket:"https://s3-us-west-1.amazonaws.com/pegg/"},facebook:{appId:"1410524409215955",redirectUrl:"http://www.pegg.us",expirationDays:30},aviary:{apiKey:"cdef40f2d4f076a2"},filepicker:{apiKey:"A36NnDQaISmXZ8IOmKGEQz"}},t.exports=n},function(t){var e;e={getItem:function(t){return t?decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(t).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null:null},setItem:function(t,e,n,i,r,o){var s;if(!t||/^(?:expires|max\-age|path|domain|secure)$/i.test(t))return!1;if(s="",n)switch(n.constructor){case Number:s=1/0===n?"; expires=Fri, 31 Dec 9999 23:59:59 GMT":"; max-age="+n;
break;case String:s="; expires="+n;break;case Date:s="; expires="+n.toUTCString()}return document.cookie=encodeURIComponent(t)+"="+encodeURIComponent(e)+s+(r?"; domain="+r:"")+(i?"; path="+i:"")+(o?"; secure":""),!0},removeItem:function(t,e,n){return this.hasItem(t)?(document.cookie=encodeURIComponent(t)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT"+(n?"; domain="+n:"")+(e?"; path="+e:""),!0):!1},hasItem:function(t){return t?new RegExp("(?:^|;\\s*)"+encodeURIComponent(t).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(document.cookie):!1},keys:function(){var t,e,n;for(t=document.cookie.replace(/((?:^|\s*;)[^\=]+)(?=;|$)|^\s*|\s*(?:\=[^;]*)?(?:\1|$)/g,"").split(/\s*(?:\=[^;]*)?;\s*/),n=t.length,e=0;n>e;)t[e]=decodeURIComponent(t[e]),e++;return t}},t.exports=e},function(t,e,n){var i,r,o;r=n(24),i=n(47)["public"].facebook,o=function(t,e,n){var i,r;return i=t.getElementsByTagName(e)[0],t.getElementById(n)?void 0:(r=t.createElement(e),r.id=n,r.src="//connect.facebook.net/en_US/all.js",i.parentNode.insertBefore(r,i))},window.fbAsyncInit=function(){return r.FacebookUtils.init({appId:i.appId,cookie:!0,xfbml:!0})},o(document,"script","facebook-jssdk")},function(t){t.exports=".famous-root{width:100%;height:100%;margin:0;padding:0;overflow:hidden}.famous-root,.famous-container{-webkit-transform-style:preserve-3d;transform-style:preserve-3d}.famous-container{position:absolute}.famous-container,.famous-group{top:0;left:0;bottom:0;right:0;overflow:visible;-webkit-backface-visibility:visible;backface-visibility:visible;pointer-events:none}.famous-group{width:0;height:0;margin:0;padding:0}.famous-group,.famous-surface{position:absolute;-webkit-transform-style:preserve-3d;transform-style:preserve-3d}.famous-surface{-webkit-transform-origin:center center;transform-origin:center center;-webkit-backface-visibility:hidden;backface-visibility:hidden;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;-webkit-tap-highlight-color:transparent;pointer-events:auto}.famous-container-group{position:relative;width:100%;height:100%}"},function(t){var e=function(){function t(t){return null==t?String(t):W[Q.call(t)]||"object"}function e(e){return"function"==t(e)}function n(t){return null!=t&&t==t.window}function i(t){return null!=t&&t.nodeType==t.DOCUMENT_NODE}function r(e){return"object"==t(e)}function o(t){return r(t)&&!n(t)&&Object.getPrototypeOf(t)==Object.prototype}function s(t){return"number"==typeof t.length}function a(t){return A.call(t,function(t){return null!=t})}function c(t){return t.length>0?x.fn.concat.apply([],t):t}function u(t){return t.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase()}function l(t){return t in I?I[t]:I[t]=new RegExp("(^|\\s)"+t+"(\\s|$)")}function h(t,e){return"number"!=typeof e||N[u(t)]?e:e+"px"}function p(t){var e,n;return E[t]||(e=T.createElement(t),T.body.appendChild(e),n=getComputedStyle(e,"").getPropertyValue("display"),e.parentNode.removeChild(e),"none"==n&&(n="block"),E[t]=n),E[t]}function d(t){return"children"in t?S.call(t.children):x.map(t.childNodes,function(t){return 1==t.nodeType?t:void 0})}function f(t,e,n){for(P in e)n&&(o(e[P])||$(e[P]))?(o(e[P])&&!o(t[P])&&(t[P]={}),$(e[P])&&!$(t[P])&&(t[P]=[]),f(t[P],e[P],n)):e[P]!==w&&(t[P]=e[P])}function g(t,e){return null==e?x(t):x(t).filter(e)}function m(t,n,i,r){return e(n)?n.call(t,i,r):n}function _(t,e,n){null==n?t.removeAttribute(e):t.setAttribute(e,n)}function y(t,e){var n=t.className,i=n&&n.baseVal!==w;return e===w?i?n.baseVal:n:void(i?n.baseVal=e:t.className=e)}function v(t){var e;try{return t?"true"==t||("false"==t?!1:"null"==t?null:/^0/.test(t)||isNaN(e=Number(t))?/^[\[\{]/.test(t)?x.parseJSON(t):t:e):t}catch(n){return t}}function b(t,e){e(t);for(var n=0,i=t.childNodes.length;i>n;n++)b(t.childNodes[n],e)}var w,P,x,k,O,j,C=[],S=C.slice,A=C.filter,T=window.document,E={},I={},N={"column-count":1,columns:1,"font-weight":1,"line-height":1,opacity:1,"z-index":1,zoom:1},R=/^\s*<(\w+|!)[^>]*>/,M=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,F=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,z=/^(?:body|html)$/i,D=/([A-Z])/g,U=["val","css","html","text","data","width","height","offset"],L=["after","prepend","before","append"],V=T.createElement("table"),q=T.createElement("tr"),B={tr:T.createElement("tbody"),tbody:V,thead:V,tfoot:V,td:q,th:q,"*":T.createElement("div")},G=/complete|loaded|interactive/,H=/^[\w-]*$/,W={},Q=W.toString,K={},Y=T.createElement("div"),J={tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},$=Array.isArray||function(t){return t instanceof Array};return K.matches=function(t,e){if(!e||!t||1!==t.nodeType)return!1;var n=t.webkitMatchesSelector||t.mozMatchesSelector||t.oMatchesSelector||t.matchesSelector;if(n)return n.call(t,e);var i,r=t.parentNode,o=!r;return o&&(r=Y).appendChild(t),i=~K.qsa(r,e).indexOf(t),o&&Y.removeChild(t),i},O=function(t){return t.replace(/-+(.)?/g,function(t,e){return e?e.toUpperCase():""})},j=function(t){return A.call(t,function(e,n){return t.indexOf(e)==n})},K.fragment=function(t,e,n){var i,r,s;return M.test(t)&&(i=x(T.createElement(RegExp.$1))),i||(t.replace&&(t=t.replace(F,"<$1></$2>")),e===w&&(e=R.test(t)&&RegExp.$1),e in B||(e="*"),s=B[e],s.innerHTML=""+t,i=x.each(S.call(s.childNodes),function(){s.removeChild(this)})),o(n)&&(r=x(i),x.each(n,function(t,e){U.indexOf(t)>-1?r[t](e):r.attr(t,e)})),i},K.Z=function(t,e){return t=t||[],t.__proto__=x.fn,t.selector=e||"",t},K.isZ=function(t){return t instanceof K.Z},K.init=function(t,n){var i;if(!t)return K.Z();if("string"==typeof t)if(t=t.trim(),"<"==t[0]&&R.test(t))i=K.fragment(t,RegExp.$1,n),t=null;else{if(n!==w)return x(n).find(t);i=K.qsa(T,t)}else{if(e(t))return x(T).ready(t);if(K.isZ(t))return t;if($(t))i=a(t);else if(r(t))i=[t],t=null;else if(R.test(t))i=K.fragment(t.trim(),RegExp.$1,n),t=null;else{if(n!==w)return x(n).find(t);i=K.qsa(T,t)}}return K.Z(i,t)},x=function(t,e){return K.init(t,e)},x.extend=function(t){var e,n=S.call(arguments,1);return"boolean"==typeof t&&(e=t,t=n.shift()),n.forEach(function(n){f(t,n,e)}),t},K.qsa=function(t,e){var n,r="#"==e[0],o=!r&&"."==e[0],s=r||o?e.slice(1):e,a=H.test(s);return i(t)&&a&&r?(n=t.getElementById(s))?[n]:[]:1!==t.nodeType&&9!==t.nodeType?[]:S.call(a&&!r?o?t.getElementsByClassName(s):t.getElementsByTagName(e):t.querySelectorAll(e))},x.contains=T.documentElement.contains?function(t,e){return t!==e&&t.contains(e)}:function(t,e){for(;e&&(e=e.parentNode);)if(e===t)return!0;return!1},x.type=t,x.isFunction=e,x.isWindow=n,x.isArray=$,x.isPlainObject=o,x.isEmptyObject=function(t){var e;for(e in t)return!1;return!0},x.inArray=function(t,e,n){return C.indexOf.call(e,t,n)},x.camelCase=O,x.trim=function(t){return null==t?"":String.prototype.trim.call(t)},x.uuid=0,x.support={},x.expr={},x.map=function(t,e){var n,i,r,o=[];if(s(t))for(i=0;i<t.length;i++)n=e(t[i],i),null!=n&&o.push(n);else for(r in t)n=e(t[r],r),null!=n&&o.push(n);return c(o)},x.each=function(t,e){var n,i;if(s(t)){for(n=0;n<t.length;n++)if(e.call(t[n],n,t[n])===!1)return t}else for(i in t)if(e.call(t[i],i,t[i])===!1)return t;return t},x.grep=function(t,e){return A.call(t,e)},window.JSON&&(x.parseJSON=JSON.parse),x.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(t,e){W["[object "+e+"]"]=e.toLowerCase()}),x.fn={forEach:C.forEach,reduce:C.reduce,push:C.push,sort:C.sort,indexOf:C.indexOf,concat:C.concat,map:function(t){return x(x.map(this,function(e,n){return t.call(e,n,e)}))},slice:function(){return x(S.apply(this,arguments))},ready:function(t){return G.test(T.readyState)&&T.body?t(x):T.addEventListener("DOMContentLoaded",function(){t(x)},!1),this},get:function(t){return t===w?S.call(this):this[t>=0?t:t+this.length]},toArray:function(){return this.get()},size:function(){return this.length},remove:function(){return this.each(function(){null!=this.parentNode&&this.parentNode.removeChild(this)})},each:function(t){return C.every.call(this,function(e,n){return t.call(e,n,e)!==!1}),this},filter:function(t){return e(t)?this.not(this.not(t)):x(A.call(this,function(e){return K.matches(e,t)}))},add:function(t,e){return x(j(this.concat(x(t,e))))},is:function(t){return this.length>0&&K.matches(this[0],t)},not:function(t){var n=[];if(e(t)&&t.call!==w)this.each(function(e){t.call(this,e)||n.push(this)});else{var i="string"==typeof t?this.filter(t):s(t)&&e(t.item)?S.call(t):x(t);this.forEach(function(t){i.indexOf(t)<0&&n.push(t)})}return x(n)},has:function(t){return this.filter(function(){return r(t)?x.contains(this,t):x(this).find(t).size()})},eq:function(t){return-1===t?this.slice(t):this.slice(t,+t+1)},first:function(){var t=this[0];return t&&!r(t)?t:x(t)},last:function(){var t=this[this.length-1];return t&&!r(t)?t:x(t)},find:function(t){var e,n=this;return e=t?"object"==typeof t?x(t).filter(function(){var t=this;return C.some.call(n,function(e){return x.contains(e,t)})}):1==this.length?x(K.qsa(this[0],t)):this.map(function(){return K.qsa(this,t)}):[]},closest:function(t,e){var n=this[0],r=!1;for("object"==typeof t&&(r=x(t));n&&!(r?r.indexOf(n)>=0:K.matches(n,t));)n=n!==e&&!i(n)&&n.parentNode;return x(n)},parents:function(t){for(var e=[],n=this;n.length>0;)n=x.map(n,function(t){return(t=t.parentNode)&&!i(t)&&e.indexOf(t)<0?(e.push(t),t):void 0});return g(e,t)},parent:function(t){return g(j(this.pluck("parentNode")),t)},children:function(t){return g(this.map(function(){return d(this)}),t)},contents:function(){return this.map(function(){return S.call(this.childNodes)})},siblings:function(t){return g(this.map(function(t,e){return A.call(d(e.parentNode),function(t){return t!==e})}),t)},empty:function(){return this.each(function(){this.innerHTML=""})},pluck:function(t){return x.map(this,function(e){return e[t]})},show:function(){return this.each(function(){"none"==this.style.display&&(this.style.display=""),"none"==getComputedStyle(this,"").getPropertyValue("display")&&(this.style.display=p(this.nodeName))})},replaceWith:function(t){return this.before(t).remove()},wrap:function(t){var n=e(t);if(this[0]&&!n)var i=x(t).get(0),r=i.parentNode||this.length>1;return this.each(function(e){x(this).wrapAll(n?t.call(this,e):r?i.cloneNode(!0):i)})},wrapAll:function(t){if(this[0]){x(this[0]).before(t=x(t));for(var e;(e=t.children()).length;)t=e.first();x(t).append(this)}return this},wrapInner:function(t){var n=e(t);return this.each(function(e){var i=x(this),r=i.contents(),o=n?t.call(this,e):t;r.length?r.wrapAll(o):i.append(o)})},unwrap:function(){return this.parent().each(function(){x(this).replaceWith(x(this).children())}),this},clone:function(){return this.map(function(){return this.cloneNode(!0)})},hide:function(){return this.css("display","none")},toggle:function(t){return this.each(function(){var e=x(this);(t===w?"none"==e.css("display"):t)?e.show():e.hide()})},prev:function(t){return x(this.pluck("previousElementSibling")).filter(t||"*")},next:function(t){return x(this.pluck("nextElementSibling")).filter(t||"*")},html:function(t){return 0 in arguments?this.each(function(e){var n=this.innerHTML;x(this).empty().append(m(this,t,e,n))}):0 in this?this[0].innerHTML:null},text:function(t){return 0 in arguments?this.each(function(e){var n=m(this,t,e,this.textContent);this.textContent=null==n?"":""+n}):0 in this?this[0].textContent:null},attr:function(t,e){var n;return"string"!=typeof t||1 in arguments?this.each(function(n){if(1===this.nodeType)if(r(t))for(P in t)_(this,P,t[P]);else _(this,t,m(this,e,n,this.getAttribute(t)))}):this.length&&1===this[0].nodeType?!(n=this[0].getAttribute(t))&&t in this[0]?this[0][t]:n:w},removeAttr:function(t){return this.each(function(){1===this.nodeType&&_(this,t)})},prop:function(t,e){return t=J[t]||t,1 in arguments?this.each(function(n){this[t]=m(this,e,n,this[t])}):this[0]&&this[0][t]},data:function(t,e){var n="data-"+t.replace(D,"-$1").toLowerCase(),i=1 in arguments?this.attr(n,e):this.attr(n);return null!==i?v(i):w},val:function(t){return 0 in arguments?this.each(function(e){this.value=m(this,t,e,this.value)}):this[0]&&(this[0].multiple?x(this[0]).find("option").filter(function(){return this.selected}).pluck("value"):this[0].value)},offset:function(t){if(t)return this.each(function(e){var n=x(this),i=m(this,t,e,n.offset()),r=n.offsetParent().offset(),o={top:i.top-r.top,left:i.left-r.left};"static"==n.css("position")&&(o.position="relative"),n.css(o)});if(!this.length)return null;var e=this[0].getBoundingClientRect();return{left:e.left+window.pageXOffset,top:e.top+window.pageYOffset,width:Math.round(e.width),height:Math.round(e.height)}},css:function(e,n){if(arguments.length<2){var i=this[0],r=getComputedStyle(i,"");if(!i)return;if("string"==typeof e)return i.style[O(e)]||r.getPropertyValue(e);if($(e)){var o={};return x.each($(e)?e:[e],function(t,e){o[e]=i.style[O(e)]||r.getPropertyValue(e)}),o}}var s="";if("string"==t(e))n||0===n?s=u(e)+":"+h(e,n):this.each(function(){this.style.removeProperty(u(e))});else for(P in e)e[P]||0===e[P]?s+=u(P)+":"+h(P,e[P])+";":this.each(function(){this.style.removeProperty(u(P))});return this.each(function(){this.style.cssText+=";"+s})},index:function(t){return t?this.indexOf(x(t)[0]):this.parent().children().indexOf(this[0])},hasClass:function(t){return t?C.some.call(this,function(t){return this.test(y(t))},l(t)):!1},addClass:function(t){return t?this.each(function(e){k=[];var n=y(this),i=m(this,t,e,n);i.split(/\s+/g).forEach(function(t){x(this).hasClass(t)||k.push(t)},this),k.length&&y(this,n+(n?" ":"")+k.join(" "))}):this},removeClass:function(t){return this.each(function(e){return t===w?y(this,""):(k=y(this),m(this,t,e,k).split(/\s+/g).forEach(function(t){k=k.replace(l(t)," ")}),void y(this,k.trim()))})},toggleClass:function(t,e){return t?this.each(function(n){var i=x(this),r=m(this,t,n,y(this));r.split(/\s+/g).forEach(function(t){(e===w?!i.hasClass(t):e)?i.addClass(t):i.removeClass(t)})}):this},scrollTop:function(t){if(this.length){var e="scrollTop"in this[0];return t===w?e?this[0].scrollTop:this[0].pageYOffset:this.each(e?function(){this.scrollTop=t}:function(){this.scrollTo(this.scrollX,t)})}},scrollLeft:function(t){if(this.length){var e="scrollLeft"in this[0];return t===w?e?this[0].scrollLeft:this[0].pageXOffset:this.each(e?function(){this.scrollLeft=t}:function(){this.scrollTo(t,this.scrollY)})}},position:function(){if(this.length){var t=this[0],e=this.offsetParent(),n=this.offset(),i=z.test(e[0].nodeName)?{top:0,left:0}:e.offset();return n.top-=parseFloat(x(t).css("margin-top"))||0,n.left-=parseFloat(x(t).css("margin-left"))||0,i.top+=parseFloat(x(e[0]).css("border-top-width"))||0,i.left+=parseFloat(x(e[0]).css("border-left-width"))||0,{top:n.top-i.top,left:n.left-i.left}}},offsetParent:function(){return this.map(function(){for(var t=this.offsetParent||T.body;t&&!z.test(t.nodeName)&&"static"==x(t).css("position");)t=t.offsetParent;return t})}},x.fn.detach=x.fn.remove,["width","height"].forEach(function(t){var e=t.replace(/./,function(t){return t[0].toUpperCase()});x.fn[t]=function(r){var o,s=this[0];return r===w?n(s)?s["inner"+e]:i(s)?s.documentElement["scroll"+e]:(o=this.offset())&&o[t]:this.each(function(e){s=x(this),s.css(t,m(this,r,e,s[t]()))})}}),L.forEach(function(e,n){var i=n%2;x.fn[e]=function(){var e,r,o=x.map(arguments,function(n){return e=t(n),"object"==e||"array"==e||null==n?n:K.fragment(n)}),s=this.length>1;return o.length<1?this:this.each(function(t,e){r=i?e:e.parentNode,e=0==n?e.nextSibling:1==n?e.firstChild:2==n?e:null;var a=x.contains(T.documentElement,r);o.forEach(function(t){if(s)t=t.cloneNode(!0);else if(!r)return x(t).remove();r.insertBefore(t,e),a&&b(t,function(t){null==t.nodeName||"SCRIPT"!==t.nodeName.toUpperCase()||t.type&&"text/javascript"!==t.type||t.src||window.eval.call(window,t.innerHTML)})})})},x.fn[i?e+"To":"insert"+(n?"Before":"After")]=function(t){return x(t)[e](this),this}}),K.Z.prototype=x.fn,K.uniq=j,K.deserializeValue=v,x.zepto=K,x}();window.Zepto=e,void 0===window.$&&(window.$=e),function(t){function e(t){return t._zid||(t._zid=p++)}function n(t,n,o,s){if(n=i(n),n.ns)var a=r(n.ns);return(m[e(t)]||[]).filter(function(t){return!(!t||n.e&&t.e!=n.e||n.ns&&!a.test(t.ns)||o&&e(t.fn)!==e(o)||s&&t.sel!=s)})}function i(t){var e=(""+t).split(".");return{e:e[0],ns:e.slice(1).sort().join(" ")}}function r(t){return new RegExp("(?:^| )"+t.replace(" "," .* ?")+"(?: |$)")}function o(t,e){return t.del&&!y&&t.e in v||!!e}function s(t){return b[t]||y&&v[t]||t}function a(n,r,a,c,l,p,d){var f=e(n),g=m[f]||(m[f]=[]);r.split(/\s/).forEach(function(e){if("ready"==e)return t(document).ready(a);var r=i(e);r.fn=a,r.sel=l,r.e in b&&(a=function(e){var n=e.relatedTarget;return!n||n!==this&&!t.contains(this,n)?r.fn.apply(this,arguments):void 0}),r.del=p;var f=p||a;r.proxy=function(t){if(t=u(t),!t.isImmediatePropagationStopped()){t.data=c;var e=f.apply(n,t._args==h?[t]:[t].concat(t._args));return e===!1&&(t.preventDefault(),t.stopPropagation()),e}},r.i=g.length,g.push(r),"addEventListener"in n&&n.addEventListener(s(r.e),r.proxy,o(r,d))})}function c(t,i,r,a,c){var u=e(t);(i||"").split(/\s/).forEach(function(e){n(t,e,r,a).forEach(function(e){delete m[u][e.i],"removeEventListener"in t&&t.removeEventListener(s(e.e),e.proxy,o(e,c))})})}function u(e,n){return(n||!e.isDefaultPrevented)&&(n||(n=e),t.each(k,function(t,i){var r=n[t];e[t]=function(){return this[i]=w,r&&r.apply(n,arguments)},e[i]=P}),(n.defaultPrevented!==h?n.defaultPrevented:"returnValue"in n?n.returnValue===!1:n.getPreventDefault&&n.getPreventDefault())&&(e.isDefaultPrevented=w)),e}function l(t){var e,n={originalEvent:t};for(e in t)x.test(e)||t[e]===h||(n[e]=t[e]);return u(n,t)}var h,p=1,d=Array.prototype.slice,f=t.isFunction,g=function(t){return"string"==typeof t},m={},_={},y="onfocusin"in window,v={focus:"focusin",blur:"focusout"},b={mouseenter:"mouseover",mouseleave:"mouseout"};_.click=_.mousedown=_.mouseup=_.mousemove="MouseEvents",t.event={add:a,remove:c},t.proxy=function(n,i){var r=2 in arguments&&d.call(arguments,2);if(f(n)){var o=function(){return n.apply(i,r?r.concat(d.call(arguments)):arguments)};return o._zid=e(n),o}if(g(i))return r?(r.unshift(n[i],n),t.proxy.apply(null,r)):t.proxy(n[i],n);throw new TypeError("expected function")},t.fn.bind=function(t,e,n){return this.on(t,e,n)},t.fn.unbind=function(t,e){return this.off(t,e)},t.fn.one=function(t,e,n,i){return this.on(t,e,n,i,1)};var w=function(){return!0},P=function(){return!1},x=/^([A-Z]|returnValue$|layer[XY]$)/,k={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"};t.fn.delegate=function(t,e,n){return this.on(e,t,n)},t.fn.undelegate=function(t,e,n){return this.off(e,t,n)},t.fn.live=function(e,n){return t(document.body).delegate(this.selector,e,n),this},t.fn.die=function(e,n){return t(document.body).undelegate(this.selector,e,n),this},t.fn.on=function(e,n,i,r,o){var s,u,p=this;return e&&!g(e)?(t.each(e,function(t,e){p.on(t,n,i,e,o)}),p):(g(n)||f(r)||r===!1||(r=i,i=n,n=h),(f(i)||i===!1)&&(r=i,i=h),r===!1&&(r=P),p.each(function(h,p){o&&(s=function(t){return c(p,t.type,r),r.apply(this,arguments)}),n&&(u=function(e){var i,o=t(e.target).closest(n,p).get(0);return o&&o!==p?(i=t.extend(l(e),{currentTarget:o,liveFired:p}),(s||r).apply(o,[i].concat(d.call(arguments,1)))):void 0}),a(p,e,r,i,n,u||s)}))},t.fn.off=function(e,n,i){var r=this;return e&&!g(e)?(t.each(e,function(t,e){r.off(t,n,e)}),r):(g(n)||f(i)||i===!1||(i=n,n=h),i===!1&&(i=P),r.each(function(){c(this,e,i,n)}))},t.fn.trigger=function(e,n){return e=g(e)||t.isPlainObject(e)?t.Event(e):u(e),e._args=n,this.each(function(){"dispatchEvent"in this?this.dispatchEvent(e):t(this).triggerHandler(e,n)})},t.fn.triggerHandler=function(e,i){var r,o;return this.each(function(s,a){r=l(g(e)?t.Event(e):e),r._args=i,r.target=a,t.each(n(a,e.type||e),function(t,e){return o=e.proxy(r),r.isImmediatePropagationStopped()?!1:void 0})}),o},"focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select keydown keypress keyup error".split(" ").forEach(function(e){t.fn[e]=function(t){return t?this.bind(e,t):this.trigger(e)}}),["focus","blur"].forEach(function(e){t.fn[e]=function(t){return t?this.bind(e,t):this.each(function(){try{this[e]()}catch(t){}}),this}}),t.Event=function(t,e){g(t)||(e=t,t=e.type);var n=document.createEvent(_[t]||"Events"),i=!0;if(e)for(var r in e)"bubbles"==r?i=!!e[r]:n[r]=e[r];return n.initEvent(t,i,!0),u(n)}}(e),function(t){function e(e,n,i){var r=t.Event(n);return t(e).trigger(r,i),!r.isDefaultPrevented()}function n(t,n,i,r){return t.global?e(n||y,i,r):void 0}function i(e){e.global&&0===t.active++&&n(e,null,"ajaxStart")}function r(e){e.global&&!--t.active&&n(e,null,"ajaxStop")}function o(t,e){var i=e.context;return e.beforeSend.call(i,t,e)===!1||n(e,i,"ajaxBeforeSend",[t,e])===!1?!1:void n(e,i,"ajaxSend",[t,e])}function s(t,e,i,r){var o=i.context,s="success";i.success.call(o,t,s,e),r&&r.resolveWith(o,[t,s,e]),n(i,o,"ajaxSuccess",[e,i,t]),c(s,e,i)}function a(t,e,i,r,o){var s=r.context;r.error.call(s,i,e,t),o&&o.rejectWith(s,[i,e,t]),n(r,s,"ajaxError",[i,r,t||e]),c(e,i,r)}function c(t,e,i){var o=i.context;i.complete.call(o,e,t),n(i,o,"ajaxComplete",[e,i]),r(i)}function u(){}function l(t){return t&&(t=t.split(";",2)[0]),t&&(t==x?"html":t==P?"json":b.test(t)?"script":w.test(t)&&"xml")||"text"}function h(t,e){return""==e?t:(t+"&"+e).replace(/[&?]{1,2}/,"?")}function p(e){e.processData&&e.data&&"string"!=t.type(e.data)&&(e.data=t.param(e.data,e.traditional)),!e.data||e.type&&"GET"!=e.type.toUpperCase()||(e.url=h(e.url,e.data),e.data=void 0)}function d(e,n,i,r){return t.isFunction(n)&&(r=i,i=n,n=void 0),t.isFunction(i)||(r=i,i=void 0),{url:e,data:n,success:i,dataType:r}}function f(e,n,i,r){var o,s=t.isArray(n),a=t.isPlainObject(n);t.each(n,function(n,c){o=t.type(c),r&&(n=i?r:r+"["+(a||"object"==o||"array"==o?n:"")+"]"),!r&&s?e.add(c.name,c.value):"array"==o||!i&&"object"==o?f(e,c,i,n):e.add(n,c)})}var g,m,_=0,y=window.document,v=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,b=/^(?:text|application)\/javascript/i,w=/^(?:text|application)\/xml/i,P="application/json",x="text/html",k=/^\s*$/;t.active=0,t.ajaxJSONP=function(e,n){if(!("type"in e))return t.ajax(e);var i,r,c=e.jsonpCallback,u=(t.isFunction(c)?c():c)||"jsonp"+ ++_,l=y.createElement("script"),h=window[u],p=function(e){t(l).triggerHandler("error",e||"abort")},d={abort:p};return n&&n.promise(d),t(l).on("load error",function(o,c){clearTimeout(r),t(l).off().remove(),"error"!=o.type&&i?s(i[0],d,e,n):a(null,c||"error",d,e,n),window[u]=h,i&&t.isFunction(h)&&h(i[0]),h=i=void 0}),o(d,e)===!1?(p("abort"),d):(window[u]=function(){i=arguments},l.src=e.url.replace(/\?(.+)=\?/,"?$1="+u),y.head.appendChild(l),e.timeout>0&&(r=setTimeout(function(){p("timeout")},e.timeout)),d)},t.ajaxSettings={type:"GET",beforeSend:u,success:u,error:u,complete:u,context:null,global:!0,xhr:function(){return new window.XMLHttpRequest},accepts:{script:"text/javascript, application/javascript, application/x-javascript",json:P,xml:"application/xml, text/xml",html:x,text:"text/plain"},crossDomain:!1,timeout:0,processData:!0,cache:!0},t.ajax=function(e){var n=t.extend({},e||{}),r=t.Deferred&&t.Deferred();for(g in t.ajaxSettings)void 0===n[g]&&(n[g]=t.ajaxSettings[g]);i(n),n.crossDomain||(n.crossDomain=/^([\w-]+:)?\/\/([^\/]+)/.test(n.url)&&RegExp.$2!=window.location.host),n.url||(n.url=window.location.toString()),p(n);var c=n.dataType,d=/\?.+=\?/.test(n.url);if(d&&(c="jsonp"),n.cache!==!1&&(e&&e.cache===!0||"script"!=c&&"jsonp"!=c)||(n.url=h(n.url,"_="+Date.now())),"jsonp"==c)return d||(n.url=h(n.url,n.jsonp?n.jsonp+"=?":n.jsonp===!1?"":"callback=?")),t.ajaxJSONP(n,r);var f,_=n.accepts[c],y={},v=function(t,e){y[t.toLowerCase()]=[t,e]},b=/^([\w-]+:)\/\//.test(n.url)?RegExp.$1:window.location.protocol,w=n.xhr(),P=w.setRequestHeader;if(r&&r.promise(w),n.crossDomain||v("X-Requested-With","XMLHttpRequest"),v("Accept",_||"*/*"),(_=n.mimeType||_)&&(_.indexOf(",")>-1&&(_=_.split(",",2)[0]),w.overrideMimeType&&w.overrideMimeType(_)),(n.contentType||n.contentType!==!1&&n.data&&"GET"!=n.type.toUpperCase())&&v("Content-Type",n.contentType||"application/x-www-form-urlencoded"),n.headers)for(m in n.headers)v(m,n.headers[m]);if(w.setRequestHeader=v,w.onreadystatechange=function(){if(4==w.readyState){w.onreadystatechange=u,clearTimeout(f);var e,i=!1;if(w.status>=200&&w.status<300||304==w.status||0==w.status&&"file:"==b){c=c||l(n.mimeType||w.getResponseHeader("content-type")),e=w.responseText;try{"script"==c?(1,eval)(e):"xml"==c?e=w.responseXML:"json"==c&&(e=k.test(e)?null:t.parseJSON(e))}catch(o){i=o}i?a(i,"parsererror",w,n,r):s(e,w,n,r)}else a(w.statusText||null,w.status?"error":"abort",w,n,r)}},o(w,n)===!1)return w.abort(),a(null,"abort",w,n,r),w;if(n.xhrFields)for(m in n.xhrFields)w[m]=n.xhrFields[m];var x="async"in n?n.async:!0;w.open(n.type,n.url,x,n.username,n.password);for(m in y)P.apply(w,y[m]);return n.timeout>0&&(f=setTimeout(function(){w.onreadystatechange=u,w.abort(),a(null,"timeout",w,n,r)},n.timeout)),w.send(n.data?n.data:null),w},t.get=function(){return t.ajax(d.apply(null,arguments))},t.post=function(){var e=d.apply(null,arguments);return e.type="POST",t.ajax(e)},t.getJSON=function(){var e=d.apply(null,arguments);return e.dataType="json",t.ajax(e)},t.fn.load=function(e,n,i){if(!this.length)return this;var r,o=this,s=e.split(/\s/),a=d(e,n,i),c=a.success;return s.length>1&&(a.url=s[0],r=s[1]),a.success=function(e){o.html(r?t("<div>").html(e.replace(v,"")).find(r):e),c&&c.apply(o,arguments)},t.ajax(a),this};var O=encodeURIComponent;t.param=function(t,e){var n=[];return n.add=function(t,e){this.push(O(t)+"="+O(e))},f(n,t,e),n.join("&").replace(/%20/g,"+")}}(e),function(t){t.fn.serializeArray=function(){var e,n=[];return t([].slice.call(this.get(0).elements)).each(function(){e=t(this);var i=e.attr("type");"fieldset"!=this.nodeName.toLowerCase()&&!this.disabled&&"submit"!=i&&"reset"!=i&&"button"!=i&&("radio"!=i&&"checkbox"!=i||this.checked)&&n.push({name:e.attr("name"),value:e.val()})}),n},t.fn.serialize=function(){var t=[];return this.serializeArray().forEach(function(e){t.push(encodeURIComponent(e.name)+"="+encodeURIComponent(e.value))}),t.join("&")},t.fn.submit=function(e){if(e)this.bind("submit",e);else if(this.length){var n=t.Event("submit");this.eq(0).trigger(n),n.isDefaultPrevented()||this.get(0).submit()}return this}}(e),function(t){"__proto__"in{}||t.extend(t.zepto,{Z:function(e,n){return e=e||[],t.extend(e,t.fn),e.selector=n||"",e.__Z=!0,e},isZ:function(e){return"array"===t.type(e)&&"__Z"in e}});try{getComputedStyle(void 0)}catch(e){var n=getComputedStyle;window.getComputedStyle=function(t){try{return n(t)}catch(e){return null}}}}(e),t.exports=$},function(t){/**
	 * @preserve FastClick: polyfill to remove click delays on browsers with touch UIs.
	 *
	 * @version 1.0.3
	 * @codingstandard ftlabs-jsv2
	 * @copyright The Financial Times Limited [All Rights Reserved]
	 * @license MIT License (see LICENSE.txt)
	 */
function e(t,n){"use strict";function r(t,e){return function(){return t.apply(e,arguments)}}var o;if(n=n||{},this.trackingClick=!1,this.trackingClickStart=0,this.targetElement=null,this.touchStartX=0,this.touchStartY=0,this.lastTouchIdentifier=0,this.touchBoundary=n.touchBoundary||10,this.layer=t,this.tapDelay=n.tapDelay||200,!e.notNeeded(t)){for(var s=["onMouse","onClick","onTouchStart","onTouchMove","onTouchEnd","onTouchCancel"],a=this,c=0,u=s.length;u>c;c++)a[s[c]]=r(a[s[c]],a);i&&(t.addEventListener("mouseover",this.onMouse,!0),t.addEventListener("mousedown",this.onMouse,!0),t.addEventListener("mouseup",this.onMouse,!0)),t.addEventListener("click",this.onClick,!0),t.addEventListener("touchstart",this.onTouchStart,!1),t.addEventListener("touchmove",this.onTouchMove,!1),t.addEventListener("touchend",this.onTouchEnd,!1),t.addEventListener("touchcancel",this.onTouchCancel,!1),Event.prototype.stopImmediatePropagation||(t.removeEventListener=function(e,n,i){var r=Node.prototype.removeEventListener;"click"===e?r.call(t,e,n.hijacked||n,i):r.call(t,e,n,i)},t.addEventListener=function(e,n,i){var r=Node.prototype.addEventListener;"click"===e?r.call(t,e,n.hijacked||(n.hijacked=function(t){t.propagationStopped||n(t)}),i):r.call(t,e,n,i)}),"function"==typeof t.onclick&&(o=t.onclick,t.addEventListener("click",function(t){o(t)},!1),t.onclick=null)}}var n=!1,i=navigator.userAgent.indexOf("Android")>0,r=/iP(ad|hone|od)/.test(navigator.userAgent),o=r&&/OS 4_\d(_\d)?/.test(navigator.userAgent),s=r&&/OS ([6-9]|\d{2})_\d/.test(navigator.userAgent),a=navigator.userAgent.indexOf("BB10")>0;e.prototype.needsClick=function(t){"use strict";switch(t.nodeName.toLowerCase()){case"button":case"select":case"textarea":if(t.disabled)return!0;break;case"input":if(r&&"file"===t.type||t.disabled)return!0;break;case"label":case"video":return!0}return/\bneedsclick\b/.test(t.className)},e.prototype.needsFocus=function(t){"use strict";switch(t.nodeName.toLowerCase()){case"textarea":return!0;case"select":return!i;case"input":switch(t.type){case"button":case"checkbox":case"file":case"image":case"radio":case"submit":return!1}return!t.disabled&&!t.readOnly;default:return/\bneedsfocus\b/.test(t.className)}},e.prototype.sendClick=function(t,e){"use strict";var n,i;document.activeElement&&document.activeElement!==t&&document.activeElement.blur(),i=e.changedTouches[0],n=document.createEvent("MouseEvents"),n.initMouseEvent(this.determineEventType(t),!0,!0,window,1,i.screenX,i.screenY,i.clientX,i.clientY,!1,!1,!1,!1,0,null),n.forwardedTouchEvent=!0,t.dispatchEvent(n)},e.prototype.determineEventType=function(t){"use strict";return i&&"select"===t.tagName.toLowerCase()?"mousedown":"click"},e.prototype.focus=function(t){"use strict";var e;r&&t.setSelectionRange&&0!==t.type.indexOf("date")&&"time"!==t.type?(e=t.value.length,t.setSelectionRange(e,e)):t.focus()},e.prototype.updateScrollParent=function(t){"use strict";var e,n;if(e=t.fastClickScrollParent,!e||!e.contains(t)){n=t;do{if(n.scrollHeight>n.offsetHeight){e=n,t.fastClickScrollParent=n;break}n=n.parentElement}while(n)}e&&(e.fastClickLastScrollTop=e.scrollTop)},e.prototype.getTargetElementFromEventTarget=function(t){"use strict";return t.nodeType===Node.TEXT_NODE?t.parentNode:t},e.prototype.onTouchStart=function(t){"use strict";var e,n,i;if(t.targetTouches.length>1)return!0;if(e=this.getTargetElementFromEventTarget(t.target),n=t.targetTouches[0],r){if(i=window.getSelection(),i.rangeCount&&!i.isCollapsed)return!0;if(!o){if(n.identifier&&n.identifier===this.lastTouchIdentifier)return t.preventDefault(),!1;this.lastTouchIdentifier=n.identifier,this.updateScrollParent(e)}}return this.trackingClick=!0,this.trackingClickStart=t.timeStamp,this.targetElement=e,this.touchStartX=n.pageX,this.touchStartY=n.pageY,t.timeStamp-this.lastClickTime<this.tapDelay&&t.preventDefault(),!0},e.prototype.touchHasMoved=function(t){"use strict";var e=t.changedTouches[0],n=this.touchBoundary;return Math.abs(e.pageX-this.touchStartX)>n||Math.abs(e.pageY-this.touchStartY)>n?!0:!1},e.prototype.onTouchMove=function(t){"use strict";return this.trackingClick?((this.targetElement!==this.getTargetElementFromEventTarget(t.target)||this.touchHasMoved(t))&&(this.trackingClick=!1,this.targetElement=null),!0):!0},e.prototype.findControl=function(t){"use strict";return void 0!==t.control?t.control:t.htmlFor?document.getElementById(t.htmlFor):t.querySelector("button, input:not([type=hidden]), keygen, meter, output, progress, select, textarea")},e.prototype.onTouchEnd=function(t){"use strict";var e,n,a,c,u,l=this.targetElement;if(!this.trackingClick)return!0;if(t.timeStamp-this.lastClickTime<this.tapDelay)return this.cancelNextClick=!0,!0;if(this.cancelNextClick=!1,this.lastClickTime=t.timeStamp,n=this.trackingClickStart,this.trackingClick=!1,this.trackingClickStart=0,s&&(u=t.changedTouches[0],l=document.elementFromPoint(u.pageX-window.pageXOffset,u.pageY-window.pageYOffset)||l,l.fastClickScrollParent=this.targetElement.fastClickScrollParent),a=l.tagName.toLowerCase(),"label"===a){if(e=this.findControl(l)){if(this.focus(l),i)return!1;l=e}}else if(this.needsFocus(l))return t.timeStamp-n>100||r&&window.top!==window&&"input"===a?(this.targetElement=null,!1):(this.focus(l),this.sendClick(l,t),r&&"select"===a||(this.targetElement=null,t.preventDefault()),!1);return r&&!o&&(c=l.fastClickScrollParent,c&&c.fastClickLastScrollTop!==c.scrollTop)?!0:(this.needsClick(l)||(t.preventDefault(),this.sendClick(l,t)),!1)},e.prototype.onTouchCancel=function(){"use strict";this.trackingClick=!1,this.targetElement=null},e.prototype.onMouse=function(t){"use strict";return this.targetElement?t.forwardedTouchEvent?!0:t.cancelable&&(!this.needsClick(this.targetElement)||this.cancelNextClick)?(t.stopImmediatePropagation?t.stopImmediatePropagation():t.propagationStopped=!0,t.stopPropagation(),t.preventDefault(),!1):!0:!0},e.prototype.onClick=function(t){"use strict";var e;return this.trackingClick?(this.targetElement=null,this.trackingClick=!1,!0):"submit"===t.target.type&&0===t.detail?!0:(e=this.onMouse(t),e||(this.targetElement=null),e)},e.prototype.destroy=function(){"use strict";var t=this.layer;i&&(t.removeEventListener("mouseover",this.onMouse,!0),t.removeEventListener("mousedown",this.onMouse,!0),t.removeEventListener("mouseup",this.onMouse,!0)),t.removeEventListener("click",this.onClick,!0),t.removeEventListener("touchstart",this.onTouchStart,!1),t.removeEventListener("touchmove",this.onTouchMove,!1),t.removeEventListener("touchend",this.onTouchEnd,!1),t.removeEventListener("touchcancel",this.onTouchCancel,!1)},e.notNeeded=function(t){"use strict";var e,n,r;if("undefined"==typeof window.ontouchstart)return!0;if(n=+(/Chrome\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1]){if(!i)return!0;if(e=document.querySelector("meta[name=viewport]")){if(-1!==e.content.indexOf("user-scalable=no"))return!0;if(n>31&&document.documentElement.scrollWidth<=window.outerWidth)return!0}}if(a&&(r=navigator.userAgent.match(/Version\/([0-9]*)\.([0-9]*)/),r[1]>=10&&r[2]>=3&&(e=document.querySelector("meta[name=viewport]")))){if(-1!==e.content.indexOf("user-scalable=no"))return!0;if(document.documentElement.scrollWidth<=window.outerWidth)return!0}return"none"===t.style.msTouchAction?!0:!1},e.attach=function(t,n){"use strict";return new e(t,n)},"function"==typeof n&&"object"==typeof n.amd&&n.amd?n(function(){"use strict";return e}):"undefined"!=typeof t&&t.exports?(t.exports=e.attach,t.exports.FastClick=e):window.FastClick=e},function(t){t.exports=".activity__title {\n  text-align: center;\n  color: #fff;\n  font-size: 25px;\n  text-transform: uppercase; }\n\n.activity__background {\n  background-color: #0c0d2a; }\n\n.activity__item {\n  color: #fff;\n  border-bottom: 1px solid #d3e9eb;\n  font-size: 20px;\n  vertical-align: center;\n  padding: 20px; }\n\n.activity__item span {\n  padding: 0px 10px;\n  display: inline-block; }\n"},function(t){t.exports="@import url(http://fonts.googleapis.com/css?family=Montserrat);\nbody {\n  font-family: 'Montserrat', sans-serif;\n  /*background-color: $darkblue;*/\n  background-image: url('images/Background@2x.png');\n  background-size: 100% 100%;\n  background-repeat: no-repeat; }\n\nbutton {\n  width: 100%;\n  height: 100%; }\n\n.answer {\n  background-color: #00a5ff;\n  padding: 10px;\n  border: 10px solid white;\n  text-align: center; }\n\n.iframe {\n  border: 2px solid #000;\n  top: 140px;\n  position: absolute;\n  width: 320px;\n  height: 568px;\n  display: table;\n  margin: 0 auto;\n  margin-left: 28px; }\n\n.device {\n  display: table;\n  margin: 0 auto;\n  width: 380px;\n  height: 780px;\n  background-image: url('images/device-iphone.svg');\n  background-size: 550px 780px;\n  background-repeat: no-repeat;\n  background-position: center;\n  margin-top: 40px; }\n\n.famous-container {\n  overflow: hidden !important; }\n"},function(t){t.exports=".backface-visible, .card__shim {\n  backface-visibility: visible;\n  -webkit-backface-visibility: visible;\n  -moz-backface-visibility: visible;\n  -ms-backface-visibility: visible; }\n\n.card__front, .card__back, .card__left, .card__right {\n  cursor: pointer;\n  padding: 20px; }\n\n.card__front__pic--big {\n  z-index: 1; }\n\n.card__front__pic--small {\n  z-index: 1; }\n\n\n.card__front__question {\n  text-align: center;\n  font-size: 25px;\n  line-height: 35px;\n  z-index: 1; }\n\n.card__front__question--medium {\n  text-align: center;\n  padding: 10px;\n  font-size: 24px;\n  line-height: 30px;\n  z-index: 1; }\n\n.card__front__question--small {\n  text-align: center;\n  font-size: 16px;\n  line-height: 20px;\n  overflow: hidden;\n  z-index: 1; }\n\n.card__front__option {\n  margin: 0 auto;\n  text-align: center; }\n\n.card__front__option .outerContainer {\n  display: table;\n  overflow: hidden;\n  margin: 0 auto; }\n\n.card__front__option .outerContainer .innerContainer {\n  display: table-cell;\n  vertical-align: middle;\n  width: 100%;\n  margin: 0 auto;\n  text-align: left;\n  font-size: 16px;\n  line-height: 20px; }\n\n.card__front__input {\n  margin: 0;\n  text-align: center; }\n\n.card__front__input input {\n  background: transparent;\n  border: 1px solid #0c0d2a;\n  border-radius: 5px;\n  padding: 10px;\n  width: 100%;\n  font-size: 15px;\n  margin: 14px; }\n\n\n.card__front__option.light:hover {\n  background-color: rgba(255, 100, 100, 0.5); }\n\n.card__front__option.dark:hover {\n  background-color: rgba(255, 100, 100, 0.5); }\n\n.card__front__option.light {\n  background-color: rgba(200, 200, 200, 0.5); }\n\n.card__front__option.dark {\n  background-color: rgba(240, 240, 240, 0.5); }\n\n.card__front__option.option__back.win {\n  background-color: #9deb00; }\n\n.card__front__option.option__back.fail {\n  background-color: #FF694F; }\n\n\n.card__front {\n  background-color: #9fcacf; }\n\n.card__backing {\n  background-color: #fff; }\n\n.card__back {\n  text-align: center;\n  background-color: #FCDA33; }\n\n.card__back__image {\n  font-size: 23px;\n  z-index: 5; }\n\n.card__back__text {\n  z-index: 5; }\n\n.card__shim {\n  background-color: #000; }\n\n.card__front_newOption {\n  margin: 0;\n  width: 80% !important; }\n\n.card__options__box {\n  z-index: 1; }\n"},function(t){t.exports=".backface-visible {\n  backface-visibility: visible;\n  -webkit-backface-visibility: visible;\n  -moz-backface-visibility: visible;\n  -ms-backface-visibility: visible; }\n\n.comments__item {\n  z-index: -10; }\n\n.comments__text {\n  color: #fff;\n  font-size: 14px; }\n\n.comments__pic {\n  border-radius: 20px; }\n\n.comments__num {\n  text-align: center; }\n"},function(t){t.exports=".fpsmeter {\n  color: #fff;\n  cursor: pointer; }\n"},function(t){t.exports=".footer {\n  background-color: #FF694F;\n  color: #fff;\n  line-height: 100px;\n  text-align: center; }\n\n.header__background {\n  z-index: 100;\n  background-color: #FF694F; }\n\n.header__background--play {\n  background-color: #FF694F; }\n\n.header__background--profile {\n  background-color: #FF694F; }\n\n.header__background--peggbox {\n  background-color: #9DEB0F; }\n\n.header__background--decks {\n  background-color: #9DEB0F; }\n\n.header__background--create {\n  background-color: #FCDA33; }\n\n.header__background--activity {\n  background-color: #48B5FB; }\n\n.header__title {\n  font-weight: bold;\n  font-size: 30px;\n  text-align: center;\n  color: #fff; }\n\n.header__text {\n  font-size: 14px;\n  color: #fff; }\n\n.header__logout {\n  font-weight: bold;\n  font-size: 18px;\n  color: #fff; }\n\n.header__logo {\n  cursor: pointer;\n  z-index: 101; }\n\n.header__profilePic {\n  z-index: 101; }\n"},function(t){t.exports=".backface-visible {\n  backface-visibility: visible;\n  -webkit-backface-visibility: visible;\n  -moz-backface-visibility: visible;\n  -ms-backface-visibility: visible; }\n\n.input__text {\n  background: transparent;\n  border: 1px solid #fff;\n  border-radius: 5px;\n  padding: 10px;\n  color: #fff;\n  font-size: 15px; }\n\n.input__text--big {\n  border: none;\n  height: 100%;\n  padding: 20px;\n  font-size: 20px;\n  width: 100%;\n  z-index: 10; }\n"},function(t){t.exports=".login__background {\n  background-color: #0c0d2a; }\n\n.login__text--header {\n  text-transform: uppercase;\n  color: #fff;\n  font-size: 24px;\n  text-align: center; }\n\n.login__text--message {\n  color: #9fcacf;\n  font-size: 12px;\n  text-align: center; }\n\n.login__button--facebook {\n  background-color: #3CA5FA;\n  text-align: center;\n  color: white;\n  cursor: pointer; }\n\n.login__button--google {\n  background-color: #E44E3C;\n  text-align: center;\n  color: white;\n  cursor: pointer; }\n\n.login__logo {\n  z-index: 10; }\n\n.login__mark .path {\n  animation: dash 4s linear 1;\n  animation-fill-mode: forwards;\n  stroke-dasharray: 2000;\n  stroke-dashoffset: 2000;\n  -webkit-animation: dash 4s linear 1;\n  -webkit-animation-fill-mode: forwards; }\n\n@-webkit-keyframes dash {\n  from {\n    stroke-dashoffset: 2000; }\n\n  to {\n    stroke-dashoffset: 0; } }\n\n@keyframes dash {\n  from {\n    stroke-dashoffset: 2000; }\n\n  to {\n    stroke-dashoffset: 0; } }\n\n.signup__text--header {\n  text-align: center;\n  text-transform: uppercase;\n  color: #fff;\n  font-size: 30px;\n  font-weight: bold; }\n\n.signup__submit {\n  background-color: #fff;\n  border-radius: 5px;\n  text-align: center;\n  font-size: 15px;\n  cursor: pointer; }\n\n.signup__email__input {\n  background: transparent;\n  border: 1px solid #fff;\n  border-radius: 5px;\n  padding: 10px;\n  color: #fff;\n  font-size: 15px; }\n\n.signup__email__box {\n  background-color: #fff; }\n\n.signup__email__input--big input {\n  border: none;\n  height: 100%;\n  padding: 20px;\n  font-size: 20px;\n  width: 100%; }\n\n.signup__response--success {\n  text-align: center;\n  color: #fff;\n  font-size: 25px;\n  font-weight: bold; }\n\n.signup__response--fail {\n  text-align: center;\n  color: #FF694F;\n  font-size: 25px;\n  font-weight: bold; }\n"},function(t){t.exports=".backface-visible {\n  backface-visibility: visible;\n  -webkit-backface-visibility: visible;\n  -moz-backface-visibility: visible;\n  -ms-backface-visibility: visible; }\n\n.message__button {\n  background-color: #00B5FF !important;\n  border-radius: 5px;\n  text-align: center;\n  font-size: 22px;\n  line-height: 60px;\n  text-align: center;\n  z-index: 102; }\n\n.message__text {\n  color: #000;\n  font-size: 22px;\n  z-index: 102; }\n\n.message__overlay {\n  background-color: rgba(0, 0, 0, 0.6);\n  z-index: 100; }\n\n.message__box {\n  border-radius: 5px;\n  background-color: #d3e9eb;\n  opacity: 0.7;\n  z-index: 101; }\n\n.message__text--loading {\n  color: #fff;\n  font-size: 50px;\n  z-index: 102; }\n"},function(t){t.exports=".backface-visible {\n  backface-visibility: visible;\n  -webkit-backface-visibility: visible;\n  -moz-backface-visibility: visible;\n  -ms-backface-visibility: visible; }\n\n\n\n.moods__box__text {\n  text-align: center;\n  color: #fff;\n  font-size: 14px; }\n\n.moods__title {\n  text-align: center;\n  color: #fff;\n  font-size: 25px;\n  text-transform: uppercase; }\n\n.moods__welcome {\n  text-align: center;\n  font-size: 14px;\n  color: #fff; }\n\n.moods__pass {\n  font-size: 14px;\n  color: #fff; }\n\n.moods__text--yellow {\n  color: #FCDA33; }\n"},function(t){t.exports=".backface-visible {\n  backface-visibility: visible;\n  -webkit-backface-visibility: visible;\n  -moz-backface-visibility: visible;\n  -ms-backface-visibility: visible; }\n\n.newcard__input {\n  background: transparent;\n  border: 1px solid #fff;\n  border-radius: 5px;\n  padding: 10px;\n  width: 92%;\n  color: #fff;\n  font-size: 15px; }\n\n.newcard__button--blue {\n  background-color: #00B5FF !important; }\n\n.newcard__button {\n  background-color: #fff;\n  border-radius: 5px;\n  text-align: center;\n  font-size: 15px; }\n\n.newcard__header {\n  color: #fff;\n  font-size: 23px;\n  text-align: center; }\n\n.newcard__number {\n  border-radius: 30px;\n  background-color: #fff;\n  text-align: center;\n  font-weight: bold;\n  line-height: 30px;\n  vertical-align: middle; }\n\n.newcard__center {\n  text-align: center; }\n\n.newcard__step3__deckText {\n  color: #fff;\n  font-size: 15px; }\n\n.newcard__header--big {\n  color: #00B5FF;\n  font-size: 36px;\n  text-align: center; }\n\n.newcard__category {\n  color: #000;\n  border-bottom: 2px solid #ccc;\n  font-size: 26px;\n  background-color: #fff;\n  z-index: 10; }\n\n.newcard__categories {\n  background-color: #fff; }\n\n.newcard__category.selected {\n  background-color: #d3e9eb; }\n.newcard__category .category-name {\n  display: block;\n  position: absolute;\n  top: 50%;\n  margin-top: -16px;\n  height: 32px;\n  line-height: 32px;\n  width: 100%;\n  text-align: center; }\n\n.newcard.confirmOrCancel {\n  background: #366469;\n  border-top: 1px solid #254447;\n  z-index: 10; }\n\n.newcard.confirmOrCancel__btn {\n  text-align: center;\n  color: #fff;\n  z-index: 11; }\n\n.categoriesContainer {\n  z-index: 10; }\n"},function(t){t.exports=".peggbox__item {\n  border-bottom: 1px solid #d3e9eb; }\n\n.peggbox__item__text {\n  color: #fff;\n  font-size: 18px;\n  display: table;\n  margin-bottom: 20px; }\n\n.peggbox__item__text__child {\n  display: table-cell;\n  vertical-align: middle; }\n\n.peggbox__item__text.pegger {\n  color: #d3e9eb; }\n\n.peggbox__item__pic {\n  border-radius: 25px; }\n"},function(t){t.exports=".play__background {\n  background-color: #0c0d2a; }\n\n.progressBar__title {\n  color: #FCDA33;\n  text-transform: uppercase;\n  font-weight: bold;\n  font-size: 12px; }\n\n.card__title {\n  text-align: center;\n  color: #fff;\n  text-transform: uppercase; }\n\n\n.play__points {\n  border-radius: 40px;\n  background-color: #9DEB0F;\n  font-size: 45px;\n  padding-top: 10px;\n  text-align: center;\n  z-index: 10; }\n\n.progressBar__percentage {\n  font-size: 14px;\n  z-index: 1; }\n\n.progressBar__active {\n  font-size: 14px;\n  z-index: 10; }\n"},function(t){t.exports="\n.profile__name__box {\n  border-radius: 20px;\n  background-color: #FF694F;\n  padding: 5px;\n  text-align: center;\n  text-transform: uppercase;\n  font-size: 19px;\n  color: #fff;\n  z-index: 100; }\n\n.profile__logout {\n  text-align: center;\n  text-transform: uppercase;\n  font-size: 16px;\n  color: #fff;\n  font-weight: bold;\n  cursor: pointer;\n  z-index: 100; }\n\n.peggBoardHeader__bg {\n  background-color: white; }\n\n.peggBoardHeader__button {\n  z-index: 1; }\n\n.profile__activity__item {\n  color: #fff;\n  border-bottom: 1px solid #d3e9eb;\n  font-size: 16px;\n  vertical-align: center;\n  padding: 20px; }\n\n.profile__activity__item .numPeggers {\n  color: #9DEB0F; }\n\n.profile__activity__item .outerContainer {\n  display: table;\n  overflow: hidden; }\n\n.profile__activity__item .outerContainer .innerContainer {\n  display: table-cell;\n  vertical-align: middle;\n  width: 100%;\n  margin: 0 auto;\n  text-align: left;\n  font-size: 14px;\n  line-height: 20px; }\n\n.profile__activity__item__pic {\n  border-radius: 25px; }\n\n"},function(t){t.exports=".backface-visible {\n  backface-visibility: visible;\n  -webkit-backface-visibility: visible;\n  -moz-backface-visibility: visible;\n  -ms-backface-visibility: visible; }\n\n.settings__logout__button {\n  text-align: center;\n  text-transform: uppercase;\n  font-size: 18px;\n  color: #fff;\n  font-weight: bold;\n  cursor: pointer;\n  z-index: 100; }\n"},function(t){t.exports=".status__pref__card {\n  z-index: -10; }\n\n.status__peggee__name, .status__preffer__name {\n  color: #fff;\n  text-align: center;\n  font-size: 40px; }\n\n.status__pegg__title {\n  color: #fff;\n  text-align: center;\n  font-size: 25px; }\n\n.status__pref__title {\n  color: #fff;\n  text-align: center;\n  font-size: 28px; }\n\n\n\n.status__pegger__name {\n  text-align: left;\n  color: #fff; }\n\n.status__pegger__points {\n  text-align: left;\n  color: #fff; }\n\n.status__pref__choice {\n  color: #fff;\n  padding-bottom: 16px; }\n\n.status__pref__bg {\n  z-index: -10; }\n\n.status__pref__question {\n  font-size: 22px;\n  color: #fff;\n  padding-bottom: 16px; }\n\n.status__pref__percentage--red {\n  background-color: #FF694F;\n  z-index: -10; }\n\n.status__pref__percentage--yellow {\n  background-color: #FCDA33;\n  z-index: -10; }\n\n.status__pref__percentage--green {\n  background-color: #9DEB0F;\n  z-index: -10; }\n\n.status__pref__percentage--blue {\n  background-color: #48B5FB;\n  z-index: -10; }\n\n.status__pref__percentage {\n  color: white;\n  line-height: 40px;\n  padding-left: 10px; }\n\n.status__done__title {\n  color: #fff;\n  text-align: center;\n  font-size: 25px; }\n"},function(t){t.exports=".tabmenu__background {\n  background-color: #0c0d2a; }\n\n.tabmenu__item {\n  cursor: pointer;\n  text-align: left;\n  background-color: #fff;\n  z-index: 100; }\n\n.tabmenu__item--profile {\n  background-color: #48B5FB; }\n\n.tabmenu__item--home {\n  background-color: #FF694F; }\n\n.tabmenu__item--play {\n  background-color: #FCDA33; }\n\n.tabmenu__item--create {\n  background-color: #9DEB0F; }\n\n.tabmenu__item--activity {\n  background-color: #FCDA33; }\n\n.tabmenu__item__title {\n  text-align: center; }\n"},function(t){t.exports=function(t){window.execScript?window.execScript(t):eval.call(null,t)}},function(t,e,n){n(200)(n(202))},function(t){t.exports='/*!\n * Parse JavaScript SDK\n * Version: 1.2.18\n * Built: Wed Mar 12 2014 15:36:03\n * http://parse.com\n *\n * Copyright 2014 Parse, Inc.\n * The Parse JavaScript SDK is freely distributable under the MIT license.\n *\n * Includes: Underscore.js\n * Copyright 2009-2012 Jeremy Ashkenas, DocumentCloud Inc.\n * Released under the MIT license.\n */\n(function(root) {\n  root.Parse = root.Parse || {};\n  root.Parse.VERSION = "js1.2.18";\n}(this));\n//     Underscore.js 1.4.4\n//     http://underscorejs.org\n//     (c) 2009-2013 Jeremy Ashkenas, DocumentCloud Inc.\n//     Underscore may be freely distributed under the MIT license.\n\n(function() {\n\n  // Baseline setup\n  // --------------\n\n  // Establish the root object, `window` in the browser, or `global` on the server.\n  var root = this;\n\n  // Save the previous value of the `_` variable.\n  var previousUnderscore = root._;\n\n  // Establish the object that gets returned to break out of a loop iteration.\n  var breaker = {};\n\n  // Save bytes in the minified (but not gzipped) version:\n  var ArrayProto = Array.prototype, ObjProto = Object.prototype, FuncProto = Function.prototype;\n\n  // Create quick reference variables for speed access to core prototypes.\n  var push             = ArrayProto.push,\n      slice            = ArrayProto.slice,\n      concat           = ArrayProto.concat,\n      toString         = ObjProto.toString,\n      hasOwnProperty   = ObjProto.hasOwnProperty;\n\n  // All **ECMAScript 5** native function implementations that we hope to use\n  // are declared here.\n  var\n    nativeForEach      = ArrayProto.forEach,\n    nativeMap          = ArrayProto.map,\n    nativeReduce       = ArrayProto.reduce,\n    nativeReduceRight  = ArrayProto.reduceRight,\n    nativeFilter       = ArrayProto.filter,\n    nativeEvery        = ArrayProto.every,\n    nativeSome         = ArrayProto.some,\n    nativeIndexOf      = ArrayProto.indexOf,\n    nativeLastIndexOf  = ArrayProto.lastIndexOf,\n    nativeIsArray      = Array.isArray,\n    nativeKeys         = Object.keys,\n    nativeBind         = FuncProto.bind;\n\n  // Create a safe reference to the Underscore object for use below.\n  var _ = function(obj) {\n    if (obj instanceof _) return obj;\n    if (!(this instanceof _)) return new _(obj);\n    this._wrapped = obj;\n  };\n\n  // Export the Underscore object for **Node.js**, with\n  // backwards-compatibility for the old `require()` API. If we\'re in\n  // the browser, add `_` as a global object via a string identifier,\n  // for Closure Compiler "advanced" mode.\n  if (typeof exports !== \'undefined\') {\n    if (typeof module !== \'undefined\' && module.exports) {\n      exports = module.exports = _;\n    }\n    exports._ = _;\n  } else {\n    root._ = _;\n  }\n\n  // Current version.\n  _.VERSION = \'1.4.4\';\n\n  // Collection Functions\n  // --------------------\n\n  // The cornerstone, an `each` implementation, aka `forEach`.\n  // Handles objects with the built-in `forEach`, arrays, and raw objects.\n  // Delegates to **ECMAScript 5**\'s native `forEach` if available.\n  var each = _.each = _.forEach = function(obj, iterator, context) {\n    if (obj == null) return;\n    if (nativeForEach && obj.forEach === nativeForEach) {\n      obj.forEach(iterator, context);\n    } else if (obj.length === +obj.length) {\n      for (var i = 0, l = obj.length; i < l; i++) {\n        if (iterator.call(context, obj[i], i, obj) === breaker) return;\n      }\n    } else {\n      for (var key in obj) {\n        if (_.has(obj, key)) {\n          if (iterator.call(context, obj[key], key, obj) === breaker) return;\n        }\n      }\n    }\n  };\n\n  // Return the results of applying the iterator to each element.\n  // Delegates to **ECMAScript 5**\'s native `map` if available.\n  _.map = _.collect = function(obj, iterator, context) {\n    var results = [];\n    if (obj == null) return results;\n    if (nativeMap && obj.map === nativeMap) return obj.map(iterator, context);\n    each(obj, function(value, index, list) {\n      results[results.length] = iterator.call(context, value, index, list);\n    });\n    return results;\n  };\n\n  var reduceError = \'Reduce of empty array with no initial value\';\n\n  // **Reduce** builds up a single result from a list of values, aka `inject`,\n  // or `foldl`. Delegates to **ECMAScript 5**\'s native `reduce` if available.\n  _.reduce = _.foldl = _.inject = function(obj, iterator, memo, context) {\n    var initial = arguments.length > 2;\n    if (obj == null) obj = [];\n    if (nativeReduce && obj.reduce === nativeReduce) {\n      if (context) iterator = _.bind(iterator, context);\n      return initial ? obj.reduce(iterator, memo) : obj.reduce(iterator);\n    }\n    each(obj, function(value, index, list) {\n      if (!initial) {\n        memo = value;\n        initial = true;\n      } else {\n        memo = iterator.call(context, memo, value, index, list);\n      }\n    });\n    if (!initial) throw new TypeError(reduceError);\n    return memo;\n  };\n\n  // The right-associative version of reduce, also known as `foldr`.\n  // Delegates to **ECMAScript 5**\'s native `reduceRight` if available.\n  _.reduceRight = _.foldr = function(obj, iterator, memo, context) {\n    var initial = arguments.length > 2;\n    if (obj == null) obj = [];\n    if (nativeReduceRight && obj.reduceRight === nativeReduceRight) {\n      if (context) iterator = _.bind(iterator, context);\n      return initial ? obj.reduceRight(iterator, memo) : obj.reduceRight(iterator);\n    }\n    var length = obj.length;\n    if (length !== +length) {\n      var keys = _.keys(obj);\n      length = keys.length;\n    }\n    each(obj, function(value, index, list) {\n      index = keys ? keys[--length] : --length;\n      if (!initial) {\n        memo = obj[index];\n        initial = true;\n      } else {\n        memo = iterator.call(context, memo, obj[index], index, list);\n      }\n    });\n    if (!initial) throw new TypeError(reduceError);\n    return memo;\n  };\n\n  // Return the first value which passes a truth test. Aliased as `detect`.\n  _.find = _.detect = function(obj, iterator, context) {\n    var result;\n    any(obj, function(value, index, list) {\n      if (iterator.call(context, value, index, list)) {\n        result = value;\n        return true;\n      }\n    });\n    return result;\n  };\n\n  // Return all the elements that pass a truth test.\n  // Delegates to **ECMAScript 5**\'s native `filter` if available.\n  // Aliased as `select`.\n  _.filter = _.select = function(obj, iterator, context) {\n    var results = [];\n    if (obj == null) return results;\n    if (nativeFilter && obj.filter === nativeFilter) return obj.filter(iterator, context);\n    each(obj, function(value, index, list) {\n      if (iterator.call(context, value, index, list)) results[results.length] = value;\n    });\n    return results;\n  };\n\n  // Return all the elements for which a truth test fails.\n  _.reject = function(obj, iterator, context) {\n    return _.filter(obj, function(value, index, list) {\n      return !iterator.call(context, value, index, list);\n    }, context);\n  };\n\n  // Determine whether all of the elements match a truth test.\n  // Delegates to **ECMAScript 5**\'s native `every` if available.\n  // Aliased as `all`.\n  _.every = _.all = function(obj, iterator, context) {\n    iterator || (iterator = _.identity);\n    var result = true;\n    if (obj == null) return result;\n    if (nativeEvery && obj.every === nativeEvery) return obj.every(iterator, context);\n    each(obj, function(value, index, list) {\n      if (!(result = result && iterator.call(context, value, index, list))) return breaker;\n    });\n    return !!result;\n  };\n\n  // Determine if at least one element in the object matches a truth test.\n  // Delegates to **ECMAScript 5**\'s native `some` if available.\n  // Aliased as `any`.\n  var any = _.some = _.any = function(obj, iterator, context) {\n    iterator || (iterator = _.identity);\n    var result = false;\n    if (obj == null) return result;\n    if (nativeSome && obj.some === nativeSome) return obj.some(iterator, context);\n    each(obj, function(value, index, list) {\n      if (result || (result = iterator.call(context, value, index, list))) return breaker;\n    });\n    return !!result;\n  };\n\n  // Determine if the array or object contains a given value (using `===`).\n  // Aliased as `include`.\n  _.contains = _.include = function(obj, target) {\n    if (obj == null) return false;\n    if (nativeIndexOf && obj.indexOf === nativeIndexOf) return obj.indexOf(target) != -1;\n    return any(obj, function(value) {\n      return value === target;\n    });\n  };\n\n  // Invoke a method (with arguments) on every item in a collection.\n  _.invoke = function(obj, method) {\n    var args = slice.call(arguments, 2);\n    var isFunc = _.isFunction(method);\n    return _.map(obj, function(value) {\n      return (isFunc ? method : value[method]).apply(value, args);\n    });\n  };\n\n  // Convenience version of a common use case of `map`: fetching a property.\n  _.pluck = function(obj, key) {\n    return _.map(obj, function(value){ return value[key]; });\n  };\n\n  // Convenience version of a common use case of `filter`: selecting only objects\n  // containing specific `key:value` pairs.\n  _.where = function(obj, attrs, first) {\n    if (_.isEmpty(attrs)) return first ? null : [];\n    return _[first ? \'find\' : \'filter\'](obj, function(value) {\n      for (var key in attrs) {\n        if (attrs[key] !== value[key]) return false;\n      }\n      return true;\n    });\n  };\n\n  // Convenience version of a common use case of `find`: getting the first object\n  // containing specific `key:value` pairs.\n  _.findWhere = function(obj, attrs) {\n    return _.where(obj, attrs, true);\n  };\n\n  // Return the maximum element or (element-based computation).\n  // Can\'t optimize arrays of integers longer than 65,535 elements.\n  // See: https://bugs.webkit.org/show_bug.cgi?id=80797\n  _.max = function(obj, iterator, context) {\n    if (!iterator && _.isArray(obj) && obj[0] === +obj[0] && obj.length < 65535) {\n      return Math.max.apply(Math, obj);\n    }\n    if (!iterator && _.isEmpty(obj)) return -Infinity;\n    var result = {computed : -Infinity, value: -Infinity};\n    each(obj, function(value, index, list) {\n      var computed = iterator ? iterator.call(context, value, index, list) : value;\n      computed >= result.computed && (result = {value : value, computed : computed});\n    });\n    return result.value;\n  };\n\n  // Return the minimum element (or element-based computation).\n  _.min = function(obj, iterator, context) {\n    if (!iterator && _.isArray(obj) && obj[0] === +obj[0] && obj.length < 65535) {\n      return Math.min.apply(Math, obj);\n    }\n    if (!iterator && _.isEmpty(obj)) return Infinity;\n    var result = {computed : Infinity, value: Infinity};\n    each(obj, function(value, index, list) {\n      var computed = iterator ? iterator.call(context, value, index, list) : value;\n      computed < result.computed && (result = {value : value, computed : computed});\n    });\n    return result.value;\n  };\n\n  // Shuffle an array.\n  _.shuffle = function(obj) {\n    var rand;\n    var index = 0;\n    var shuffled = [];\n    each(obj, function(value) {\n      rand = _.random(index++);\n      shuffled[index - 1] = shuffled[rand];\n      shuffled[rand] = value;\n    });\n    return shuffled;\n  };\n\n  // An internal function to generate lookup iterators.\n  var lookupIterator = function(value) {\n    return _.isFunction(value) ? value : function(obj){ return obj[value]; };\n  };\n\n  // Sort the object\'s values by a criterion produced by an iterator.\n  _.sortBy = function(obj, value, context) {\n    var iterator = lookupIterator(value);\n    return _.pluck(_.map(obj, function(value, index, list) {\n      return {\n        value : value,\n        index : index,\n        criteria : iterator.call(context, value, index, list)\n      };\n    }).sort(function(left, right) {\n      var a = left.criteria;\n      var b = right.criteria;\n      if (a !== b) {\n        if (a > b || a === void 0) return 1;\n        if (a < b || b === void 0) return -1;\n      }\n      return left.index < right.index ? -1 : 1;\n    }), \'value\');\n  };\n\n  // An internal function used for aggregate "group by" operations.\n  var group = function(obj, value, context, behavior) {\n    var result = {};\n    var iterator = lookupIterator(value || _.identity);\n    each(obj, function(value, index) {\n      var key = iterator.call(context, value, index, obj);\n      behavior(result, key, value);\n    });\n    return result;\n  };\n\n  // Groups the object\'s values by a criterion. Pass either a string attribute\n  // to group by, or a function that returns the criterion.\n  _.groupBy = function(obj, value, context) {\n    return group(obj, value, context, function(result, key, value) {\n      (_.has(result, key) ? result[key] : (result[key] = [])).push(value);\n    });\n  };\n\n  // Counts instances of an object that group by a certain criterion. Pass\n  // either a string attribute to count by, or a function that returns the\n  // criterion.\n  _.countBy = function(obj, value, context) {\n    return group(obj, value, context, function(result, key) {\n      if (!_.has(result, key)) result[key] = 0;\n      result[key]++;\n    });\n  };\n\n  // Use a comparator function to figure out the smallest index at which\n  // an object should be inserted so as to maintain order. Uses binary search.\n  _.sortedIndex = function(array, obj, iterator, context) {\n    iterator = iterator == null ? _.identity : lookupIterator(iterator);\n    var value = iterator.call(context, obj);\n    var low = 0, high = array.length;\n    while (low < high) {\n      var mid = (low + high) >>> 1;\n      iterator.call(context, array[mid]) < value ? low = mid + 1 : high = mid;\n    }\n    return low;\n  };\n\n  // Safely convert anything iterable into a real, live array.\n  _.toArray = function(obj) {\n    if (!obj) return [];\n    if (_.isArray(obj)) return slice.call(obj);\n    if (obj.length === +obj.length) return _.map(obj, _.identity);\n    return _.values(obj);\n  };\n\n  // Return the number of elements in an object.\n  _.size = function(obj) {\n    if (obj == null) return 0;\n    return (obj.length === +obj.length) ? obj.length : _.keys(obj).length;\n  };\n\n  // Array Functions\n  // ---------------\n\n  // Get the first element of an array. Passing **n** will return the first N\n  // values in the array. Aliased as `head` and `take`. The **guard** check\n  // allows it to work with `_.map`.\n  _.first = _.head = _.take = function(array, n, guard) {\n    if (array == null) return void 0;\n    return (n != null) && !guard ? slice.call(array, 0, n) : array[0];\n  };\n\n  // Returns everything but the last entry of the array. Especially useful on\n  // the arguments object. Passing **n** will return all the values in\n  // the array, excluding the last N. The **guard** check allows it to work with\n  // `_.map`.\n  _.initial = function(array, n, guard) {\n    return slice.call(array, 0, array.length - ((n == null) || guard ? 1 : n));\n  };\n\n  // Get the last element of an array. Passing **n** will return the last N\n  // values in the array. The **guard** check allows it to work with `_.map`.\n  _.last = function(array, n, guard) {\n    if (array == null) return void 0;\n    if ((n != null) && !guard) {\n      return slice.call(array, Math.max(array.length - n, 0));\n    } else {\n      return array[array.length - 1];\n    }\n  };\n\n  // Returns everything but the first entry of the array. Aliased as `tail` and `drop`.\n  // Especially useful on the arguments object. Passing an **n** will return\n  // the rest N values in the array. The **guard**\n  // check allows it to work with `_.map`.\n  _.rest = _.tail = _.drop = function(array, n, guard) {\n    return slice.call(array, (n == null) || guard ? 1 : n);\n  };\n\n  // Trim out all falsy values from an array.\n  _.compact = function(array) {\n    return _.filter(array, _.identity);\n  };\n\n  // Internal implementation of a recursive `flatten` function.\n  var flatten = function(input, shallow, output) {\n    each(input, function(value) {\n      if (_.isArray(value)) {\n        shallow ? push.apply(output, value) : flatten(value, shallow, output);\n      } else {\n        output.push(value);\n      }\n    });\n    return output;\n  };\n\n  // Return a completely flattened version of an array.\n  _.flatten = function(array, shallow) {\n    return flatten(array, shallow, []);\n  };\n\n  // Return a version of the array that does not contain the specified value(s).\n  _.without = function(array) {\n    return _.difference(array, slice.call(arguments, 1));\n  };\n\n  // Produce a duplicate-free version of the array. If the array has already\n  // been sorted, you have the option of using a faster algorithm.\n  // Aliased as `unique`.\n  _.uniq = _.unique = function(array, isSorted, iterator, context) {\n    if (_.isFunction(isSorted)) {\n      context = iterator;\n      iterator = isSorted;\n      isSorted = false;\n    }\n    var initial = iterator ? _.map(array, iterator, context) : array;\n    var results = [];\n    var seen = [];\n    each(initial, function(value, index) {\n      if (isSorted ? (!index || seen[seen.length - 1] !== value) : !_.contains(seen, value)) {\n        seen.push(value);\n        results.push(array[index]);\n      }\n    });\n    return results;\n  };\n\n  // Produce an array that contains the union: each distinct element from all of\n  // the passed-in arrays.\n  _.union = function() {\n    return _.uniq(concat.apply(ArrayProto, arguments));\n  };\n\n  // Produce an array that contains every item shared between all the\n  // passed-in arrays.\n  _.intersection = function(array) {\n    var rest = slice.call(arguments, 1);\n    return _.filter(_.uniq(array), function(item) {\n      return _.every(rest, function(other) {\n        return _.indexOf(other, item) >= 0;\n      });\n    });\n  };\n\n  // Take the difference between one array and a number of other arrays.\n  // Only the elements present in just the first array will remain.\n  _.difference = function(array) {\n    var rest = concat.apply(ArrayProto, slice.call(arguments, 1));\n    return _.filter(array, function(value){ return !_.contains(rest, value); });\n  };\n\n  // Zip together multiple lists into a single array -- elements that share\n  // an index go together.\n  _.zip = function() {\n    var args = slice.call(arguments);\n    var length = _.max(_.pluck(args, \'length\'));\n    var results = new Array(length);\n    for (var i = 0; i < length; i++) {\n      results[i] = _.pluck(args, "" + i);\n    }\n    return results;\n  };\n\n  // Converts lists into objects. Pass either a single array of `[key, value]`\n  // pairs, or two parallel arrays of the same length -- one of keys, and one of\n  // the corresponding values.\n  _.object = function(list, values) {\n    if (list == null) return {};\n    var result = {};\n    for (var i = 0, l = list.length; i < l; i++) {\n      if (values) {\n        result[list[i]] = values[i];\n      } else {\n        result[list[i][0]] = list[i][1];\n      }\n    }\n    return result;\n  };\n\n  // If the browser doesn\'t supply us with indexOf (I\'m looking at you, **MSIE**),\n  // we need this function. Return the position of the first occurrence of an\n  // item in an array, or -1 if the item is not included in the array.\n  // Delegates to **ECMAScript 5**\'s native `indexOf` if available.\n  // If the array is large and already in sort order, pass `true`\n  // for **isSorted** to use binary search.\n  _.indexOf = function(array, item, isSorted) {\n    if (array == null) return -1;\n    var i = 0, l = array.length;\n    if (isSorted) {\n      if (typeof isSorted == \'number\') {\n        i = (isSorted < 0 ? Math.max(0, l + isSorted) : isSorted);\n      } else {\n        i = _.sortedIndex(array, item);\n        return array[i] === item ? i : -1;\n      }\n    }\n    if (nativeIndexOf && array.indexOf === nativeIndexOf) return array.indexOf(item, isSorted);\n    for (; i < l; i++) if (array[i] === item) return i;\n    return -1;\n  };\n\n  // Delegates to **ECMAScript 5**\'s native `lastIndexOf` if available.\n  _.lastIndexOf = function(array, item, from) {\n    if (array == null) return -1;\n    var hasIndex = from != null;\n    if (nativeLastIndexOf && array.lastIndexOf === nativeLastIndexOf) {\n      return hasIndex ? array.lastIndexOf(item, from) : array.lastIndexOf(item);\n    }\n    var i = (hasIndex ? from : array.length);\n    while (i--) if (array[i] === item) return i;\n    return -1;\n  };\n\n  // Generate an integer Array containing an arithmetic progression. A port of\n  // the native Python `range()` function. See\n  // [the Python documentation](http://docs.python.org/library/functions.html#range).\n  _.range = function(start, stop, step) {\n    if (arguments.length <= 1) {\n      stop = start || 0;\n      start = 0;\n    }\n    step = arguments[2] || 1;\n\n    var len = Math.max(Math.ceil((stop - start) / step), 0);\n    var idx = 0;\n    var range = new Array(len);\n\n    while(idx < len) {\n      range[idx++] = start;\n      start += step;\n    }\n\n    return range;\n  };\n\n  // Function (ahem) Functions\n  // ------------------\n\n  // Create a function bound to a given object (assigning `this`, and arguments,\n  // optionally). Delegates to **ECMAScript 5**\'s native `Function.bind` if\n  // available.\n  _.bind = function(func, context) {\n    if (func.bind === nativeBind && nativeBind) return nativeBind.apply(func, slice.call(arguments, 1));\n    var args = slice.call(arguments, 2);\n    return function() {\n      return func.apply(context, args.concat(slice.call(arguments)));\n    };\n  };\n\n  // Partially apply a function by creating a version that has had some of its\n  // arguments pre-filled, without changing its dynamic `this` context.\n  _.partial = function(func) {\n    var args = slice.call(arguments, 1);\n    return function() {\n      return func.apply(this, args.concat(slice.call(arguments)));\n    };\n  };\n\n  // Bind all of an object\'s methods to that object. Useful for ensuring that\n  // all callbacks defined on an object belong to it.\n  _.bindAll = function(obj) {\n    var funcs = slice.call(arguments, 1);\n    if (funcs.length === 0) funcs = _.functions(obj);\n    each(funcs, function(f) { obj[f] = _.bind(obj[f], obj); });\n    return obj;\n  };\n\n  // Memoize an expensive function by storing its results.\n  _.memoize = function(func, hasher) {\n    var memo = {};\n    hasher || (hasher = _.identity);\n    return function() {\n      var key = hasher.apply(this, arguments);\n      return _.has(memo, key) ? memo[key] : (memo[key] = func.apply(this, arguments));\n    };\n  };\n\n  // Delays a function for the given number of milliseconds, and then calls\n  // it with the arguments supplied.\n  _.delay = function(func, wait) {\n    var args = slice.call(arguments, 2);\n    return setTimeout(function(){ return func.apply(null, args); }, wait);\n  };\n\n  // Defers a function, scheduling it to run after the current call stack has\n  // cleared.\n  _.defer = function(func) {\n    return _.delay.apply(_, [func, 1].concat(slice.call(arguments, 1)));\n  };\n\n  // Returns a function, that, when invoked, will only be triggered at most once\n  // during a given window of time.\n  _.throttle = function(func, wait) {\n    var context, args, timeout, result;\n    var previous = 0;\n    var later = function() {\n      previous = new Date;\n      timeout = null;\n      result = func.apply(context, args);\n    };\n    return function() {\n      var now = new Date;\n      var remaining = wait - (now - previous);\n      context = this;\n      args = arguments;\n      if (remaining <= 0) {\n        clearTimeout(timeout);\n        timeout = null;\n        previous = now;\n        result = func.apply(context, args);\n      } else if (!timeout) {\n        timeout = setTimeout(later, remaining);\n      }\n      return result;\n    };\n  };\n\n  // Returns a function, that, as long as it continues to be invoked, will not\n  // be triggered. The function will be called after it stops being called for\n  // N milliseconds. If `immediate` is passed, trigger the function on the\n  // leading edge, instead of the trailing.\n  _.debounce = function(func, wait, immediate) {\n    var timeout, result;\n    return function() {\n      var context = this, args = arguments;\n      var later = function() {\n        timeout = null;\n        if (!immediate) result = func.apply(context, args);\n      };\n      var callNow = immediate && !timeout;\n      clearTimeout(timeout);\n      timeout = setTimeout(later, wait);\n      if (callNow) result = func.apply(context, args);\n      return result;\n    };\n  };\n\n  // Returns a function that will be executed at most one time, no matter how\n  // often you call it. Useful for lazy initialization.\n  _.once = function(func) {\n    var ran = false, memo;\n    return function() {\n      if (ran) return memo;\n      ran = true;\n      memo = func.apply(this, arguments);\n      func = null;\n      return memo;\n    };\n  };\n\n  // Returns the first function passed as an argument to the second,\n  // allowing you to adjust arguments, run code before and after, and\n  // conditionally execute the original function.\n  _.wrap = function(func, wrapper) {\n    return function() {\n      var args = [func];\n      push.apply(args, arguments);\n      return wrapper.apply(this, args);\n    };\n  };\n\n  // Returns a function that is the composition of a list of functions, each\n  // consuming the return value of the function that follows.\n  _.compose = function() {\n    var funcs = arguments;\n    return function() {\n      var args = arguments;\n      for (var i = funcs.length - 1; i >= 0; i--) {\n        args = [funcs[i].apply(this, args)];\n      }\n      return args[0];\n    };\n  };\n\n  // Returns a function that will only be executed after being called N times.\n  _.after = function(times, func) {\n    if (times <= 0) return func();\n    return function() {\n      if (--times < 1) {\n        return func.apply(this, arguments);\n      }\n    };\n  };\n\n  // Object Functions\n  // ----------------\n\n  // Retrieve the names of an object\'s properties.\n  // Delegates to **ECMAScript 5**\'s native `Object.keys`\n  _.keys = nativeKeys || function(obj) {\n    if (obj !== Object(obj)) throw new TypeError(\'Invalid object\');\n    var keys = [];\n    for (var key in obj) if (_.has(obj, key)) keys[keys.length] = key;\n    return keys;\n  };\n\n  // Retrieve the values of an object\'s properties.\n  _.values = function(obj) {\n    var values = [];\n    for (var key in obj) if (_.has(obj, key)) values.push(obj[key]);\n    return values;\n  };\n\n  // Convert an object into a list of `[key, value]` pairs.\n  _.pairs = function(obj) {\n    var pairs = [];\n    for (var key in obj) if (_.has(obj, key)) pairs.push([key, obj[key]]);\n    return pairs;\n  };\n\n  // Invert the keys and values of an object. The values must be serializable.\n  _.invert = function(obj) {\n    var result = {};\n    for (var key in obj) if (_.has(obj, key)) result[obj[key]] = key;\n    return result;\n  };\n\n  // Return a sorted list of the function names available on the object.\n  // Aliased as `methods`\n  _.functions = _.methods = function(obj) {\n    var names = [];\n    for (var key in obj) {\n      if (_.isFunction(obj[key])) names.push(key);\n    }\n    return names.sort();\n  };\n\n  // Extend a given object with all the properties in passed-in object(s).\n  _.extend = function(obj) {\n    each(slice.call(arguments, 1), function(source) {\n      if (source) {\n        for (var prop in source) {\n          obj[prop] = source[prop];\n        }\n      }\n    });\n    return obj;\n  };\n\n  // Return a copy of the object only containing the whitelisted properties.\n  _.pick = function(obj) {\n    var copy = {};\n    var keys = concat.apply(ArrayProto, slice.call(arguments, 1));\n    each(keys, function(key) {\n      if (key in obj) copy[key] = obj[key];\n    });\n    return copy;\n  };\n\n   // Return a copy of the object without the blacklisted properties.\n  _.omit = function(obj) {\n    var copy = {};\n    var keys = concat.apply(ArrayProto, slice.call(arguments, 1));\n    for (var key in obj) {\n      if (!_.contains(keys, key)) copy[key] = obj[key];\n    }\n    return copy;\n  };\n\n  // Fill in a given object with default properties.\n  _.defaults = function(obj) {\n    each(slice.call(arguments, 1), function(source) {\n      if (source) {\n        for (var prop in source) {\n          if (obj[prop] == null) obj[prop] = source[prop];\n        }\n      }\n    });\n    return obj;\n  };\n\n  // Create a (shallow-cloned) duplicate of an object.\n  _.clone = function(obj) {\n    if (!_.isObject(obj)) return obj;\n    return _.isArray(obj) ? obj.slice() : _.extend({}, obj);\n  };\n\n  // Invokes interceptor with the obj, and then returns obj.\n  // The primary purpose of this method is to "tap into" a method chain, in\n  // order to perform operations on intermediate results within the chain.\n  _.tap = function(obj, interceptor) {\n    interceptor(obj);\n    return obj;\n  };\n\n  // Internal recursive comparison function for `isEqual`.\n  var eq = function(a, b, aStack, bStack) {\n    // Identical objects are equal. `0 === -0`, but they aren\'t identical.\n    // See the Harmony `egal` proposal: http://wiki.ecmascript.org/doku.php?id=harmony:egal.\n    if (a === b) return a !== 0 || 1 / a == 1 / b;\n    // A strict comparison is necessary because `null == undefined`.\n    if (a == null || b == null) return a === b;\n    // Unwrap any wrapped objects.\n    if (a instanceof _) a = a._wrapped;\n    if (b instanceof _) b = b._wrapped;\n    // Compare `[[Class]]` names.\n    var className = toString.call(a);\n    if (className != toString.call(b)) return false;\n    switch (className) {\n      // Strings, numbers, dates, and booleans are compared by value.\n      case \'[object String]\':\n        // Primitives and their corresponding object wrappers are equivalent; thus, `"5"` is\n        // equivalent to `new String("5")`.\n        return a == String(b);\n      case \'[object Number]\':\n        // `NaN`s are equivalent, but non-reflexive. An `egal` comparison is performed for\n        // other numeric values.\n        return a != +a ? b != +b : (a == 0 ? 1 / a == 1 / b : a == +b);\n      case \'[object Date]\':\n      case \'[object Boolean]\':\n        // Coerce dates and booleans to numeric primitive values. Dates are compared by their\n        // millisecond representations. Note that invalid dates with millisecond representations\n        // of `NaN` are not equivalent.\n        return +a == +b;\n      // RegExps are compared by their source patterns and flags.\n      case \'[object RegExp]\':\n        return a.source == b.source &&\n               a.global == b.global &&\n               a.multiline == b.multiline &&\n               a.ignoreCase == b.ignoreCase;\n    }\n    if (typeof a != \'object\' || typeof b != \'object\') return false;\n    // Assume equality for cyclic structures. The algorithm for detecting cyclic\n    // structures is adapted from ES 5.1 section 15.12.3, abstract operation `JO`.\n    var length = aStack.length;\n    while (length--) {\n      // Linear search. Performance is inversely proportional to the number of\n      // unique nested structures.\n      if (aStack[length] == a) return bStack[length] == b;\n    }\n    // Add the first object to the stack of traversed objects.\n    aStack.push(a);\n    bStack.push(b);\n    var size = 0, result = true;\n    // Recursively compare objects and arrays.\n    if (className == \'[object Array]\') {\n      // Compare array lengths to determine if a deep comparison is necessary.\n      size = a.length;\n      result = size == b.length;\n      if (result) {\n        // Deep compare the contents, ignoring non-numeric properties.\n        while (size--) {\n          if (!(result = eq(a[size], b[size], aStack, bStack))) break;\n        }\n      }\n    } else {\n      // Objects with different constructors are not equivalent, but `Object`s\n      // from different frames are.\n      var aCtor = a.constructor, bCtor = b.constructor;\n      if (aCtor !== bCtor && !(_.isFunction(aCtor) && (aCtor instanceof aCtor) &&\n                               _.isFunction(bCtor) && (bCtor instanceof bCtor))) {\n        return false;\n      }\n      // Deep compare objects.\n      for (var key in a) {\n        if (_.has(a, key)) {\n          // Count the expected number of properties.\n          size++;\n          // Deep compare each member.\n          if (!(result = _.has(b, key) && eq(a[key], b[key], aStack, bStack))) break;\n        }\n      }\n      // Ensure that both objects contain the same number of properties.\n      if (result) {\n        for (key in b) {\n          if (_.has(b, key) && !(size--)) break;\n        }\n        result = !size;\n      }\n    }\n    // Remove the first object from the stack of traversed objects.\n    aStack.pop();\n    bStack.pop();\n    return result;\n  };\n\n  // Perform a deep comparison to check if two objects are equal.\n  _.isEqual = function(a, b) {\n    return eq(a, b, [], []);\n  };\n\n  // Is a given array, string, or object empty?\n  // An "empty" object has no enumerable own-properties.\n  _.isEmpty = function(obj) {\n    if (obj == null) return true;\n    if (_.isArray(obj) || _.isString(obj)) return obj.length === 0;\n    for (var key in obj) if (_.has(obj, key)) return false;\n    return true;\n  };\n\n  // Is a given value a DOM element?\n  _.isElement = function(obj) {\n    return !!(obj && obj.nodeType === 1);\n  };\n\n  // Is a given value an array?\n  // Delegates to ECMA5\'s native Array.isArray\n  _.isArray = nativeIsArray || function(obj) {\n    return toString.call(obj) == \'[object Array]\';\n  };\n\n  // Is a given variable an object?\n  _.isObject = function(obj) {\n    return obj === Object(obj);\n  };\n\n  // Add some isType methods: isArguments, isFunction, isString, isNumber, isDate, isRegExp.\n  each([\'Arguments\', \'Function\', \'String\', \'Number\', \'Date\', \'RegExp\'], function(name) {\n    _[\'is\' + name] = function(obj) {\n      return toString.call(obj) == \'[object \' + name + \']\';\n    };\n  });\n\n  // Define a fallback version of the method in browsers (ahem, IE), where\n  // there isn\'t any inspectable "Arguments" type.\n  if (!_.isArguments(arguments)) {\n    _.isArguments = function(obj) {\n      return !!(obj && _.has(obj, \'callee\'));\n    };\n  }\n\n  // Optimize `isFunction` if appropriate.\n  if (typeof (/./) !== \'function\') {\n    _.isFunction = function(obj) {\n      return typeof obj === \'function\';\n    };\n  }\n\n  // Is a given object a finite number?\n  _.isFinite = function(obj) {\n    return isFinite(obj) && !isNaN(parseFloat(obj));\n  };\n\n  // Is the given value `NaN`? (NaN is the only number which does not equal itself).\n  _.isNaN = function(obj) {\n    return _.isNumber(obj) && obj != +obj;\n  };\n\n  // Is a given value a boolean?\n  _.isBoolean = function(obj) {\n    return obj === true || obj === false || toString.call(obj) == \'[object Boolean]\';\n  };\n\n  // Is a given value equal to null?\n  _.isNull = function(obj) {\n    return obj === null;\n  };\n\n  // Is a given variable undefined?\n  _.isUndefined = function(obj) {\n    return obj === void 0;\n  };\n\n  // Shortcut function for checking if an object has a given property directly\n  // on itself (in other words, not on a prototype).\n  _.has = function(obj, key) {\n    return hasOwnProperty.call(obj, key);\n  };\n\n  // Utility Functions\n  // -----------------\n\n  // Run Underscore.js in *noConflict* mode, returning the `_` variable to its\n  // previous owner. Returns a reference to the Underscore object.\n  _.noConflict = function() {\n    root._ = previousUnderscore;\n    return this;\n  };\n\n  // Keep the identity function around for default iterators.\n  _.identity = function(value) {\n    return value;\n  };\n\n  // Run a function **n** times.\n  _.times = function(n, iterator, context) {\n    var accum = Array(n);\n    for (var i = 0; i < n; i++) accum[i] = iterator.call(context, i);\n    return accum;\n  };\n\n  // Return a random integer between min and max (inclusive).\n  _.random = function(min, max) {\n    if (max == null) {\n      max = min;\n      min = 0;\n    }\n    return min + Math.floor(Math.random() * (max - min + 1));\n  };\n\n  // List of HTML entities for escaping.\n  var entityMap = {\n    escape: {\n      \'&\': \'&amp;\',\n      \'<\': \'&lt;\',\n      \'>\': \'&gt;\',\n      \'"\': \'&quot;\',\n      "\'": \'&#x27;\',\n      \'/\': \'&#x2F;\'\n    }\n  };\n  entityMap.unescape = _.invert(entityMap.escape);\n\n  // Regexes containing the keys and values listed immediately above.\n  var entityRegexes = {\n    escape:   new RegExp(\'[\' + _.keys(entityMap.escape).join(\'\') + \']\', \'g\'),\n    unescape: new RegExp(\'(\' + _.keys(entityMap.unescape).join(\'|\') + \')\', \'g\')\n  };\n\n  // Functions for escaping and unescaping strings to/from HTML interpolation.\n  _.each([\'escape\', \'unescape\'], function(method) {\n    _[method] = function(string) {\n      if (string == null) return \'\';\n      return (\'\' + string).replace(entityRegexes[method], function(match) {\n        return entityMap[method][match];\n      });\n    };\n  });\n\n  // If the value of the named property is a function then invoke it;\n  // otherwise, return it.\n  _.result = function(object, property) {\n    if (object == null) return null;\n    var value = object[property];\n    return _.isFunction(value) ? value.call(object) : value;\n  };\n\n  // Add your own custom functions to the Underscore object.\n  _.mixin = function(obj) {\n    each(_.functions(obj), function(name){\n      var func = _[name] = obj[name];\n      _.prototype[name] = function() {\n        var args = [this._wrapped];\n        push.apply(args, arguments);\n        return result.call(this, func.apply(_, args));\n      };\n    });\n  };\n\n  // Generate a unique integer id (unique within the entire client session).\n  // Useful for temporary DOM ids.\n  var idCounter = 0;\n  _.uniqueId = function(prefix) {\n    var id = ++idCounter + \'\';\n    return prefix ? prefix + id : id;\n  };\n\n  // By default, Underscore uses ERB-style template delimiters, change the\n  // following template settings to use alternative delimiters.\n  _.templateSettings = {\n    evaluate    : /<%([\\s\\S]+?)%>/g,\n    interpolate : /<%=([\\s\\S]+?)%>/g,\n    escape      : /<%-([\\s\\S]+?)%>/g\n  };\n\n  // When customizing `templateSettings`, if you don\'t want to define an\n  // interpolation, evaluation or escaping regex, we need one that is\n  // guaranteed not to match.\n  var noMatch = /(.)^/;\n\n  // Certain characters need to be escaped so that they can be put into a\n  // string literal.\n  var escapes = {\n    "\'":      "\'",\n    \'\\\\\':     \'\\\\\',\n    \'\\r\':     \'r\',\n    \'\\n\':     \'n\',\n    \'\\t\':     \'t\',\n    \'\\u2028\': \'u2028\',\n    \'\\u2029\': \'u2029\'\n  };\n\n  var escaper = /\\\\|\'|\\r|\\n|\\t|\\u2028|\\u2029/g;\n\n  // JavaScript micro-templating, similar to John Resig\'s implementation.\n  // Underscore templating handles arbitrary delimiters, preserves whitespace,\n  // and correctly escapes quotes within interpolated code.\n  _.template = function(text, data, settings) {\n    var render;\n    settings = _.defaults({}, settings, _.templateSettings);\n\n    // Combine delimiters into one regular expression via alternation.\n    var matcher = new RegExp([\n      (settings.escape || noMatch).source,\n      (settings.interpolate || noMatch).source,\n      (settings.evaluate || noMatch).source\n    ].join(\'|\') + \'|$\', \'g\');\n\n    // Compile the template source, escaping string literals appropriately.\n    var index = 0;\n    var source = "__p+=\'";\n    text.replace(matcher, function(match, escape, interpolate, evaluate, offset) {\n      source += text.slice(index, offset)\n        .replace(escaper, function(match) { return \'\\\\\' + escapes[match]; });\n\n      if (escape) {\n        source += "\'+\\n((__t=(" + escape + "))==null?\'\':_.escape(__t))+\\n\'";\n      }\n      if (interpolate) {\n        source += "\'+\\n((__t=(" + interpolate + "))==null?\'\':__t)+\\n\'";\n      }\n      if (evaluate) {\n        source += "\';\\n" + evaluate + "\\n__p+=\'";\n      }\n      index = offset + match.length;\n      return match;\n    });\n    source += "\';\\n";\n\n    // If a variable is not specified, place data values in local scope.\n    if (!settings.variable) source = \'with(obj||{}){\\n\' + source + \'}\\n\';\n\n    source = "var __t,__p=\'\',__j=Array.prototype.join," +\n      "print=function(){__p+=__j.call(arguments,\'\');};\\n" +\n      source + "return __p;\\n";\n\n    try {\n      render = new Function(settings.variable || \'obj\', \'_\', source);\n    } catch (e) {\n      e.source = source;\n      throw e;\n    }\n\n    if (data) return render(data, _);\n    var template = function(data) {\n      return render.call(this, data, _);\n    };\n\n    // Provide the compiled function source as a convenience for precompilation.\n    template.source = \'function(\' + (settings.variable || \'obj\') + \'){\\n\' + source + \'}\';\n\n    return template;\n  };\n\n  // Add a "chain" function, which will delegate to the wrapper.\n  _.chain = function(obj) {\n    return _(obj).chain();\n  };\n\n  // OOP\n  // ---------------\n  // If Underscore is called as a function, it returns a wrapped object that\n  // can be used OO-style. This wrapper holds altered versions of all the\n  // underscore functions. Wrapped objects may be chained.\n\n  // Helper function to continue chaining intermediate results.\n  var result = function(obj) {\n    return this._chain ? _(obj).chain() : obj;\n  };\n\n  // Add all of the Underscore functions to the wrapper object.\n  _.mixin(_);\n\n  // Add all mutator Array functions to the wrapper.\n  each([\'pop\', \'push\', \'reverse\', \'shift\', \'sort\', \'splice\', \'unshift\'], function(name) {\n    var method = ArrayProto[name];\n    _.prototype[name] = function() {\n      var obj = this._wrapped;\n      method.apply(obj, arguments);\n      if ((name == \'shift\' || name == \'splice\') && obj.length === 0) delete obj[0];\n      return result.call(this, obj);\n    };\n  });\n\n  // Add all accessor Array functions to the wrapper.\n  each([\'concat\', \'join\', \'slice\'], function(name) {\n    var method = ArrayProto[name];\n    _.prototype[name] = function() {\n      return result.call(this, method.apply(this._wrapped, arguments));\n    };\n  });\n\n  _.extend(_.prototype, {\n\n    // Start chaining a wrapped Underscore object.\n    chain: function() {\n      this._chain = true;\n      return this;\n    },\n\n    // Extracts the result from a wrapped and chained object.\n    value: function() {\n      return this._wrapped;\n    }\n\n  });\n\n}).call(this);\n\n/*global _: false, $: false, localStorage: false, process: true,\n  XMLHttpRequest: false, XDomainRequest: false, exports: false,\n  require: false */\n(function(root) {\n  root.Parse = root.Parse || {};\n  /**\n   * Contains all Parse API classes and functions.\n   * @name Parse\n   * @namespace\n   *\n   * Contains all Parse API classes and functions.\n   */\n  var Parse = root.Parse;\n\n  // Import Parse\'s local copy of underscore.\n  if (typeof(exports) !== "undefined" && exports._) {\n    // We\'re running in Node.js.  Pull in the dependencies.\n    Parse._ = exports._.noConflict();\n    Parse.localStorage = require(\'localStorage\');\n    Parse.XMLHttpRequest = require(\'xmlhttprequest\').XMLHttpRequest;\n    exports.Parse = Parse;\n  } else {\n    Parse._ = _.noConflict();\n    if (typeof(localStorage) !== "undefined") {\n      Parse.localStorage = localStorage;\n    }\n    if (typeof(XMLHttpRequest) !== "undefined") {\n      Parse.XMLHttpRequest = XMLHttpRequest;\n    }\n  }\n\n  // If jQuery or Zepto has been included, grab a reference to it.\n  if (typeof($) !== "undefined") {\n    Parse.$ = $;\n  }\n\n  // Helpers\n  // -------\n\n  // Shared empty constructor function to aid in prototype-chain creation.\n  var EmptyConstructor = function() {};\n\n\n  // Helper function to correctly set up the prototype chain, for subclasses.\n  // Similar to `goog.inherits`, but uses a hash of prototype properties and\n  // class properties to be extended.\n  var inherits = function(parent, protoProps, staticProps) {\n    var child;\n\n    // The constructor function for the new subclass is either defined by you\n    // (the "constructor" property in your `extend` definition), or defaulted\n    // by us to simply call the parent\'s constructor.\n    if (protoProps && protoProps.hasOwnProperty(\'constructor\')) {\n      child = protoProps.constructor;\n    } else {\n      /** @ignore */\n      child = function(){ parent.apply(this, arguments); };\n    }\n\n    // Inherit class (static) properties from parent.\n    Parse._.extend(child, parent);\n\n    // Set the prototype chain to inherit from `parent`, without calling\n    // `parent`\'s constructor function.\n    EmptyConstructor.prototype = parent.prototype;\n    child.prototype = new EmptyConstructor();\n\n    // Add prototype properties (instance properties) to the subclass,\n    // if supplied.\n    if (protoProps) {\n      Parse._.extend(child.prototype, protoProps);\n    }\n\n    // Add static properties to the constructor function, if supplied.\n    if (staticProps) {\n      Parse._.extend(child, staticProps);\n    }\n\n    // Correctly set child\'s `prototype.constructor`.\n    child.prototype.constructor = child;\n\n    // Set a convenience property in case the parent\'s prototype is\n    // needed later.\n    child.__super__ = parent.prototype;\n\n    return child;\n  };\n\n  // Set the server for Parse to talk to.\n  Parse.serverURL = "https://api.parse.com";\n\n  // Check whether we are running in Node.js.\n  if (typeof(process) !== "undefined" &&\n      process.versions &&\n      process.versions.node) {\n    Parse._isNode = true;\n  }\n\n  /**\n   * Call this method first to set up your authentication tokens for Parse.\n   * You can get your keys from the Data Browser on parse.com.\n   * @param {String} applicationId Your Parse Application ID.\n   * @param {String} javaScriptKey Your Parse JavaScript Key.\n   * @param {String} masterKey (optional) Your Parse Master Key. (Node.js only!)\n   */\n  Parse.initialize = function(applicationId, javaScriptKey, masterKey) {\n    if (masterKey) {\n      throw "Parse.initialize() was passed a Master Key, which is only " +\n        "allowed from within Node.js.";\n    }\n    Parse._initialize(applicationId, javaScriptKey);\n  };\n\n  /**\n   * Call this method first to set up master authentication tokens for Parse.\n   * This method is for Parse\'s own private use.\n   * @param {String} applicationId Your Parse Application ID.\n   * @param {String} javaScriptKey Your Parse JavaScript Key.\n   * @param {String} masterKey Your Parse Master Key.\n   */\n  Parse._initialize = function(applicationId, javaScriptKey, masterKey) {\n    Parse.applicationId = applicationId;\n    Parse.javaScriptKey = javaScriptKey;\n    Parse.masterKey = masterKey;\n    Parse._useMasterKey = false;\n  };\n\n  // If we\'re running in node.js, allow using the master key.\n  if (Parse._isNode) {\n    Parse.initialize = Parse._initialize;\n\n    Parse.Cloud = Parse.Cloud || {};\n    /**\n     * Switches the Parse SDK to using the Master key.  The Master key grants\n     * priveleged access to the data in Parse and can be used to bypass ACLs and\n     * other restrictions that are applied to the client SDKs.\n     * <p><strong><em>Available in Cloud Code and Node.js only.</em></strong>\n     * </p>\n     */\n    Parse.Cloud.useMasterKey = function() {\n      Parse._useMasterKey = true;\n    };\n  }\n\n  /**\n   * Returns prefix for localStorage keys used by this instance of Parse.\n   * @param {String} path The relative suffix to append to it.\n   *     null or undefined is treated as the empty string.\n   * @return {String} The full key name.\n   */\n  Parse._getParsePath = function(path) {\n    if (!Parse.applicationId) {\n      throw "You need to call Parse.initialize before using Parse.";\n    }\n    if (!path) {\n      path = "";\n    }\n    if (!Parse._.isString(path)) {\n      throw "Tried to get a localStorage path that wasn\'t a String.";\n    }\n    if (path[0] === "/") {\n      path = path.substring(1);\n    }\n    return "Parse/" + Parse.applicationId + "/" + path;\n  };\n\n  /**\n   * Returns the unique string for this app on this machine.\n   * Gets reset when localStorage is cleared.\n   */\n  Parse._installationId = null;\n  Parse._getInstallationId = function() {\n    // See if it\'s cached in RAM.\n    if (Parse._installationId) {\n      return Parse._installationId;\n    }\n\n    // Try to get it from localStorage.\n    var path = Parse._getParsePath("installationId");\n    Parse._installationId = Parse.localStorage.getItem(path);\n\n    if (!Parse._installationId || Parse._installationId === "") {\n      // It wasn\'t in localStorage, so create a new one.\n      var hexOctet = function() {\n        return Math.floor((1+Math.random())*0x10000).toString(16).substring(1);\n      };\n      Parse._installationId = (\n        hexOctet() + hexOctet() + "-" +\n        hexOctet() + "-" +\n        hexOctet() + "-" +\n        hexOctet() + "-" +\n        hexOctet() + hexOctet() + hexOctet());\n      Parse.localStorage.setItem(path, Parse._installationId);\n    }\n\n    return Parse._installationId;\n  };\n\n  Parse._parseDate = function(iso8601) {\n    var regexp = new RegExp(\n      "^([0-9]{1,4})-([0-9]{1,2})-([0-9]{1,2})" + "T" +\n      "([0-9]{1,2}):([0-9]{1,2}):([0-9]{1,2})" +\n      "(.([0-9]+))?" + "Z$");\n    var match = regexp.exec(iso8601);\n    if (!match) {\n      var date = new Date(iso8601);\n      return date.getTime() === NaN ? null : date;\n    }\n\n    var year = match[1] || 0;\n    var month = (match[2] || 1) - 1;\n    var day = match[3] || 0;\n    var hour = match[4] || 0;\n    var minute = match[5] || 0;\n    var second = match[6] || 0;\n    var milli = match[8] || 0;\n\n    return new Date(Date.UTC(year, month, day, hour, minute, second, milli));\n  };\n\n  Parse._ajaxIE8 = function(method, url, data) {\n    var promise = new Parse.Promise();\n    var xdr = new XDomainRequest();\n    xdr.onload = function() {\n      var response;\n      try {\n        response = JSON.parse(xdr.responseText);\n      } catch (e) {\n        promise.reject(e);\n      }\n      if (response) {\n        promise.resolve(response);\n      }\n    };\n    xdr.onerror = xdr.ontimeout = function() {\n      // Let\'s fake a real error message.\n      var fakeResponse = {\n        responseText: JSON.stringify({\n          code: Parse.Error.X_DOMAIN_REQUEST,\n          error: "IE\'s XDomainRequest does not supply error info."\n        })\n      };\n      promise.reject(fakeResponse);\n    };\n    xdr.onprogress = function() {};\n    xdr.open(method, url);\n    xdr.send(data);\n    return promise;\n  };\n\n  Parse._useXDomainRequest = function() {\n    if (typeof(XDomainRequest) !== "undefined") {\n      // We\'re in IE 8+.\n      if (\'withCredentials\' in new XMLHttpRequest()) {\n        // We\'re in IE 10+.\n        return false;\n      }\n      return true;\n    }\n    return false;\n  };\n\n\n  Parse._ajax = function(method, url, data, success, error) {\n    var options = {\n      success: success,\n      error: error\n    };\n\n    if (Parse._useXDomainRequest()) {\n      return Parse._ajaxIE8(method, url, data)._thenRunCallbacks(options);\n    }\n\n    var promise = new Parse.Promise();\n    var handled = false;\n\n    var xhr = new Parse.XMLHttpRequest();\n    xhr.onreadystatechange = function() {\n      if (xhr.readyState === 4) {\n        if (handled) {\n          return;\n        }\n        handled = true;\n\n        if (xhr.status >= 200 && xhr.status < 300) {\n          var response;\n          try {\n            response = JSON.parse(xhr.responseText);\n          } catch (e) {\n            promise.reject(e);\n          }\n          if (response) {\n            promise.resolve(response, xhr.status, xhr);\n          }\n        } else {\n          promise.reject(xhr);\n        }\n      }\n    };\n    xhr.open(method, url, true);\n    xhr.setRequestHeader("Content-Type", "text/plain");  // avoid pre-flight.\n    if (Parse._isNode) {\n      // Add a special user agent just for request from node.js.\n      xhr.setRequestHeader("User-Agent",\n                           "Parse/" + Parse.VERSION +\n                           " (NodeJS " + process.versions.node + ")");\n    }\n    xhr.send(data);\n    return promise._thenRunCallbacks(options);\n  };\n\n  // A self-propagating extend function.\n  Parse._extend = function(protoProps, classProps) {\n    var child = inherits(this, protoProps, classProps);\n    child.extend = this.extend;\n    return child;\n  };\n\n  /**\n   * Options:\n   *   route: is classes, users, login, etc.\n   *   objectId: null if there is no associated objectId.\n   *   method: the http method for the REST API.\n   *   dataObject: the payload as an object, or null if there is none.\n   *   useMasterKey: overrides whether to use the master key if set.\n   * @ignore\n   */\n  Parse._request = function(options) {\n    var route = options.route;\n    var className = options.className;\n    var objectId = options.objectId;\n    var method = options.method;\n    var useMasterKey = options.useMasterKey;\n    var sessionToken = options.sessionToken;\n    var dataObject = options.data;\n\n    if (!Parse.applicationId) {\n      throw "You must specify your applicationId using Parse.initialize.";\n    }\n\n    if (!Parse.javaScriptKey && !Parse.masterKey) {\n      throw "You must specify a key using Parse.initialize.";\n    }\n\n\n    if (!sessionToken) {\n      // Use the current user session token if none was provided.\n      var currentUser = Parse.User.current();\n      if (currentUser && currentUser._sessionToken) {\n        sessionToken = currentUser._sessionToken;\n      }\n    }\n\n\n    if (route !== "batch" &&\n        route !== "classes" &&\n        route !== "events" &&\n        route !== "files" &&\n        route !== "functions" &&\n        route !== "login" &&\n        route !== "push" &&\n        route !== "requestPasswordReset" &&\n        route !== "rest_verify_analytics" &&\n        route !== "users" &&\n        route !== "jobs") {\n      throw "Bad route: \'" + route + "\'.";\n    }\n\n    var url = Parse.serverURL;\n    if (url.charAt(url.length - 1) !== "/") {\n      url += "/";\n    }\n    url += "1/" + route;\n    if (className) {\n      url += "/" + className;\n    }\n    if (objectId) {\n      url += "/" + objectId;\n    }\n\n    dataObject = Parse._.clone(dataObject || {});\n    if (method !== "POST") {\n      dataObject._method = method;\n      method = "POST";\n    }\n\n    if (Parse._.isUndefined(useMasterKey)) {\n      useMasterKey = Parse._useMasterKey;\n    }\n\n    dataObject._ApplicationId = Parse.applicationId;\n    if (!useMasterKey) {\n      dataObject._JavaScriptKey = Parse.javaScriptKey;\n    } else {\n      dataObject._MasterKey = Parse.masterKey;\n    }\n\n    dataObject._ClientVersion = Parse.VERSION;\n    dataObject._InstallationId = Parse._getInstallationId();\n    if (sessionToken) {\n      dataObject._SessionToken = sessionToken;\n    }\n    var data = JSON.stringify(dataObject);\n\n    return Parse._ajax(method, url, data).then(null, function(response) {\n      // Transform the error into an instance of Parse.Error by trying to parse\n      // the error string as JSON.\n      var error;\n      if (response && response.responseText) {\n        try {\n          var errorJSON = JSON.parse(response.responseText);\n          error = new Parse.Error(errorJSON.code, errorJSON.error);\n        } catch (e) {\n          // If we fail to parse the error text, that\'s okay.\n          error = new Parse.Error(\n              Parse.Error.INVALID_JSON,\n              "Received an error with invalid JSON from Parse: " +\n                  response.responseText);\n        }\n      } else {\n        error = new Parse.Error(\n            Parse.Error.CONNECTION_FAILED,\n            "XMLHttpRequest failed: " + JSON.stringify(response));\n      }\n      // By explicitly returning a rejected Promise, this will work with\n      // either jQuery or Promises/A semantics.\n      return Parse.Promise.error(error);\n    });\n  };\n\n  // Helper function to get a value from a Backbone object as a property\n  // or as a function.\n  Parse._getValue = function(object, prop) {\n    if (!(object && object[prop])) {\n      return null;\n    }\n    return Parse._.isFunction(object[prop]) ? object[prop]() : object[prop];\n  };\n\n  /**\n   * Converts a value in a Parse Object into the appropriate representation.\n   * This is the JS equivalent of Java\'s Parse.maybeReferenceAndEncode(Object)\n   * if seenObjects is falsey. Otherwise any Parse.Objects not in\n   * seenObjects will be fully embedded rather than encoded\n   * as a pointer.  This array will be used to prevent going into an infinite\n   * loop because we have circular references.  If seenObjects\n   * is set, then none of the Parse Objects that are serialized can be dirty.\n   */\n  Parse._encode = function(value, seenObjects, disallowObjects) {\n    var _ = Parse._;\n    if (value instanceof Parse.Object) {\n      if (disallowObjects) {\n        throw "Parse.Objects not allowed here";\n      }\n      if (!seenObjects || _.include(seenObjects, value) || !value._hasData) {\n        return value._toPointer();\n      }\n      if (!value.dirty()) {\n        seenObjects = seenObjects.concat(value);\n        return Parse._encode(value._toFullJSON(seenObjects),\n                             seenObjects,\n                             disallowObjects);\n      }\n      throw "Tried to save an object with a pointer to a new, unsaved object.";\n    }\n    if (value instanceof Parse.ACL) {\n      return value.toJSON();\n    }\n    if (_.isDate(value)) {\n      return { "__type": "Date", "iso": value.toJSON() };\n    }\n    if (value instanceof Parse.GeoPoint) {\n      return value.toJSON();\n    }\n    if (_.isArray(value)) {\n      return _.map(value, function(x) {\n        return Parse._encode(x, seenObjects, disallowObjects);\n      });\n    }\n    if (_.isRegExp(value)) {\n      return value.source;\n    }\n    if (value instanceof Parse.Relation) {\n      return value.toJSON();\n    }\n    if (value instanceof Parse.Op) {\n      return value.toJSON();\n    }\n    if (value instanceof Parse.File) {\n      if (!value.url()) {\n        throw "Tried to save an object containing an unsaved file.";\n      }\n      return {\n        __type: "File",\n        name: value.name(),\n        url: value.url()\n      };\n    }\n    if (_.isObject(value)) {\n      var output = {};\n      Parse._objectEach(value, function(v, k) {\n        output[k] = Parse._encode(v, seenObjects, disallowObjects);\n      });\n      return output;\n    }\n    return value;\n  };\n\n  /**\n   * The inverse function of Parse._encode.\n   * TODO: make decode not mutate value.\n   */\n  Parse._decode = function(key, value) {\n    var _ = Parse._;\n    if (!_.isObject(value)) {\n      return value;\n    }\n    if (_.isArray(value)) {\n      Parse._arrayEach(value, function(v, k) {\n        value[k] = Parse._decode(k, v);\n      });\n      return value;\n    }\n    if (value instanceof Parse.Object) {\n      return value;\n    }\n    if (value instanceof Parse.File) {\n      return value;\n    }\n    if (value instanceof Parse.Op) {\n      return value;\n    }\n    if (value.__op) {\n      return Parse.Op._decode(value);\n    }\n    if (value.__type === "Pointer") {\n      var pointer = Parse.Object._create(value.className);\n      pointer._finishFetch({ objectId: value.objectId }, false);\n      return pointer;\n    }\n    if (value.__type === "Object") {\n      // It\'s an Object included in a query result.\n      var className = value.className;\n      delete value.__type;\n      delete value.className;\n      var object = Parse.Object._create(className);\n      object._finishFetch(value, true);\n      return object;\n    }\n    if (value.__type === "Date") {\n      return Parse._parseDate(value.iso);\n    }\n    if (value.__type === "GeoPoint") {\n      return new Parse.GeoPoint({\n        latitude: value.latitude,\n        longitude: value.longitude\n      });\n    }\n    if (key === "ACL") {\n      if (value instanceof Parse.ACL) {\n        return value;\n      }\n      return new Parse.ACL(value);\n    }\n    if (value.__type === "Relation") {\n      var relation = new Parse.Relation(null, key);\n      relation.targetClassName = value.className;\n      return relation;\n    }\n    if (value.__type === "File") {\n      var file = new Parse.File(value.name);\n      file._url = value.url;\n      return file;\n    }\n    Parse._objectEach(value, function(v, k) {\n      value[k] = Parse._decode(k, v);\n    });\n    return value;\n  };\n\n  Parse._arrayEach = Parse._.each;\n\n  /**\n   * Does a deep traversal of every item in object, calling func on every one.\n   * @param {Object} object The object or array to traverse deeply.\n   * @param {Function} func The function to call for every item. It will\n   *     be passed the item as an argument. If it returns a truthy value, that\n   *     value will replace the item in its parent container.\n   * @returns {} the result of calling func on the top-level object itself.\n   */\n  Parse._traverse = function(object, func, seen) {\n    if (object instanceof Parse.Object) {\n      seen = seen || [];\n      if (Parse._.indexOf(seen, object) >= 0) {\n        // We\'ve already visited this object in this call.\n        return;\n      }\n      seen.push(object);\n      Parse._traverse(object.attributes, func, seen);\n      return func(object);\n    }\n    if (object instanceof Parse.Relation || object instanceof Parse.File) {\n      // Nothing needs to be done, but we don\'t want to recurse into the\n      // object\'s parent infinitely, so we catch this case.\n      return func(object);\n    }\n    if (Parse._.isArray(object)) {\n      Parse._.each(object, function(child, index) {\n        var newChild = Parse._traverse(child, func, seen);\n        if (newChild) {\n          object[index] = newChild;\n        }\n      });\n      return func(object);\n    }\n    if (Parse._.isObject(object)) {\n      Parse._each(object, function(child, key) {\n        var newChild = Parse._traverse(child, func, seen);\n        if (newChild) {\n          object[key] = newChild;\n        }\n      });\n      return func(object);\n    }\n    return func(object);\n  };\n\n  /**\n   * This is like _.each, except:\n   * * it doesn\'t work for so-called array-like objects,\n   * * it does work for dictionaries with a "length" attribute.\n   */\n  Parse._objectEach = Parse._each = function(obj, callback) {\n    var _ = Parse._;\n    if (_.isObject(obj)) {\n      _.each(_.keys(obj), function(key) {\n        callback(obj[key], key);\n      });\n    } else {\n      _.each(obj, callback);\n    }\n  };\n\n  // Helper function to check null or undefined.\n  Parse._isNullOrUndefined = function(x) {\n    return Parse._.isNull(x) || Parse._.isUndefined(x);\n  };\n}(this));\n\n(function(root) {\n  root.Parse = root.Parse || {};\n  var Parse = root.Parse;\n  var _ = Parse._;\n\n  /**\n   * @namespace Provides an interface to Parse\'s logging and analytics backend.\n   */\n  Parse.Analytics = Parse.Analytics || {};\n\n  _.extend(Parse.Analytics, /** @lends Parse.Analytics */ {\n    /**\n     * Tracks the occurrence of a custom event with additional dimensions.\n     * Parse will store a data point at the time of invocation with the given\n     * event name.\n     *\n     * Dimensions will allow segmentation of the occurrences of this custom\n     * event. Keys and values should be {@code String}s, and will throw\n     * otherwise.\n     *\n     * To track a user signup along with additional metadata, consider the\n     * following:\n     * <pre>\n     * var dimensions = {\n     *  gender: \'m\',\n     *  source: \'web\',\n     *  dayType: \'weekend\'\n     * };\n     * Parse.Analytics.track(\'signup\', dimensions);\n     * </pre>\n     *\n     * There is a default limit of 4 dimensions per event tracked.\n     *\n     * @param {String} name The name of the custom event to report to Parse as\n     * having happened.\n     * @param {Object} dimensions The dictionary of information by which to\n     * segment this event.\n     * @return {Parse.Promise} A promise that is resolved when the round-trip\n     * to the server completes.\n     */\n    track: function(name, dimensions) {\n      name = name || \'\';\n      name = name.replace(/^\\s*/, \'\');\n      name = name.replace(/\\s*$/, \'\');\n      if (name.length === 0) {\n        throw \'A name for the custom event must be provided\';\n      }\n\n      _.each(dimensions, function(val, key) {\n        if (!_.isString(key) || !_.isString(val)) {\n          throw \'track() dimensions expects keys and values of type "string".\';\n        }\n      });\n\n      return Parse._request({\n        route: \'events\',\n        className: name,\n        method: \'POST\',\n        data: { dimensions: dimensions }\n      });\n    }\n  });\n}(this));\n\n(function(root) {\n  root.Parse = root.Parse || {};\n  var Parse = root.Parse;\n  var _ = Parse._;\n\n  /**\n   * Constructs a new Parse.Error object with the given code and message.\n   * @param {Number} code An error code constant from <code>Parse.Error</code>.\n   * @param {String} message A detailed description of the error.\n   * @class\n   *\n   * <p>Class used for all objects passed to error callbacks.</p>\n   */\n  Parse.Error = function(code, message) {\n    this.code = code;\n    this.message = message;\n  };\n\n  _.extend(Parse.Error, /** @lends Parse.Error */ {\n    /**\n     * Error code indicating some error other than those enumerated here.\n     * @constant\n     */\n    OTHER_CAUSE: -1,\n\n    /**\n     * Error code indicating that something has gone wrong with the server.\n     * If you get this error code, it is Parse\'s fault. Contact us at\n     * https://parse.com/help\n     * @constant\n     */\n    INTERNAL_SERVER_ERROR: 1,\n\n    /**\n     * Error code indicating the connection to the Parse servers failed.\n     * @constant\n     */\n    CONNECTION_FAILED: 100,\n\n    /**\n     * Error code indicating the specified object doesn\'t exist.\n     * @constant\n     */\n    OBJECT_NOT_FOUND: 101,\n\n    /**\n     * Error code indicating you tried to query with a datatype that doesn\'t\n     * support it, like exact matching an array or object.\n     * @constant\n     */\n    INVALID_QUERY: 102,\n\n    /**\n     * Error code indicating a missing or invalid classname. Classnames are\n     * case-sensitive. They must start with a letter, and a-zA-Z0-9_ are the\n     * only valid characters.\n     * @constant\n     */\n    INVALID_CLASS_NAME: 103,\n\n    /**\n     * Error code indicating an unspecified object id.\n     * @constant\n     */\n    MISSING_OBJECT_ID: 104,\n\n    /**\n     * Error code indicating an invalid key name. Keys are case-sensitive. They\n     * must start with a letter, and a-zA-Z0-9_ are the only valid characters.\n     * @constant\n     */\n    INVALID_KEY_NAME: 105,\n\n    /**\n     * Error code indicating a malformed pointer. You should not see this unless\n     * you have been mucking about changing internal Parse code.\n     * @constant\n     */\n    INVALID_POINTER: 106,\n\n    /**\n     * Error code indicating that badly formed JSON was received upstream. This\n     * either indicates you have done something unusual with modifying how\n     * things encode to JSON, or the network is failing badly.\n     * @constant\n     */\n    INVALID_JSON: 107,\n\n    /**\n     * Error code indicating that the feature you tried to access is only\n     * available internally for testing purposes.\n     * @constant\n     */\n    COMMAND_UNAVAILABLE: 108,\n\n    /**\n     * You must call Parse.initialize before using the Parse library.\n     * @constant\n     */\n    NOT_INITIALIZED: 109,\n\n    /**\n     * Error code indicating that a field was set to an inconsistent type.\n     * @constant\n     */\n    INCORRECT_TYPE: 111,\n\n    /**\n     * Error code indicating an invalid channel name. A channel name is either\n     * an empty string (the broadcast channel) or contains only a-zA-Z0-9_\n     * characters and starts with a letter.\n     * @constant\n     */\n    INVALID_CHANNEL_NAME: 112,\n\n    /**\n     * Error code indicating that push is misconfigured.\n     * @constant\n     */\n    PUSH_MISCONFIGURED: 115,\n\n    /**\n     * Error code indicating that the object is too large.\n     * @constant\n     */\n    OBJECT_TOO_LARGE: 116,\n\n    /**\n     * Error code indicating that the operation isn\'t allowed for clients.\n     * @constant\n     */\n    OPERATION_FORBIDDEN: 119,\n\n    /**\n     * Error code indicating the result was not found in the cache.\n     * @constant\n     */\n    CACHE_MISS: 120,\n\n    /**\n     * Error code indicating that an invalid key was used in a nested\n     * JSONObject.\n     * @constant\n     */\n    INVALID_NESTED_KEY: 121,\n\n    /**\n     * Error code indicating that an invalid filename was used for ParseFile.\n     * A valid file name contains only a-zA-Z0-9_. characters and is between 1\n     * and 128 characters.\n     * @constant\n     */\n    INVALID_FILE_NAME: 122,\n\n    /**\n     * Error code indicating an invalid ACL was provided.\n     * @constant\n     */\n    INVALID_ACL: 123,\n\n    /**\n     * Error code indicating that the request timed out on the server. Typically\n     * this indicates that the request is too expensive to run.\n     * @constant\n     */\n    TIMEOUT: 124,\n\n    /**\n     * Error code indicating that the email address was invalid.\n     * @constant\n     */\n    INVALID_EMAIL_ADDRESS: 125,\n\n    /**\n     * Error code indicating a missing content type.\n     * @constant\n     */\n    MISSING_CONTENT_TYPE: 126,\n\n    /**\n     * Error code indicating a missing content length.\n     * @constant\n     */\n    MISSING_CONTENT_LENGTH: 127,\n\n    /**\n     * Error code indicating an invalid content length.\n     * @constant\n     */\n    INVALID_CONTENT_LENGTH: 128,\n\n    /**\n     * Error code indicating a file that was too large.\n     * @constant\n     */\n    FILE_TOO_LARGE: 129,\n\n    /**\n     * Error code indicating an error saving a file.\n     * @constant\n     */\n    FILE_SAVE_ERROR: 130,\n\n    /**\n     * Error code indicating an error deleting a file.\n     * @constant\n     */\n    FILE_DELETE_ERROR: 153,\n\n    /**\n     * Error code indicating that a unique field was given a value that is\n     * already taken.\n     * @constant\n     */\n    DUPLICATE_VALUE: 137,\n\n    /**\n     * Error code indicating that a role\'s name is invalid.\n     * @constant\n     */\n    INVALID_ROLE_NAME: 139,\n\n    /**\n     * Error code indicating that an application quota was exceeded.  Upgrade to\n     * resolve.\n     * @constant\n     */\n    EXCEEDED_QUOTA: 140,\n\n    /**\n     * Error code indicating that a Cloud Code script failed.\n     * @constant\n     */\n    SCRIPT_FAILED: 141,\n\n    /**\n     * Error code indicating that a Cloud Code validation failed.\n     * @constant\n     */\n    VALIDATION_ERROR: 142,\n\n    /**\n     * Error code indicating that invalid image data was provided.\n     * @constant\n     */\n    INVALID_IMAGE_DATA: 150,\n\n    /**\n     * Error code indicating an unsaved file.\n     * @constant\n     */\n    UNSAVED_FILE_ERROR: 151,\n\n    /**\n     * Error code indicating an invalid push time.\n     */\n    INVALID_PUSH_TIME_ERROR: 152,\n\n    /**\n     * Error code indicating that the username is missing or empty.\n     * @constant\n     */\n    USERNAME_MISSING: 200,\n\n    /**\n     * Error code indicating that the password is missing or empty.\n     * @constant\n     */\n    PASSWORD_MISSING: 201,\n\n    /**\n     * Error code indicating that the username has already been taken.\n     * @constant\n     */\n    USERNAME_TAKEN: 202,\n\n    /**\n     * Error code indicating that the email has already been taken.\n     * @constant\n     */\n    EMAIL_TAKEN: 203,\n\n    /**\n     * Error code indicating that the email is missing, but must be specified.\n     * @constant\n     */\n    EMAIL_MISSING: 204,\n\n    /**\n     * Error code indicating that a user with the specified email was not found.\n     * @constant\n     */\n    EMAIL_NOT_FOUND: 205,\n\n    /**\n     * Error code indicating that a user object without a valid session could\n     * not be altered.\n     * @constant\n     */\n    SESSION_MISSING: 206,\n\n    /**\n     * Error code indicating that a user can only be created through signup.\n     * @constant\n     */\n    MUST_CREATE_USER_THROUGH_SIGNUP: 207,\n\n    /**\n     * Error code indicating that an an account being linked is already linked\n     * to another user.\n     * @constant\n     */\n    ACCOUNT_ALREADY_LINKED: 208,\n\n    /**\n     * Error code indicating that a user cannot be linked to an account because\n     * that account\'s id could not be found.\n     * @constant\n     */\n    LINKED_ID_MISSING: 250,\n\n    /**\n     * Error code indicating that a user with a linked (e.g. Facebook) account\n     * has an invalid session.\n     * @constant\n     */\n    INVALID_LINKED_SESSION: 251,\n\n    /**\n     * Error code indicating that a service being linked (e.g. Facebook or\n     * Twitter) is unsupported.\n     * @constant\n     */\n    UNSUPPORTED_SERVICE: 252,\n\n    /**\n     * Error code indicating that there were multiple errors. Aggregate errors\n     * have an "errors" property, which is an array of error objects with more\n     * detail about each error that occurred.\n     * @constant\n     */\n    AGGREGATE_ERROR: 600,\n\n    /**\n     * Error code indicating the client was unable to read an input file.\n     * @constant\n     */\n    FILE_READ_ERROR: 601,\n\n    /**\n     * Error code indicating a real error code is unavailable because\n     * we had to use an XDomainRequest object to allow CORS requests in\n     * Internet Explorer, which strips the body from HTTP responses that have\n     * a non-2XX status code.\n     * @constant\n     */\n    X_DOMAIN_REQUEST: 602\n  });\n\n}(this));\n\n/*global _: false */\n(function() {\n  var root = this;\n  var Parse = (root.Parse || (root.Parse = {}));\n  var eventSplitter = /\\s+/;\n  var slice = Array.prototype.slice;\n\n  /**\n   * @class\n   *\n   * <p>Parse.Events is a fork of Backbone\'s Events module, provided for your\n   * convenience.</p>\n   *\n   * <p>A module that can be mixed in to any object in order to provide\n   * it with custom events. You may bind callback functions to an event\n   * with `on`, or remove these functions with `off`.\n   * Triggering an event fires all callbacks in the order that `on` was\n   * called.\n   *\n   * <pre>\n   *     var object = {};\n   *     _.extend(object, Parse.Events);\n   *     object.on(\'expand\', function(){ alert(\'expanded\'); });\n   *     object.trigger(\'expand\');</pre></p>\n   *\n   * <p>For more information, see the\n   * <a href="http://documentcloud.github.com/backbone/#Events">Backbone\n   * documentation</a>.</p>\n   */\n  Parse.Events = {\n    /**\n     * Bind one or more space separated events, `events`, to a `callback`\n     * function. Passing `"all"` will bind the callback to all events fired.\n     */\n    on: function(events, callback, context) {\n\n      var calls, event, node, tail, list;\n      if (!callback) {\n        return this;\n      }\n      events = events.split(eventSplitter);\n      calls = this._callbacks || (this._callbacks = {});\n\n      // Create an immutable callback list, allowing traversal during\n      // modification.  The tail is an empty object that will always be used\n      // as the next node.\n      event = events.shift();\n      while (event) {\n        list = calls[event];\n        node = list ? list.tail : {};\n        node.next = tail = {};\n        node.context = context;\n        node.callback = callback;\n        calls[event] = {tail: tail, next: list ? list.next : node};\n        event = events.shift();\n      }\n\n      return this;\n    },\n\n    /**\n     * Remove one or many callbacks. If `context` is null, removes all callbacks\n     * with that function. If `callback` is null, removes all callbacks for the\n     * event. If `events` is null, removes all bound callbacks for all events.\n     */\n    off: function(events, callback, context) {\n      var event, calls, node, tail, cb, ctx;\n\n      // No events, or removing *all* events.\n      if (!(calls = this._callbacks)) {\n        return;\n      }\n      if (!(events || callback || context)) {\n        delete this._callbacks;\n        return this;\n      }\n\n      // Loop through the listed events and contexts, splicing them out of the\n      // linked list of callbacks if appropriate.\n      events = events ? events.split(eventSplitter) : _.keys(calls);\n      event = events.shift();\n      while (event) {\n        node = calls[event];\n        delete calls[event];\n        if (!node || !(callback || context)) {\n          continue;\n        }\n        // Create a new list, omitting the indicated callbacks.\n        tail = node.tail;\n        node = node.next;\n        while (node !== tail) {\n          cb = node.callback;\n          ctx = node.context;\n          if ((callback && cb !== callback) || (context && ctx !== context)) {\n            this.on(event, cb, ctx);\n          }\n          node = node.next;\n        }\n        event = events.shift();\n      }\n\n      return this;\n    },\n\n    /**\n     * Trigger one or many events, firing all bound callbacks. Callbacks are\n     * passed the same arguments as `trigger` is, apart from the event name\n     * (unless you\'re listening on `"all"`, which will cause your callback to\n     * receive the true name of the event as the first argument).\n     */\n    trigger: function(events) {\n      var event, node, calls, tail, args, all, rest;\n      if (!(calls = this._callbacks)) {\n        return this;\n      }\n      all = calls.all;\n      events = events.split(eventSplitter);\n      rest = slice.call(arguments, 1);\n\n      // For each event, walk through the linked list of callbacks twice,\n      // first to trigger the event, then to trigger any `"all"` callbacks.\n      event = events.shift();\n      while (event) {\n        node = calls[event];\n        if (node) {\n          tail = node.tail;\n          while ((node = node.next) !== tail) {\n            node.callback.apply(node.context || this, rest);\n          }\n        }\n        node = all;\n        if (node) {\n          tail = node.tail;\n          args = [event].concat(rest);\n          while ((node = node.next) !== tail) {\n            node.callback.apply(node.context || this, args);\n          }\n        }\n        event = events.shift();\n      }\n\n      return this;\n    }\n  };\n\n  /**\n   * @function\n   */\n  Parse.Events.bind = Parse.Events.on;\n\n  /**\n   * @function\n   */\n  Parse.Events.unbind = Parse.Events.off;\n}.call(this));\n\n\n/*global navigator: false */\n(function(root) {\n  root.Parse = root.Parse || {};\n  var Parse = root.Parse;\n  var _ = Parse._;\n\n  /**\n   * Creates a new GeoPoint with any of the following forms:<br>\n   *   <pre>\n   *   new GeoPoint(otherGeoPoint)\n   *   new GeoPoint(30, 30)\n   *   new GeoPoint([30, 30])\n   *   new GeoPoint({latitude: 30, longitude: 30})\n   *   new GeoPoint()  // defaults to (0, 0)\n   *   </pre>\n   * @class\n   *\n   * <p>Represents a latitude / longitude point that may be associated\n   * with a key in a ParseObject or used as a reference point for geo queries.\n   * This allows proximity-based queries on the key.</p>\n   *\n   * <p>Only one key in a class may contain a GeoPoint.</p>\n   *\n   * <p>Example:<pre>\n   *   var point = new Parse.GeoPoint(30.0, -20.0);\n   *   var object = new Parse.Object("PlaceObject");\n   *   object.set("location", point);\n   *   object.save();</pre></p>\n   */\n  Parse.GeoPoint = function(arg1, arg2) {\n    if (_.isArray(arg1)) {\n      Parse.GeoPoint._validate(arg1[0], arg1[1]);\n      this.latitude = arg1[0];\n      this.longitude = arg1[1];\n    } else if (_.isObject(arg1)) {\n      Parse.GeoPoint._validate(arg1.latitude, arg1.longitude);\n      this.latitude = arg1.latitude;\n      this.longitude = arg1.longitude;\n    } else if (_.isNumber(arg1) && _.isNumber(arg2)) {\n      Parse.GeoPoint._validate(arg1, arg2);\n      this.latitude = arg1;\n      this.longitude = arg2;\n    } else {\n      this.latitude = 0;\n      this.longitude = 0;\n    }\n\n    // Add properties so that anyone using Webkit or Mozilla will get an error\n    // if they try to set values that are out of bounds.\n    var self = this;\n    if (this.__defineGetter__ && this.__defineSetter__) {\n      // Use _latitude and _longitude to actually store the values, and add\n      // getters and setters for latitude and longitude.\n      this._latitude = this.latitude;\n      this._longitude = this.longitude;\n      this.__defineGetter__("latitude", function() {\n        return self._latitude;\n      });\n      this.__defineGetter__("longitude", function() {\n        return self._longitude;\n      });\n      this.__defineSetter__("latitude", function(val) {\n        Parse.GeoPoint._validate(val, self.longitude);\n        self._latitude = val;\n      });\n      this.__defineSetter__("longitude", function(val) {\n        Parse.GeoPoint._validate(self.latitude, val);\n        self._longitude = val;\n      });\n    }\n  };\n\n  /**\n   * @lends Parse.GeoPoint.prototype\n   * @property {float} latitude North-south portion of the coordinate, in range\n   *   [-90, 90].  Throws an exception if set out of range in a modern browser.\n   * @property {float} longitude East-west portion of the coordinate, in range\n   *   [-180, 180].  Throws if set out of range in a modern browser.\n   */\n\n  /**\n   * Throws an exception if the given lat-long is out of bounds.\n   */\n  Parse.GeoPoint._validate = function(latitude, longitude) {\n    if (latitude < -90.0) {\n      throw "Parse.GeoPoint latitude " + latitude + " < -90.0.";\n    }\n    if (latitude > 90.0) {\n      throw "Parse.GeoPoint latitude " + latitude + " > 90.0.";\n    }\n    if (longitude < -180.0) {\n      throw "Parse.GeoPoint longitude " + longitude + " < -180.0.";\n    }\n    if (longitude > 180.0) {\n      throw "Parse.GeoPoint longitude " + longitude + " > 180.0.";\n    }\n  };\n\n  /**\n   * Creates a GeoPoint with the user\'s current location, if available.\n   * Calls options.success with a new GeoPoint instance or calls options.error.\n   * @param {Object} options An object with success and error callbacks.\n   */\n  Parse.GeoPoint.current = function(options) {\n    var promise = new Parse.Promise();\n    navigator.geolocation.getCurrentPosition(function(location) {\n      promise.resolve(new Parse.GeoPoint({\n        latitude: location.coords.latitude,\n        longitude: location.coords.longitude\n      }));\n\n    }, function(error) {\n      promise.reject(error);\n    });\n\n    return promise._thenRunCallbacks(options);\n  };\n\n  Parse.GeoPoint.prototype = {\n    /**\n     * Returns a JSON representation of the GeoPoint, suitable for Parse.\n     * @return {Object}\n     */\n    toJSON: function() {\n      Parse.GeoPoint._validate(this.latitude, this.longitude);\n      return {\n        "__type": "GeoPoint",\n        latitude: this.latitude,\n        longitude: this.longitude\n      };\n    },\n\n    /**\n     * Returns the distance from this GeoPoint to another in radians.\n     * @param {Parse.GeoPoint} point the other Parse.GeoPoint.\n     * @return {Number}\n     */\n    radiansTo: function(point) {\n      var d2r = Math.PI / 180.0;\n      var lat1rad = this.latitude * d2r;\n      var long1rad = this.longitude * d2r;\n      var lat2rad = point.latitude * d2r;\n      var long2rad = point.longitude * d2r;\n      var deltaLat = lat1rad - lat2rad;\n      var deltaLong = long1rad - long2rad;\n      var sinDeltaLatDiv2 = Math.sin(deltaLat / 2);\n      var sinDeltaLongDiv2 = Math.sin(deltaLong / 2);\n      // Square of half the straight line chord distance between both points.\n      var a = ((sinDeltaLatDiv2 * sinDeltaLatDiv2) +\n               (Math.cos(lat1rad) * Math.cos(lat2rad) *\n                sinDeltaLongDiv2 * sinDeltaLongDiv2));\n      a = Math.min(1.0, a);\n      return 2 * Math.asin(Math.sqrt(a));\n    },\n\n    /**\n     * Returns the distance from this GeoPoint to another in kilometers.\n     * @param {Parse.GeoPoint} point the other Parse.GeoPoint.\n     * @return {Number}\n     */\n    kilometersTo: function(point) {\n      return this.radiansTo(point) * 6371.0;\n    },\n\n    /**\n     * Returns the distance from this GeoPoint to another in miles.\n     * @param {Parse.GeoPoint} point the other Parse.GeoPoint.\n     * @return {Number}\n     */\n    milesTo: function(point) {\n      return this.radiansTo(point) * 3958.8;\n    }\n  };\n}(this));\n\n/*global navigator: false */\n(function(root) {\n  root.Parse = root.Parse || {};\n  var Parse = root.Parse;\n  var _ = Parse._;\n\n  var PUBLIC_KEY = "*";\n\n  /**\n   * Creates a new ACL.\n   * If no argument is given, the ACL has no permissions for anyone.\n   * If the argument is a Parse.User, the ACL will have read and write\n   *   permission for only that user.\n   * If the argument is any other JSON object, that object will be interpretted\n   *   as a serialized ACL created with toJSON().\n   * @see Parse.Object#setACL\n   * @class\n   *\n   * <p>An ACL, or Access Control List can be added to any\n   * <code>Parse.Object</code> to restrict access to only a subset of users\n   * of your application.</p>\n   */\n  Parse.ACL = function(arg1) {\n    var self = this;\n    self.permissionsById = {};\n    if (_.isObject(arg1)) {\n      if (arg1 instanceof Parse.User) {\n        self.setReadAccess(arg1, true);\n        self.setWriteAccess(arg1, true);\n      } else {\n        if (_.isFunction(arg1)) {\n          throw "Parse.ACL() called with a function.  Did you forget ()?";\n        }\n        Parse._objectEach(arg1, function(accessList, userId) {\n          if (!_.isString(userId)) {\n            throw "Tried to create an ACL with an invalid userId.";\n          }\n          self.permissionsById[userId] = {};\n          Parse._objectEach(accessList, function(allowed, permission) {\n            if (permission !== "read" && permission !== "write") {\n              throw "Tried to create an ACL with an invalid permission type.";\n            }\n            if (!_.isBoolean(allowed)) {\n              throw "Tried to create an ACL with an invalid permission value.";\n            }\n            self.permissionsById[userId][permission] = allowed;\n          });\n        });\n      }\n    }\n  };\n\n  /**\n   * Returns a JSON-encoded version of the ACL.\n   * @return {Object}\n   */\n  Parse.ACL.prototype.toJSON = function() {\n    return _.clone(this.permissionsById);\n  };\n\n  Parse.ACL.prototype._setAccess = function(accessType, userId, allowed) {\n    if (userId instanceof Parse.User) {\n      userId = userId.id;\n    } else if (userId instanceof Parse.Role) {\n      userId = "role:" + userId.getName();\n    }\n    if (!_.isString(userId)) {\n      throw "userId must be a string.";\n    }\n    if (!_.isBoolean(allowed)) {\n      throw "allowed must be either true or false.";\n    }\n    var permissions = this.permissionsById[userId];\n    if (!permissions) {\n      if (!allowed) {\n        // The user already doesn\'t have this permission, so no action needed.\n        return;\n      } else {\n        permissions = {};\n        this.permissionsById[userId] = permissions;\n      }\n    }\n\n    if (allowed) {\n      this.permissionsById[userId][accessType] = true;\n    } else {\n      delete permissions[accessType];\n      if (_.isEmpty(permissions)) {\n        delete permissions[userId];\n      }\n    }\n  };\n\n  Parse.ACL.prototype._getAccess = function(accessType, userId) {\n    if (userId instanceof Parse.User) {\n      userId = userId.id;\n    } else if (userId instanceof Parse.Role) {\n      userId = "role:" + userId.getName();\n    }\n    var permissions = this.permissionsById[userId];\n    if (!permissions) {\n      return false;\n    }\n    return permissions[accessType] ? true : false;\n  };\n\n  /**\n   * Set whether the given user is allowed to read this object.\n   * @param userId An instance of Parse.User or its objectId.\n   * @param {Boolean} allowed Whether that user should have read access.\n   */\n  Parse.ACL.prototype.setReadAccess = function(userId, allowed) {\n    this._setAccess("read", userId, allowed);\n  };\n\n  /**\n   * Get whether the given user id is *explicitly* allowed to read this object.\n   * Even if this returns false, the user may still be able to access it if\n   * getPublicReadAccess returns true or a role that the user belongs to has\n   * write access.\n   * @param userId An instance of Parse.User or its objectId, or a Parse.Role.\n   * @return {Boolean}\n   */\n  Parse.ACL.prototype.getReadAccess = function(userId) {\n    return this._getAccess("read", userId);\n  };\n\n  /**\n   * Set whether the given user id is allowed to write this object.\n   * @param userId An instance of Parse.User or its objectId, or a Parse.Role..\n   * @param {Boolean} allowed Whether that user should have write access.\n   */\n  Parse.ACL.prototype.setWriteAccess = function(userId, allowed) {\n    this._setAccess("write", userId, allowed);\n  };\n\n  /**\n   * Get whether the given user id is *explicitly* allowed to write this object.\n   * Even if this returns false, the user may still be able to write it if\n   * getPublicWriteAccess returns true or a role that the user belongs to has\n   * write access.\n   * @param userId An instance of Parse.User or its objectId, or a Parse.Role.\n   * @return {Boolean}\n   */\n  Parse.ACL.prototype.getWriteAccess = function(userId) {\n    return this._getAccess("write", userId);\n  };\n\n  /**\n   * Set whether the public is allowed to read this object.\n   * @param {Boolean} allowed\n   */\n  Parse.ACL.prototype.setPublicReadAccess = function(allowed) {\n    this.setReadAccess(PUBLIC_KEY, allowed);\n  };\n\n  /**\n   * Get whether the public is allowed to read this object.\n   * @return {Boolean}\n   */\n  Parse.ACL.prototype.getPublicReadAccess = function() {\n    return this.getReadAccess(PUBLIC_KEY);\n  };\n\n  /**\n   * Set whether the public is allowed to write this object.\n   * @param {Boolean} allowed\n   */\n  Parse.ACL.prototype.setPublicWriteAccess = function(allowed) {\n    this.setWriteAccess(PUBLIC_KEY, allowed);\n  };\n\n  /**\n   * Get whether the public is allowed to write this object.\n   * @return {Boolean}\n   */\n  Parse.ACL.prototype.getPublicWriteAccess = function() {\n    return this.getWriteAccess(PUBLIC_KEY);\n  };\n\n  /**\n   * Get whether users belonging to the given role are allowed\n   * to read this object. Even if this returns false, the role may\n   * still be able to write it if a parent role has read access.\n   *\n   * @param role The name of the role, or a Parse.Role object.\n   * @return {Boolean} true if the role has read access. false otherwise.\n   * @throws {String} If role is neither a Parse.Role nor a String.\n   */\n  Parse.ACL.prototype.getRoleReadAccess = function(role) {\n    if (role instanceof Parse.Role) {\n      // Normalize to the String name\n      role = role.getName();\n    }\n    if (_.isString(role)) {\n      return this.getReadAccess("role:" + role);\n    }\n    throw "role must be a Parse.Role or a String";\n  };\n\n  /**\n   * Get whether users belonging to the given role are allowed\n   * to write this object. Even if this returns false, the role may\n   * still be able to write it if a parent role has write access.\n   *\n   * @param role The name of the role, or a Parse.Role object.\n   * @return {Boolean} true if the role has write access. false otherwise.\n   * @throws {String} If role is neither a Parse.Role nor a String.\n   */\n  Parse.ACL.prototype.getRoleWriteAccess = function(role) {\n    if (role instanceof Parse.Role) {\n      // Normalize to the String name\n      role = role.getName();\n    }\n    if (_.isString(role)) {\n      return this.getWriteAccess("role:" + role);\n    }\n    throw "role must be a Parse.Role or a String";\n  };\n\n  /**\n   * Set whether users belonging to the given role are allowed\n   * to read this object.\n   *\n   * @param role The name of the role, or a Parse.Role object.\n   * @param {Boolean} allowed Whether the given role can read this object.\n   * @throws {String} If role is neither a Parse.Role nor a String.\n   */\n  Parse.ACL.prototype.setRoleReadAccess = function(role, allowed) {\n    if (role instanceof Parse.Role) {\n      // Normalize to the String name\n      role = role.getName();\n    }\n    if (_.isString(role)) {\n      this.setReadAccess("role:" + role, allowed);\n      return;\n    }\n    throw "role must be a Parse.Role or a String";\n  };\n\n  /**\n   * Set whether users belonging to the given role are allowed\n   * to write this object.\n   *\n   * @param role The name of the role, or a Parse.Role object.\n   * @param {Boolean} allowed Whether the given role can write this object.\n   * @throws {String} If role is neither a Parse.Role nor a String.\n   */\n  Parse.ACL.prototype.setRoleWriteAccess = function(role, allowed) {\n    if (role instanceof Parse.Role) {\n      // Normalize to the String name\n      role = role.getName();\n    }\n    if (_.isString(role)) {\n      this.setWriteAccess("role:" + role, allowed);\n      return;\n    }\n    throw "role must be a Parse.Role or a String";\n  };\n\n}(this));\n\n(function(root) {\n  root.Parse = root.Parse || {};\n  var Parse = root.Parse;\n  var _ = Parse._;\n\n  /**\n   * @class\n   * A Parse.Op is an atomic operation that can be applied to a field in a\n   * Parse.Object. For example, calling <code>object.set("foo", "bar")</code>\n   * is an example of a Parse.Op.Set. Calling <code>object.unset("foo")</code>\n   * is a Parse.Op.Unset. These operations are stored in a Parse.Object and\n   * sent to the server as part of <code>object.save()</code> operations.\n   * Instances of Parse.Op should be immutable.\n   *\n   * You should not create subclasses of Parse.Op or instantiate Parse.Op\n   * directly.\n   */\n  Parse.Op = function() {\n    this._initialize.apply(this, arguments);\n  };\n\n  Parse.Op.prototype = {\n    _initialize: function() {}\n  };\n\n  _.extend(Parse.Op, {\n    /**\n     * To create a new Op, call Parse.Op._extend();\n     */\n    _extend: Parse._extend,\n\n    // A map of __op string to decoder function.\n    _opDecoderMap: {},\n\n    /**\n     * Registers a function to convert a json object with an __op field into an\n     * instance of a subclass of Parse.Op.\n     */\n    _registerDecoder: function(opName, decoder) {\n      Parse.Op._opDecoderMap[opName] = decoder;\n    },\n\n    /**\n     * Converts a json object into an instance of a subclass of Parse.Op.\n     */\n    _decode: function(json) {\n      var decoder = Parse.Op._opDecoderMap[json.__op];\n      if (decoder) {\n        return decoder(json);\n      } else {\n        return undefined;\n      }\n    }\n  });\n\n  /*\n   * Add a handler for Batch ops.\n   */\n  Parse.Op._registerDecoder("Batch", function(json) {\n    var op = null;\n    Parse._arrayEach(json.ops, function(nextOp) {\n      nextOp = Parse.Op._decode(nextOp);\n      op = nextOp._mergeWithPrevious(op);\n    });\n    return op;\n  });\n\n  /**\n   * @class\n   * A Set operation indicates that either the field was changed using\n   * Parse.Object.set, or it is a mutable container that was detected as being\n   * changed.\n   */\n  Parse.Op.Set = Parse.Op._extend(/** @lends Parse.Op.Set.prototype */ {\n    _initialize: function(value) {\n      this._value = value;\n    },\n\n    /**\n     * Returns the new value of this field after the set.\n     */\n    value: function() {\n      return this._value;\n    },\n\n    /**\n     * Returns a JSON version of the operation suitable for sending to Parse.\n     * @return {Object}\n     */\n    toJSON: function() {\n      return Parse._encode(this.value());\n    },\n\n    _mergeWithPrevious: function(previous) {\n      return this;\n    },\n\n    _estimate: function(oldValue) {\n      return this.value();\n    }\n  });\n\n  /**\n   * A sentinel value that is returned by Parse.Op.Unset._estimate to\n   * indicate the field should be deleted. Basically, if you find _UNSET as a\n   * value in your object, you should remove that key.\n   */\n  Parse.Op._UNSET = {};\n\n  /**\n   * @class\n   * An Unset operation indicates that this field has been deleted from the\n   * object.\n   */\n  Parse.Op.Unset = Parse.Op._extend(/** @lends Parse.Op.Unset.prototype */ {\n    /**\n     * Returns a JSON version of the operation suitable for sending to Parse.\n     * @return {Object}\n     */\n    toJSON: function() {\n      return { __op: "Delete" };\n    },\n\n    _mergeWithPrevious: function(previous) {\n      return this;\n    },\n\n    _estimate: function(oldValue) {\n      return Parse.Op._UNSET;\n    }\n  });\n\n  Parse.Op._registerDecoder("Delete", function(json) {\n    return new Parse.Op.Unset();\n  });\n\n  /**\n   * @class\n   * An Increment is an atomic operation where the numeric value for the field\n   * will be increased by a given amount.\n   */\n  Parse.Op.Increment = Parse.Op._extend(\n      /** @lends Parse.Op.Increment.prototype */ {\n\n    _initialize: function(amount) {\n      this._amount = amount;\n    },\n\n    /**\n     * Returns the amount to increment by.\n     * @return {Number} the amount to increment by.\n     */\n    amount: function() {\n      return this._amount;\n    },\n\n    /**\n     * Returns a JSON version of the operation suitable for sending to Parse.\n     * @return {Object}\n     */\n    toJSON: function() {\n      return { __op: "Increment", amount: this._amount };\n    },\n\n    _mergeWithPrevious: function(previous) {\n      if (!previous) {\n        return this;\n      } else if (previous instanceof Parse.Op.Unset) {\n        return new Parse.Op.Set(this.amount());\n      } else if (previous instanceof Parse.Op.Set) {\n        return new Parse.Op.Set(previous.value() + this.amount());\n      } else if (previous instanceof Parse.Op.Increment) {\n        return new Parse.Op.Increment(this.amount() + previous.amount());\n      } else {\n        throw "Op is invalid after previous op.";\n      }\n    },\n\n    _estimate: function(oldValue) {\n      if (!oldValue) {\n        return this.amount();\n      }\n      return oldValue + this.amount();\n    }\n  });\n\n  Parse.Op._registerDecoder("Increment", function(json) {\n    return new Parse.Op.Increment(json.amount);\n  });\n\n  /**\n   * @class\n   * Add is an atomic operation where the given objects will be appended to the\n   * array that is stored in this field.\n   */\n  Parse.Op.Add = Parse.Op._extend(/** @lends Parse.Op.Add.prototype */ {\n    _initialize: function(objects) {\n      this._objects = objects;\n    },\n\n    /**\n     * Returns the objects to be added to the array.\n     * @return {Array} The objects to be added to the array.\n     */\n    objects: function() {\n      return this._objects;\n    },\n\n    /**\n     * Returns a JSON version of the operation suitable for sending to Parse.\n     * @return {Object}\n     */\n    toJSON: function() {\n      return { __op: "Add", objects: Parse._encode(this.objects()) };\n    },\n\n    _mergeWithPrevious: function(previous) {\n      if (!previous) {\n        return this;\n      } else if (previous instanceof Parse.Op.Unset) {\n        return new Parse.Op.Set(this.objects());\n      } else if (previous instanceof Parse.Op.Set) {\n        return new Parse.Op.Set(this._estimate(previous.value()));\n      } else if (previous instanceof Parse.Op.Add) {\n        return new Parse.Op.Add(previous.objects().concat(this.objects()));\n      } else {\n        throw "Op is invalid after previous op.";\n      }\n    },\n\n    _estimate: function(oldValue) {\n      if (!oldValue) {\n        return _.clone(this.objects());\n      } else {\n        return oldValue.concat(this.objects());\n      }\n    }\n  });\n\n  Parse.Op._registerDecoder("Add", function(json) {\n    return new Parse.Op.Add(Parse._decode(undefined, json.objects));\n  });\n\n  /**\n   * @class\n   * AddUnique is an atomic operation where the given items will be appended to\n   * the array that is stored in this field only if they were not already\n   * present in the array.\n   */\n  Parse.Op.AddUnique = Parse.Op._extend(\n      /** @lends Parse.Op.AddUnique.prototype */ {\n\n    _initialize: function(objects) {\n      this._objects = _.uniq(objects);\n    },\n\n    /**\n     * Returns the objects to be added to the array.\n     * @return {Array} The objects to be added to the array.\n     */\n    objects: function() {\n      return this._objects;\n    },\n\n    /**\n     * Returns a JSON version of the operation suitable for sending to Parse.\n     * @return {Object}\n     */\n    toJSON: function() {\n      return { __op: "AddUnique", objects: Parse._encode(this.objects()) };\n    },\n\n    _mergeWithPrevious: function(previous) {\n      if (!previous) {\n        return this;\n      } else if (previous instanceof Parse.Op.Unset) {\n        return new Parse.Op.Set(this.objects());\n      } else if (previous instanceof Parse.Op.Set) {\n        return new Parse.Op.Set(this._estimate(previous.value()));\n      } else if (previous instanceof Parse.Op.AddUnique) {\n        return new Parse.Op.AddUnique(this._estimate(previous.objects()));\n      } else {\n        throw "Op is invalid after previous op.";\n      }\n    },\n\n    _estimate: function(oldValue) {\n      if (!oldValue) {\n        return _.clone(this.objects());\n      } else {\n        // We can\'t just take the _.uniq(_.union(...)) of oldValue and\n        // this.objects, because the uniqueness may not apply to oldValue\n        // (especially if the oldValue was set via .set())\n        var newValue = _.clone(oldValue);\n        Parse._arrayEach(this.objects(), function(obj) {\n          if (obj instanceof Parse.Object && obj.id) {\n            var matchingObj = _.find(newValue, function(anObj) {\n              return (anObj instanceof Parse.Object) && (anObj.id === obj.id);\n            });\n            if (!matchingObj) {\n              newValue.push(obj);\n            } else {\n              var index = _.indexOf(newValue, matchingObj);\n              newValue[index] = obj;\n            }\n          } else if (!_.contains(newValue, obj)) {\n            newValue.push(obj);\n          }\n        });\n        return newValue;\n      }\n    }\n  });\n\n  Parse.Op._registerDecoder("AddUnique", function(json) {\n    return new Parse.Op.AddUnique(Parse._decode(undefined, json.objects));\n  });\n\n  /**\n   * @class\n   * Remove is an atomic operation where the given objects will be removed from\n   * the array that is stored in this field.\n   */\n  Parse.Op.Remove = Parse.Op._extend(/** @lends Parse.Op.Remove.prototype */ {\n    _initialize: function(objects) {\n      this._objects = _.uniq(objects);\n    },\n\n    /**\n     * Returns the objects to be removed from the array.\n     * @return {Array} The objects to be removed from the array.\n     */\n    objects: function() {\n      return this._objects;\n    },\n\n    /**\n     * Returns a JSON version of the operation suitable for sending to Parse.\n     * @return {Object}\n     */\n    toJSON: function() {\n      return { __op: "Remove", objects: Parse._encode(this.objects()) };\n    },\n\n    _mergeWithPrevious: function(previous) {\n      if (!previous) {\n        return this;\n      } else if (previous instanceof Parse.Op.Unset) {\n        return previous;\n      } else if (previous instanceof Parse.Op.Set) {\n        return new Parse.Op.Set(this._estimate(previous.value()));\n      } else if (previous instanceof Parse.Op.Remove) {\n        return new Parse.Op.Remove(_.union(previous.objects(), this.objects()));\n      } else {\n        throw "Op is invalid after previous op.";\n      }\n    },\n\n    _estimate: function(oldValue) {\n      if (!oldValue) {\n        return [];\n      } else {\n        var newValue = _.difference(oldValue, this.objects());\n        // If there are saved Parse Objects being removed, also remove them.\n        Parse._arrayEach(this.objects(), function(obj) {\n          if (obj instanceof Parse.Object && obj.id) {\n            newValue = _.reject(newValue, function(other) {\n              return (other instanceof Parse.Object) && (other.id === obj.id);\n            });\n          }\n        });\n        return newValue;\n      }\n    }\n  });\n\n  Parse.Op._registerDecoder("Remove", function(json) {\n    return new Parse.Op.Remove(Parse._decode(undefined, json.objects));\n  });\n\n  /**\n   * @class\n   * A Relation operation indicates that the field is an instance of\n   * Parse.Relation, and objects are being added to, or removed from, that\n   * relation.\n   */\n  Parse.Op.Relation = Parse.Op._extend(\n      /** @lends Parse.Op.Relation.prototype */ {\n\n    _initialize: function(adds, removes) {\n      this._targetClassName = null;\n\n      var self = this;\n\n      var pointerToId = function(object) {\n        if (object instanceof Parse.Object) {\n          if (!object.id) {\n            throw "You can\'t add an unsaved Parse.Object to a relation.";\n          }\n          if (!self._targetClassName) {\n            self._targetClassName = object.className;\n          }\n          if (self._targetClassName !== object.className) {\n            throw "Tried to create a Parse.Relation with 2 different types: " +\n                  self._targetClassName + " and " + object.className + ".";\n          }\n          return object.id;\n        }\n        return object;\n      };\n\n      this.relationsToAdd = _.uniq(_.map(adds, pointerToId));\n      this.relationsToRemove = _.uniq(_.map(removes, pointerToId));\n    },\n\n    /**\n     * Returns an array of unfetched Parse.Object that are being added to the\n     * relation.\n     * @return {Array}\n     */\n    added: function() {\n      var self = this;\n      return _.map(this.relationsToAdd, function(objectId) {\n        var object = Parse.Object._create(self._targetClassName);\n        object.id = objectId;\n        return object;\n      });\n    },\n\n    /**\n     * Returns an array of unfetched Parse.Object that are being removed from\n     * the relation.\n     * @return {Array}\n     */\n    removed: function() {\n      var self = this;\n      return _.map(this.relationsToRemove, function(objectId) {\n        var object = Parse.Object._create(self._targetClassName);\n        object.id = objectId;\n        return object;\n      });\n    },\n\n    /**\n     * Returns a JSON version of the operation suitable for sending to Parse.\n     * @return {Object}\n     */\n    toJSON: function() {\n      var adds = null;\n      var removes = null;\n      var self = this;\n      var idToPointer = function(id) {\n        return { __type: \'Pointer\',\n                 className: self._targetClassName,\n                 objectId: id };\n      };\n      var pointers = null;\n      if (this.relationsToAdd.length > 0) {\n        pointers = _.map(this.relationsToAdd, idToPointer);\n        adds = { "__op": "AddRelation", "objects": pointers };\n      }\n\n      if (this.relationsToRemove.length > 0) {\n        pointers = _.map(this.relationsToRemove, idToPointer);\n        removes = { "__op": "RemoveRelation", "objects": pointers };\n      }\n\n      if (adds && removes) {\n        return { "__op": "Batch", "ops": [adds, removes]};\n      }\n\n      return adds || removes || {};\n    },\n\n    _mergeWithPrevious: function(previous) {\n      if (!previous) {\n        return this;\n      } else if (previous instanceof Parse.Op.Unset) {\n        throw "You can\'t modify a relation after deleting it.";\n      } else if (previous instanceof Parse.Op.Relation) {\n        if (previous._targetClassName &&\n            previous._targetClassName !== this._targetClassName) {\n          throw "Related object must be of class " + previous._targetClassName +\n              ", but " + this._targetClassName + " was passed in.";\n        }\n        var newAdd = _.union(_.difference(previous.relationsToAdd,\n                                          this.relationsToRemove),\n                             this.relationsToAdd);\n        var newRemove = _.union(_.difference(previous.relationsToRemove,\n                                             this.relationsToAdd),\n                                this.relationsToRemove);\n\n        var newRelation = new Parse.Op.Relation(newAdd, newRemove);\n        newRelation._targetClassName = this._targetClassName;\n        return newRelation;\n      } else {\n        throw "Op is invalid after previous op.";\n      }\n    },\n\n    _estimate: function(oldValue, object, key) {\n      if (!oldValue) {\n        var relation = new Parse.Relation(object, key);\n        relation.targetClassName = this._targetClassName;\n      } else if (oldValue instanceof Parse.Relation) {\n        if (this._targetClassName) {\n          if (oldValue.targetClassName) {\n            if (oldValue.targetClassName !== this._targetClassName) {\n              throw "Related object must be a " + oldValue.targetClassName +\n                  ", but a " + this._targetClassName + " was passed in.";\n            }\n          } else {\n            oldValue.targetClassName = this._targetClassName;\n          }\n        }\n        return oldValue;\n      } else {\n        throw "Op is invalid after previous op.";\n      }\n    }\n  });\n\n  Parse.Op._registerDecoder("AddRelation", function(json) {\n    return new Parse.Op.Relation(Parse._decode(undefined, json.objects), []);\n  });\n  Parse.Op._registerDecoder("RemoveRelation", function(json) {\n    return new Parse.Op.Relation([], Parse._decode(undefined, json.objects));\n  });\n\n}(this));\n\n(function(root) {\n  root.Parse = root.Parse || {};\n  var Parse = root.Parse;\n  var _ = Parse._;\n\n  /**\n   * Creates a new Relation for the given parent object and key. This\n   * constructor should rarely be used directly, but rather created by\n   * Parse.Object.relation.\n   * @param {Parse.Object} parent The parent of this relation.\n   * @param {String} key The key for this relation on the parent.\n   * @see Parse.Object#relation\n   * @class\n   *\n   * <p>\n   * A class that is used to access all of the children of a many-to-many\n   * relationship.  Each instance of Parse.Relation is associated with a\n   * particular parent object and key.\n   * </p>\n   */\n  Parse.Relation = function(parent, key) {\n    this.parent = parent;\n    this.key = key;\n    this.targetClassName = null;\n  };\n\n  Parse.Relation.prototype = {\n    /**\n     * Makes sure that this relation has the right parent and key.\n     */\n    _ensureParentAndKey: function(parent, key) {\n      this.parent = this.parent || parent;\n      this.key = this.key || key;\n      if (this.parent !== parent) {\n        throw "Internal Error. Relation retrieved from two different Objects.";\n      }\n      if (this.key !== key) {\n        throw "Internal Error. Relation retrieved from two different keys.";\n      }\n    },\n\n    /**\n     * Adds a Parse.Object or an array of Parse.Objects to the relation.\n     * @param {} objects The item or items to add.\n     */\n    add: function(objects) {\n      if (!_.isArray(objects)) {\n        objects = [objects];\n      }\n\n      var change = new Parse.Op.Relation(objects, []);\n      this.parent.set(this.key, change);\n      this.targetClassName = change._targetClassName;\n    },\n\n    /**\n     * Removes a Parse.Object or an array of Parse.Objects from this relation.\n     * @param {} objects The item or items to remove.\n     */\n    remove: function(objects) {\n      if (!_.isArray(objects)) {\n        objects = [objects];\n      }\n\n      var change = new Parse.Op.Relation([], objects);\n      this.parent.set(this.key, change);\n      this.targetClassName = change._targetClassName;\n    },\n\n    /**\n     * Returns a JSON version of the object suitable for saving to disk.\n     * @return {Object}\n     */\n    toJSON: function() {\n      return { "__type": "Relation", "className": this.targetClassName };\n    },\n\n    /**\n     * Returns a Parse.Query that is limited to objects in this\n     * relation.\n     * @return {Parse.Query}\n     */\n    query: function() {\n      var targetClass;\n      var query;\n      if (!this.targetClassName) {\n        targetClass = Parse.Object._getSubclass(this.parent.className);\n        query = new Parse.Query(targetClass);\n        query._extraOptions.redirectClassNameForKey = this.key;\n      } else {\n        targetClass = Parse.Object._getSubclass(this.targetClassName);\n        query = new Parse.Query(targetClass);\n      }\n      query._addCondition("$relatedTo", "object", this.parent._toPointer());\n      query._addCondition("$relatedTo", "key", this.key);\n\n      return query;\n    }\n  };\n}(this));\n\n(function(root) {\n  root.Parse = root.Parse || {};\n  var Parse = root.Parse;\n  var _ = Parse._;\n\n  /**\n   * A Promise is returned by async methods as a hook to provide callbacks to be\n   * called when the async task is fulfilled.\n   *\n   * <p>Typical usage would be like:<pre>\n   *    query.find().then(function(results) {\n   *      results[0].set("foo", "bar");\n   *      return results[0].saveAsync();\n   *    }).then(function(result) {\n   *      console.log("Updated " + result.id);\n   *    });\n   * </pre></p>\n   *\n   * @see Parse.Promise.prototype.then\n   * @class\n   */\n  Parse.Promise = function() {\n    this._resolved = false;\n    this._rejected = false;\n    this._resolvedCallbacks = [];\n    this._rejectedCallbacks = [];\n  };\n\n  _.extend(Parse.Promise, /** @lends Parse.Promise */ {\n\n    /**\n     * Returns true iff the given object fulfils the Promise interface.\n     * @return {Boolean}\n     */\n    is: function(promise) {\n      return promise && promise.then && _.isFunction(promise.then);\n    },\n\n    /**\n     * Returns a new promise that is resolved with a given value.\n     * @return {Parse.Promise} the new promise.\n     */\n    as: function() {\n      var promise = new Parse.Promise();\n      promise.resolve.apply(promise, arguments);\n      return promise;\n    },\n\n    /**\n     * Returns a new promise that is rejected with a given error.\n     * @return {Parse.Promise} the new promise.\n     */\n    error: function() {\n      var promise = new Parse.Promise();\n      promise.reject.apply(promise, arguments);\n      return promise;\n    },\n\n    /**\n     * Returns a new promise that is fulfilled when all of the input promises\n     * are resolved. If any promise in the list fails, then the returned promise\n     * will fail with the last error. If they all succeed, then the returned\n     * promise will succeed, with the results being the results of all the input\n     * promises. For example: <pre>\n     *   var p1 = Parse.Promise.as(1);\n     *   var p2 = Parse.Promise.as(2);\n     *   var p3 = Parse.Promise.as(3);\n     *\n     *   Parse.Promise.when(p1, p2, p3).then(function(r1, r2, r3) {\n     *     console.log(r1);  // prints 1\n     *     console.log(r2);  // prints 2\n     *     console.log(r3);  // prints 3\n     *   });</pre>\n     *\n     * The input promises can also be specified as an array: <pre>\n     *   var promises = [p1, p2, p3];\n     *   Parse.Promise.when(promises).then(function(r1, r2, r3) {\n     *     console.log(r1);  // prints 1\n     *     console.log(r2);  // prints 2\n     *     console.log(r3);  // prints 3\n     *   });\n     * </pre>\n     * @param {Array} promises a list of promises to wait for.\n     * @return {Parse.Promise} the new promise.\n     */\n    when: function(promises) {\n      // Allow passing in Promises as separate arguments instead of an Array.\n      var objects;\n      if (promises && Parse._isNullOrUndefined(promises.length)) {\n        objects = arguments;\n      } else {\n        objects = promises;\n      }\n\n      var total = objects.length;\n      var hadError = false;\n      var results = [];\n      var errors = [];\n      results.length = objects.length;\n      errors.length = objects.length;\n\n      if (total === 0) {\n        return Parse.Promise.as.apply(this, results);\n      }\n\n      var promise = new Parse.Promise();\n\n      var resolveOne = function() {\n        total = total - 1;\n        if (total === 0) {\n          if (hadError) {\n            promise.reject(errors);\n          } else {\n            promise.resolve.apply(promise, results);\n          }\n        }\n      };\n\n      Parse._arrayEach(objects, function(object, i) {\n        if (Parse.Promise.is(object)) {\n          object.then(function(result) {\n            results[i] = result;\n            resolveOne();\n          }, function(error) {\n            errors[i] = error;\n            hadError = true;\n            resolveOne();\n          });\n        } else {\n          results[i] = object;\n          resolveOne();\n        }\n      });\n\n      return promise;\n    },\n\n    /**\n     * Runs the given asyncFunction repeatedly, as long as the predicate\n     * function returns a truthy value. Stops repeating if asyncFunction returns\n     * a rejected promise.\n     * @param {Function} predicate should return false when ready to stop.\n     * @param {Function} asyncFunction should return a Promise.\n     */\n    _continueWhile: function(predicate, asyncFunction) {\n      if (predicate()) {\n        return asyncFunction().then(function() {\n          return Parse.Promise._continueWhile(predicate, asyncFunction);\n        });\n      }\n      return Parse.Promise.as();\n    }\n  });\n\n  _.extend(Parse.Promise.prototype, /** @lends Parse.Promise.prototype */ {\n\n    /**\n     * Marks this promise as fulfilled, firing any callbacks waiting on it.\n     * @param {Object} result the result to pass to the callbacks.\n     */\n    resolve: function(result) {\n      if (this._resolved || this._rejected) {\n        throw "A promise was resolved even though it had already been " +\n          (this._resolved ? "resolved" : "rejected") + ".";\n      }\n      this._resolved = true;\n      this._result = arguments;\n      var results = arguments;\n      Parse._arrayEach(this._resolvedCallbacks, function(resolvedCallback) {\n        resolvedCallback.apply(this, results);\n      });\n      this._resolvedCallbacks = [];\n      this._rejectedCallbacks = [];\n    },\n\n    /**\n     * Marks this promise as fulfilled, firing any callbacks waiting on it.\n     * @param {Object} error the error to pass to the callbacks.\n     */\n    reject: function(error) {\n      if (this._resolved || this._rejected) {\n        throw "A promise was rejected even though it had already been " +\n          (this._resolved ? "resolved" : "rejected") + ".";\n      }\n      this._rejected = true;\n      this._error = error;\n      Parse._arrayEach(this._rejectedCallbacks, function(rejectedCallback) {\n        rejectedCallback(error);\n      });\n      this._resolvedCallbacks = [];\n      this._rejectedCallbacks = [];\n    },\n\n    /**\n     * Adds callbacks to be called when this promise is fulfilled. Returns a new\n     * Promise that will be fulfilled when the callback is complete. It allows\n     * chaining. If the callback itself returns a Promise, then the one returned\n     * by "then" will not be fulfilled until that one returned by the callback\n     * is fulfilled.\n     * @param {Function} resolvedCallback Function that is called when this\n     * Promise is resolved. Once the callback is complete, then the Promise\n     * returned by "then" will also be fulfilled.\n     * @param {Function} rejectedCallback Function that is called when this\n     * Promise is rejected with an error. Once the callback is complete, then\n     * the promise returned by "then" with be resolved successfully. If\n     * rejectedCallback is null, or it returns a rejected Promise, then the\n     * Promise returned by "then" will be rejected with that error.\n     * @return {Parse.Promise} A new Promise that will be fulfilled after this\n     * Promise is fulfilled and either callback has completed. If the callback\n     * returned a Promise, then this Promise will not be fulfilled until that\n     * one is.\n     */\n    then: function(resolvedCallback, rejectedCallback) {\n      var promise = new Parse.Promise();\n\n      var wrappedResolvedCallback = function() {\n        var result = arguments;\n        if (resolvedCallback) {\n          result = [resolvedCallback.apply(this, result)];\n        }\n        if (result.length === 1 && Parse.Promise.is(result[0])) {\n          result[0].then(function() {\n            promise.resolve.apply(promise, arguments);\n          }, function(error) {\n            promise.reject(error);\n          });\n        } else {\n          promise.resolve.apply(promise, result);\n        }\n      };\n\n      var wrappedRejectedCallback = function(error) {\n        var result = [];\n        if (rejectedCallback) {\n          result = [rejectedCallback(error)];\n          if (result.length === 1 && Parse.Promise.is(result[0])) {\n            result[0].then(function() {\n              promise.resolve.apply(promise, arguments);\n            }, function(error) {\n              promise.reject(error);\n            });\n          } else {\n            // A Promises/A+ compliant implementation would call:\n            // promise.resolve.apply(promise, result);\n            promise.reject(result[0]);\n          }\n        } else {\n          promise.reject(error);\n        }\n      };\n\n      if (this._resolved) {\n        wrappedResolvedCallback.apply(this, this._result);\n      } else if (this._rejected) {\n        wrappedRejectedCallback(this._error);\n      } else {\n        this._resolvedCallbacks.push(wrappedResolvedCallback);\n        this._rejectedCallbacks.push(wrappedRejectedCallback);\n      }\n\n      return promise;\n    },\n\n    /**\n     * Add handlers to be called when the promise\n     * is either resolved or rejected\n     */\n    always: function(callback) {\n      return this.then(callback, callback);\n    },\n\n    /**\n     * Add handlers to be called when the Promise object is resolved\n     */\n    done: function(callback) {\n      return this.then(callback);\n    },\n\n    /**\n     * Add handlers to be called when the Promise object is rejected\n     */\n    fail: function(callback) {\n      return this.then(null, callback);\n    },\n\n    /**\n     * Run the given callbacks after this promise is fulfilled.\n     * @param optionsOrCallback {} A Backbone-style options callback, or a\n     * callback function. If this is an options object and contains a "model"\n     * attributes, that will be passed to error callbacks as the first argument.\n     * @param model {} If truthy, this will be passed as the first result of\n     * error callbacks. This is for Backbone-compatability.\n     * @return {Parse.Promise} A promise that will be resolved after the\n     * callbacks are run, with the same result as this.\n     */\n    _thenRunCallbacks: function(optionsOrCallback, model) {\n      var options;\n      if (_.isFunction(optionsOrCallback)) {\n        var callback = optionsOrCallback;\n        options = {\n          success: function(result) {\n            callback(result, null);\n          },\n          error: function(error) {\n            callback(null, error);\n          }\n        };\n      } else {\n        options = _.clone(optionsOrCallback);\n      }\n      options = options || {};\n\n      return this.then(function(result) {\n        if (options.success) {\n          options.success.apply(this, arguments);\n        } else if (model) {\n          // When there\'s no callback, a sync event should be triggered.\n          model.trigger(\'sync\', model, result, options);\n        }\n        return Parse.Promise.as.apply(Parse.Promise, arguments);\n      }, function(error) {\n        if (options.error) {\n          if (!_.isUndefined(model)) {\n            options.error(model, error);\n          } else {\n            options.error(error);\n          }\n        } else if (model) {\n          // When there\'s no error callback, an error event should be triggered.\n          model.trigger(\'error\', model, error, options);\n        }\n        // By explicitly returning a rejected Promise, this will work with\n        // either jQuery or Promises/A semantics.\n        return Parse.Promise.error(error);\n      });\n    },\n\n    /**\n     * Adds a callback function that should be called regardless of whether\n     * this promise failed or succeeded. The callback will be given either the\n     * array of results for its first argument, or the error as its second,\n     * depending on whether this Promise was rejected or resolved. Returns a\n     * new Promise, like "then" would.\n     * @param {Function} continuation the callback.\n     */\n    _continueWith: function(continuation) {\n      return this.then(function() {\n        return continuation(arguments, null);\n      }, function(error) {\n        return continuation(null, error);\n      });\n    }\n\n  });\n\n}(this));\n\n/*jshint bitwise:false *//*global FileReader: true, File: true */\n(function(root) {\n  root.Parse = root.Parse || {};\n  var Parse = root.Parse;\n  var _ = Parse._;\n\n  var b64Digit = function(number) {\n    if (number < 26) {\n      return String.fromCharCode(65 + number);\n    }\n    if (number < 52) {\n      return String.fromCharCode(97 + (number - 26));\n    }\n    if (number < 62) {\n      return String.fromCharCode(48 + (number - 52));\n    }\n    if (number === 62) {\n      return "+";\n    }\n    if (number === 63) {\n      return "/";\n    }\n    throw "Tried to encode large digit " + number + " in base64.";\n  };\n\n  var encodeBase64 = function(array) {\n    var chunks = [];\n    chunks.length = Math.ceil(array.length / 3);\n    _.times(chunks.length, function(i) {\n      var b1 = array[i * 3];\n      var b2 = array[i * 3 + 1] || 0;\n      var b3 = array[i * 3 + 2] || 0;\n\n      var has2 = (i * 3 + 1) < array.length;\n      var has3 = (i * 3 + 2) < array.length;\n\n      chunks[i] = [\n        b64Digit((b1 >> 2) & 0x3F),\n        b64Digit(((b1 << 4) & 0x30) | ((b2 >> 4) & 0x0F)),\n        has2 ? b64Digit(((b2 << 2) & 0x3C) | ((b3 >> 6) & 0x03)) : "=",\n        has3 ? b64Digit(b3 & 0x3F) : "="\n      ].join("");\n    });\n    return chunks.join("");\n  };\n\n\n  // A list of file extensions to mime types as found here:\n  // http://stackoverflow.com/questions/58510/using-net-how-can-you-find-the-\n  //     mime-type-of-a-file-based-on-the-file-signature\n  var mimeTypes = {\n    ai: "application/postscript",\n    aif: "audio/x-aiff",\n    aifc: "audio/x-aiff",\n    aiff: "audio/x-aiff",\n    asc: "text/plain",\n    atom: "application/atom+xml",\n    au: "audio/basic",\n    avi: "video/x-msvideo",\n    bcpio: "application/x-bcpio",\n    bin: "application/octet-stream",\n    bmp: "image/bmp",\n    cdf: "application/x-netcdf",\n    cgm: "image/cgm",\n    "class": "application/octet-stream",\n    cpio: "application/x-cpio",\n    cpt: "application/mac-compactpro",\n    csh: "application/x-csh",\n    css: "text/css",\n    dcr: "application/x-director",\n    dif: "video/x-dv",\n    dir: "application/x-director",\n    djv: "image/vnd.djvu",\n    djvu: "image/vnd.djvu",\n    dll: "application/octet-stream",\n    dmg: "application/octet-stream",\n    dms: "application/octet-stream",\n    doc: "application/msword",\n    docx: "application/vnd.openxmlformats-officedocument.wordprocessingml." +\n          "document",\n    dotx: "application/vnd.openxmlformats-officedocument.wordprocessingml." +\n          "template",\n    docm: "application/vnd.ms-word.document.macroEnabled.12",\n    dotm: "application/vnd.ms-word.template.macroEnabled.12",\n    dtd: "application/xml-dtd",\n    dv: "video/x-dv",\n    dvi: "application/x-dvi",\n    dxr: "application/x-director",\n    eps: "application/postscript",\n    etx: "text/x-setext",\n    exe: "application/octet-stream",\n    ez: "application/andrew-inset",\n    gif: "image/gif",\n    gram: "application/srgs",\n    grxml: "application/srgs+xml",\n    gtar: "application/x-gtar",\n    hdf: "application/x-hdf",\n    hqx: "application/mac-binhex40",\n    htm: "text/html",\n    html: "text/html",\n    ice: "x-conference/x-cooltalk",\n    ico: "image/x-icon",\n    ics: "text/calendar",\n    ief: "image/ief",\n    ifb: "text/calendar",\n    iges: "model/iges",\n    igs: "model/iges",\n    jnlp: "application/x-java-jnlp-file",\n    jp2: "image/jp2",\n    jpe: "image/jpeg",\n    jpeg: "image/jpeg",\n    jpg: "image/jpeg",\n    js: "application/x-javascript",\n    kar: "audio/midi",\n    latex: "application/x-latex",\n    lha: "application/octet-stream",\n    lzh: "application/octet-stream",\n    m3u: "audio/x-mpegurl",\n    m4a: "audio/mp4a-latm",\n    m4b: "audio/mp4a-latm",\n    m4p: "audio/mp4a-latm",\n    m4u: "video/vnd.mpegurl",\n    m4v: "video/x-m4v",\n    mac: "image/x-macpaint",\n    man: "application/x-troff-man",\n    mathml: "application/mathml+xml",\n    me: "application/x-troff-me",\n    mesh: "model/mesh",\n    mid: "audio/midi",\n    midi: "audio/midi",\n    mif: "application/vnd.mif",\n    mov: "video/quicktime",\n    movie: "video/x-sgi-movie",\n    mp2: "audio/mpeg",\n    mp3: "audio/mpeg",\n    mp4: "video/mp4",\n    mpe: "video/mpeg",\n    mpeg: "video/mpeg",\n    mpg: "video/mpeg",\n    mpga: "audio/mpeg",\n    ms: "application/x-troff-ms",\n    msh: "model/mesh",\n    mxu: "video/vnd.mpegurl",\n    nc: "application/x-netcdf",\n    oda: "application/oda",\n    ogg: "application/ogg",\n    pbm: "image/x-portable-bitmap",\n    pct: "image/pict",\n    pdb: "chemical/x-pdb",\n    pdf: "application/pdf",\n    pgm: "image/x-portable-graymap",\n    pgn: "application/x-chess-pgn",\n    pic: "image/pict",\n    pict: "image/pict",\n    png: "image/png",\n    pnm: "image/x-portable-anymap",\n    pnt: "image/x-macpaint",\n    pntg: "image/x-macpaint",\n    ppm: "image/x-portable-pixmap",\n    ppt: "application/vnd.ms-powerpoint",\n    pptx: "application/vnd.openxmlformats-officedocument.presentationml." +\n          "presentation",\n    potx: "application/vnd.openxmlformats-officedocument.presentationml." +\n          "template",\n    ppsx: "application/vnd.openxmlformats-officedocument.presentationml." +\n          "slideshow",\n    ppam: "application/vnd.ms-powerpoint.addin.macroEnabled.12",\n    pptm: "application/vnd.ms-powerpoint.presentation.macroEnabled.12",\n    potm: "application/vnd.ms-powerpoint.template.macroEnabled.12",\n    ppsm: "application/vnd.ms-powerpoint.slideshow.macroEnabled.12",\n    ps: "application/postscript",\n    qt: "video/quicktime",\n    qti: "image/x-quicktime",\n    qtif: "image/x-quicktime",\n    ra: "audio/x-pn-realaudio",\n    ram: "audio/x-pn-realaudio",\n    ras: "image/x-cmu-raster",\n    rdf: "application/rdf+xml",\n    rgb: "image/x-rgb",\n    rm: "application/vnd.rn-realmedia",\n    roff: "application/x-troff",\n    rtf: "text/rtf",\n    rtx: "text/richtext",\n    sgm: "text/sgml",\n    sgml: "text/sgml",\n    sh: "application/x-sh",\n    shar: "application/x-shar",\n    silo: "model/mesh",\n    sit: "application/x-stuffit",\n    skd: "application/x-koan",\n    skm: "application/x-koan",\n    skp: "application/x-koan",\n    skt: "application/x-koan",\n    smi: "application/smil",\n    smil: "application/smil",\n    snd: "audio/basic",\n    so: "application/octet-stream",\n    spl: "application/x-futuresplash",\n    src: "application/x-wais-source",\n    sv4cpio: "application/x-sv4cpio",\n    sv4crc: "application/x-sv4crc",\n    svg: "image/svg+xml",\n    swf: "application/x-shockwave-flash",\n    t: "application/x-troff",\n    tar: "application/x-tar",\n    tcl: "application/x-tcl",\n    tex: "application/x-tex",\n    texi: "application/x-texinfo",\n    texinfo: "application/x-texinfo",\n    tif: "image/tiff",\n    tiff: "image/tiff",\n    tr: "application/x-troff",\n    tsv: "text/tab-separated-values",\n    txt: "text/plain",\n    ustar: "application/x-ustar",\n    vcd: "application/x-cdlink",\n    vrml: "model/vrml",\n    vxml: "application/voicexml+xml",\n    wav: "audio/x-wav",\n    wbmp: "image/vnd.wap.wbmp",\n    wbmxl: "application/vnd.wap.wbxml",\n    wml: "text/vnd.wap.wml",\n    wmlc: "application/vnd.wap.wmlc",\n    wmls: "text/vnd.wap.wmlscript",\n    wmlsc: "application/vnd.wap.wmlscriptc",\n    wrl: "model/vrml",\n    xbm: "image/x-xbitmap",\n    xht: "application/xhtml+xml",\n    xhtml: "application/xhtml+xml",\n    xls: "application/vnd.ms-excel",\n    xml: "application/xml",\n    xpm: "image/x-xpixmap",\n    xsl: "application/xml",\n    xlsx: "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",\n    xltx: "application/vnd.openxmlformats-officedocument.spreadsheetml." +\n          "template",\n    xlsm: "application/vnd.ms-excel.sheet.macroEnabled.12",\n    xltm: "application/vnd.ms-excel.template.macroEnabled.12",\n    xlam: "application/vnd.ms-excel.addin.macroEnabled.12",\n    xlsb: "application/vnd.ms-excel.sheet.binary.macroEnabled.12",\n    xslt: "application/xslt+xml",\n    xul: "application/vnd.mozilla.xul+xml",\n    xwd: "image/x-xwindowdump",\n    xyz: "chemical/x-xyz",\n    zip: "application/zip"\n  };\n\n  /**\n   * Reads a File using a FileReader.\n   * @param file {File} the File to read.\n   * @param type {String} (optional) the mimetype to override with.\n   * @return {Parse.Promise} A Promise that will be fulfilled with a\n   *     base64-encoded string of the data and its mime type.\n   */\n  var readAsync = function(file, type) {\n    var promise = new Parse.Promise();\n\n    if (typeof(FileReader) === "undefined") {\n      return Parse.Promise.error(new Parse.Error(\n          Parse.Error.FILE_READ_ERROR,\n          "Attempted to use a FileReader on an unsupported browser."));\n    }\n\n    var reader = new FileReader();\n    reader.onloadend = function() {\n      if (reader.readyState !== 2) {\n        promise.reject(new Parse.Error(\n            Parse.Error.FILE_READ_ERROR,\n            "Error reading file."));\n        return;\n      }\n\n      var dataURL = reader.result;\n      var matches = /^data:([^;]*);base64,(.*)$/.exec(dataURL);\n      if (!matches) {\n        promise.reject(new Parse.Error(\n            Parse.ERROR.FILE_READ_ERROR,\n            "Unable to interpret data URL: " + dataURL));\n        return;\n      }\n\n      promise.resolve(matches[2], type || matches[1]);\n    };\n    reader.readAsDataURL(file);\n    return promise;\n  };\n\n  /**\n   * A Parse.File is a local representation of a file that is saved to the Parse\n   * cloud.\n   * @class\n   * @param name {String} The file\'s name. This will be prefixed by a unique\n   *     value once the file has finished saving. The file name must begin with\n   *     an alphanumeric character, and consist of alphanumeric characters,\n   *     periods, spaces, underscores, or dashes.\n   * @param data {Array} The data for the file, as either:\n   *     1. an Array of byte value Numbers, or\n   *     2. an Object like { base64: "..." } with a base64-encoded String.\n   *     3. a File object selected with a file upload control. (3) only works\n   *        in Firefox 3.6+, Safari 6.0.2+, Chrome 7+, and IE 10+.\n   *        For example:<pre>\n   * var fileUploadControl = $("#profilePhotoFileUpload")[0];\n   * if (fileUploadControl.files.length > 0) {\n   *   var file = fileUploadControl.files[0];\n   *   var name = "photo.jpg";\n   *   var parseFile = new Parse.File(name, file);\n   *   parseFile.save().then(function() {\n   *     // The file has been saved to Parse.\n   *   }, function(error) {\n   *     // The file either could not be read, or could not be saved to Parse.\n   *   });\n   * }</pre>\n   * @param type {String} Optional Content-Type header to use for the file. If\n   *     this is omitted, the content type will be inferred from the name\'s\n   *     extension.\n   */\n  Parse.File = function(name, data, type) {\n    this._name = name;\n\n    // Guess the content type from the extension if we need to.\n    var extension = /\\.([^.]*)$/.exec(name);\n    if (extension) {\n      extension = extension[1].toLowerCase();\n    }\n    var guessedType = type || mimeTypes[extension] || "text/plain";\n\n    if (_.isArray(data)) {\n      this._source = Parse.Promise.as(encodeBase64(data), guessedType);\n    } else if (data && data.base64) {\n      // if it contains data uri, extract based64 and the type out of it.\n      /*jslint maxlen: 1000*/\n      var dataUriRegexp = /^data:([a-zA-Z]*\\/[a-zA-Z+.-]*);(charset=[a-zA-Z0-9\\-\\/\\s]*,)?base64,(\\S+)/;\n      /*jslint maxlen: 80*/\n\n      var matches = dataUriRegexp.exec(data.base64);\n      if (matches && matches.length > 0) {\n        // if data URI with charset, there will have 4 matches.\n        this._source = Parse.Promise.as(\n          (matches.length === 4 ? matches[3] : matches[2]), matches[1]\n        );\n      } else {\n        this._source = Parse.Promise.as(data.base64, guessedType);\n      }\n    } else if (typeof(File) !== "undefined" && data instanceof File) {\n      this._source = readAsync(data, type);\n    } else if (_.isString(data)) {\n      throw "Creating a Parse.File from a String is not yet supported.";\n    }\n  };\n\n  Parse.File.prototype = {\n\n    /**\n     * Gets the name of the file. Before save is called, this is the filename\n     * given by the user. After save is called, that name gets prefixed with a\n     * unique identifier.\n     */\n    name: function() {\n      return this._name;\n    },\n\n    /**\n     * Gets the url of the file. It is only available after you save the file or\n     * after you get the file from a Parse.Object.\n     * @return {String}\n     */\n    url: function() {\n      return this._url;\n    },\n\n    /**\n     * Saves the file to the Parse cloud.\n     * @param {Object} options A Backbone-style options object.\n     * @return {Parse.Promise} Promise that is resolved when the save finishes.\n     */\n    save: function(options) {\n      options= options || {};\n\n      var self = this;\n      if (!self._previousSave) {\n        self._previousSave = self._source.then(function(base64, type) {\n          var data = {\n            base64: base64,\n            _ContentType: type\n          };\n          return Parse._request({\n            route: "files",\n            className: self._name,\n            method: \'POST\',\n            data: data,\n            useMasterKey: options.useMasterKey\n          });\n\n        }).then(function(response) {\n          self._name = response.name;\n          self._url = response.url;\n          return self;\n        });\n      }\n      return self._previousSave._thenRunCallbacks(options);\n    }\n  };\n\n}(this));\n\n// Parse.Object is analogous to the Java ParseObject.\n// It also implements the same interface as a Backbone model.\n\n(function(root) {\n  root.Parse = root.Parse || {};\n  var Parse = root.Parse;\n  var _ = Parse._;\n\n  /**\n   * Creates a new model with defined attributes. A client id (cid) is\n   * automatically generated and assigned for you.\n   *\n   * <p>You won\'t normally call this method directly.  It is recommended that\n   * you use a subclass of <code>Parse.Object</code> instead, created by calling\n   * <code>extend</code>.</p>\n   *\n   * <p>However, if you don\'t want to use a subclass, or aren\'t sure which\n   * subclass is appropriate, you can use this form:<pre>\n   *     var object = new Parse.Object("ClassName");\n   * </pre>\n   * That is basically equivalent to:<pre>\n   *     var MyClass = Parse.Object.extend("ClassName");\n   *     var object = new MyClass();\n   * </pre></p>\n   *\n   * @param {Object} attributes The initial set of data to store in the object.\n   * @param {Object} options A set of Backbone-like options for creating the\n   *     object.  The only option currently supported is "collection".\n   * @see Parse.Object.extend\n   *\n   * @class\n   *\n   * <p>The fundamental unit of Parse data, which implements the Backbone Model\n   * interface.</p>\n   */\n  Parse.Object = function(attributes, options) {\n    // Allow new Parse.Object("ClassName") as a shortcut to _create.\n    if (_.isString(attributes)) {\n      return Parse.Object._create.apply(this, arguments);\n    }\n\n    attributes = attributes || {};\n    if (options && options.parse) {\n      attributes = this.parse(attributes);\n    }\n    var defaults = Parse._getValue(this, \'defaults\');\n    if (defaults) {\n      attributes = _.extend({}, defaults, attributes);\n    }\n    if (options && options.collection) {\n      this.collection = options.collection;\n    }\n\n    this._serverData = {};  // The last known data for this object from cloud.\n    this._opSetQueue = [{}];  // List of sets of changes to the data.\n    this.attributes = {};  // The best estimate of this\'s current data.\n\n    this._hashedJSON = {};  // Hash of values of containers at last save.\n    this._escapedAttributes = {};\n    this.cid = _.uniqueId(\'c\');\n    this.changed = {};\n    this._silent = {};\n    this._pending = {};\n    if (!this.set(attributes, {silent: true})) {\n      throw new Error("Can\'t create an invalid Parse.Object");\n    }\n    this.changed = {};\n    this._silent = {};\n    this._pending = {};\n    this._hasData = true;\n    this._previousAttributes = _.clone(this.attributes);\n    this.initialize.apply(this, arguments);\n  };\n\n  /**\n   * @lends Parse.Object.prototype\n   * @property {String} id The objectId of the Parse Object.\n   */\n\n  /**\n   * Saves the given list of Parse.Object.\n   * If any error is encountered, stops and calls the error handler.\n   *\n   * <pre>\n   *   Parse.Object.saveAll([object1, object2, ...], {\n   *     success: function(list) {\n   *       // All the objects were saved.\n   *     },\n   *     error: function(error) {\n   *       // An error occurred while saving one of the objects.\n   *     },\n   *   });\n   * </pre>\n   *\n   * @param {Array} list A list of <code>Parse.Object</code>.\n   * @param {Object} options A Backbone-style callback object.\n   * Valid options are:<ul>\n   *   <li>useMasterKey: In Cloud Code and Node only, causes the Master Key to\n   *     be used for this request.\n   * </ul>\n   */\n  Parse.Object.saveAll = function(list, options) {\n    options = options || {};\n    return Parse.Object._deepSaveAsync(list, {\n      useMasterKey: options.useMasterKey\n    })._thenRunCallbacks(options);\n  };\n\n  /**\n   * Destroy the given list of models on the server if it was already persisted.\n   * Optimistically removes each model from its collection, if it has one.\n   * If `wait: true` is passed, waits for the server to respond before removal.\n   *\n   * <p>Unlike saveAll, if an error occurs while deleting an individual model,\n   * this method will continue trying to delete the rest of the models if\n   * possible, except in the case of a fatal error like a connection error.\n   *\n   * <p>In particular, the Parse.Error object returned in the case of error may\n   * be one of two types:\n   *\n   * <ul>\n   *   <li>A Parse.Error.AGGREGATE_ERROR. This object\'s "errors" property is an\n   *       array of other Parse.Error objects. Each error object in this array\n   *       has an "object" property that references the object that could not be\n   *       deleted (for instance, because that object could not be found).</li>\n   *   <li>A non-aggregate Parse.Error. This indicates a serious error that\n   *       caused the delete operation to be aborted partway through (for\n   *       instance, a connection failure in the middle of the delete).</li>\n   * </ul>\n   *\n   * <pre>\n   *   Parse.Object.destroyAll([object1, object2, ...], {\n   *     success: function() {\n   *       // All the objects were deleted.\n   *     },\n   *     error: function(error) {\n   *       // An error occurred while deleting one or more of the objects.\n   *       // If this is an aggregate error, then we can inspect each error\n   *       // object individually to determine the reason why a particular\n   *       // object was not deleted.\n   *       if (error.code == Parse.Error.AGGREGATE_ERROR) {\n   *         for (var i = 0; i < error.errors.length; i++) {\n   *           console.log("Couldn\'t delete " + error.errors[i].object.id +\n   *             "due to " + error.errors[i].message);\n   *         }\n   *       } else {\n   *         console.log("Delete aborted because of " + error.message);\n   *       }\n   *     },\n   *   });\n   * </pre>\n   *\n   * @param {Array} list A list of <code>Parse.Object</code>.\n   * @param {Object} options A Backbone-style callback object.\n   * Valid options are:<ul>\n   *   <li>useMasterKey: In Cloud Code and Node only, causes the Master Key to\n   *     be used for this request.\n   * </ul>\n   */\n  Parse.Object.destroyAll = function(list, options) {\n    options = options || {};\n\n    var triggerDestroy = function(object) {\n      object.trigger(\'destroy\', object, object.collection, options);\n    };\n\n    var errors = [];\n    var destroyBatch = function(batch) {\n      var promise = Parse.Promise.as();\n\n      if (batch.length > 0) {\n        promise = promise.then(function() {\n          return Parse._request({\n            route: "batch",\n            method: "POST",\n            useMasterKey: options.useMasterKey,\n            data: {\n              requests: _.map(batch, function(object) {\n                return {\n                  method: "DELETE",\n                  path: "/1/classes/" + object.className + "/" + object.id\n                };\n              })\n            }\n          });\n        }).then(function(responses, status, xhr) {\n          Parse._arrayEach(batch, function(object, i) {\n            if (responses[i].success && options.wait) {\n              triggerDestroy(object);\n            } else if (responses[i].error) {\n              var error = new Parse.Error(responses[i].error.code,\n                                          responses[i].error.error);\n              error.object = object;\n\n              errors.push(error);\n            }\n          });\n        });\n      }\n\n      return promise;\n    };\n\n    var promise = Parse.Promise.as();\n    var batch = [];\n    Parse._arrayEach(list, function(object, i) {\n      if (!object.id || !options.wait) {\n        triggerDestroy(object);\n      }\n\n      if (object.id) {\n        batch.push(object);\n      }\n\n      if (batch.length === 20 || i+1 === list.length) {\n        var thisBatch = batch;\n        batch = [];\n\n        promise = promise.then(function() {\n          return destroyBatch(thisBatch);\n        });\n      }\n    });\n\n    return promise.then(function() {\n      if (errors.length === 0) {\n        return true;\n      } else {\n        var error = new Parse.Error(Parse.Error.AGGREGATE_ERROR,\n                                    "Error deleting an object in destroyAll");\n        error.errors = errors;\n\n        return Parse.Promise.error(error);\n      }\n    })._thenRunCallbacks(options);\n  };\n\n  /**\n   * Fetches the given list of Parse.Object.\n   * If any error is encountered, stops and calls the error handler.\n   *\n   * <pre>\n   *   Parse.Object.fetchAll([object1, object2, ...], {\n   *     success: function(list) {\n   *       // All the objects were fetched.\n   *     },\n   *     error: function(error) {\n   *       // An error occurred while fetching one of the objects.\n   *     },\n   *   });\n   * </pre>\n   *\n   * @param {Array} list A list of <code>Parse.Object</code>.\n   * @param {Object} options A Backbone-style callback object.\n   * Valid options are:<ul>\n   *   <li>success: A Backbone-style success callback.\n   *   <li>error: An Backbone-style error callback.\n   * </ul>\n   */\n  Parse.Object.fetchAll = function(list, options) {\n    return Parse.Object._fetchAll(\n      list,\n      true\n    )._thenRunCallbacks(options);\n  };\n\n  /**\n   * Fetches the given list of Parse.Object if needed.\n   * If any error is encountered, stops and calls the error handler.\n   *\n   * <pre>\n   *   Parse.Object.fetchAllIfNeeded([object1, ...], {\n   *     success: function(list) {\n   *       // Objects were fetched and updated.\n   *     },\n   *     error: function(error) {\n   *       // An error occurred while fetching one of the objects.\n   *     },\n   *   });\n   * </pre>\n   *\n   * @param {Array} list A list of <code>Parse.Object</code>.\n   * @param {Object} options A Backbone-style callback object.\n   * Valid options are:<ul>\n   *   <li>success: A Backbone-style success callback.\n   *   <li>error: An Backbone-style error callback.\n   * </ul>\n   */\n  Parse.Object.fetchAllIfNeeded = function(list, options) {\n    return Parse.Object._fetchAll(\n      list,\n      false\n    )._thenRunCallbacks(options);\n  };\n\n  // Attach all inheritable methods to the Parse.Object prototype.\n  _.extend(Parse.Object.prototype, Parse.Events,\n           /** @lends Parse.Object.prototype */ {\n    _existed: false,\n\n    /**\n     * Initialize is an empty function by default. Override it with your own\n     * initialization logic.\n     */\n    initialize: function(){},\n\n    /**\n     * Returns a JSON version of the object suitable for saving to Parse.\n     * @return {Object}\n     */\n    toJSON: function() {\n      var json = this._toFullJSON();\n      Parse._arrayEach(["__type", "className"],\n                       function(key) { delete json[key]; });\n      return json;\n    },\n\n    _toFullJSON: function(seenObjects) {\n      var json = _.clone(this.attributes);\n      Parse._objectEach(json, function(val, key) {\n        json[key] = Parse._encode(val, seenObjects);\n      });\n      Parse._objectEach(this._operations, function(val, key) {\n        json[key] = val;\n      });\n\n      if (_.has(this, "id")) {\n        json.objectId = this.id;\n      }\n      if (_.has(this, "createdAt")) {\n        if (_.isDate(this.createdAt)) {\n          json.createdAt = this.createdAt.toJSON();\n        } else {\n          json.createdAt = this.createdAt;\n        }\n      }\n\n      if (_.has(this, "updatedAt")) {\n        if (_.isDate(this.updatedAt)) {\n          json.updatedAt = this.updatedAt.toJSON();\n        } else {\n          json.updatedAt = this.updatedAt;\n        }\n      }\n      json.__type = "Object";\n      json.className = this.className;\n      return json;\n    },\n\n    /**\n     * Updates _hashedJSON to reflect the current state of this object.\n     * Adds any changed hash values to the set of pending changes.\n     */\n    _refreshCache: function() {\n      var self = this;\n      if (self._refreshingCache) {\n        return;\n      }\n      self._refreshingCache = true;\n      Parse._objectEach(this.attributes, function(value, key) {\n        if (value instanceof Parse.Object) {\n          value._refreshCache();\n        } else if (_.isObject(value)) {\n          if (self._resetCacheForKey(key)) {\n            self.set(key, new Parse.Op.Set(value), { silent: true });\n          }\n        }\n      });\n      delete self._refreshingCache;\n    },\n\n    /**\n     * Returns true if this object has been modified since its last\n     * save/refresh.  If an attribute is specified, it returns true only if that\n     * particular attribute has been modified since the last save/refresh.\n     * @param {String} attr An attribute name (optional).\n     * @return {Boolean}\n     */\n    dirty: function(attr) {\n      this._refreshCache();\n\n      var currentChanges = _.last(this._opSetQueue);\n\n      if (attr) {\n        return (currentChanges[attr] ? true : false);\n      }\n      if (!this.id) {\n        return true;\n      }\n      if (_.keys(currentChanges).length > 0) {\n        return true;\n      }\n      return false;\n    },\n\n    /**\n     * Returns an array of keys that have been modified since last save/refresh\n     * @return {Array of string}\n     */\n    dirtyKeys: function() {\n      return _.keys(_.last(this._opSetQueue));\n    },\n\n    /**\n     * Gets a Pointer referencing this Object.\n     */\n    _toPointer: function() {\n      if (!this.id) {\n        throw new Error("Can\'t serialize an unsaved Parse.Object");\n      }\n      return { __type: "Pointer",\n               className: this.className,\n               objectId: this.id };\n    },\n\n    /**\n     * Gets the value of an attribute.\n     * @param {String} attr The string name of an attribute.\n     */\n    get: function(attr) {\n      return this.attributes[attr];\n    },\n\n    /**\n     * Gets a relation on the given class for the attribute.\n     * @param String attr The attribute to get the relation for.\n     */\n    relation: function(attr) {\n      var value = this.get(attr);\n      if (value) {\n        if (!(value instanceof Parse.Relation)) {\n          throw "Called relation() on non-relation field " + attr;\n        }\n        value._ensureParentAndKey(this, attr);\n        return value;\n      } else {\n        return new Parse.Relation(this, attr);\n      }\n    },\n\n    /**\n     * Gets the HTML-escaped value of an attribute.\n     */\n    escape: function(attr) {\n      var html = this._escapedAttributes[attr];\n      if (html) {\n        return html;\n      }\n      var val = this.attributes[attr];\n      var escaped;\n      if (Parse._isNullOrUndefined(val)) {\n        escaped = \'\';\n      } else {\n        escaped = _.escape(val.toString());\n      }\n      this._escapedAttributes[attr] = escaped;\n      return escaped;\n    },\n\n    /**\n     * Returns <code>true</code> if the attribute contains a value that is not\n     * null or undefined.\n     * @param {String} attr The string name of the attribute.\n     * @return {Boolean}\n     */\n    has: function(attr) {\n      return !Parse._isNullOrUndefined(this.attributes[attr]);\n    },\n\n    /**\n     * Pulls "special" fields like objectId, createdAt, etc. out of attrs\n     * and puts them on "this" directly.  Removes them from attrs.\n     * @param attrs - A dictionary with the data for this Parse.Object.\n     */\n    _mergeMagicFields: function(attrs) {\n      // Check for changes of magic fields.\n      var model = this;\n      var specialFields = ["id", "objectId", "createdAt", "updatedAt"];\n      Parse._arrayEach(specialFields, function(attr) {\n        if (attrs[attr]) {\n          if (attr === "objectId") {\n            model.id = attrs[attr];\n          } else if ((attr === "createdAt" || attr === "updatedAt") &&\n                     !_.isDate(attrs[attr])) {\n            model[attr] = Parse._parseDate(attrs[attr]);\n          } else {\n            model[attr] = attrs[attr];\n          }\n          delete attrs[attr];\n        }\n      });\n    },\n\n    /**\n     * Copies the given serverData to "this", refreshes attributes, and\n     * clears pending changes;\n     */\n    _copyServerData: function(serverData) {\n      // Copy server data\n      var tempServerData = {};\n      Parse._objectEach(serverData, function(value, key) {\n        tempServerData[key] = Parse._decode(key, value);\n      });\n      this._serverData = tempServerData;\n\n      // Refresh the attributes.\n      this._rebuildAllEstimatedData();\n\n\n      // Clear out any changes the user might have made previously.\n      this._refreshCache();\n      this._opSetQueue = [{}];\n\n      // Refresh the attributes again.\n      this._rebuildAllEstimatedData();\n    },\n\n    /**\n     * Merges another object\'s attributes into this object.\n     */\n    _mergeFromObject: function(other) {\n      if (!other) {\n        return;\n      }\n\n      // This does the inverse of _mergeMagicFields.\n      this.id = other.id;\n      this.createdAt = other.createdAt;\n      this.updatedAt = other.updatedAt;\n\n      this._copyServerData(other._serverData);\n\n      this._hasData = true;\n    },\n\n    /**\n     * Returns the json to be sent to the server.\n     */\n    _startSave: function() {\n      this._opSetQueue.push({});\n    },\n\n    /**\n     * Called when a save fails because of an error. Any changes that were part\n     * of the save need to be merged with changes made after the save. This\n     * might throw an exception is you do conflicting operations. For example,\n     * if you do:\n     *   object.set("foo", "bar");\n     *   object.set("invalid field name", "baz");\n     *   object.save();\n     *   object.increment("foo");\n     * then this will throw when the save fails and the client tries to merge\n     * "bar" with the +1.\n     */\n    _cancelSave: function() {\n      var self = this;\n      var failedChanges = _.first(this._opSetQueue);\n      this._opSetQueue = _.rest(this._opSetQueue);\n      var nextChanges = _.first(this._opSetQueue);\n      Parse._objectEach(failedChanges, function(op, key) {\n        var op1 = failedChanges[key];\n        var op2 = nextChanges[key];\n        if (op1 && op2) {\n          nextChanges[key] = op2._mergeWithPrevious(op1);\n        } else if (op1) {\n          nextChanges[key] = op1;\n        }\n      });\n      this._saving = this._saving - 1;\n    },\n\n    /**\n     * Called when a save completes successfully. This merges the changes that\n     * were saved into the known server data, and overrides it with any data\n     * sent directly from the server.\n     */\n    _finishSave: function(serverData) {\n      // Grab a copy of any object referenced by this object. These instances\n      // may have already been fetched, and we don\'t want to lose their data.\n      // Note that doing it like this means we will unify separate copies of the\n      // same object, but that\'s a risk we have to take.\n      var fetchedObjects = {};\n      Parse._traverse(this.attributes, function(object) {\n        if (object instanceof Parse.Object && object.id && object._hasData) {\n          fetchedObjects[object.id] = object;\n        }\n      });\n\n      var savedChanges = _.first(this._opSetQueue);\n      this._opSetQueue = _.rest(this._opSetQueue);\n      this._applyOpSet(savedChanges, this._serverData);\n      this._mergeMagicFields(serverData);\n      var self = this;\n      Parse._objectEach(serverData, function(value, key) {\n        self._serverData[key] = Parse._decode(key, value);\n\n        // Look for any objects that might have become unfetched and fix them\n        // by replacing their values with the previously observed values.\n        var fetched = Parse._traverse(self._serverData[key], function(object) {\n          if (object instanceof Parse.Object && fetchedObjects[object.id]) {\n            return fetchedObjects[object.id];\n          }\n        });\n        if (fetched) {\n          self._serverData[key] = fetched;\n        }\n      });\n      this._rebuildAllEstimatedData();\n      this._saving = this._saving - 1;\n    },\n\n    /**\n     * Called when a fetch or login is complete to set the known server data to\n     * the given object.\n     */\n    _finishFetch: function(serverData, hasData) {\n\n      this._opSetQueue = [{}];\n\n      // Bring in all the new server data.\n      this._mergeMagicFields(serverData);\n      this._copyServerData(serverData);\n\n      this._hasData = hasData;\n    },\n\n    /**\n     * Applies the set of Parse.Op in opSet to the object target.\n     */\n    _applyOpSet: function(opSet, target) {\n      var self = this;\n      Parse._objectEach(opSet, function(change, key) {\n        target[key] = change._estimate(target[key], self, key);\n        if (target[key] === Parse.Op._UNSET) {\n          delete target[key];\n        }\n      });\n    },\n\n    /**\n     * Replaces the cached value for key with the current value.\n     * Returns true if the new value is different than the old value.\n     */\n    _resetCacheForKey: function(key) {\n      var value = this.attributes[key];\n      if (_.isObject(value) &&\n          !(value instanceof Parse.Object) &&\n          !(value instanceof Parse.File)) {\n        value = value.toJSON ? value.toJSON() : value;\n        var json = JSON.stringify(value);\n        if (this._hashedJSON[key] !== json) {\n          this._hashedJSON[key] = json;\n          return true;\n        }\n      }\n      return false;\n    },\n\n    /**\n     * Populates attributes[key] by starting with the last known data from the\n     * server, and applying all of the local changes that have been made to that\n     * key since then.\n     */\n    _rebuildEstimatedDataForKey: function(key) {\n      var self = this;\n      delete this.attributes[key];\n      if (this._serverData[key]) {\n        this.attributes[key] = this._serverData[key];\n      }\n      Parse._arrayEach(this._opSetQueue, function(opSet) {\n        var op = opSet[key];\n        if (op) {\n          self.attributes[key] = op._estimate(self.attributes[key], self, key);\n          if (self.attributes[key] === Parse.Op._UNSET) {\n            delete self.attributes[key];\n          } else {\n            self._resetCacheForKey(key);\n          }\n        }\n      });\n    },\n\n    /**\n     * Populates attributes by starting with the last known data from the\n     * server, and applying all of the local changes that have been made since\n     * then.\n     */\n    _rebuildAllEstimatedData: function() {\n      var self = this;\n\n      var previousAttributes = _.clone(this.attributes);\n\n      this.attributes = _.clone(this._serverData);\n      Parse._arrayEach(this._opSetQueue, function(opSet) {\n        self._applyOpSet(opSet, self.attributes);\n        Parse._objectEach(opSet, function(op, key) {\n          self._resetCacheForKey(key);\n        });\n      });\n\n      // Trigger change events for anything that changed because of the fetch.\n      Parse._objectEach(previousAttributes, function(oldValue, key) {\n        if (self.attributes[key] !== oldValue) {\n          self.trigger(\'change:\' + key, self, self.attributes[key], {});\n        }\n      });\n      Parse._objectEach(this.attributes, function(newValue, key) {\n        if (!_.has(previousAttributes, key)) {\n          self.trigger(\'change:\' + key, self, newValue, {});\n        }\n      });\n    },\n\n    /**\n     * Sets a hash of model attributes on the object, firing\n     * <code>"change"</code> unless you choose to silence it.\n     *\n     * <p>You can call it with an object containing keys and values, or with one\n     * key and value.  For example:<pre>\n     *   gameTurn.set({\n     *     player: player1,\n     *     diceRoll: 2\n     *   }, {\n     *     error: function(gameTurnAgain, error) {\n     *       // The set failed validation.\n     *     }\n     *   });\n     *\n     *   game.set("currentPlayer", player2, {\n     *     error: function(gameTurnAgain, error) {\n     *       // The set failed validation.\n     *     }\n     *   });\n     *\n     *   game.set("finished", true);</pre></p>\n     *\n     * @param {String} key The key to set.\n     * @param {} value The value to give it.\n     * @param {Object} options A set of Backbone-like options for the set.\n     *     The only supported options are <code>silent</code>,\n     *     <code>error</code>, and <code>promise</code>.\n     * @return {Boolean} true if the set succeeded.\n     * @see Parse.Object#validate\n     * @see Parse.Error\n     */\n    set: function(key, value, options) {\n      var attrs, attr;\n      if (_.isObject(key) || Parse._isNullOrUndefined(key)) {\n        attrs = key;\n        Parse._objectEach(attrs, function(v, k) {\n          attrs[k] = Parse._decode(k, v);\n        });\n        options = value;\n      } else {\n        attrs = {};\n        attrs[key] = Parse._decode(key, value);\n      }\n\n      // Extract attributes and options.\n      options = options || {};\n      if (!attrs) {\n        return this;\n      }\n      if (attrs instanceof Parse.Object) {\n        attrs = attrs.attributes;\n      }\n\n      // If the unset option is used, every attribute should be a Unset.\n      if (options.unset) {\n        Parse._objectEach(attrs, function(unused_value, key) {\n          attrs[key] = new Parse.Op.Unset();\n        });\n      }\n\n      // Apply all the attributes to get the estimated values.\n      var dataToValidate = _.clone(attrs);\n      var self = this;\n      Parse._objectEach(dataToValidate, function(value, key) {\n        if (value instanceof Parse.Op) {\n          dataToValidate[key] = value._estimate(self.attributes[key],\n                                                self, key);\n          if (dataToValidate[key] === Parse.Op._UNSET) {\n            delete dataToValidate[key];\n          }\n        }\n      });\n\n      // Run validation.\n      if (!this._validate(attrs, options)) {\n        return false;\n      }\n\n      this._mergeMagicFields(attrs);\n\n      options.changes = {};\n      var escaped = this._escapedAttributes;\n      var prev = this._previousAttributes || {};\n\n      // Update attributes.\n      Parse._arrayEach(_.keys(attrs), function(attr) {\n        var val = attrs[attr];\n\n        // If this is a relation object we need to set the parent correctly,\n        // since the location where it was parsed does not have access to\n        // this object.\n        if (val instanceof Parse.Relation) {\n          val.parent = self;\n        }\n\n        if (!(val instanceof Parse.Op)) {\n          val = new Parse.Op.Set(val);\n        }\n\n        // See if this change will actually have any effect.\n        var isRealChange = true;\n        if (val instanceof Parse.Op.Set &&\n            _.isEqual(self.attributes[attr], val.value)) {\n          isRealChange = false;\n        }\n\n        if (isRealChange) {\n          delete escaped[attr];\n          if (options.silent) {\n            self._silent[attr] = true;\n          } else {\n            options.changes[attr] = true;\n          }\n        }\n\n        var currentChanges = _.last(self._opSetQueue);\n        currentChanges[attr] = val._mergeWithPrevious(currentChanges[attr]);\n        self._rebuildEstimatedDataForKey(attr);\n\n        if (isRealChange) {\n          self.changed[attr] = self.attributes[attr];\n          if (!options.silent) {\n            self._pending[attr] = true;\n          }\n        } else {\n          delete self.changed[attr];\n          delete self._pending[attr];\n        }\n      });\n\n      if (!options.silent) {\n        this.change(options);\n      }\n      return this;\n    },\n\n    /**\n     * Remove an attribute from the model, firing <code>"change"</code> unless\n     * you choose to silence it. This is a noop if the attribute doesn\'t\n     * exist.\n     */\n    unset: function(attr, options) {\n      options = options || {};\n      options.unset = true;\n      return this.set(attr, null, options);\n    },\n\n    /**\n     * Atomically increments the value of the given attribute the next time the\n     * object is saved. If no amount is specified, 1 is used by default.\n     *\n     * @param attr {String} The key.\n     * @param amount {Number} The amount to increment by.\n     */\n    increment: function(attr, amount) {\n      if (_.isUndefined(amount) || _.isNull(amount)) {\n        amount = 1;\n      }\n      return this.set(attr, new Parse.Op.Increment(amount));\n    },\n\n    /**\n     * Atomically add an object to the end of the array associated with a given\n     * key.\n     * @param attr {String} The key.\n     * @param item {} The item to add.\n     */\n    add: function(attr, item) {\n      return this.set(attr, new Parse.Op.Add([item]));\n    },\n\n    /**\n     * Atomically add an object to the array associated with a given key, only\n     * if it is not already present in the array. The position of the insert is\n     * not guaranteed.\n     *\n     * @param attr {String} The key.\n     * @param item {} The object to add.\n     */\n    addUnique: function(attr, item) {\n      return this.set(attr, new Parse.Op.AddUnique([item]));\n    },\n\n    /**\n     * Atomically remove all instances of an object from the array associated\n     * with a given key.\n     *\n     * @param attr {String} The key.\n     * @param item {} The object to remove.\n     */\n    remove: function(attr, item) {\n      return this.set(attr, new Parse.Op.Remove([item]));\n    },\n\n    /**\n     * Returns an instance of a subclass of Parse.Op describing what kind of\n     * modification has been performed on this field since the last time it was\n     * saved. For example, after calling object.increment("x"), calling\n     * object.op("x") would return an instance of Parse.Op.Increment.\n     *\n     * @param attr {String} The key.\n     * @returns {Parse.Op} The operation, or undefined if none.\n     */\n    op: function(attr) {\n      return _.last(this._opSetQueue)[attr];\n    },\n\n    /**\n     * Clear all attributes on the model, firing <code>"change"</code> unless\n     * you choose to silence it.\n     */\n    clear: function(options) {\n      options = options || {};\n      options.unset = true;\n      var keysToClear = _.extend(this.attributes, this._operations);\n      return this.set(keysToClear, options);\n    },\n\n    /**\n     * Returns a JSON-encoded set of operations to be sent with the next save\n     * request.\n     */\n    _getSaveJSON: function() {\n      var json = _.clone(_.first(this._opSetQueue));\n      Parse._objectEach(json, function(op, key) {\n        json[key] = op.toJSON();\n      });\n      return json;\n    },\n\n    /**\n     * Returns true if this object can be serialized for saving.\n     */\n    _canBeSerialized: function() {\n      return Parse.Object._canBeSerializedAsValue(this.attributes);\n    },\n\n    /**\n     * Fetch the model from the server. If the server\'s representation of the\n     * model differs from its current attributes, they will be overriden,\n     * triggering a <code>"change"</code> event.\n     *\n     * @param {Object} options A Backbone-style callback object.\n     * Valid options are:<ul>\n     *   <li>success: A Backbone-style success callback.\n     *   <li>error: An Backbone-style error callback.\n     *   <li>useMasterKey: In Cloud Code and Node only, causes the Master Key to\n     *     be used for this request.\n     * </ul>\n     * @return {Parse.Promise} A promise that is fulfilled when the fetch\n     *     completes.\n     */\n    fetch: function(options) {\n      var self = this;\n      options = options || {};\n      var request = Parse._request({\n        method: \'GET\',\n        route: "classes",\n        className: this.className,\n        objectId: this.id,\n        useMasterKey: options.useMasterKey\n      });\n      return request.then(function(response, status, xhr) {\n        self._finishFetch(self.parse(response, status, xhr), true);\n        return self;\n      })._thenRunCallbacks(options, this);\n    },\n\n    /**\n     * Set a hash of model attributes, and save the model to the server.\n     * updatedAt will be updated when the request returns.\n     * You can either call it as:<pre>\n     *   object.save();</pre>\n     * or<pre>\n     *   object.save(null, options);</pre>\n     * or<pre>\n     *   object.save(attrs, options);</pre>\n     * or<pre>\n     *   object.save(key, value, options);</pre>\n     *\n     * For example, <pre>\n     *   gameTurn.save({\n     *     player: "Jake Cutter",\n     *     diceRoll: 2\n     *   }, {\n     *     success: function(gameTurnAgain) {\n     *       // The save was successful.\n     *     },\n     *     error: function(gameTurnAgain, error) {\n     *       // The save failed.  Error is an instance of Parse.Error.\n     *     }\n     *   });</pre>\n     * or with promises:<pre>\n     *   gameTurn.save({\n     *     player: "Jake Cutter",\n     *     diceRoll: 2\n     *   }).then(function(gameTurnAgain) {\n     *     // The save was successful.\n     *   }, function(error) {\n     *     // The save failed.  Error is an instance of Parse.Error.\n     *   });</pre>\n     *\n     * @param {Object} options A Backbone-style callback object.\n     * Valid options are:<ul>\n     *   <li>wait: Set to true to wait for the server to confirm a successful\n     *   save before modifying the attributes on the object.\n     *   <li>silent: Set to true to avoid firing the `set` event.\n     *   <li>success: A Backbone-style success callback.\n     *   <li>error: An Backbone-style error callback.\n     *   <li>useMasterKey: In Cloud Code and Node only, causes the Master Key to\n     *     be used for this request.\n     * </ul>\n     * @return {Parse.Promise} A promise that is fulfilled when the save\n     *     completes.\n     * @see Parse.Error\n     */\n    save: function(arg1, arg2, arg3) {\n      var i, attrs, current, options, saved;\n      if (_.isObject(arg1) || Parse._isNullOrUndefined(arg1)) {\n        attrs = arg1;\n        options = arg2;\n      } else {\n        attrs = {};\n        attrs[arg1] = arg2;\n        options = arg3;\n      }\n\n      // Make save({ success: function() {} }) work.\n      if (!options && attrs) {\n        var extra_keys = _.reject(attrs, function(value, key) {\n          return _.include(["success", "error", "wait"], key);\n        });\n        if (extra_keys.length === 0) {\n          var all_functions = true;\n          if (_.has(attrs, "success") && !_.isFunction(attrs.success)) {\n            all_functions = false;\n          }\n          if (_.has(attrs, "error") && !_.isFunction(attrs.error)) {\n            all_functions = false;\n          }\n          if (all_functions) {\n            // This attrs object looks like it\'s really an options object,\n            // and there\'s no other options object, so let\'s just use it.\n            return this.save(null, attrs);\n          }\n        }\n      }\n\n      options = _.clone(options) || {};\n      if (options.wait) {\n        current = _.clone(this.attributes);\n      }\n\n      var setOptions = _.clone(options) || {};\n      if (setOptions.wait) {\n        setOptions.silent = true;\n      }\n      var setError;\n      setOptions.error = function(model, error) {\n        setError = error;\n      };\n      if (attrs && !this.set(attrs, setOptions)) {\n        return Parse.Promise.error(setError)._thenRunCallbacks(options, this);\n      }\n\n      var model = this;\n\n      // If there is any unsaved child, save it first.\n      model._refreshCache();\n\n\n\n      var unsavedChildren = [];\n      var unsavedFiles = [];\n      Parse.Object._findUnsavedChildren(model.attributes,\n                                        unsavedChildren,\n                                        unsavedFiles);\n      if (unsavedChildren.length + unsavedFiles.length > 0) {\n        return Parse.Object._deepSaveAsync(this.attributes, {\n          useMasterKey: options.useMasterKey\n        }).then(function() {\n          return model.save(null, options);\n        }, function(error) {\n          return Parse.Promise.error(error)._thenRunCallbacks(options, model);\n        });\n      }\n\n      this._startSave();\n      this._saving = (this._saving || 0) + 1;\n\n      this._allPreviousSaves = this._allPreviousSaves || Parse.Promise.as();\n      this._allPreviousSaves = this._allPreviousSaves._continueWith(function() {\n        var method = model.id ? \'PUT\' : \'POST\';\n\n        var json = model._getSaveJSON();\n\n        var route = "classes";\n        var className = model.className;\n        if (model.className === "_User" && !model.id) {\n          // Special-case user sign-up.\n          route = "users";\n          className = null;\n        }\n        var request = Parse._request({\n          route: route,\n          className: className,\n          objectId: model.id,\n          method: method,\n          useMasterKey: options.useMasterKey,\n          data: json\n        });\n\n        request = request.then(function(resp, status, xhr) {\n          var serverAttrs = model.parse(resp, status, xhr);\n          if (options.wait) {\n            serverAttrs = _.extend(attrs || {}, serverAttrs);\n          }\n          model._finishSave(serverAttrs);\n          if (options.wait) {\n            model.set(current, setOptions);\n          }\n          return model;\n\n        }, function(error) {\n          model._cancelSave();\n          return Parse.Promise.error(error);\n\n        })._thenRunCallbacks(options, model);\n\n        return request;\n      });\n      return this._allPreviousSaves;\n    },\n\n    /**\n     * Destroy this model on the server if it was already persisted.\n     * Optimistically removes the model from its collection, if it has one.\n     * If `wait: true` is passed, waits for the server to respond\n     * before removal.\n     *\n     * @param {Object} options A Backbone-style callback object.\n     * Valid options are:<ul>\n     *   <li>wait: Set to true to wait for the server to confirm successful\n     *   deletion of the object before triggering the `destroy` event.\n     *   <li>success: A Backbone-style success callback\n     *   <li>error: An Backbone-style error callback.\n     *   <li>useMasterKey: In Cloud Code and Node only, causes the Master Key to\n     *     be used for this request.\n     * </ul>\n     * @return {Parse.Promise} A promise that is fulfilled when the destroy\n     *     completes.\n     */\n    destroy: function(options) {\n      options = options || {};\n      var model = this;\n\n      var triggerDestroy = function() {\n        model.trigger(\'destroy\', model, model.collection, options);\n      };\n\n      if (!this.id) {\n        return triggerDestroy();\n      }\n\n      if (!options.wait) {\n        triggerDestroy();\n      }\n\n      var request = Parse._request({\n        route: "classes",\n        className: this.className,\n        objectId: this.id,\n        method: \'DELETE\',\n        useMasterKey: options.useMasterKey\n      });\n      return request.then(function() {\n        if (options.wait) {\n          triggerDestroy();\n        }\n        return model;\n      })._thenRunCallbacks(options, this);\n    },\n\n    /**\n     * Converts a response into the hash of attributes to be set on the model.\n     * @ignore\n     */\n    parse: function(resp, status, xhr) {\n      var output = _.clone(resp);\n      _(["createdAt", "updatedAt"]).each(function(key) {\n        if (output[key]) {\n          output[key] = Parse._parseDate(output[key]);\n        }\n      });\n      if (!output.updatedAt) {\n        output.updatedAt = output.createdAt;\n      }\n      if (status) {\n        this._existed = (status !== 201);\n      }\n      return output;\n    },\n\n    /**\n     * Creates a new model with identical attributes to this one.\n     * @return {Parse.Object}\n     */\n    clone: function() {\n      return new this.constructor(this.attributes);\n    },\n\n    /**\n     * Returns true if this object has never been saved to Parse.\n     * @return {Boolean}\n     */\n    isNew: function() {\n      return !this.id;\n    },\n\n    /**\n     * Call this method to manually fire a `"change"` event for this model and\n     * a `"change:attribute"` event for each changed attribute.\n     * Calling this will cause all objects observing the model to update.\n     */\n    change: function(options) {\n      options = options || {};\n      var changing = this._changing;\n      this._changing = true;\n\n      // Silent changes become pending changes.\n      var self = this;\n      Parse._objectEach(this._silent, function(attr) {\n        self._pending[attr] = true;\n      });\n\n      // Silent changes are triggered.\n      var changes = _.extend({}, options.changes, this._silent);\n      this._silent = {};\n      Parse._objectEach(changes, function(unused_value, attr) {\n        self.trigger(\'change:\' + attr, self, self.get(attr), options);\n      });\n      if (changing) {\n        return this;\n      }\n\n      // This is to get around lint not letting us make a function in a loop.\n      var deleteChanged = function(value, attr) {\n        if (!self._pending[attr] && !self._silent[attr]) {\n          delete self.changed[attr];\n        }\n      };\n\n      // Continue firing `"change"` events while there are pending changes.\n      while (!_.isEmpty(this._pending)) {\n        this._pending = {};\n        this.trigger(\'change\', this, options);\n        // Pending and silent changes still remain.\n        Parse._objectEach(this.changed, deleteChanged);\n        self._previousAttributes = _.clone(this.attributes);\n      }\n\n      this._changing = false;\n      return this;\n    },\n\n    /**\n     * Returns true if this object was created by the Parse server when the\n     * object might have already been there (e.g. in the case of a Facebook\n     * login)\n     */\n    existed: function() {\n      return this._existed;\n    },\n\n    /**\n     * Determine if the model has changed since the last <code>"change"</code>\n     * event.  If you specify an attribute name, determine if that attribute\n     * has changed.\n     * @param {String} attr Optional attribute name\n     * @return {Boolean}\n     */\n    hasChanged: function(attr) {\n      if (!arguments.length) {\n        return !_.isEmpty(this.changed);\n      }\n      return this.changed && _.has(this.changed, attr);\n    },\n\n    /**\n     * Returns an object containing all the attributes that have changed, or\n     * false if there are no changed attributes. Useful for determining what\n     * parts of a view need to be updated and/or what attributes need to be\n     * persisted to the server. Unset attributes will be set to undefined.\n     * You can also pass an attributes object to diff against the model,\n     * determining if there *would be* a change.\n     */\n    changedAttributes: function(diff) {\n      if (!diff) {\n        return this.hasChanged() ? _.clone(this.changed) : false;\n      }\n      var changed = {};\n      var old = this._previousAttributes;\n      Parse._objectEach(diff, function(diffVal, attr) {\n        if (!_.isEqual(old[attr], diffVal)) {\n          changed[attr] = diffVal;\n        }\n      });\n      return changed;\n    },\n\n    /**\n     * Gets the previous value of an attribute, recorded at the time the last\n     * <code>"change"</code> event was fired.\n     * @param {String} attr Name of the attribute to get.\n     */\n    previous: function(attr) {\n      if (!arguments.length || !this._previousAttributes) {\n        return null;\n      }\n      return this._previousAttributes[attr];\n    },\n\n    /**\n     * Gets all of the attributes of the model at the time of the previous\n     * <code>"change"</code> event.\n     * @return {Object}\n     */\n    previousAttributes: function() {\n      return _.clone(this._previousAttributes);\n    },\n\n    /**\n     * Checks if the model is currently in a valid state. It\'s only possible to\n     * get into an *invalid* state if you\'re using silent changes.\n     * @return {Boolean}\n     */\n    isValid: function() {\n      return !this.validate(this.attributes);\n    },\n\n    /**\n     * You should not call this function directly unless you subclass\n     * <code>Parse.Object</code>, in which case you can override this method\n     * to provide additional validation on <code>set</code> and\n     * <code>save</code>.  Your implementation should return\n     *\n     * @param {Object} attrs The current data to validate.\n     * @param {Object} options A Backbone-like options object.\n     * @return {} False if the data is valid.  An error object otherwise.\n     * @see Parse.Object#set\n     */\n    validate: function(attrs, options) {\n      if (_.has(attrs, "ACL") && !(attrs.ACL instanceof Parse.ACL)) {\n        return new Parse.Error(Parse.Error.OTHER_CAUSE,\n                               "ACL must be a Parse.ACL.");\n      }\n      var correct = true;\n      Parse._objectEach(attrs, function(unused_value, key) {\n        if (!(/^[A-Za-z][0-9A-Za-z_]*$/).test(key)) {\n          correct = false;\n        }\n      });\n      if (!correct) {\n        return new Parse.Error(Parse.Error.INVALID_KEY_NAME);\n      }\n      return false;\n    },\n\n    /**\n     * Run validation against a set of incoming attributes, returning `true`\n     * if all is well. If a specific `error` callback has been passed,\n     * call that instead of firing the general `"error"` event.\n     */\n    _validate: function(attrs, options) {\n      if (options.silent || !this.validate) {\n        return true;\n      }\n      attrs = _.extend({}, this.attributes, attrs);\n      var error = this.validate(attrs, options);\n      if (!error) {\n        return true;\n      }\n      if (options && options.error) {\n        options.error(this, error, options);\n      } else {\n        this.trigger(\'error\', this, error, options);\n      }\n      return false;\n    },\n\n    /**\n     * Returns the ACL for this object.\n     * @returns {Parse.ACL} An instance of Parse.ACL.\n     * @see Parse.Object#get\n     */\n    getACL: function() {\n      return this.get("ACL");\n    },\n\n    /**\n     * Sets the ACL to be used for this object.\n     * @param {Parse.ACL} acl An instance of Parse.ACL.\n     * @param {Object} options Optional Backbone-like options object to be\n     *     passed in to set.\n     * @return {Boolean} Whether the set passed validation.\n     * @see Parse.Object#set\n     */\n    setACL: function(acl, options) {\n      return this.set("ACL", acl, options);\n    }\n\n  });\n\n  /**\n   * Returns the appropriate subclass for making new instances of the given\n   * className string.\n   */\n  Parse.Object._getSubclass = function(className) {\n    if (!_.isString(className)) {\n      throw "Parse.Object._getSubclass requires a string argument.";\n    }\n    var ObjectClass = Parse.Object._classMap[className];\n    if (!ObjectClass) {\n      ObjectClass = Parse.Object.extend(className);\n      Parse.Object._classMap[className] = ObjectClass;\n    }\n    return ObjectClass;\n  };\n\n  /**\n   * Creates an instance of a subclass of Parse.Object for the given classname.\n   */\n  Parse.Object._create = function(className, attributes, options) {\n    var ObjectClass = Parse.Object._getSubclass(className);\n    return new ObjectClass(attributes, options);\n  };\n\n  /**\n   * Returns a list of object ids given a list of objects.\n   */\n  Parse.Object._toObjectIdArray = function(list, omitObjectsWithData) {\n    if (list.length === 0) {\n      return Parse.Promise.as(list);\n    }\n\n    var error;\n    var className = list[0].className;\n    var objectIds = [];\n    for (var i = 0; i < list.length; i++) {\n      var object = list[i];\n      if (className !== object.className) {\n        error = new Parse.Error(Parse.Error.INVALID_CLASS_NAME,\n                                "All objects should be of the same class");\n        return Parse.Promise.error(error);\n      } else if (!object.id) {\n        error = new Parse.Error(Parse.Error.MISSING_OBJECT_ID,\n                                "All objects must have an ID");\n        return Parse.Promise.error(error);\n      } else if (omitObjectsWithData && object._hasData) {\n        continue;\n      }\n      objectIds.push(object.id);\n    }\n\n    return Parse.Promise.as(objectIds);\n  };\n\n  /**\n   * Updates a list of objects with fetched results.\n   */\n  Parse.Object._updateWithFetchedResults = function(list, fetched, forceFetch) {\n    var fetchedObjectsById = {};\n    Parse._arrayEach(fetched, function(object, i) {\n      fetchedObjectsById[object.id] = object;\n    });\n\n    for (var i = 0; i < list.length; i++) {\n      var object = list[i];\n      var fetchedObject = fetchedObjectsById[object.id];\n      if (!fetchedObject && forceFetch) {\n        var error = new Parse.Error(Parse.Error.OBJECT_NOT_FOUND,\n                                "All objects must exist on the server");\n        return Parse.Promise.error(error);\n      }\n\n      object._mergeFromObject(fetchedObject);\n    }\n\n    return Parse.Promise.as(list);\n  };\n\n  /**\n   * Fetches the objects given in list.  The forceFetch option will fetch all\n   * objects if true and ignore objects with data if false.\n   */\n  Parse.Object._fetchAll = function(list, forceFetch) {\n    if (list.length === 0) {\n      return Parse.Promise.as(list);\n    }\n\n    var omitObjectsWithData = !forceFetch;\n    return Parse.Object._toObjectIdArray(\n      list,\n      omitObjectsWithData\n    ).then(function(objectIds) {\n      var className = list[0].className;\n      var query = new Parse.Query(className);\n      query.containedIn("objectId", objectIds);\n      query.limit = objectIds.length;\n      return query.find();\n    }).then(function(results) {\n      return Parse.Object._updateWithFetchedResults(\n        list,\n        results,\n        forceFetch\n      );\n    });\n  };\n\n  // Set up a map of className to class so that we can create new instances of\n  // Parse Objects from JSON automatically.\n  Parse.Object._classMap = {};\n\n  Parse.Object._extend = Parse._extend;\n\n  /**\n   * Creates a new subclass of Parse.Object for the given Parse class name.\n   *\n   * <p>Every extension of a Parse class will inherit from the most recent\n   * previous extension of that class. When a Parse.Object is automatically\n   * created by parsing JSON, it will use the most recent extension of that\n   * class.</p>\n   *\n   * <p>You should call either:<pre>\n   *     var MyClass = Parse.Object.extend("MyClass", {\n   *         <i>Instance methods</i>,\n   *         initialize: function(attrs, options) {\n   *             this.someInstanceProperty = [],\n   *             <i>Other instance properties</i>\n   *         }\n   *     }, {\n   *         <i>Class properties</i>\n   *     });</pre>\n   * or, for Backbone compatibility:<pre>\n   *     var MyClass = Parse.Object.extend({\n   *         className: "MyClass",\n   *         <i>Instance methods</i>,\n   *         initialize: function(attrs, options) {\n   *             this.someInstanceProperty = [],\n   *             <i>Other instance properties</i>\n   *         }\n   *     }, {\n   *         <i>Class properties</i>\n   *     });</pre></p>\n   *\n   * @param {String} className The name of the Parse class backing this model.\n   * @param {Object} protoProps Instance properties to add to instances of the\n   *     class returned from this method.\n   * @param {Object} classProps Class properties to add the class returned from\n   *     this method.\n   * @return {Class} A new subclass of Parse.Object.\n   */\n  Parse.Object.extend = function(className, protoProps, classProps) {\n    // Handle the case with only two args.\n    if (!_.isString(className)) {\n      if (className && _.has(className, "className")) {\n        return Parse.Object.extend(className.className, className, protoProps);\n      } else {\n        throw new Error(\n            "Parse.Object.extend\'s first argument should be the className.");\n      }\n    }\n\n    // If someone tries to subclass "User", coerce it to the right type.\n    if (className === "User" && Parse.User._performUserRewrite) {\n      className = "_User";\n    }\n    protoProps = protoProps || {};\n    protoProps.className = className;\n\n    var NewClassObject = null;\n    if (_.has(Parse.Object._classMap, className)) {\n      var OldClassObject = Parse.Object._classMap[className];\n      // This new subclass has been told to extend both from "this" and from\n      // OldClassObject. This is multiple inheritance, which isn\'t supported.\n      // For now, let\'s just pick one.\n      NewClassObject = OldClassObject._extend(protoProps, classProps);\n    } else {\n      NewClassObject = this._extend(protoProps, classProps);\n    }\n    // Extending a subclass should reuse the classname automatically.\n    NewClassObject.extend = function(arg0) {\n      if (_.isString(arg0) || (arg0 && _.has(arg0, "className"))) {\n        return Parse.Object.extend.apply(NewClassObject, arguments);\n      }\n      var newArguments = [className].concat(Parse._.toArray(arguments));\n      return Parse.Object.extend.apply(NewClassObject, newArguments);\n    };\n    Parse.Object._classMap[className] = NewClassObject;\n    return NewClassObject;\n  };\n\n  Parse.Object._findUnsavedChildren = function(object, children, files) {\n    Parse._traverse(object, function(object) {\n      if (object instanceof Parse.Object) {\n        object._refreshCache();\n        if (object.dirty()) {\n          children.push(object);\n        }\n        return;\n      }\n\n      if (object instanceof Parse.File) {\n        if (!object.url()) {\n          files.push(object);\n        }\n        return;\n      }\n    });\n  };\n\n  Parse.Object._canBeSerializedAsValue = function(object) {\n\n    if (object instanceof Parse.Object) {\n      return !!object.id;\n    }\n    if (object instanceof Parse.File) {\n      // Don\'t recurse indefinitely into files.\n      return true;\n    }\n\n    var canBeSerializedAsValue = true;\n\n    if (_.isArray(object)) {\n      Parse._arrayEach(object, function(child) {\n        if (!Parse.Object._canBeSerializedAsValue(child)) {\n          canBeSerializedAsValue = false;\n        }\n      });\n    } else if (_.isObject(object)) {\n      Parse._objectEach(object, function(child) {\n        if (!Parse.Object._canBeSerializedAsValue(child)) {\n          canBeSerializedAsValue = false;\n        }\n      });\n    }\n    return canBeSerializedAsValue;\n  };\n\n  /**\n   * @param {Object} object The root object.\n   * @param {Object} options: The only valid option is useMasterKey.\n   */\n  Parse.Object._deepSaveAsync = function(object, options) {\n    var unsavedChildren = [];\n    var unsavedFiles = [];\n    Parse.Object._findUnsavedChildren(object, unsavedChildren, unsavedFiles);\n\n    var promise = Parse.Promise.as();\n    _.each(unsavedFiles, function(file) {\n      promise = promise.then(function() {\n        return file.save(options);\n      });\n    });\n\n    var objects = _.uniq(unsavedChildren);\n    var remaining = _.uniq(objects);\n\n    return promise.then(function() {\n      return Parse.Promise._continueWhile(function() {\n        return remaining.length > 0;\n      }, function() {\n\n        // Gather up all the objects that can be saved in this batch.\n        var batch = [];\n        var newRemaining = [];\n        Parse._arrayEach(remaining, function(object) {\n          // Limit batches to 20 objects.\n          if (batch.length > 20) {\n            newRemaining.push(object);\n            return;\n          }\n\n          if (object._canBeSerialized()) {\n            batch.push(object);\n          } else {\n            newRemaining.push(object);\n          }\n        });\n        remaining = newRemaining;\n\n        // If we can\'t save any objects, there must be a circular reference.\n        if (batch.length === 0) {\n          return Parse.Promise.error(\n            new Parse.Error(Parse.Error.OTHER_CAUSE,\n                            "Tried to save a batch with a cycle."));\n        }\n\n        // Reserve a spot in every object\'s save queue.\n        var readyToStart = Parse.Promise.when(_.map(batch, function(object) {\n          return object._allPreviousSaves || Parse.Promise.as();\n        }));\n        var batchFinished = new Parse.Promise();\n        Parse._arrayEach(batch, function(object) {\n          object._allPreviousSaves = batchFinished;\n        });\n\n        // Save a single batch, whether previous saves succeeded or failed.\n        return readyToStart._continueWith(function() {\n          return Parse._request({\n            route: "batch",\n            method: "POST",\n            useMasterKey: options.useMasterKey,\n            data: {\n              requests: _.map(batch, function(object) {\n                var json = object._getSaveJSON();\n                var method = "POST";\n\n                var path = "/1/classes/" + object.className;\n                if (object.id) {\n                  path = path + "/" + object.id;\n                  method = "PUT";\n                }\n\n                object._startSave();\n\n                return {\n                  method: method,\n                  path: path,\n                  body: json\n                };\n              })\n            }\n          }).then(function(response, status, xhr) {\n            var error;\n            Parse._arrayEach(batch, function(object, i) {\n              if (response[i].success) {\n                object._finishSave(\n                  object.parse(response[i].success, status, xhr));\n              } else {\n                error = error || response[i].error;\n                object._cancelSave();\n              }\n            });\n            if (error) {\n              return Parse.Promise.error(\n                new Parse.Error(error.code, error.error));\n            }\n\n          }).then(function(results) {\n            batchFinished.resolve(results);\n            return results;\n          }, function(error) {\n            batchFinished.reject(error);\n            return Parse.Promise.error(error);\n          });\n        });\n      });\n    }).then(function() {\n      return object;\n    });\n  };\n\n}(this));\n\n(function(root) {\n  root.Parse = root.Parse || {};\n  var Parse = root.Parse;\n  var _ = Parse._;\n\n  /**\n   * Represents a Role on the Parse server. Roles represent groupings of\n   * Users for the purposes of granting permissions (e.g. specifying an ACL\n   * for an Object). Roles are specified by their sets of child users and\n   * child roles, all of which are granted any permissions that the parent\n   * role has.\n   *\n   * <p>Roles must have a name (which cannot be changed after creation of the\n   * role), and must specify an ACL.</p>\n   * @class\n   * A Parse.Role is a local representation of a role persisted to the Parse\n   * cloud.\n   */\n  Parse.Role = Parse.Object.extend("_Role", /** @lends Parse.Role.prototype */ {\n    // Instance Methods\n\n    /**\n     * Constructs a new ParseRole with the given name and ACL.\n     *\n     * @param {String} name The name of the Role to create.\n     * @param {Parse.ACL} acl The ACL for this role. Roles must have an ACL.\n     */\n    constructor: function(name, acl) {\n      if (_.isString(name) && (acl instanceof Parse.ACL)) {\n        Parse.Object.prototype.constructor.call(this, null, null);\n        this.setName(name);\n        this.setACL(acl);\n      } else {\n        Parse.Object.prototype.constructor.call(this, name, acl);\n      }\n    },\n\n    /**\n     * Gets the name of the role.  You can alternatively call role.get("name")\n     *\n     * @return {String} the name of the role.\n     */\n    getName: function() {\n      return this.get("name");\n    },\n\n    /**\n     * Sets the name for a role. This value must be set before the role has\n     * been saved to the server, and cannot be set once the role has been\n     * saved.\n     *\n     * <p>\n     *   A role\'s name can only contain alphanumeric characters, _, -, and\n     *   spaces.\n     * </p>\n     *\n     * <p>This is equivalent to calling role.set("name", name)</p>\n     *\n     * @param {String} name The name of the role.\n     * @param {Object} options Standard options object with success and error\n     *     callbacks.\n     */\n    setName: function(name, options) {\n      return this.set("name", name, options);\n    },\n\n    /**\n     * Gets the Parse.Relation for the Parse.Users that are direct\n     * children of this role. These users are granted any privileges that this\n     * role has been granted (e.g. read or write access through ACLs). You can\n     * add or remove users from the role through this relation.\n     *\n     * <p>This is equivalent to calling role.relation("users")</p>\n     *\n     * @return {Parse.Relation} the relation for the users belonging to this\n     *     role.\n     */\n    getUsers: function() {\n      return this.relation("users");\n    },\n\n    /**\n     * Gets the Parse.Relation for the Parse.Roles that are direct\n     * children of this role. These roles\' users are granted any privileges that\n     * this role has been granted (e.g. read or write access through ACLs). You\n     * can add or remove child roles from this role through this relation.\n     *\n     * <p>This is equivalent to calling role.relation("roles")</p>\n     *\n     * @return {Parse.Relation} the relation for the roles belonging to this\n     *     role.\n     */\n    getRoles: function() {\n      return this.relation("roles");\n    },\n\n    /**\n     * @ignore\n     */\n    validate: function(attrs, options) {\n      if ("name" in attrs && attrs.name !== this.getName()) {\n        var newName = attrs.name;\n        if (this.id && this.id !== attrs.objectId) {\n          // Check to see if the objectId being set matches this.id.\n          // This happens during a fetch -- the id is set before calling fetch.\n          // Let the name be set in this case.\n          return new Parse.Error(Parse.Error.OTHER_CAUSE,\n              "A role\'s name can only be set before it has been saved.");\n        }\n        if (!_.isString(newName)) {\n          return new Parse.Error(Parse.Error.OTHER_CAUSE,\n              "A role\'s name must be a String.");\n        }\n        if (!(/^[0-9a-zA-Z\\-_ ]+$/).test(newName)) {\n          return new Parse.Error(Parse.Error.OTHER_CAUSE,\n              "A role\'s name can only contain alphanumeric characters, _," +\n              " -, and spaces.");\n        }\n      }\n      if (Parse.Object.prototype.validate) {\n        return Parse.Object.prototype.validate.call(this, attrs, options);\n      }\n      return false;\n    }\n  });\n}(this));\n\n\n/*global _: false */\n(function(root) {\n  root.Parse = root.Parse || {};\n  var Parse = root.Parse;\n  var _ = Parse._;\n\n  /**\n   * Creates a new instance with the given models and options.  Typically, you\n   * will not call this method directly, but will instead make a subclass using\n   * <code>Parse.Collection.extend</code>.\n   *\n   * @param {Array} models An array of instances of <code>Parse.Object</code>.\n   *\n   * @param {Object} options An optional object with Backbone-style options.\n   * Valid options are:<ul>\n   *   <li>model: The Parse.Object subclass that this collection contains.\n   *   <li>query: An instance of Parse.Query to use when fetching items.\n   *   <li>comparator: A string property name or function to sort by.\n   * </ul>\n   *\n   * @see Parse.Collection.extend\n   *\n   * @class\n   *\n   * <p>Provides a standard collection class for our sets of models, ordered\n   * or unordered.  For more information, see the\n   * <a href="http://documentcloud.github.com/backbone/#Collection">Backbone\n   * documentation</a>.</p>\n   */\n  Parse.Collection = function(models, options) {\n    options = options || {};\n    if (options.comparator) {\n      this.comparator = options.comparator;\n    }\n    if (options.model) {\n      this.model = options.model;\n    }\n    if (options.query) {\n      this.query = options.query;\n    }\n    this._reset();\n    this.initialize.apply(this, arguments);\n    if (models) {\n      this.reset(models, {silent: true, parse: options.parse});\n    }\n  };\n\n  // Define the Collection\'s inheritable methods.\n  _.extend(Parse.Collection.prototype, Parse.Events,\n      /** @lends Parse.Collection.prototype */ {\n\n    // The default model for a collection is just a Parse.Object.\n    // This should be overridden in most cases.\n\n    model: Parse.Object,\n\n    /**\n     * Initialize is an empty function by default. Override it with your own\n     * initialization logic.\n     */\n    initialize: function(){},\n\n    /**\n     * The JSON representation of a Collection is an array of the\n     * models\' attributes.\n     */\n    toJSON: function() {\n      return this.map(function(model){ return model.toJSON(); });\n    },\n\n    /**\n     * Add a model, or list of models to the set. Pass **silent** to avoid\n     * firing the `add` event for every new model.\n     *\n     * @param {Array} models An array of instances of <code>Parse.Object</code>.\n     *\n     * @param {Object} options An optional object with Backbone-style options.\n     * Valid options are:<ul>\n     *   <li>at: The index at which to add the models.\n     *   <li>silent: Set to true to avoid firing the `add` event for every new\n     *   model.\n     * </ul>\n     */\n    add: function(models, options) {\n      var i, index, length, model, cid, id, cids = {}, ids = {};\n      options = options || {};\n      models = _.isArray(models) ? models.slice() : [models];\n\n      // Begin by turning bare objects into model references, and preventing\n      // invalid models or duplicate models from being added.\n      for (i = 0, length = models.length; i < length; i++) {\n        models[i] = this._prepareModel(models[i], options);\n        model = models[i];\n        if (!model) {\n          throw new Error("Can\'t add an invalid model to a collection");\n        }\n        cid = model.cid;\n        if (cids[cid] || this._byCid[cid]) {\n          throw new Error("Duplicate cid: can\'t add the same model " +\n                          "to a collection twice");\n        }\n        id = model.id;\n        if (!Parse._isNullOrUndefined(id) && (ids[id] || this._byId[id])) {\n          throw new Error("Duplicate id: can\'t add the same model " +\n                          "to a collection twice");\n        }\n        ids[id] = model;\n        cids[cid] = model;\n      }\n\n      // Listen to added models\' events, and index models for lookup by\n      // `id` and by `cid`.\n      for (i = 0; i < length; i++) {\n        (model = models[i]).on(\'all\', this._onModelEvent, this);\n        this._byCid[model.cid] = model;\n        if (model.id) {\n          this._byId[model.id] = model;\n        }\n      }\n\n      // Insert models into the collection, re-sorting if needed, and triggering\n      // `add` events unless silenced.\n      this.length += length;\n      index = Parse._isNullOrUndefined(options.at) ?\n          this.models.length : options.at;\n      this.models.splice.apply(this.models, [index, 0].concat(models));\n      if (this.comparator) {\n        this.sort({silent: true});\n      }\n      if (options.silent) {\n        return this;\n      }\n      for (i = 0, length = this.models.length; i < length; i++) {\n        model = this.models[i];\n        if (cids[model.cid]) {\n          options.index = i;\n          model.trigger(\'add\', model, this, options);\n        }\n      }\n      return this;\n    },\n\n    /**\n     * Remove a model, or a list of models from the set. Pass silent to avoid\n     * firing the <code>remove</code> event for every model removed.\n     *\n     * @param {Array} models The model or list of models to remove from the\n     *   collection.\n     * @param {Object} options An optional object with Backbone-style options.\n     * Valid options are: <ul>\n     *   <li>silent: Set to true to avoid firing the `remove` event.\n     * </ul>\n     */\n    remove: function(models, options) {\n      var i, l, index, model;\n      options = options || {};\n      models = _.isArray(models) ? models.slice() : [models];\n      for (i = 0, l = models.length; i < l; i++) {\n        model = this.getByCid(models[i]) || this.get(models[i]);\n        if (!model) {\n          continue;\n        }\n        delete this._byId[model.id];\n        delete this._byCid[model.cid];\n        index = this.indexOf(model);\n        this.models.splice(index, 1);\n        this.length--;\n        if (!options.silent) {\n          options.index = index;\n          model.trigger(\'remove\', model, this, options);\n        }\n        this._removeReference(model);\n      }\n      return this;\n    },\n\n    /**\n     * Gets a model from the set by id.\n     * @param {String} id The Parse objectId identifying the Parse.Object to\n     * fetch from this collection.\n     */\n    get: function(id) {\n      return id && this._byId[id.id || id];\n    },\n\n    /**\n     * Gets a model from the set by client id.\n     * @param {} cid The Backbone collection id identifying the Parse.Object to\n     * fetch from this collection.\n     */\n    getByCid: function(cid) {\n      return cid && this._byCid[cid.cid || cid];\n    },\n\n    /**\n     * Gets the model at the given index.\n     *\n     * @param {Number} index The index of the model to return.\n     */\n    at: function(index) {\n      return this.models[index];\n    },\n\n    /**\n     * Forces the collection to re-sort itself. You don\'t need to call this\n     * under normal circumstances, as the set will maintain sort order as each\n     * item is added.\n     * @param {Object} options An optional object with Backbone-style options.\n     * Valid options are: <ul>\n     *   <li>silent: Set to true to avoid firing the `reset` event.\n     * </ul>\n     */\n    sort: function(options) {\n      options = options || {};\n      if (!this.comparator) {\n        throw new Error(\'Cannot sort a set without a comparator\');\n      }\n      var boundComparator = _.bind(this.comparator, this);\n      if (this.comparator.length === 1) {\n        this.models = this.sortBy(boundComparator);\n      } else {\n        this.models.sort(boundComparator);\n      }\n      if (!options.silent) {\n        this.trigger(\'reset\', this, options);\n      }\n      return this;\n    },\n\n    /**\n     * Plucks an attribute from each model in the collection.\n     * @param {String} attr The attribute to return from each model in the\n     * collection.\n     */\n    pluck: function(attr) {\n      return _.map(this.models, function(model){ return model.get(attr); });\n    },\n\n    /**\n     * When you have more items than you want to add or remove individually,\n     * you can reset the entire set with a new list of models, without firing\n     * any `add` or `remove` events. Fires `reset` when finished.\n     *\n     * @param {Array} models The model or list of models to remove from the\n     *   collection.\n     * @param {Object} options An optional object with Backbone-style options.\n     * Valid options are: <ul>\n     *   <li>silent: Set to true to avoid firing the `reset` event.\n     * </ul>\n     */\n    reset: function(models, options) {\n      var self = this;\n      models = models || [];\n      options = options || {};\n      Parse._arrayEach(this.models, function(model) {\n        self._removeReference(model);\n      });\n      this._reset();\n      this.add(models, {silent: true, parse: options.parse});\n      if (!options.silent) {\n        this.trigger(\'reset\', this, options);\n      }\n      return this;\n    },\n\n    /**\n     * Fetches the default set of models for this collection, resetting the\n     * collection when they arrive. If `add: true` is passed, appends the\n     * models to the collection instead of resetting.\n     *\n     * @param {Object} options An optional object with Backbone-style options.\n     * Valid options are:<ul>\n     *   <li>silent: Set to true to avoid firing `add` or `reset` events for\n     *   models fetched by this fetch.\n     *   <li>success: A Backbone-style success callback.\n     *   <li>error: An Backbone-style error callback.\n     *   <li>useMasterKey: In Cloud Code and Node only, uses the Master Key for\n     *       this request.\n     * </ul>\n     */\n    fetch: function(options) {\n      options = _.clone(options) || {};\n      if (options.parse === undefined) {\n        options.parse = true;\n      }\n      var collection = this;\n      var query = this.query || new Parse.Query(this.model);\n      return query.find({\n        useMasterKey: options.useMasterKey\n      }).then(function(results) {\n        if (options.add) {\n          collection.add(results, options);\n        } else {\n          collection.reset(results, options);\n        }\n        return collection;\n      })._thenRunCallbacks(options, this);\n    },\n\n    /**\n     * Creates a new instance of a model in this collection. Add the model to\n     * the collection immediately, unless `wait: true` is passed, in which case\n     * we wait for the server to agree.\n     *\n     * @param {Parse.Object} model The new model to create and add to the\n     *   collection.\n     * @param {Object} options An optional object with Backbone-style options.\n     * Valid options are:<ul>\n     *   <li>wait: Set to true to wait for the server to confirm creation of the\n     *       model before adding it to the collection.\n     *   <li>silent: Set to true to avoid firing an `add` event.\n     *   <li>success: A Backbone-style success callback.\n     *   <li>error: An Backbone-style error callback.\n     *   <li>useMasterKey: In Cloud Code and Node only, uses the Master Key for\n     *       this request.\n     * </ul>\n     */\n    create: function(model, options) {\n      var coll = this;\n      options = options ? _.clone(options) : {};\n      model = this._prepareModel(model, options);\n      if (!model) {\n        return false;\n      }\n      if (!options.wait) {\n        coll.add(model, options);\n      }\n      var success = options.success;\n      options.success = function(nextModel, resp, xhr) {\n        if (options.wait) {\n          coll.add(nextModel, options);\n        }\n        if (success) {\n          success(nextModel, resp);\n        } else {\n          nextModel.trigger(\'sync\', model, resp, options);\n        }\n      };\n      model.save(null, options);\n      return model;\n    },\n\n    /**\n     * Converts a response into a list of models to be added to the collection.\n     * The default implementation is just to pass it through.\n     * @ignore\n     */\n    parse: function(resp, xhr) {\n      return resp;\n    },\n\n    /**\n     * Proxy to _\'s chain. Can\'t be proxied the same way the rest of the\n     * underscore methods are proxied because it relies on the underscore\n     * constructor.\n     */\n    chain: function() {\n      return _(this.models).chain();\n    },\n\n    /**\n     * Reset all internal state. Called when the collection is reset.\n     */\n    _reset: function(options) {\n      this.length = 0;\n      this.models = [];\n      this._byId  = {};\n      this._byCid = {};\n    },\n\n    /**\n     * Prepare a model or hash of attributes to be added to this collection.\n     */\n    _prepareModel: function(model, options) {\n      if (!(model instanceof Parse.Object)) {\n        var attrs = model;\n        options.collection = this;\n        model = new this.model(attrs, options);\n        if (!model._validate(model.attributes, options)) {\n          model = false;\n        }\n      } else if (!model.collection) {\n        model.collection = this;\n      }\n      return model;\n    },\n\n    /**\n     * Internal method to remove a model\'s ties to a collection.\n     */\n    _removeReference: function(model) {\n      if (this === model.collection) {\n        delete model.collection;\n      }\n      model.off(\'all\', this._onModelEvent, this);\n    },\n\n    /**\n     * Internal method called every time a model in the set fires an event.\n     * Sets need to update their indexes when models change ids. All other\n     * events simply proxy through. "add" and "remove" events that originate\n     * in other collections are ignored.\n     */\n    _onModelEvent: function(ev, model, collection, options) {\n      if ((ev === \'add\' || ev === \'remove\') && collection !== this) {\n        return;\n      }\n      if (ev === \'destroy\') {\n        this.remove(model, options);\n      }\n      if (model && ev === \'change:objectId\') {\n        delete this._byId[model.previous("objectId")];\n        this._byId[model.id] = model;\n      }\n      this.trigger.apply(this, arguments);\n    }\n\n  });\n\n  // Underscore methods that we want to implement on the Collection.\n  var methods = [\'forEach\', \'each\', \'map\', \'reduce\', \'reduceRight\', \'find\',\n    \'detect\', \'filter\', \'select\', \'reject\', \'every\', \'all\', \'some\', \'any\',\n    \'include\', \'contains\', \'invoke\', \'max\', \'min\', \'sortBy\', \'sortedIndex\',\n    \'toArray\', \'size\', \'first\', \'initial\', \'rest\', \'last\', \'without\', \'indexOf\',\n    \'shuffle\', \'lastIndexOf\', \'isEmpty\', \'groupBy\'];\n\n  // Mix in each Underscore method as a proxy to `Collection#models`.\n  Parse._arrayEach(methods, function(method) {\n    Parse.Collection.prototype[method] = function() {\n      return _[method].apply(_, [this.models].concat(_.toArray(arguments)));\n    };\n  });\n\n  /**\n   * Creates a new subclass of <code>Parse.Collection</code>.  For example,<pre>\n   *   var MyCollection = Parse.Collection.extend({\n   *     // Instance properties\n   *\n   *     model: MyClass,\n   *     query: MyQuery,\n   *\n   *     getFirst: function() {\n   *       return this.at(0);\n   *     }\n   *   }, {\n   *     // Class properties\n   *\n   *     makeOne: function() {\n   *       return new MyCollection();\n   *     }\n   *   });\n   *\n   *   var collection = new MyCollection();\n   * </pre>\n   *\n   * @function\n   * @param {Object} instanceProps Instance properties for the collection.\n   * @param {Object} classProps Class properies for the collection.\n   * @return {Class} A new subclass of <code>Parse.Collection</code>.\n   */\n  Parse.Collection.extend = Parse._extend;\n\n}(this));\n\n/*global _: false, document: false */\n(function(root) {\n  root.Parse = root.Parse || {};\n  var Parse = root.Parse;\n  var _ = Parse._;\n\n  /**\n   * Creating a Parse.View creates its initial element outside of the DOM,\n   * if an existing element is not provided...\n   * @class\n   *\n   * <p>A fork of Backbone.View, provided for your convenience.  If you use this\n   * class, you must also include jQuery, or another library that provides a\n   * jQuery-compatible $ function.  For more information, see the\n   * <a href="http://documentcloud.github.com/backbone/#View">Backbone\n   * documentation</a>.</p>\n   * <p><strong><em>Available in the client SDK only.</em></strong></p>\n   */\n  Parse.View = function(options) {\n    this.cid = _.uniqueId(\'view\');\n    this._configure(options || {});\n    this._ensureElement();\n    this.initialize.apply(this, arguments);\n    this.delegateEvents();\n  };\n\n  // Cached regex to split keys for `delegate`.\n  var eventSplitter = /^(\\S+)\\s*(.*)$/;\n\n  // List of view options to be merged as properties.\n\n  var viewOptions = [\'model\', \'collection\', \'el\', \'id\', \'attributes\',\n                     \'className\', \'tagName\'];\n\n  // Set up all inheritable **Parse.View** properties and methods.\n  _.extend(Parse.View.prototype, Parse.Events,\n           /** @lends Parse.View.prototype */ {\n\n    // The default `tagName` of a View\'s element is `"div"`.\n    tagName: \'div\',\n\n    /**\n     * jQuery delegate for element lookup, scoped to DOM elements within the\n     * current view. This should be prefered to global lookups where possible.\n     */\n    $: function(selector) {\n      return this.$el.find(selector);\n    },\n\n    /**\n     * Initialize is an empty function by default. Override it with your own\n     * initialization logic.\n     */\n    initialize: function(){},\n\n    /**\n     * The core function that your view should override, in order\n     * to populate its element (`this.el`), with the appropriate HTML. The\n     * convention is for **render** to always return `this`.\n     */\n    render: function() {\n      return this;\n    },\n\n    /**\n     * Remove this view from the DOM. Note that the view isn\'t present in the\n     * DOM by default, so calling this method may be a no-op.\n     */\n    remove: function() {\n      this.$el.remove();\n      return this;\n    },\n\n    /**\n     * For small amounts of DOM Elements, where a full-blown template isn\'t\n     * needed, use **make** to manufacture elements, one at a time.\n     * <pre>\n     *     var el = this.make(\'li\', {\'class\': \'row\'},\n     *                        this.model.escape(\'title\'));</pre>\n     */\n    make: function(tagName, attributes, content) {\n      var el = document.createElement(tagName);\n      if (attributes) {\n        Parse.$(el).attr(attributes);\n      }\n      if (content) {\n        Parse.$(el).html(content);\n      }\n      return el;\n    },\n\n    /**\n     * Changes the view\'s element (`this.el` property), including event\n     * re-delegation.\n     */\n    setElement: function(element, delegate) {\n      this.$el = Parse.$(element);\n      this.el = this.$el[0];\n      if (delegate !== false) {\n        this.delegateEvents();\n      }\n      return this;\n    },\n\n    /**\n     * Set callbacks.  <code>this.events</code> is a hash of\n     * <pre>\n     * *{"event selector": "callback"}*\n     *\n     *     {\n     *       \'mousedown .title\':  \'edit\',\n     *       \'click .button\':     \'save\'\n     *       \'click .open\':       function(e) { ... }\n     *     }\n     * </pre>\n     * pairs. Callbacks will be bound to the view, with `this` set properly.\n     * Uses event delegation for efficiency.\n     * Omitting the selector binds the event to `this.el`.\n     * This only works for delegate-able events: not `focus`, `blur`, and\n     * not `change`, `submit`, and `reset` in Internet Explorer.\n     */\n    delegateEvents: function(events) {\n      events = events || Parse._getValue(this, \'events\');\n      if (!events) {\n        return;\n      }\n      this.undelegateEvents();\n      var self = this;\n      Parse._objectEach(events, function(method, key) {\n        if (!_.isFunction(method)) {\n          method = self[events[key]];\n        }\n        if (!method) {\n          throw new Error(\'Event "\' + events[key] + \'" does not exist\');\n        }\n        var match = key.match(eventSplitter);\n        var eventName = match[1], selector = match[2];\n        method = _.bind(method, self);\n        eventName += \'.delegateEvents\' + self.cid;\n        if (selector === \'\') {\n          self.$el.bind(eventName, method);\n        } else {\n          self.$el.delegate(selector, eventName, method);\n        }\n      });\n    },\n\n    /**\n     * Clears all callbacks previously bound to the view with `delegateEvents`.\n     * You usually don\'t need to use this, but may wish to if you have multiple\n     * Backbone views attached to the same DOM element.\n     */\n    undelegateEvents: function() {\n      this.$el.unbind(\'.delegateEvents\' + this.cid);\n    },\n\n    /**\n     * Performs the initial configuration of a View with a set of options.\n     * Keys with special meaning *(model, collection, id, className)*, are\n     * attached directly to the view.\n     */\n    _configure: function(options) {\n      if (this.options) {\n        options = _.extend({}, this.options, options);\n      }\n      var self = this;\n      _.each(viewOptions, function(attr) {\n        if (options[attr]) {\n          self[attr] = options[attr];\n        }\n      });\n      this.options = options;\n    },\n\n    /**\n     * Ensure that the View has a DOM element to render into.\n     * If `this.el` is a string, pass it through `$()`, take the first\n     * matching element, and re-assign it to `el`. Otherwise, create\n     * an element from the `id`, `className` and `tagName` properties.\n     */\n    _ensureElement: function() {\n      if (!this.el) {\n        var attrs = Parse._getValue(this, \'attributes\') || {};\n        if (this.id) {\n          attrs.id = this.id;\n        }\n        if (this.className) {\n          attrs[\'class\'] = this.className;\n        }\n        this.setElement(this.make(this.tagName, attrs), false);\n      } else {\n        this.setElement(this.el, false);\n      }\n    }\n\n  });\n\n  /**\n   * @function\n   * @param {Object} instanceProps Instance properties for the view.\n   * @param {Object} classProps Class properies for the view.\n   * @return {Class} A new subclass of <code>Parse.View</code>.\n   */\n  Parse.View.extend = Parse._extend;\n\n}(this));\n\n(function(root) {\n  root.Parse = root.Parse || {};\n  var Parse = root.Parse;\n  var _ = Parse._;\n\n  /**\n   * @class\n   *\n   * <p>A Parse.User object is a local representation of a user persisted to the\n   * Parse cloud. This class is a subclass of a Parse.Object, and retains the\n   * same functionality of a Parse.Object, but also extends it with various\n   * user specific methods, like authentication, signing up, and validation of\n   * uniqueness.</p>\n   */\n  Parse.User = Parse.Object.extend("_User", /** @lends Parse.User.prototype */ {\n    // Instance Variables\n    _isCurrentUser: false,\n\n\n    // Instance Methods\n\n    /**\n     * Merges another object\'s attributes into this object.\n     */\n    _mergeFromObject: function(other) {\n      if (other.getSessionToken()) {\n        this._sessionToken = other.getSessionToken();\n      }\n      Parse.User.__super__._mergeFromObject.call(this, other);\n    },\n\n    /**\n     * Internal method to handle special fields in a _User response.\n     */\n    _mergeMagicFields: function(attrs) {\n      if (attrs.sessionToken) {\n        this._sessionToken = attrs.sessionToken;\n        delete attrs.sessionToken;\n      }\n      Parse.User.__super__._mergeMagicFields.call(this, attrs);\n    },\n\n    /**\n     * Removes null values from authData (which exist temporarily for\n     * unlinking)\n     */\n    _cleanupAuthData: function() {\n      if (!this.isCurrent()) {\n        return;\n      }\n      var authData = this.get(\'authData\');\n      if (!authData) {\n        return;\n      }\n      Parse._objectEach(this.get(\'authData\'), function(value, key) {\n        if (!authData[key]) {\n          delete authData[key];\n        }\n      });\n    },\n\n    /**\n     * Synchronizes authData for all providers.\n     */\n    _synchronizeAllAuthData: function() {\n      var authData = this.get(\'authData\');\n      if (!authData) {\n        return;\n      }\n\n      var self = this;\n      Parse._objectEach(this.get(\'authData\'), function(value, key) {\n        self._synchronizeAuthData(key);\n      });\n    },\n\n    /**\n     * Synchronizes auth data for a provider (e.g. puts the access token in the\n     * right place to be used by the Facebook SDK).\n     */\n    _synchronizeAuthData: function(provider) {\n      if (!this.isCurrent()) {\n        return;\n      }\n      var authType;\n      if (_.isString(provider)) {\n        authType = provider;\n        provider = Parse.User._authProviders[authType];\n      } else {\n        authType = provider.getAuthType();\n      }\n      var authData = this.get(\'authData\');\n      if (!authData || !provider) {\n        return;\n      }\n      var success = provider.restoreAuthentication(authData[authType]);\n      if (!success) {\n        this._unlinkFrom(provider);\n      }\n    },\n\n    _handleSaveResult: function(makeCurrent) {\n      // Clean up and synchronize the authData object, removing any unset values\n      if (makeCurrent) {\n        this._isCurrentUser = true;\n      }\n      this._cleanupAuthData();\n      this._synchronizeAllAuthData();\n      // Don\'t keep the password around.\n      delete this._serverData.password;\n      this._rebuildEstimatedDataForKey("password");\n      this._refreshCache();\n      if (makeCurrent || this.isCurrent()) {\n        Parse.User._saveCurrentUser(this);\n      }\n    },\n\n    /**\n     * Unlike in the Android/iOS SDKs, logInWith is unnecessary, since you can\n     * call linkWith on the user (even if it doesn\'t exist yet on the server).\n     */\n    _linkWith: function(provider, options) {\n      var authType;\n      if (_.isString(provider)) {\n        authType = provider;\n        provider = Parse.User._authProviders[provider];\n      } else {\n        authType = provider.getAuthType();\n      }\n      if (_.has(options, \'authData\')) {\n        var authData = this.get(\'authData\') || {};\n        authData[authType] = options.authData;\n        this.set(\'authData\', authData);\n\n        // Overridden so that the user can be made the current user.\n        var newOptions = _.clone(options) || {};\n        newOptions.success = function(model) {\n          model._handleSaveResult(true);\n          if (options.success) {\n            options.success.apply(this, arguments);\n          }\n        };\n        return this.save({\'authData\': authData}, newOptions);\n      } else {\n        var self = this;\n        var promise = new Parse.Promise();\n        provider.authenticate({\n          success: function(provider, result) {\n            self._linkWith(provider, {\n              authData: result,\n              success: options.success,\n              error: options.error\n            }).then(function() {\n              promise.resolve(self);\n            });\n          },\n          error: function(provider, error) {\n            if (options.error) {\n              options.error(self, error);\n            }\n            promise.reject(error);\n          }\n        });\n        return promise;\n      }\n    },\n\n    /**\n     * Unlinks a user from a service.\n     */\n    _unlinkFrom: function(provider, options) {\n      var authType;\n      if (_.isString(provider)) {\n        authType = provider;\n        provider = Parse.User._authProviders[provider];\n      } else {\n        authType = provider.getAuthType();\n      }\n      var newOptions = _.clone(options);\n      var self = this;\n      newOptions.authData = null;\n      newOptions.success = function(model) {\n        self._synchronizeAuthData(provider);\n        if (options.success) {\n          options.success.apply(this, arguments);\n        }\n      };\n      return this._linkWith(provider, newOptions);\n    },\n\n    /**\n     * Checks whether a user is linked to a service.\n     */\n    _isLinked: function(provider) {\n      var authType;\n      if (_.isString(provider)) {\n        authType = provider;\n      } else {\n        authType = provider.getAuthType();\n      }\n      var authData = this.get(\'authData\') || {};\n      return !!authData[authType];\n    },\n\n    /**\n     * Deauthenticates all providers.\n     */\n    _logOutWithAll: function() {\n      var authData = this.get(\'authData\');\n      if (!authData) {\n        return;\n      }\n      var self = this;\n      Parse._objectEach(this.get(\'authData\'), function(value, key) {\n        self._logOutWith(key);\n      });\n    },\n\n    /**\n     * Deauthenticates a single provider (e.g. removing access tokens from the\n     * Facebook SDK).\n     */\n    _logOutWith: function(provider) {\n      if (!this.isCurrent()) {\n        return;\n      }\n      if (_.isString(provider)) {\n        provider = Parse.User._authProviders[provider];\n      }\n      if (provider && provider.deauthenticate) {\n        provider.deauthenticate();\n      }\n    },\n\n    /**\n     * Signs up a new user. You should call this instead of save for\n     * new Parse.Users. This will create a new Parse.User on the server, and\n     * also persist the session on disk so that you can access the user using\n     * <code>current</code>.\n     *\n     * <p>A username and password must be set before calling signUp.</p>\n     *\n     * <p>Calls options.success or options.error on completion.</p>\n     *\n     * @param {Object} attrs Extra fields to set on the new user, or null.\n     * @param {Object} options A Backbone-style options object.\n     * @return {Parse.Promise} A promise that is fulfilled when the signup\n     *     finishes.\n     * @see Parse.User.signUp\n     */\n    signUp: function(attrs, options) {\n      var error;\n      options = options || {};\n\n      var username = (attrs && attrs.username) || this.get("username");\n      if (!username || (username === "")) {\n        error = new Parse.Error(\n            Parse.Error.OTHER_CAUSE,\n            "Cannot sign up user with an empty name.");\n        if (options && options.error) {\n          options.error(this, error);\n        }\n        return Parse.Promise.error(error);\n      }\n\n      var password = (attrs && attrs.password) || this.get("password");\n      if (!password || (password === "")) {\n        error = new Parse.Error(\n            Parse.Error.OTHER_CAUSE,\n            "Cannot sign up user with an empty password.");\n        if (options && options.error) {\n          options.error(this, error);\n        }\n        return Parse.Promise.error(error);\n      }\n\n      // Overridden so that the user can be made the current user.\n      var newOptions = _.clone(options);\n      newOptions.success = function(model) {\n        model._handleSaveResult(true);\n        if (options.success) {\n          options.success.apply(this, arguments);\n        }\n      };\n      return this.save(attrs, newOptions);\n    },\n\n    /**\n     * Logs in a Parse.User. On success, this saves the session to localStorage,\n     * so you can retrieve the currently logged in user using\n     * <code>current</code>.\n     *\n     * <p>A username and password must be set before calling logIn.</p>\n     *\n     * <p>Calls options.success or options.error on completion.</p>\n     *\n     * @param {Object} options A Backbone-style options object.\n     * @see Parse.User.logIn\n     * @return {Parse.Promise} A promise that is fulfilled with the user when\n     *     the login is complete.\n     */\n    logIn: function(options) {\n      var model = this;\n      options = options || {};\n      var request = Parse._request({\n        route: "login",\n        method: "GET",\n        useMasterKey: options.useMasterKey,\n        data: this.toJSON()\n      });\n      return request.then(function(resp, status, xhr) {\n        var serverAttrs = model.parse(resp, status, xhr);\n        model._finishFetch(serverAttrs);\n        model._handleSaveResult(true);\n        return model;\n      })._thenRunCallbacks(options, this);\n    },\n\n    /**\n     * @see Parse.Object#save\n     */\n    save: function(arg1, arg2, arg3) {\n      var i, attrs, current, options, saved;\n      if (_.isObject(arg1) || _.isNull(arg1) || _.isUndefined(arg1)) {\n        attrs = arg1;\n        options = arg2;\n      } else {\n        attrs = {};\n        attrs[arg1] = arg2;\n        options = arg3;\n      }\n      options = options || {};\n\n      var newOptions = _.clone(options);\n      newOptions.success = function(model) {\n        model._handleSaveResult(false);\n        if (options.success) {\n          options.success.apply(this, arguments);\n        }\n      };\n      return Parse.Object.prototype.save.call(this, attrs, newOptions);\n    },\n\n    /**\n     * @see Parse.Object#fetch\n     */\n    fetch: function(options) {\n      var newOptions = options ? _.clone(options) : {};\n      newOptions.success = function(model) {\n        model._handleSaveResult(false);\n        if (options && options.success) {\n          options.success.apply(this, arguments);\n        }\n      };\n      return Parse.Object.prototype.fetch.call(this, newOptions);\n    },\n\n    /**\n     * Returns true if <code>current</code> would return this user.\n     * @see Parse.User#current\n     */\n    isCurrent: function() {\n      return this._isCurrentUser;\n    },\n\n    /**\n     * Returns get("username").\n     * @return {String}\n     * @see Parse.Object#get\n     */\n    getUsername: function() {\n      return this.get("username");\n    },\n\n    /**\n     * Calls set("username", username, options) and returns the result.\n     * @param {String} username\n     * @param {Object} options A Backbone-style options object.\n     * @return {Boolean}\n     * @see Parse.Object.set\n     */\n    setUsername: function(username, options) {\n      return this.set("username", username, options);\n    },\n\n    /**\n     * Calls set("password", password, options) and returns the result.\n     * @param {String} password\n     * @param {Object} options A Backbone-style options object.\n     * @return {Boolean}\n     * @see Parse.Object.set\n     */\n    setPassword: function(password, options) {\n      return this.set("password", password, options);\n    },\n\n    /**\n     * Returns get("email").\n     * @return {String}\n     * @see Parse.Object#get\n     */\n    getEmail: function() {\n      return this.get("email");\n    },\n\n    /**\n     * Calls set("email", email, options) and returns the result.\n     * @param {String} email\n     * @param {Object} options A Backbone-style options object.\n     * @return {Boolean}\n     * @see Parse.Object.set\n     */\n    setEmail: function(email, options) {\n      return this.set("email", email, options);\n    },\n\n    /**\n     * Checks whether this user is the current user and has been authenticated.\n     * @return (Boolean) whether this user is the current user and is logged in.\n     */\n    authenticated: function() {\n      return !!this._sessionToken &&\n          (Parse.User.current() && Parse.User.current().id === this.id);\n    },\n\n    /**\n     * Returns the session token for this user, if the user has been logged in,\n     * or if it is the result of a query with the master key. Otherwise, returns\n     * undefined.\n     * @return {String} the session token, or undefined\n     */\n    getSessionToken: function() {\n      return this._sessionToken;\n    }\n\n  }, /** @lends Parse.User */ {\n    // Class Variables\n\n    // The currently logged-in user.\n    _currentUser: null,\n\n    // Whether currentUser is known to match the serialized version on disk.\n    // This is useful for saving a localstorage check if you try to load\n    // _currentUser frequently while there is none stored.\n    _currentUserMatchesDisk: false,\n\n    // The localStorage key suffix that the current user is stored under.\n    _CURRENT_USER_KEY: "currentUser",\n\n    // The mapping of auth provider names to actual providers\n    _authProviders: {},\n\n    // Whether to rewrite className User to _User\n    _performUserRewrite: true,\n\n\n    // Class Methods\n\n    /**\n     * Signs up a new user with a username (or email) and password.\n     * This will create a new Parse.User on the server, and also persist the\n     * session in localStorage so that you can access the user using\n     * {@link #current}.\n     *\n     * <p>Calls options.success or options.error on completion.</p>\n     *\n     * @param {String} username The username (or email) to sign up with.\n     * @param {String} password The password to sign up with.\n     * @param {Object} attrs Extra fields to set on the new user.\n     * @param {Object} options A Backbone-style options object.\n     * @return {Parse.Promise} A promise that is fulfilled with the user when\n     *     the signup completes.\n     * @see Parse.User#signUp\n     */\n    signUp: function(username, password, attrs, options) {\n      attrs = attrs || {};\n      attrs.username = username;\n      attrs.password = password;\n      var user = Parse.Object._create("_User");\n      return user.signUp(attrs, options);\n    },\n\n    /**\n     * Logs in a user with a username (or email) and password. On success, this\n     * saves the session to disk, so you can retrieve the currently logged in\n     * user using <code>current</code>.\n     *\n     * <p>Calls options.success or options.error on completion.</p>\n     *\n     * @param {String} username The username (or email) to log in with.\n     * @param {String} password The password to log in with.\n     * @param {Object} options A Backbone-style options object.\n     * @return {Parse.Promise} A promise that is fulfilled with the user when\n     *     the login completes.\n     * @see Parse.User#logIn\n     */\n    logIn: function(username, password, options) {\n      var user = Parse.Object._create("_User");\n      user._finishFetch({ username: username, password: password });\n      return user.logIn(options);\n    },\n\n    /**\n     * Logs in a user with a session token. On success, this saves the session\n     * to disk, so you can retrieve the currently logged in user using\n     * <code>current</code>.\n     *\n     * <p>Calls options.success or options.error on completion.</p>\n     *\n     * @param {String} sessionToken The sessionToken to log in with.\n     * @param {Object} options A Backbone-style options object.\n     * @return {Parse.Promise} A promise that is fulfilled with the user when\n     *     the login completes.\n     */\n    become: function(sessionToken, options) {\n      options = options || {};\n\n      var user = Parse.Object._create("_User");\n      return Parse._request({\n        route: "users",\n        className: "me",\n        method: "GET",\n        useMasterKey: options.useMasterKey,\n        sessionToken: sessionToken\n      }).then(function(resp, status, xhr) {\n        var serverAttrs = user.parse(resp, status, xhr);\n        user._finishFetch(serverAttrs);\n        user._handleSaveResult(true);\n        return user;\n\n      })._thenRunCallbacks(options, user);\n    },\n\n    /**\n     * Logs out the currently logged in user session. This will remove the\n     * session from disk, log out of linked services, and future calls to\n     * <code>current</code> will return <code>null</code>.\n     */\n    logOut: function() {\n      if (Parse.User._currentUser !== null) {\n        Parse.User._currentUser._logOutWithAll();\n        Parse.User._currentUser._isCurrentUser = false;\n      }\n      Parse.User._currentUserMatchesDisk = true;\n      Parse.User._currentUser = null;\n      Parse.localStorage.removeItem(\n          Parse._getParsePath(Parse.User._CURRENT_USER_KEY));\n    },\n\n    /**\n     * Requests a password reset email to be sent to the specified email address\n     * associated with the user account. This email allows the user to securely\n     * reset their password on the Parse site.\n     *\n     * <p>Calls options.success or options.error on completion.</p>\n     *\n     * @param {String} email The email address associated with the user that\n     *     forgot their password.\n     * @param {Object} options A Backbone-style options object.\n     */\n    requestPasswordReset: function(email, options) {\n      options = options || {};\n      var request = Parse._request({\n        route: "requestPasswordReset",\n        method: "POST",\n        useMasterKey: options.useMasterKey,\n        data: { email: email }\n      });\n      return request._thenRunCallbacks(options);\n    },\n\n    /**\n     * Retrieves the currently logged in ParseUser with a valid session,\n     * either from memory or localStorage, if necessary.\n     * @return {Parse.Object} The currently logged in Parse.User.\n     */\n    current: function() {\n      if (Parse.User._currentUser) {\n        return Parse.User._currentUser;\n      }\n\n      if (Parse.User._currentUserMatchesDisk) {\n\n        return Parse.User._currentUser;\n      }\n\n      // Load the user from local storage.\n      Parse.User._currentUserMatchesDisk = true;\n\n      var userData = Parse.localStorage.getItem(Parse._getParsePath(\n          Parse.User._CURRENT_USER_KEY));\n      if (!userData) {\n\n        return null;\n      }\n      Parse.User._currentUser = Parse.Object._create("_User");\n      Parse.User._currentUser._isCurrentUser = true;\n\n      var json = JSON.parse(userData);\n      Parse.User._currentUser.id = json._id;\n      delete json._id;\n      Parse.User._currentUser._sessionToken = json._sessionToken;\n      delete json._sessionToken;\n      Parse.User._currentUser._finishFetch(json);\n\n      Parse.User._currentUser._synchronizeAllAuthData();\n      Parse.User._currentUser._refreshCache();\n      Parse.User._currentUser._opSetQueue = [{}];\n      return Parse.User._currentUser;\n    },\n\n    /**\n     * Allow someone to define a custom User class without className\n     * being rewritten to _User. The default behavior is to rewrite\n     * User to _User for legacy reasons. This allows developers to\n     * override that behavior.\n     *\n     * @param {Boolean} isAllowed Whether or not to allow custom User class\n     */\n    allowCustomUserClass: function(isAllowed) {\n      this._performUserRewrite = !isAllowed;\n    },\n\n    /**\n     * Persists a user as currentUser to localStorage, and into the singleton.\n     */\n    _saveCurrentUser: function(user) {\n      if (Parse.User._currentUser !== user) {\n        Parse.User.logOut();\n      }\n      user._isCurrentUser = true;\n      Parse.User._currentUser = user;\n      Parse.User._currentUserMatchesDisk = true;\n\n      var json = user.toJSON();\n      json._id = user.id;\n      json._sessionToken = user._sessionToken;\n      Parse.localStorage.setItem(\n          Parse._getParsePath(Parse.User._CURRENT_USER_KEY),\n          JSON.stringify(json));\n    },\n\n    _registerAuthenticationProvider: function(provider) {\n      Parse.User._authProviders[provider.getAuthType()] = provider;\n      // Synchronize the current user with the auth provider.\n      if (Parse.User.current()) {\n        Parse.User.current()._synchronizeAuthData(provider.getAuthType());\n      }\n    },\n\n    _logInWith: function(provider, options) {\n      var user = Parse.Object._create("_User");\n      return user._linkWith(provider, options);\n    }\n\n  });\n}(this));\n\n\n// Parse.Query is a way to create a list of Parse.Objects.\n(function(root) {\n  root.Parse = root.Parse || {};\n  var Parse = root.Parse;\n  var _ = Parse._;\n\n  /**\n   * Creates a new parse Parse.Query for the given Parse.Object subclass.\n   * @param objectClass -\n   *   An instance of a subclass of Parse.Object, or a Parse className string.\n   * @class\n   *\n   * <p>Parse.Query defines a query that is used to fetch Parse.Objects. The\n   * most common use case is finding all objects that match a query through the\n   * <code>find</code> method. For example, this sample code fetches all objects\n   * of class <code>MyClass</code>. It calls a different function depending on\n   * whether the fetch succeeded or not.\n   *\n   * <pre>\n   * var query = new Parse.Query(MyClass);\n   * query.find({\n   *   success: function(results) {\n   *     // results is an array of Parse.Object.\n   *   },\n   *\n   *   error: function(error) {\n   *     // error is an instance of Parse.Error.\n   *   }\n   * });</pre></p>\n   *\n   * <p>A Parse.Query can also be used to retrieve a single object whose id is\n   * known, through the get method. For example, this sample code fetches an\n   * object of class <code>MyClass</code> and id <code>myId</code>. It calls a\n   * different function depending on whether the fetch succeeded or not.\n   *\n   * <pre>\n   * var query = new Parse.Query(MyClass);\n   * query.get(myId, {\n   *   success: function(object) {\n   *     // object is an instance of Parse.Object.\n   *   },\n   *\n   *   error: function(object, error) {\n   *     // error is an instance of Parse.Error.\n   *   }\n   * });</pre></p>\n   *\n   * <p>A Parse.Query can also be used to count the number of objects that match\n   * the query without retrieving all of those objects. For example, this\n   * sample code counts the number of objects of the class <code>MyClass</code>\n   * <pre>\n   * var query = new Parse.Query(MyClass);\n   * query.count({\n   *   success: function(number) {\n   *     // There are number instances of MyClass.\n   *   },\n   *\n   *   error: function(error) {\n   *     // error is an instance of Parse.Error.\n   *   }\n   * });</pre></p>\n   */\n  Parse.Query = function(objectClass) {\n    if (_.isString(objectClass)) {\n      objectClass = Parse.Object._getSubclass(objectClass);\n    }\n\n    this.objectClass = objectClass;\n\n    this.className = objectClass.prototype.className;\n\n    this._where = {};\n    this._include = [];\n    this._limit = -1; // negative limit means, do not send a limit\n    this._skip = 0;\n    this._extraOptions = {};\n  };\n\n  /**\n   * Constructs a Parse.Query that is the OR of the passed in queries.  For\n   * example:\n   * <pre>var compoundQuery = Parse.Query.or(query1, query2, query3);</pre>\n   *\n   * will create a compoundQuery that is an or of the query1, query2, and\n   * query3.\n   * @param {...Parse.Query} var_args The list of queries to OR.\n   * @return {Parse.Query} The query that is the OR of the passed in queries.\n   */\n  Parse.Query.or = function() {\n    var queries = _.toArray(arguments);\n    var className = null;\n    Parse._arrayEach(queries, function(q) {\n      if (_.isNull(className)) {\n        className = q.className;\n      }\n\n      if (className !== q.className) {\n        throw "All queries must be for the same class";\n      }\n    });\n    var query = new Parse.Query(className);\n    query._orQuery(queries);\n    return query;\n  };\n\n  Parse.Query.prototype = {\n    /**\n     * Constructs a Parse.Object whose id is already known by fetching data from\n     * the server.  Either options.success or options.error is called when the\n     * find completes.\n     *\n     * @param {String} objectId The id of the object to be fetched.\n     * @param {Object} options A Backbone-style options object.\n     * Valid options are:<ul>\n     *   <li>success: A Backbone-style success callback\n     *   <li>error: An Backbone-style error callback.\n     *   <li>useMasterKey: In Cloud Code and Node only, causes the Master Key to\n     *     be used for this request.\n     * </ul>\n     */\n    get: function(objectId, options) {\n      var self = this;\n      self.equalTo(\'objectId\', objectId);\n\n      var firstOptions = {};\n      if (options && _.has(options, \'useMasterKey\')) {\n        firstOptions = { useMasterKey: options.useMasterKey };\n      }\n\n      return self.first(firstOptions).then(function(response) {\n        if (response) {\n          return response;\n        }\n\n        var errorObject = new Parse.Error(Parse.Error.OBJECT_NOT_FOUND,\n                                          "Object not found.");\n        return Parse.Promise.error(errorObject);\n\n      })._thenRunCallbacks(options, null);\n    },\n\n    /**\n     * Returns a JSON representation of this query.\n     * @return {Object} The JSON representation of the query.\n     */\n    toJSON: function() {\n      var params = {\n        where: this._where\n      };\n\n      if (this._include.length > 0) {\n        params.include = this._include.join(",");\n      }\n      if (this._select) {\n        params.keys = this._select.join(",");\n      }\n      if (this._limit >= 0) {\n        params.limit = this._limit;\n      }\n      if (this._skip > 0) {\n        params.skip = this._skip;\n      }\n      if (this._order !== undefined) {\n        params.order = this._order.join(",");\n      }\n\n      Parse._objectEach(this._extraOptions, function(v, k) {\n        params[k] = v;\n      });\n\n      return params;\n    },\n\n    /**\n     * Retrieves a list of ParseObjects that satisfy this query.\n     * Either options.success or options.error is called when the find\n     * completes.\n     *\n     * @param {Object} options A Backbone-style options object. Valid options\n     * are:<ul>\n     *   <li>success: Function to call when the find completes successfully.\n     *   <li>error: Function to call when the find fails.\n     *   <li>useMasterKey: In Cloud Code and Node only, causes the Master Key to\n     *     be used for this request.\n     * </ul>\n     *\n     * @return {Parse.Promise} A promise that is resolved with the results when\n     * the query completes.\n     */\n    find: function(options) {\n      var self = this;\n      options = options || {};\n\n      var request = Parse._request({\n        route: "classes",\n        className: this.className,\n        method: "GET",\n        useMasterKey: options.useMasterKey,\n        data: this.toJSON()\n      });\n\n      return request.then(function(response) {\n        return _.map(response.results, function(json) {\n          var obj;\n          if (response.className) {\n            obj = new Parse.Object(response.className);\n          } else {\n            obj = new self.objectClass();\n          }\n          obj._finishFetch(json, true);\n          return obj;\n        });\n      })._thenRunCallbacks(options);\n    },\n\n    /**\n     * Counts the number of objects that match this query.\n     * Either options.success or options.error is called when the count\n     * completes.\n     *\n     * @param {Object} options A Backbone-style options object. Valid options\n     * are:<ul>\n     *   <li>success: Function to call when the count completes successfully.\n     *   <li>error: Function to call when the find fails.\n     *   <li>useMasterKey: In Cloud Code and Node only, causes the Master Key to\n     *     be used for this request.\n     * </ul>\n     *\n     * @return {Parse.Promise} A promise that is resolved with the count when\n     * the query completes.\n     */\n    count: function(options) {\n      var self = this;\n      options = options || {};\n\n      var params = this.toJSON();\n      params.limit = 0;\n      params.count = 1;\n      var request = Parse._request({\n        route: "classes",\n        className: self.className,\n        method: "GET",\n        useMasterKey: options.useMasterKey,\n        data: params\n      });\n\n      return request.then(function(response) {\n        return response.count;\n      })._thenRunCallbacks(options);\n    },\n\n    /**\n     * Retrieves at most one Parse.Object that satisfies this query.\n     *\n     * Either options.success or options.error is called when it completes.\n     * success is passed the object if there is one. otherwise, undefined.\n     *\n     * @param {Object} options A Backbone-style options object. Valid options\n     * are:<ul>\n     *   <li>success: Function to call when the find completes successfully.\n     *   <li>error: Function to call when the find fails.\n     *   <li>useMasterKey: In Cloud Code and Node only, causes the Master Key to\n     *     be used for this request.\n     * </ul>\n     *\n     * @return {Parse.Promise} A promise that is resolved with the object when\n     * the query completes.\n     */\n    first: function(options) {\n      var self = this;\n      options = options || {};\n\n      var params = this.toJSON();\n      params.limit = 1;\n      var request = Parse._request({\n        route: "classes",\n        className: this.className,\n        method: "GET",\n        useMasterKey: options.useMasterKey,\n        data: params\n      });\n\n      return request.then(function(response) {\n        return _.map(response.results, function(json) {\n          var obj = new self.objectClass();\n          obj._finishFetch(json, true);\n          return obj;\n        })[0];\n      })._thenRunCallbacks(options);\n    },\n\n    /**\n     * Returns a new instance of Parse.Collection backed by this query.\n     * @param {Array} items An array of instances of <code>Parse.Object</code>\n     *     with which to start this Collection.\n     * @param {Object} options An optional object with Backbone-style options.\n     * Valid options are:<ul>\n     *   <li>model: The Parse.Object subclass that this collection contains.\n     *   <li>query: An instance of Parse.Query to use when fetching items.\n     *   <li>comparator: A string property name or function to sort by.\n     * </ul>\n     * @return {Parse.Collection}\n     */\n    collection: function(items, options) {\n      options = options || {};\n      return new Parse.Collection(items, _.extend(options, {\n        model: this.objectClass,\n        query: this\n      }));\n    },\n\n    /**\n     * Sets the number of results to skip before returning any results.\n     * This is useful for pagination.\n     * Default is to skip zero results.\n     * @param {Number} n the number of results to skip.\n     * @return {Parse.Query} Returns the query, so you can chain this call.\n     */\n    skip: function(n) {\n      this._skip = n;\n      return this;\n    },\n\n    /**\n     * Sets the limit of the number of results to return. The default limit is\n     * 100, with a maximum of 1000 results being returned at a time.\n     * @param {Number} n the number of results to limit to.\n     * @return {Parse.Query} Returns the query, so you can chain this call.\n     */\n    limit: function(n) {\n      this._limit = n;\n      return this;\n    },\n\n    /**\n     * Add a constraint to the query that requires a particular key\'s value to\n     * be equal to the provided value.\n     * @param {String} key The key to check.\n     * @param value The value that the Parse.Object must contain.\n     * @return {Parse.Query} Returns the query, so you can chain this call.\n     */\n    equalTo: function(key, value) {\n      if (_.isUndefined(value)) {\n        return this.doesNotExist(key);\n      }\n\n      this._where[key] = Parse._encode(value);\n      return this;\n    },\n\n    /**\n     * Helper for condition queries\n     */\n    _addCondition: function(key, condition, value) {\n      // Check if we already have a condition\n      if (!this._where[key]) {\n        this._where[key] = {};\n      }\n      this._where[key][condition] = Parse._encode(value);\n      return this;\n    },\n\n    /**\n     * Add a constraint to the query that requires a particular key\'s value to\n     * be not equal to the provided value.\n     * @param {String} key The key to check.\n     * @param value The value that must not be equalled.\n     * @return {Parse.Query} Returns the query, so you can chain this call.\n     */\n    notEqualTo: function(key, value) {\n      this._addCondition(key, "$ne", value);\n      return this;\n    },\n\n    /**\n     * Add a constraint to the query that requires a particular key\'s value to\n     * be less than the provided value.\n     * @param {String} key The key to check.\n     * @param value The value that provides an upper bound.\n     * @return {Parse.Query} Returns the query, so you can chain this call.\n     */\n    lessThan: function(key, value) {\n      this._addCondition(key, "$lt", value);\n      return this;\n    },\n\n    /**\n     * Add a constraint to the query that requires a particular key\'s value to\n     * be greater than the provided value.\n     * @param {String} key The key to check.\n     * @param value The value that provides an lower bound.\n     * @return {Parse.Query} Returns the query, so you can chain this call.\n     */\n    greaterThan: function(key, value) {\n      this._addCondition(key, "$gt", value);\n      return this;\n    },\n\n    /**\n     * Add a constraint to the query that requires a particular key\'s value to\n     * be less than or equal to the provided value.\n     * @param {String} key The key to check.\n     * @param value The value that provides an upper bound.\n     * @return {Parse.Query} Returns the query, so you can chain this call.\n     */\n    lessThanOrEqualTo: function(key, value) {\n      this._addCondition(key, "$lte", value);\n      return this;\n    },\n\n    /**\n     * Add a constraint to the query that requires a particular key\'s value to\n     * be greater than or equal to the provided value.\n     * @param {String} key The key to check.\n     * @param value The value that provides an lower bound.\n     * @return {Parse.Query} Returns the query, so you can chain this call.\n     */\n    greaterThanOrEqualTo: function(key, value) {\n      this._addCondition(key, "$gte", value);\n      return this;\n    },\n\n    /**\n     * Add a constraint to the query that requires a particular key\'s value to\n     * be contained in the provided list of values.\n     * @param {String} key The key to check.\n     * @param {Array} values The values that will match.\n     * @return {Parse.Query} Returns the query, so you can chain this call.\n     */\n    containedIn: function(key, values) {\n      this._addCondition(key, "$in", values);\n      return this;\n    },\n\n    /**\n     * Add a constraint to the query that requires a particular key\'s value to\n     * not be contained in the provided list of values.\n     * @param {String} key The key to check.\n     * @param {Array} values The values that will not match.\n     * @return {Parse.Query} Returns the query, so you can chain this call.\n     */\n    notContainedIn: function(key, values) {\n      this._addCondition(key, "$nin", values);\n      return this;\n    },\n\n    /**\n     * Add a constraint to the query that requires a particular key\'s value to\n     * contain each one of the provided list of values.\n     * @param {String} key The key to check.  This key\'s value must be an array.\n     * @param {Array} values The values that will match.\n     * @return {Parse.Query} Returns the query, so you can chain this call.\n     */\n    containsAll: function(key, values) {\n      this._addCondition(key, "$all", values);\n      return this;\n    },\n\n\n    /**\n     * Add a constraint for finding objects that contain the given key.\n     * @param {String} key The key that should exist.\n     * @return {Parse.Query} Returns the query, so you can chain this call.\n     */\n    exists: function(key) {\n      this._addCondition(key, "$exists", true);\n      return this;\n    },\n\n    /**\n     * Add a constraint for finding objects that do not contain a given key.\n     * @param {String} key The key that should not exist\n     * @return {Parse.Query} Returns the query, so you can chain this call.\n     */\n    doesNotExist: function(key) {\n      this._addCondition(key, "$exists", false);\n      return this;\n    },\n\n    /**\n     * Add a regular expression constraint for finding string values that match\n     * the provided regular expression.\n     * This may be slow for large datasets.\n     * @param {String} key The key that the string to match is stored in.\n     * @param {RegExp} regex The regular expression pattern to match.\n     * @return {Parse.Query} Returns the query, so you can chain this call.\n     */\n    matches: function(key, regex, modifiers) {\n      this._addCondition(key, "$regex", regex);\n      if (!modifiers) { modifiers = ""; }\n      // Javascript regex options support mig as inline options but store them\n      // as properties of the object. We support mi & should migrate them to\n      // modifiers\n      if (regex.ignoreCase) { modifiers += \'i\'; }\n      if (regex.multiline) { modifiers += \'m\'; }\n\n      if (modifiers && modifiers.length) {\n        this._addCondition(key, "$options", modifiers);\n      }\n      return this;\n    },\n\n    /**\n     * Add a constraint that requires that a key\'s value matches a Parse.Query\n     * constraint.\n     * @param {String} key The key that the contains the object to match the\n     *                     query.\n     * @param {Parse.Query} query The query that should match.\n     * @return {Parse.Query} Returns the query, so you can chain this call.\n     */\n    matchesQuery: function(key, query) {\n      var queryJSON = query.toJSON();\n      queryJSON.className = query.className;\n      this._addCondition(key, "$inQuery", queryJSON);\n      return this;\n    },\n\n   /**\n     * Add a constraint that requires that a key\'s value not matches a\n     * Parse.Query constraint.\n     * @param {String} key The key that the contains the object to match the\n     *                     query.\n     * @param {Parse.Query} query The query that should not match.\n     * @return {Parse.Query} Returns the query, so you can chain this call.\n     */\n    doesNotMatchQuery: function(key, query) {\n      var queryJSON = query.toJSON();\n      queryJSON.className = query.className;\n      this._addCondition(key, "$notInQuery", queryJSON);\n      return this;\n    },\n\n\n    /**\n     * Add a constraint that requires that a key\'s value matches a value in\n     * an object returned by a different Parse.Query.\n     * @param {String} key The key that contains the value that is being\n     *                     matched.\n     * @param {String} queryKey The key in the objects returned by the query to\n     *                          match against.\n     * @param {Parse.Query} query The query to run.\n     * @return {Parse.Query} Returns the query, so you can chain this call.\n     */\n    matchesKeyInQuery: function(key, queryKey, query) {\n      var queryJSON = query.toJSON();\n      queryJSON.className = query.className;\n      this._addCondition(key, "$select",\n                         { key: queryKey, query: queryJSON });\n      return this;\n    },\n\n    /**\n     * Add a constraint that requires that a key\'s value not match a value in\n     * an object returned by a different Parse.Query.\n     * @param {String} key The key that contains the value that is being\n     *                     excluded.\n     * @param {String} queryKey The key in the objects returned by the query to\n     *                          match against.\n     * @param {Parse.Query} query The query to run.\n     * @return {Parse.Query} Returns the query, so you can chain this call.\n     */\n    doesNotMatchKeyInQuery: function(key, queryKey, query) {\n      var queryJSON = query.toJSON();\n      queryJSON.className = query.className;\n      this._addCondition(key, "$dontSelect",\n                         { key: queryKey, query: queryJSON });\n      return this;\n    },\n\n    /**\n     * Add constraint that at least one of the passed in queries matches.\n     * @param {Array} queries\n     * @return {Parse.Query} Returns the query, so you can chain this call.\n     */\n    _orQuery: function(queries) {\n      var queryJSON = _.map(queries, function(q) {\n        return q.toJSON().where;\n      });\n\n      this._where.$or = queryJSON;\n      return this;\n    },\n\n    /**\n     * Converts a string into a regex that matches it.\n     * Surrounding with \\Q .. \\E does this, we just need to escape \\E\'s in\n     * the text separately.\n     */\n    _quote: function(s) {\n      return "\\\\Q" + s.replace("\\\\E", "\\\\E\\\\\\\\E\\\\Q") + "\\\\E";\n    },\n\n    /**\n     * Add a constraint for finding string values that contain a provided\n     * string.  This may be slow for large datasets.\n     * @param {String} key The key that the string to match is stored in.\n     * @param {String} substring The substring that the value must contain.\n     * @return {Parse.Query} Returns the query, so you can chain this call.\n     */\n    contains: function(key, value) {\n      this._addCondition(key, "$regex", this._quote(value));\n      return this;\n    },\n\n    /**\n     * Add a constraint for finding string values that start with a provided\n     * string.  This query will use the backend index, so it will be fast even\n     * for large datasets.\n     * @param {String} key The key that the string to match is stored in.\n     * @param {String} prefix The substring that the value must start with.\n     * @return {Parse.Query} Returns the query, so you can chain this call.\n     */\n    startsWith: function(key, value) {\n      this._addCondition(key, "$regex", "^" + this._quote(value));\n      return this;\n    },\n\n    /**\n     * Add a constraint for finding string values that end with a provided\n     * string.  This will be slow for large datasets.\n     * @param {String} key The key that the string to match is stored in.\n     * @param {String} suffix The substring that the value must end with.\n     * @return {Parse.Query} Returns the query, so you can chain this call.\n     */\n    endsWith: function(key, value) {\n      this._addCondition(key, "$regex", this._quote(value) + "$");\n      return this;\n    },\n\n    /**\n     * Sorts the results in ascending order by the given key.\n     *\n     * @param {(String|String[]|...String} key The key to order by, which is a\n     * string of comma separated values, or an Array of keys, or multiple keys.\n     * @return {Parse.Query} Returns the query, so you can chain this call.\n     */\n    ascending: function() {\n      this._order = [];\n      return this.addAscending.apply(this, arguments);\n    },\n\n    /**\n     * Sorts the results in ascending order by the given key,\n     * but can also add secondary sort descriptors without overwriting _order.\n     *\n     * @param {(String|String[]|...String} key The key to order by, which is a\n     * string of comma separated values, or an Array of keys, or multiple keys.\n     * @return {Parse.Query} Returns the query, so you can chain this call.\n     */\n    addAscending: function(key) {\n      var self = this;\n      if (!this._order) {\n        this._order = [];\n      }\n      Parse._arrayEach(arguments, function(key) {\n        if (Array.isArray(key)) {\n          key = key.join();\n        }\n        self._order = self._order.concat(key.replace(/\\s/g, "").split(","));\n      });\n      return this;\n    },\n\n    /**\n     * Sorts the results in descending order by the given key.\n     *\n     * @param {(String|String[]|...String} key The key to order by, which is a\n     * string of comma separated values, or an Array of keys, or multiple keys.\n     * @return {Parse.Query} Returns the query, so you can chain this call.\n     */\n    descending: function(key) {\n      this._order = [];\n      return this.addDescending.apply(this, arguments);\n    },\n\n    /**\n     * Sorts the results in descending order by the given key,\n     * but can also add secondary sort descriptors without overwriting _order.\n     *\n     * @param {(String|String[]|...String} key The key to order by, which is a\n     * string of comma separated values, or an Array of keys, or multiple keys.\n     * @return {Parse.Query} Returns the query, so you can chain this call.\n     */\n    addDescending: function(key) {\n      var self = this;\n      if (!this._order) {\n        this._order = [];\n      }\n      Parse._arrayEach(arguments, function(key) {\n        if (Array.isArray(key)) {\n          key = key.join();\n        }\n        self._order = self._order.concat(\n          _.map(key.replace(/\\s/g, "").split(","),\n            function(k) { return "-" + k; }));\n      });\n      return this;\n    },\n\n    /**\n     * Add a proximity based constraint for finding objects with key point\n     * values near the point given.\n     * @param {String} key The key that the Parse.GeoPoint is stored in.\n     * @param {Parse.GeoPoint} point The reference Parse.GeoPoint that is used.\n     * @return {Parse.Query} Returns the query, so you can chain this call.\n     */\n    near: function(key, point) {\n      if (!(point instanceof Parse.GeoPoint)) {\n        // Try to cast it to a GeoPoint, so that near("loc", [20,30]) works.\n        point = new Parse.GeoPoint(point);\n      }\n      this._addCondition(key, "$nearSphere", point);\n      return this;\n    },\n\n    /**\n     * Add a proximity based constraint for finding objects with key point\n     * values near the point given and within the maximum distance given.\n     * @param {String} key The key that the Parse.GeoPoint is stored in.\n     * @param {Parse.GeoPoint} point The reference Parse.GeoPoint that is used.\n     * @param {Number} maxDistance Maximum distance (in radians) of results to\n     *   return.\n     * @return {Parse.Query} Returns the query, so you can chain this call.\n     */\n    withinRadians: function(key, point, distance) {\n      this.near(key, point);\n      this._addCondition(key, "$maxDistance", distance);\n      return this;\n    },\n\n    /**\n     * Add a proximity based constraint for finding objects with key point\n     * values near the point given and within the maximum distance given.\n     * Radius of earth used is 3958.8 miles.\n     * @param {String} key The key that the Parse.GeoPoint is stored in.\n     * @param {Parse.GeoPoint} point The reference Parse.GeoPoint that is used.\n     * @param {Number} maxDistance Maximum distance (in miles) of results to\n     *     return.\n     * @return {Parse.Query} Returns the query, so you can chain this call.\n     */\n    withinMiles: function(key, point, distance) {\n      return this.withinRadians(key, point, distance / 3958.8);\n    },\n\n    /**\n     * Add a proximity based constraint for finding objects with key point\n     * values near the point given and within the maximum distance given.\n     * Radius of earth used is 6371.0 kilometers.\n     * @param {String} key The key that the Parse.GeoPoint is stored in.\n     * @param {Parse.GeoPoint} point The reference Parse.GeoPoint that is used.\n     * @param {Number} maxDistance Maximum distance (in kilometers) of results\n     *     to return.\n     * @return {Parse.Query} Returns the query, so you can chain this call.\n     */\n    withinKilometers: function(key, point, distance) {\n      return this.withinRadians(key, point, distance / 6371.0);\n    },\n\n    /**\n     * Add a constraint to the query that requires a particular key\'s\n     * coordinates be contained within a given rectangular geographic bounding\n     * box.\n     * @param {String} key The key to be constrained.\n     * @param {Parse.GeoPoint} southwest\n     *     The lower-left inclusive corner of the box.\n     * @param {Parse.GeoPoint} northeast\n     *     The upper-right inclusive corner of the box.\n     * @return {Parse.Query} Returns the query, so you can chain this call.\n     */\n    withinGeoBox: function(key, southwest, northeast) {\n      if (!(southwest instanceof Parse.GeoPoint)) {\n        southwest = new Parse.GeoPoint(southwest);\n      }\n      if (!(northeast instanceof Parse.GeoPoint)) {\n        northeast = new Parse.GeoPoint(northeast);\n      }\n      this._addCondition(key, \'$within\', { \'$box\': [southwest, northeast] });\n      return this;\n    },\n\n    /**\n     * Include nested Parse.Objects for the provided key.  You can use dot\n     * notation to specify which fields in the included object are also fetch.\n     * @param {String} key The name of the key to include.\n     * @return {Parse.Query} Returns the query, so you can chain this call.\n     */\n    include: function() {\n      var self = this;\n      Parse._arrayEach(arguments, function(key) {\n        if (_.isArray(key)) {\n          self._include = self._include.concat(key);\n        } else {\n          self._include.push(key);\n        }\n      });\n      return this;\n    },\n\n    /**\n     * Restrict the fields of the returned Parse.Objects to include only the\n     * provided keys.  If this is called multiple times, then all of the keys\n     * specified in each of the calls will be included.\n     * @param {Array} keys The names of the keys to include.\n     * @return {Parse.Query} Returns the query, so you can chain this call.\n     */\n    select: function() {\n      var self = this;\n      this._select = this._select || [];\n      Parse._arrayEach(arguments, function(key) {\n        if (_.isArray(key)) {\n          self._select = self._select.concat(key);\n        } else {\n          self._select.push(key);\n        }\n      });\n      return this;\n    },\n\n    /**\n     * Iterates over each result of a query, calling a callback for each one. If\n     * the callback returns a promise, the iteration will not continue until\n     * that promise has been fulfilled. If the callback returns a rejected\n     * promise, then iteration will stop with that error. The items are\n     * processed in an unspecified order. The query may not have any sort order,\n     * and may not use limit or skip.\n     * @param {Function} callback Callback that will be called with each result\n     *     of the query.\n     * @param {Object} options An optional Backbone-like options object with\n     *     success and error callbacks that will be invoked once the iteration\n     *     has finished.\n     * @return {Parse.Promise} A promise that will be fulfilled once the\n     *     iteration has completed.\n     */\n    each: function(callback, options) {\n      options = options || {};\n\n      if (this._order || this._skip || (this._limit >= 0)) {\n        var error =\n          "Cannot iterate on a query with sort, skip, or limit.";\n        return Parse.Promise.error(error)._thenRunCallbacks(options);\n      }\n\n      var promise = new Parse.Promise();\n\n      var query = new Parse.Query(this.objectClass);\n      // We can override the batch size from the options.\n      // This is undocumented, but useful for testing.\n      query._limit = options.batchSize || 100;\n      query._where = _.clone(this._where);\n      query._include = _.clone(this._include);\n\n      query.ascending(\'objectId\');\n\n      var finished = false;\n      return Parse.Promise._continueWhile(function() {\n        return !finished;\n\n      }, function() {\n        return query.find().then(function(results) {\n          var callbacksDone = Parse.Promise.as();\n          Parse._.each(results, function(result) {\n            callbacksDone = callbacksDone.then(function() {\n              return callback(result);\n            });\n          });\n\n          return callbacksDone.then(function() {\n            if (results.length >= query._limit) {\n              query.greaterThan("objectId", results[results.length - 1].id);\n            } else {\n              finished = true;\n            }\n          });\n        });\n      })._thenRunCallbacks(options);\n    }\n  };\n\n}(this));\n\n/*global FB: false , console: false*/\n(function(root) {\n  root.Parse = root.Parse || {};\n  var Parse = root.Parse;\n  var _ = Parse._;\n\n  var PUBLIC_KEY = "*";\n\n  var initialized = false;\n  var requestedPermissions;\n  var initOptions;\n  var provider = {\n    authenticate: function(options) {\n      var self = this;\n      FB.login(function(response) {\n        if (response.authResponse) {\n          if (options.success) {\n            options.success(self, {\n              id: response.authResponse.userID,\n              access_token: response.authResponse.accessToken,\n              expiration_date: new Date(response.authResponse.expiresIn * 1000 +\n                  (new Date()).getTime()).toJSON()\n            });\n          }\n        } else {\n          if (options.error) {\n            options.error(self, response);\n          }\n        }\n      }, {\n        scope: requestedPermissions\n      });\n    },\n    restoreAuthentication: function(authData) {\n      if (authData) {\n        var authResponse = {\n          userID: authData.id,\n          accessToken: authData.access_token,\n          expiresIn: (Parse._parseDate(authData.expiration_date).getTime() -\n              (new Date()).getTime()) / 1000\n        };\n        var newOptions = _.clone(initOptions);\n        newOptions.authResponse = authResponse;\n\n        // Suppress checks for login status from the browser.\n        newOptions.status = false;\n\n        // If the user doesn\'t match the one known by the FB SDK, log out.\n        // Most of the time, the users will match -- it\'s only in cases where\n        // the FB SDK knows of a different user than the one being restored\n        // from a Parse User that logged in with username/password.\n        var existingResponse = FB.getAuthResponse();\n        if (existingResponse &&\n            existingResponse.userID !== authResponse.userID) {\n          FB.logout();\n        }\n\n        FB.init(newOptions);\n      }\n      return true;\n    },\n    getAuthType: function() {\n      return "facebook";\n    },\n    deauthenticate: function() {\n      this.restoreAuthentication(null);\n    }\n  };\n\n  /**\n   * Provides a set of utilities for using Parse with Facebook.\n   * @namespace\n   * Provides a set of utilities for using Parse with Facebook.\n   */\n  Parse.FacebookUtils = {\n    /**\n     * Initializes Parse Facebook integration.  Call this function after you\n     * have loaded the Facebook Javascript SDK with the same parameters\n     * as you would pass to<code>\n     * <a href=\n     * "https://developers.facebook.com/docs/reference/javascript/FB.init/">\n     * FB.init()</a></code>.  Parse.FacebookUtils will invoke FB.init() for you\n     * with these arguments.\n     *\n     * @param {Object} options Facebook options argument as described here:\n     *   <a href=\n     *   "https://developers.facebook.com/docs/reference/javascript/FB.init/">\n     *   FB.init()</a>. The status flag will be coerced to \'false\' because it\n     *   interferes with Parse Facebook integration. Call FB.getLoginStatus()\n     *   explicitly if this behavior is required by your application.\n     */\n    init: function(options) {\n      if (typeof(FB) === \'undefined\') {\n        throw "The Facebook JavaScript SDK must be loaded before calling init.";\n      }\n      initOptions = _.clone(options) || {};\n      if (initOptions.status && typeof(console) !== "undefined") {\n        var warn = console.warn || console.log || function() {};\n        warn.call(console, "The \'status\' flag passed into" +\n          " FB.init, when set to true, can interfere with Parse Facebook" +\n          " integration, so it has been suppressed. Please call" +\n          " FB.getLoginStatus() explicitly if you require this behavior.");\n      }\n      initOptions.status = false;\n      FB.init(initOptions);\n      Parse.User._registerAuthenticationProvider(provider);\n      initialized = true;\n    },\n\n    /**\n     * Gets whether the user has their account linked to Facebook.\n     *\n     * @param {Parse.User} user User to check for a facebook link.\n     *     The user must be logged in on this device.\n     * @return {Boolean} <code>true</code> if the user has their account\n     *     linked to Facebook.\n     */\n    isLinked: function(user) {\n      return user._isLinked("facebook");\n    },\n\n    /**\n     * Logs in a user using Facebook. This method delegates to the Facebook\n     * SDK to authenticate the user, and then automatically logs in (or\n     * creates, in the case where it is a new user) a Parse.User.\n     *\n     * @param {String, Object} permissions The permissions required for Facebook\n     *    log in.  This is a comma-separated string of permissions.\n     *    Alternatively, supply a Facebook authData object as described in our\n     *    REST API docs if you want to handle getting facebook auth tokens\n     *    yourself.\n     * @param {Object} options Standard options object with success and error\n     *    callbacks.\n     */\n    logIn: function(permissions, options) {\n      if (!permissions || _.isString(permissions)) {\n        if (!initialized) {\n          throw "You must initialize FacebookUtils before calling logIn.";\n        }\n        requestedPermissions = permissions;\n        return Parse.User._logInWith("facebook", options);\n      } else {\n        var newOptions = _.clone(options) || {};\n        newOptions.authData = permissions;\n        return Parse.User._logInWith("facebook", newOptions);\n      }\n    },\n\n    /**\n     * Links Facebook to an existing PFUser. This method delegates to the\n     * Facebook SDK to authenticate the user, and then automatically links\n     * the account to the Parse.User.\n     *\n     * @param {Parse.User} user User to link to Facebook. This must be the\n     *     current user.\n     * @param {String, Object} permissions The permissions required for Facebook\n     *    log in.  This is a comma-separated string of permissions.\n     *    Alternatively, supply a Facebook authData object as described in our\n     *    REST API docs if you want to handle getting facebook auth tokens\n     *    yourself.\n     * @param {Object} options Standard options object with success and error\n     *    callbacks.\n     */\n    link: function(user, permissions, options) {\n      if (!permissions || _.isString(permissions)) {\n        if (!initialized) {\n          throw "You must initialize FacebookUtils before calling link.";\n        }\n        requestedPermissions = permissions;\n        return user._linkWith("facebook", options);\n      } else {\n        var newOptions = _.clone(options) || {};\n        newOptions.authData = permissions;\n        return user._linkWith("facebook", newOptions);\n      }\n    },\n\n    /**\n     * Unlinks the Parse.User from a Facebook account.\n     *\n     * @param {Parse.User} user User to unlink from Facebook. This must be the\n     *     current user.\n     * @param {Object} options Standard options object with success and error\n     *    callbacks.\n     */\n    unlink: function(user, options) {\n      if (!initialized) {\n        throw "You must initialize FacebookUtils before calling unlink.";\n      }\n      return user._unlinkFrom("facebook", options);\n    }\n  };\n\n}(this));\n\n/*global _: false, document: false, window: false, navigator: false */\n(function(root) {\n  root.Parse = root.Parse || {};\n  var Parse = root.Parse;\n  var _ = Parse._;\n\n  /**\n   * History serves as a global router (per frame) to handle hashchange\n   * events or pushState, match the appropriate route, and trigger\n   * callbacks. You shouldn\'t ever have to create one of these yourself\n   * â€” you should use the reference to <code>Parse.history</code>\n   * that will be created for you automatically if you make use of\n   * Routers with routes.\n   * @class\n   *\n   * <p>A fork of Backbone.History, provided for your convenience.  If you\n   * use this class, you must also include jQuery, or another library\n   * that provides a jQuery-compatible $ function.  For more information,\n   * see the <a href="http://documentcloud.github.com/backbone/#History">\n   * Backbone documentation</a>.</p>\n   * <p><strong><em>Available in the client SDK only.</em></strong></p>\n   */\n  Parse.History = function() {\n    this.handlers = [];\n    _.bindAll(this, \'checkUrl\');\n  };\n\n  // Cached regex for cleaning leading hashes and slashes .\n  var routeStripper = /^[#\\/]/;\n\n  // Cached regex for detecting MSIE.\n  var isExplorer = /msie [\\w.]+/;\n\n  // Has the history handling already been started?\n  Parse.History.started = false;\n\n  // Set up all inheritable **Parse.History** properties and methods.\n  _.extend(Parse.History.prototype, Parse.Events,\n           /** @lends Parse.History.prototype */ {\n\n    // The default interval to poll for hash changes, if necessary, is\n    // twenty times a second.\n    interval: 50,\n\n    // Gets the true hash value. Cannot use location.hash directly due to bug\n    // in Firefox where location.hash will always be decoded.\n    getHash: function(windowOverride) {\n      var loc = windowOverride ? windowOverride.location : window.location;\n      var match = loc.href.match(/#(.*)$/);\n      return match ? match[1] : \'\';\n    },\n\n    // Get the cross-browser normalized URL fragment, either from the URL,\n    // the hash, or the override.\n    getFragment: function(fragment, forcePushState) {\n      if (Parse._isNullOrUndefined(fragment)) {\n        if (this._hasPushState || forcePushState) {\n          fragment = window.location.pathname;\n          var search = window.location.search;\n          if (search) {\n            fragment += search;\n          }\n        } else {\n          fragment = this.getHash();\n        }\n      }\n      if (!fragment.indexOf(this.options.root)) {\n        fragment = fragment.substr(this.options.root.length);\n      }\n      return fragment.replace(routeStripper, \'\');\n    },\n\n    /**\n     * Start the hash change handling, returning `true` if the current\n     * URL matches an existing route, and `false` otherwise.\n     */\n    start: function(options) {\n      if (Parse.History.started) {\n        throw new Error("Parse.history has already been started");\n      }\n      Parse.History.started = true;\n\n      // Figure out the initial configuration. Do we need an iframe?\n      // Is pushState desired ... is it available?\n      this.options = _.extend({}, {root: \'/\'}, this.options, options);\n      this._wantsHashChange = this.options.hashChange !== false;\n      this._wantsPushState = !!this.options.pushState;\n      this._hasPushState = !!(this.options.pushState &&\n                              window.history &&\n                              window.history.pushState);\n      var fragment = this.getFragment();\n      var docMode = document.documentMode;\n      var oldIE = (isExplorer.exec(navigator.userAgent.toLowerCase()) &&\n                   (!docMode || docMode <= 7));\n\n      if (oldIE) {\n        this.iframe = Parse.$(\'<iframe src="javascript:0" tabindex="-1" />\')\n                      .hide().appendTo(\'body\')[0].contentWindow;\n        this.navigate(fragment);\n      }\n\n      // Depending on whether we\'re using pushState or hashes, and whether\n      // \'onhashchange\' is supported, determine how we check the URL state.\n      if (this._hasPushState) {\n        Parse.$(window).bind(\'popstate\', this.checkUrl);\n      } else if (this._wantsHashChange &&\n                 (\'onhashchange\' in window) &&\n                 !oldIE) {\n        Parse.$(window).bind(\'hashchange\', this.checkUrl);\n      } else if (this._wantsHashChange) {\n        this._checkUrlInterval = window.setInterval(this.checkUrl,\n                                                    this.interval);\n      }\n\n      // Determine if we need to change the base url, for a pushState link\n      // opened by a non-pushState browser.\n      this.fragment = fragment;\n      var loc = window.location;\n      var atRoot  = loc.pathname === this.options.root;\n\n      // If we\'ve started off with a route from a `pushState`-enabled browser,\n      // but we\'re currently in a browser that doesn\'t support it...\n      if (this._wantsHashChange &&\n          this._wantsPushState &&\n          !this._hasPushState &&\n          !atRoot) {\n        this.fragment = this.getFragment(null, true);\n        window.location.replace(this.options.root + \'#\' + this.fragment);\n        // Return immediately as browser will do redirect to new url\n        return true;\n\n      // Or if we\'ve started out with a hash-based route, but we\'re currently\n      // in a browser where it could be `pushState`-based instead...\n      } else if (this._wantsPushState &&\n                 this._hasPushState &&\n                 atRoot &&\n                 loc.hash) {\n        this.fragment = this.getHash().replace(routeStripper, \'\');\n        window.history.replaceState({}, document.title,\n            loc.protocol + \'//\' + loc.host + this.options.root + this.fragment);\n      }\n\n      if (!this.options.silent) {\n        return this.loadUrl();\n      }\n    },\n\n    // Disable Parse.history, perhaps temporarily. Not useful in a real app,\n    // but possibly useful for unit testing Routers.\n    stop: function() {\n      Parse.$(window).unbind(\'popstate\', this.checkUrl)\n                     .unbind(\'hashchange\', this.checkUrl);\n      window.clearInterval(this._checkUrlInterval);\n      Parse.History.started = false;\n    },\n\n    // Add a route to be tested when the fragment changes. Routes added later\n    // may override previous routes.\n    route: function(route, callback) {\n      this.handlers.unshift({route: route, callback: callback});\n    },\n\n    // Checks the current URL to see if it has changed, and if it has,\n    // calls `loadUrl`, normalizing across the hidden iframe.\n    checkUrl: function(e) {\n      var current = this.getFragment();\n      if (current === this.fragment && this.iframe) {\n        current = this.getFragment(this.getHash(this.iframe));\n      }\n      if (current === this.fragment) {\n        return false;\n      }\n      if (this.iframe) {\n        this.navigate(current);\n      }\n      if (!this.loadUrl()) {\n        this.loadUrl(this.getHash());\n      }\n    },\n\n    // Attempt to load the current URL fragment. If a route succeeds with a\n    // match, returns `true`. If no defined routes matches the fragment,\n    // returns `false`.\n    loadUrl: function(fragmentOverride) {\n      var fragment = this.fragment = this.getFragment(fragmentOverride);\n      var matched = _.any(this.handlers, function(handler) {\n        if (handler.route.test(fragment)) {\n          handler.callback(fragment);\n          return true;\n        }\n      });\n      return matched;\n    },\n\n    // Save a fragment into the hash history, or replace the URL state if the\n    // \'replace\' option is passed. You are responsible for properly URL-encoding\n    // the fragment in advance.\n    //\n    // The options object can contain `trigger: true` if you wish to have the\n    // route callback be fired (not usually desirable), or `replace: true`, if\n    // you wish to modify the current URL without adding an entry to the\n    // history.\n    navigate: function(fragment, options) {\n      if (!Parse.History.started) {\n        return false;\n      }\n      if (!options || options === true) {\n        options = {trigger: options};\n      }\n      var frag = (fragment || \'\').replace(routeStripper, \'\');\n      if (this.fragment === frag) {\n        return;\n      }\n\n      // If pushState is available, we use it to set the fragment as a real URL.\n      if (this._hasPushState) {\n        if (frag.indexOf(this.options.root) !== 0) {\n          frag = this.options.root + frag;\n        }\n        this.fragment = frag;\n        var replaceOrPush = options.replace ? \'replaceState\' : \'pushState\';\n        window.history[replaceOrPush]({}, document.title, frag);\n\n      // If hash changes haven\'t been explicitly disabled, update the hash\n      // fragment to store history.\n      } else if (this._wantsHashChange) {\n        this.fragment = frag;\n        this._updateHash(window.location, frag, options.replace);\n        if (this.iframe &&\n            (frag !== this.getFragment(this.getHash(this.iframe)))) {\n          // Opening and closing the iframe tricks IE7 and earlier\n          // to push a history entry on hash-tag change.\n          // When replace is true, we don\'t want this.\n          if (!options.replace) {\n            this.iframe.document.open().close();\n          }\n          this._updateHash(this.iframe.location, frag, options.replace);\n        }\n\n      // If you\'ve told us that you explicitly don\'t want fallback hashchange-\n      // based history, then `navigate` becomes a page refresh.\n      } else {\n        window.location.assign(this.options.root + fragment);\n      }\n      if (options.trigger) {\n        this.loadUrl(fragment);\n      }\n    },\n\n    // Update the hash location, either replacing the current entry, or adding\n    // a new one to the browser history.\n    _updateHash: function(location, fragment, replace) {\n      if (replace) {\n        var s = location.toString().replace(/(javascript:|#).*$/, \'\');\n        location.replace(s + \'#\' + fragment);\n      } else {\n        location.hash = fragment;\n      }\n    }\n  });\n}(this));\n\n/*global _: false*/\n(function(root) {\n  root.Parse = root.Parse || {};\n  var Parse = root.Parse;\n  var _ = Parse._;\n\n  /**\n   * Routers map faux-URLs to actions, and fire events when routes are\n   * matched. Creating a new one sets its `routes` hash, if not set statically.\n   * @class\n   *\n   * <p>A fork of Backbone.Router, provided for your convenience.\n   * For more information, see the\n   * <a href="http://documentcloud.github.com/backbone/#Router">Backbone\n   * documentation</a>.</p>\n   * <p><strong><em>Available in the client SDK only.</em></strong></p>\n   */\n  Parse.Router = function(options) {\n    options = options || {};\n    if (options.routes) {\n      this.routes = options.routes;\n    }\n    this._bindRoutes();\n    this.initialize.apply(this, arguments);\n  };\n\n  // Cached regular expressions for matching named param parts and splatted\n  // parts of route strings.\n  var namedParam    = /:\\w+/g;\n  var splatParam    = /\\*\\w+/g;\n  var escapeRegExp  = /[\\-\\[\\]{}()+?.,\\\\\\^\\$\\|#\\s]/g;\n\n  // Set up all inheritable **Parse.Router** properties and methods.\n  _.extend(Parse.Router.prototype, Parse.Events,\n           /** @lends Parse.Router.prototype */ {\n\n    /**\n     * Initialize is an empty function by default. Override it with your own\n     * initialization logic.\n     */\n    initialize: function(){},\n\n    /**\n     * Manually bind a single named route to a callback. For example:\n     *\n     * <pre>this.route(\'search/:query/p:num\', \'search\', function(query, num) {\n     *       ...\n     *     });</pre>\n     */\n    route: function(route, name, callback) {\n      Parse.history = Parse.history || new Parse.History();\n      if (!_.isRegExp(route)) {\n        route = this._routeToRegExp(route);\n      }\n      if (!callback) {\n        callback = this[name];\n      }\n      Parse.history.route(route, _.bind(function(fragment) {\n        var args = this._extractParameters(route, fragment);\n        if (callback) {\n          callback.apply(this, args);\n        }\n        this.trigger.apply(this, [\'route:\' + name].concat(args));\n        Parse.history.trigger(\'route\', this, name, args);\n      }, this));\n      return this;\n    },\n\n    /**\n     * Whenever you reach a point in your application that you\'d\n     * like to save as a URL, call navigate in order to update the\n     * URL. If you wish to also call the route function, set the\n     * trigger option to true. To update the URL without creating\n     * an entry in the browser\'s history, set the replace option\n     * to true.\n     */\n    navigate: function(fragment, options) {\n      Parse.history.navigate(fragment, options);\n    },\n\n    // Bind all defined routes to `Parse.history`. We have to reverse the\n    // order of the routes here to support behavior where the most general\n    // routes can be defined at the bottom of the route map.\n    _bindRoutes: function() {\n      if (!this.routes) {\n        return;\n      }\n      var routes = [];\n      for (var route in this.routes) {\n        if (this.routes.hasOwnProperty(route)) {\n          routes.unshift([route, this.routes[route]]);\n        }\n      }\n      for (var i = 0, l = routes.length; i < l; i++) {\n        this.route(routes[i][0], routes[i][1], this[routes[i][1]]);\n      }\n    },\n\n    // Convert a route string into a regular expression, suitable for matching\n    // against the current location hash.\n    _routeToRegExp: function(route) {\n      route = route.replace(escapeRegExp, \'\\\\$&\')\n                   .replace(namedParam, \'([^\\/]+)\')\n                   .replace(splatParam, \'(.*?)\');\n      return new RegExp(\'^\' + route + \'$\');\n    },\n\n    // Given a route, and a URL fragment that it matches, return the array of\n    // extracted parameters.\n    _extractParameters: function(route, fragment) {\n      return route.exec(fragment).slice(1);\n    }\n  });\n\n  /**\n   * @function\n   * @param {Object} instanceProps Instance properties for the router.\n   * @param {Object} classProps Class properies for the router.\n   * @return {Class} A new subclass of <code>Parse.Router</code>.\n   */\n  Parse.Router.extend = Parse._extend;\n}(this));\n(function(root) {\n  root.Parse = root.Parse || {};\n  var Parse = root.Parse;\n  var _ = Parse._;\n\n  /**\n   * @namespace Contains functions for calling and declaring\n   * <a href="/docs/cloud_code_guide#functions">cloud functions</a>.\n   * <p><strong><em>\n   *   Some functions are only available from Cloud Code.\n   * </em></strong></p>\n   */\n  Parse.Cloud = Parse.Cloud || {};\n\n  _.extend(Parse.Cloud, /** @lends Parse.Cloud */ {\n    /**\n     * Makes a call to a cloud function.\n     * @param {String} name The function name.\n     * @param {Object} data The parameters to send to the cloud function.\n     * @param {Object} options A Backbone-style options object\n     * options.success, if set, should be a function to handle a successful\n     * call to a cloud function.  options.error should be a function that\n     * handles an error running the cloud function.  Both functions are\n     * optional.  Both functions take a single argument.\n     * @return {Parse.Promise} A promise that will be resolved with the result\n     * of the function.\n     */\n    run: function(name, data, options) {\n      options = options || {};\n\n      var request = Parse._request({\n        route: "functions",\n        className: name,\n        method: \'POST\',\n        useMasterKey: options.useMasterKey,\n        data: Parse._encode(data, null, true)\n      });\n\n      return request.then(function(resp) {\n        return Parse._decode(null, resp).result;\n      })._thenRunCallbacks(options);\n    }\n  });\n}(this));\n\n(function(root) {\n  root.Parse = root.Parse || {};\n  var Parse = root.Parse;\n\n  Parse.Installation = Parse.Object.extend("_Installation");\n\n  /**\n   * Contains functions to deal with Push in Parse\n   * @name Parse.Push\n   * @namespace\n   */\n  Parse.Push = Parse.Push || {};\n\n  /**\n   * Sends a push notification.\n   * @param {Object} data -  The data of the push notification.  Valid fields\n   * are:\n   *   <ol>\n   *     <li>channels - An Array of channels to push to.</li>\n   *     <li>push_time - A Date object for when to send the push.</li>\n   *     <li>expiration_time -  A Date object for when to expire\n   *         the push.</li>\n   *     <li>expiration_interval - The seconds from now to expire the push.</li>\n   *     <li>where - A Parse.Query over Parse.Installation that is used to match\n   *         a set of installations to push to.</li>\n   *     <li>data - The data to send as part of the push</li>\n   *   <ol>\n   * @param {Object} options An object that has an optional success function,\n   * that takes no arguments and will be called on a successful push, and\n   * an error function that takes a Parse.Error and will be called if the push\n   * failed.\n   */\n  Parse.Push.send = function(data, options) {\n    options = options || {};\n\n    if (data.where) {\n      data.where = data.where.toJSON().where;\n    }\n\n    if (data.push_time) {\n      data.push_time = data.push_time.toJSON();\n    }\n\n    if (data.expiration_time) {\n      data.expiration_time = data.expiration_time.toJSON();\n    }\n\n    if (data.expiration_time && data.expiration_interval) {\n      throw "Both expiration_time and expiration_interval can\'t be set";\n    }\n\n    var request = Parse._request({\n      route: \'push\',\n      method: \'POST\',\n      data: data,\n      useMasterKey: options.useMasterKey\n    });\n    return request._thenRunCallbacks(options);\n  };\n}(this));\n'
},function(t,e,n){n(14)(n(180))},function(t,e,n){n(14)(n(184))},function(t,e,n){n(14)(n(187))},function(t,e,n){n(14)(n(188))},function(t,e,n){n(14)(n(189))},function(t,e,n){n(14)(n(191))},function(t,e,n){n(14)(n(193))},function(t,e,n){n(14)(n(197))}])});
//# sourceMappingURL=bundle-07d9d75bbc8a61a2deb7.js.map